<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">

<!-- Mirrored from processors.wiki.ti.com/index.php/AM18XX_SitaraWare_EMAC by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 01 Dec 2020 09:55:33 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8"/>
<title>AM18XX SitaraWare EMAC - Texas Instruments Wiki</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"AM18XX_SitaraWare_EMAC","wgTitle":"AM18XX SitaraWare EMAC","wgCurRevisionId":216169,"wgRevisionId":216169,"wgArticleId":11108,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["AM18x"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"AM18XX_SitaraWare_EMAC","wgRelevantArticleId":11108,"wgRequestId":"9b6e89249800fcff45a4ed6f","wgIsProbablyEditable":false,"wgRelevantPageIsProbablyEditable":false,"wgRestrictionEdit":["sysop"],"wgRestrictionMove":["sysop"]});mw.loader.state({"site.styles":"ready","noscript":"ready","user.styles":"ready","user":"ready","user.options":"ready","user.tokens":"loading","mediawiki.legacy.shared":"ready","mediawiki.legacy.commonPrint":"ready","mediawiki.sectionAnchor":"ready","mediawiki.skinning.interface":"ready","skins.vector.styles":"ready"});mw.loader.implement("user.tokens@19o3a1s",function($,jQuery,require,module){/*@nomin*/mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});
});mw.loader.load(["site","mediawiki.page.startup","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.toc","mediawiki.searchSuggest","skins.vector.js"]);});</script>
<link rel="stylesheet" href="https://processors.wiki.ti.com/load.php?debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.interface%7Cskins.vector.styles&amp;only=styles&amp;skin=vector"/>
<script async="" src="https://processors.wiki.ti.com/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=vector"></script>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="https://processors.wiki.ti.com/load.php?debug=false&amp;lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=vector"/>
<meta name="generator" content="MediaWiki 1.31.6"/>
<link rel="shortcut icon" href="https://processors.wiki.ti.com/favicon.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="https://processors.wiki.ti.com/opensearch_desc.php" title="Texas Instruments Wiki (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="https://processors.wiki.ti.com/api.php?action=rsd"/>
<link rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/"/>
<link rel="alternate" type="application/atom+xml" title="Texas Instruments Wiki Atom feed" href="https://processors.wiki.ti.com/index.php?title=Special:RecentChanges&amp;feed=atom"/>
<!--[if lt IE 9]><script src="/load.php?debug=false&amp;lang=en&amp;modules=html5shiv&amp;only=scripts&amp;skin=Vector&amp;sync=1"></script><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-AM18XX_SitaraWare_EMAC rootpage-AM18XX_SitaraWare_EMAC skin-vector action-view">		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<div id="content" class="mw-body" role="main">
			<a id="top"></a>
			<div id="siteNotice" class="mw-body-content"><div id="localNotice" lang="en" dir="ltr"><div class="mw-parser-output"><p><br />
<span style="color:#ff0000"><b>NOTICE: The Processors Wiki will End-of-Life on January 15, 2021. It is recommended to download any files or other content you may need that are hosted on processors.wiki.ti.com. The site is now set to read only.</b></span>
</p></div></div></div><div class="mw-indicators mw-body-content">
</div>
<h1 id="firstHeading" class="firstHeading" lang="en">AM18XX SitaraWare EMAC</h1>			<div id="bodyContent" class="mw-body-content">
				<div id="siteSub" class="noprint">From Texas Instruments Wiki</div>				<div id="contentSub"></div>
								<div id="jump-to-nav" class="mw-jump">
					Jump to:					<a href="#mw-head">navigation</a>, 					<a href="#p-search">search</a>
				</div>
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output"><div style="padding:5px; background: #eeeeee; color: #FF0000">
<p><i><b>Important Note:</b></i><br />
</p><p><i><b>The software found on this site is available for download, but is no longer being actively developed and maintained. This wiki is in maintenance mode and the software is supported on <a rel="nofollow" class="external text" href="https://e2e.ti.com/support/arm/sitara_arm/f/791#pi239797013=1">Sitara E2E forum</a></b></i>
</p>
</div> <p><br />
</p><p><a href="File_TIBanner.html" class="image"><img alt="TIBanner.png" src="https://processors.wiki.ti.com/images/c/cd/TIBanner.png" width="667" height="87" /></a> <br /> 
</p><p><br />
</p>
<table width="1000" cellspacing="1" cellpadding="1" border="1">

<tbody><tr>
<th bgcolor="#ccffff" scope="col">IMPORTANT - The content of this page is due to change quite frequently and thus the quality and accuracy are not guaranteed until this message has been removed. For suggestion/recommendation, please send mail to your local FAE.
</th></tr></tbody></table>
<p><br />
</p>
<div id="toc" class="toc"><div class="toctitle" lang="en" dir="ltr"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#AM18XX_Ethernet"><span class="tocnumber">1</span> <span class="toctext">AM18XX Ethernet</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Lan8710a"><span class="tocnumber">2</span> <span class="toctext">Lan8710a</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Design_overview"><span class="tocnumber">3</span> <span class="toctext">Design overview</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#The_device_level_abstraction_layer"><span class="tocnumber">3.1</span> <span class="toctext">The device level abstraction layer</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#The_lwIP_interface_layer"><span class="tocnumber">3.2</span> <span class="toctext">The lwIP interface layer</span></a>
<ul>
<li class="toclevel-3 tocsection-6"><a href="#Sitara_network_interface_layer"><span class="tocnumber">3.2.1</span> <span class="toctext">Sitara network interface layer</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-7"><a href="#The_lwIP_application_layer"><span class="tocnumber">3.3</span> <span class="toctext">The lwIP application layer</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#The_System_application_layer"><span class="tocnumber">3.4</span> <span class="toctext">The System application layer</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-9"><a href="#EMAC_Programming"><span class="tocnumber">4</span> <span class="toctext">EMAC Programming</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#Example_applications"><span class="tocnumber">5</span> <span class="toctext">Example applications</span></a>
<ul>
<li class="toclevel-2 tocsection-11"><a href="#Embedded_Web_Server_application"><span class="tocnumber">5.1</span> <span class="toctext">Embedded Web Server application</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Echo_server_application"><span class="tocnumber">5.2</span> <span class="toctext">Echo server application</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#makefsfile_utility"><span class="tocnumber">5.3</span> <span class="toctext">makefsfile utility</span></a>
<ul>
<li class="toclevel-3 tocsection-14"><a href="#Executing_makefsfile_utility"><span class="tocnumber">5.3.1</span> <span class="toctext">Executing makefsfile utility</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>

<h2><span class="mw-headline" id="AM18XX_Ethernet">AM18XX Ethernet</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AM18XX_SitaraWare_EMAC&amp;action=edit&amp;section=1" title="Edit section: AM18XX Ethernet">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The AM1808 uses Ethernet Media Access Controller (EMAC) and Management Data Input/Output (MDIO) module integrated in the device for implementing ethernet interface.The EMAC peripheral conforms to the IEEE 802.3 standard, describing the Carrier Sense Multiple Access with Collision Detection (CSMA/CD) Access Method and Physical Layer specifications. The EMAC module provides an efficient interface between the processor and the network. The EMAC on AM1808 supports 10Base-T (10 Mbits/sec) and 100BaseTX (100 Mbits/sec), half-duplex and full-duplex mode. The EMAC control module is the main interface between the device core processor to the EMAC and MDIO modules. The EMAC control module controls device interrupts and incorporates an 8k-byte internal RAM to hold EMAC buffer descriptors (also known as CPPI RAM). The MDIO module implements the 802.3 serial management interface to interrogate and control up to 32 Ethernet PHYs connected to the device by using a shared two-wire bus. The application shall use the MDIO module to configure the auto negotiation parameters of each PHY attached to the EMAC, retrieve the negotiation results, and configure required parameters in the EMAC module for correct operation. The APIs for configuring and using EMAC and MDIO are exported in /include/emac.h and /include/mdio.h respectively. 
</p>
<h2><span class="mw-headline" id="Lan8710a">Lan8710a</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AM18XX_SitaraWare_EMAC&amp;action=edit&amp;section=2" title="Edit section: Lan8710a">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>LAN8710A is a low-power 10BASE-T/100BASE-TX physical layer (PHY) transceiver which communicates with the EMAC via standard MII/RMII Interface. All the configuration and register settings of the PHY will be done via MDIO interface. The APIs for configuring LAN8710A are exported in /include/lan8710a.h. 
</p>
<h2><span class="mw-headline" id="Design_overview">Design overview</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AM18XX_SitaraWare_EMAC&amp;action=edit&amp;section=3" title="Edit section: Design overview">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The SitaraWare Ethernet software deliverable can be broadly classified into three main components:
</p>
<ol><li>The device abstraction layer - EMAC DAL, MDIO DAL, PHY DAL</li>
<li>The LWIP Network Interface Layer - Sitara NetIF port for LWIP</li>
<li>The LWIP based application layer - An IP stack based application based on LWIP. For example HTTP server, UDP based client, an embedded web server serving control pages etc. The packets start and end at this layer.</li>
<li>The System application layer - The application layer which is used for AM1808 initialization and can be used for any other algorithm of the system</li></ol>
<p><a href="File_SitaraWareEthernetApplication.html" class="image"><img alt="SitaraWareEthernetApplication.jpg" src="https://processors.wiki.ti.com/images/2/2e/SitaraWareEthernetApplication.jpg" width="733" height="517" /></a>
</p>
<h3><span class="mw-headline" id="The_device_level_abstraction_layer">The device level abstraction layer</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AM18XX_SitaraWare_EMAC&amp;action=edit&amp;section=4" title="Edit section: The device level abstraction layer">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>This layer implements the lowest level hardware abstraction APIs which can be used for control and configuration of the EMAC device. There are three files that form this layer and are located at <i>SitaraWare_xx_yy_mm_pp/drivers/</i>
</p>
<ul><li>emac.c which acts upon the Ethernet MAC and Control module</li>
<li>mdio.c which acts upon the MDIO interface between the PHY and MAC</li>
<li>lan8710a.c which acts upon the PHY device.</li></ul>
<p>The device abstraction layer is implemented as a very light layer just for hardware/device access and conforms to the generic framework of SitaraWare - it does not maintain any state variables.
</p>
<h3><span class="mw-headline" id="The_lwIP_interface_layer">The lwIP interface layer</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AM18XX_SitaraWare_EMAC&amp;action=edit&amp;section=5" title="Edit section: The lwIP interface layer">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>For realistic interfacing of Ethernet device with the rest of the network, the device abstraction layer needs to be glued with a network stack that can form/interpret network packets. The choice is to have lwIP, for its no OS adaptability and support for fair number of network protocols. The device abstraction is glued by implementing the interface layer of lwIP. This is also called as the sitara-port for the lwIP or the sitara-interface for lwIP. This lwIP interface layer forms a major part of the SitaraWare network driver. It defines standard interface entry points and interface state variable. A network device is represented by "struct netif", generically referred to as netif. The netif contains all the information about the interface, like the IP/MAC address(s), TCP/IP options, protocol handlers, link Information and most importantly the network device driver entry point callbacks. Every network interface, as also sitara interface, implements the linkoutput and init callbacks. Also, any state information is maintained in this structure. The interface layer also implement the core interrupt handling and DMA handling. All the required function calls for initializing the lwIP stack and registering the sitara network interface are abstracted under the lwiplib.c. Refer to <a rel="nofollow" class="external text" href="http://www.sics.se/~adam/lwip/doc/lwip.pdf">lwip.pdf</a> for details on lwIP stack implementation. Further sections below explain the network interface initialization and registration. This is located at <i>third_party/lwip-1.3.2/ports/am1808/</i>
</p>
<h5><span class="mw-headline" id="Sitara_network_interface_layer">Sitara network interface layer</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AM18XX_SitaraWare_EMAC&amp;action=edit&amp;section=6" title="Edit section: Sitara network interface layer">edit</a><span class="mw-editsection-bracket">]</span></span></h5>
<p>The main tasks of the Sitara network interface layer are 
</p>
<ul><li>Network device initialization</li></ul>
<p>Network device initialization, which is the first step towards bringing up the interface, is done as part of the sitaraif_init. This function is called when the network device is being registered with the lwip stack using netif_add. As part of the initialization, the netif output callbacks are registered and h/w initialization, which includes PHY and DMA initialization, are completed. DMA buffer descriptor(bd) pools are maintained in the CPPI RAM for both TX and RX channels. The descriptor chains are maintained by the "free_head" which points to the next unused/free descriptor in the bd pool, "active_tail" which points to the last bd in the active queue which has been en-queued to the hardware. The packet buffers (pbuf) are pre-allocated for maximum length and queued in the receive buffer descriptors before the reception begins. Please refer to lwip.pdf Section 6, for details on pbuf handling by lwIP. 
</p>
<ul><li>Packet data transmission</li></ul>
<p>The packet data transmission takes place in the context of linkoutput callback registered with the lwIP stack. This callback is invoked whenever the lwIP stack receives a packet for transmission from the application layer. The pbuf can contain a chain of packet buffers and hence the DMA descriptors are properly updated (chained if necessary), with SOP, EOP and length fields. The first DMA descriptor is marked with the EOP and OWNER flags, while only the last is set with the EOP flag. After filling the bd's with the pbuf information, the bd, which corresponds to the SOP is written to the HEAD descriptor pointer register to start the transmission. Once a packet is transmitted, the EMAC Control Core will generate a transmit interrupt. This interrupt will be cleared only if the completion pointer is written with the last bd processed. In the interrupt handler, the next bd to process is taken then traversed to reach the bd which corresponds to the end of the packet. This bd, which corresponds to the end of the packet is written to the completion pointer. After this, the pbuf which corresponds to this packet is freed. Thus it is made sure that the freeing of pbuf is done only after the packet transmission is complete. 
</p>
<ul><li>Packet data reception</li></ul>
<p>The packet reception takes place in the context of the interrupt handler for receive. As described earlier, the receive buffer descriptors are en-queued to the DMA before the reception can actually begin. The pbuf allocated for maximum length, may actually contain a chain of packet buffers. The descriptors are updated for OWNER flag only. The EOP, SOP and EOQ are updated by the DMA upon completion of the reception. One important point to note is that, the actual data received may be less/more than the max length allocated. Hence the pbuf chain needs to be adjusted as detailed here. First, the active_head (which is the first bd en-queued), is checked for OWNER bit having been cleared by the DMA. Then the bd list is traversed, starting at the active_head, to find the EOP bd, which is the last bd of the current packet. While doing so if the EOP is not found on the current bd, then the pbuf of the current bd is chained to the pbuf of the next bd, since the current packet has spilled over to the next bd. Once, the EOP is found the last pbuf is updated as the terminator (pbuf-&gt;next = NULL). Thus, the entire packet is collected and passed to the upper layer for processing. Since, the current bd has been done with, it is put back at the free_head, by allocating a new pbuf.
</p>
<h3><span class="mw-headline" id="The_lwIP_application_layer">The lwIP application layer</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AM18XX_SitaraWare_EMAC&amp;action=edit&amp;section=7" title="Edit section: The lwIP application layer">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>This layer contains the ethernet application like a HTTP server, an echo server etc. This is located at "SitaraWare_xx_yy_mm_pp/third_party/lwip-1.3.2/apps/&lt;application&gt;/". This is the layer at which all the imcoming packets terminate and all outgoing packets originate.
</p>
<h3><span class="mw-headline" id="The_System_application_layer">The System application layer</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AM18XX_SitaraWare_EMAC&amp;action=edit&amp;section=8" title="Edit section: The System application layer">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>This layer implements system level initialization and provides options for lwIP stack. This layer can contain any other algorithms, decoding etc. The main IP stack based application is part of the lwip directory as mentioned above.
</p>
<h2><span class="mw-headline" id="EMAC_Programming">EMAC Programming</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AM18XX_SitaraWare_EMAC&amp;action=edit&amp;section=9" title="Edit section: EMAC Programming">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>When the device is powered on EMAC will be in a disabled state. Proper pin multiplexing has to be done for EMAC and MDIO modules. Also, before any EMAC specific initialization, the EMAC and MDIO modules shall be enabled in PSC registers. The below sequence can be used configure and use the EMAC and MDIO modules. 
</p>
<ul><li>Enable the pin multiplexing for EMAC and MDIO using <i>EMACPinMuxSetup()</i> API.</li>
<li>Enable the EMAC and MDIO modules in PSC registers using the API <i>PSCModuleControl().</i></li>
<li>Initialize the EMAC module by invoking <i>EMACInit().</i> This API resets the EMAC and EMAC Control Module Registers.</li>
<li>Initialize the MDIO Module using<i>MDIOInit().</i> Enough delay shall be given to ensure the successful completion of the MDIO module initialization before any further access to MDIO.</li>
<li>Auto negotiate with the PHY device connected through the MDIO. Respective PHY Auto negotiation API can be used for this.</li>
<li>On successful completion of auto negotiation, get the auto negotiation result using the respective PHY’s link partner ability API and set the duplex mode of operation in the EMAC using <i>EMACDuplexSet().</i></li>
<li>Set the MAC Address in the EMAC hardware using <i>EMACMACAddrSet().</i></li>
<li>Enable unicast for a specific channel using the API <i>EMACRxUnicastSet(),</i> if desired.</li>
<li>Initialize the TX and RX buffer descriptors in the CPPI RAM, which is local to the EMAC.</li>
<li>Enable the TX operation in EMAC using <i>EMACTxEnable().</i> This enables the EMAC hardware transmit operation. However, transmission will start only if a valid descriptor pointer is written using <i>EMACTxHdrDescPtrWrite().</i></li>
<li>Enable the RX operation in EMAC using <i>EMACRXEnable()</i></li>
<li>Write the RX Header Descriptor Pointer using <i>EMACRxHdrDescPtrWrite().</i> The EMAC hardware will start receiving data at this point. The data will be stored to the buffer pointer in this buffer descriptor. After the buffer corresponding to this descriptor is filled, the next descriptor is used by the EMAC hardware according to the buffer descriptor settings.</li>
<li>Enable MII using <i>EMACMIIEnable()</i></li>
<li>Enable the Transmit and Receive Pulse interrupts using <i>EMACTxIntPulseEnable()</i> and <i>EMACRxIntPulseEnable().</i> The interrupts will be routed through the EMAC Control Core to the ARM Interrupt Controller. This enables the EMAC TX and RX pulse interrupts at EMAC peripheral level only. The core interrupts shall be enabled separately in the interrupt controller.</li></ul>
<ul><li>In an EMAC Transmit interrupt handler, the interrupt shall be acknowledged to the EMAC hardware using <i>EMACCoreIntAck().</i> However, the interrupt will be cleared only if the completion pointer is written using the API <i>EMACTxCPWrite()</i> with the last processed TX buffer descriptor.</li>
<li>In an EMAC Receive interrupt handler, the interrupt shall be acknowledged to the EMAC hardware using <i>EMACCoreIntAck().</i> Again, the interrupt will be cleared only if the completion pointer is written using the API <i>EMACRxCPWrite()</i> with the last processed RX buffer descriptor.</li></ul>
<h2><span class="mw-headline" id="Example_applications">Example applications</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AM18XX_SitaraWare_EMAC&amp;action=edit&amp;section=10" title="Edit section: Example applications">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p><b>TMS470 Tool chain does not support packed attributes. This leads to issues when ethernet applications, built with TMS470 tool chain, are executed on the target. Hence, please do not use/connect ethernet in the demo. This issue is documented in the Known issues section of the release notes</b> <br /> 
</p><p>The SitaraWare AM18XX ethernet application over lwIP stack is demonstrated using two applications.
</p>
<ol><li>An embedded web server application, which hosts a default page when requested</li>
<li>An echo server application, which demonstrates a simple data transfer between a client and server.</li></ol>
<ul><li>Modules used in this example
<ul><li>EMAC</li>
<li>MDIO</li>
<li>LAN8710A</li>
<li>Interrupt</li>
<li>UART</li>
<li>lwIP Stack</li></ul></li></ul>
<p>In the following examples, the MAC Address and IP address can be configured in <i>enet_lwip/include/lwipopts.h</i>. The macro MAC_ADDRESS shall specify the MAC address and STATIC_IP_ADDRESS shall specify the static IP address to be used. If a dynamic IP address to be used, STATIC_IP_ADDRESS shall be defined as 0.
</p>
<h3><span class="mw-headline" id="Embedded_Web_Server_application">Embedded Web Server application</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AM18XX_SitaraWare_EMAC&amp;action=edit&amp;section=11" title="Edit section: Embedded Web Server application">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>A sample http server application is demonstrated, using lwIP stack. This is located at <i>SitaraWare_xx_yy_mm_pp/examples/evmAM1808/enet_lwip/</i>.  
</p><p><br />Before executing the example, ensure that the serial port on board is connected to the host machine and a serial terminal application (like TeraTem/Hyperterminal/minicom) is running on the host. The example uses a serial console to display the dynamic IP address assigned for the EVM by the DHCP server. Flash the Ethernet example application or load the executable ELF (.out) file on to the EVM. 
</p>
<ul><li>Testing by connecting peer to peer with a host machine:
<ul><li>Connect the Ethernet port on board to the host Ethernet port via an Ethernet cable</li>
<li>Assign a static IP address to the host machine.</li>
<li>Run a DHCP server application on the host.</li>
<li>Execute the example application</li>
<li>Note the dynamic IP address assigned which displayed on the serial console.</li>
<li>Access the http server application default page using <code>http://&lt;ip_address&gt;/index.html</code> via a web browser on the host.</li>
<li>Ensure that proxy server is not used for the dynamic IP address assigned for the board.</li></ul></li></ul>
<ul><li>Testing by connecting to a corporate network:
<ul><li>Connect the Ethernet port on board to a port on the corporate network.</li>
<li>Execute the example application.</li>
<li>Note the dynamic IP address assigned which displayed on the serial console.</li>
<li>Access the http server application default page using <code>http://&lt;ip_address&gt;/index.html</code> via a web browser on the host.</li>
<li>Ensure that proxy server is not used for the dynamic IP address assigned for the board.</li></ul></li></ul>
<h3><span class="mw-headline" id="Echo_server_application">Echo server application</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AM18XX_SitaraWare_EMAC&amp;action=edit&amp;section=12" title="Edit section: Echo server application">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>A sample echo server-client set up is demonstrated, using lwIP stack. The echo server, which runs on the target just echos back the received data to the sender - typically the client running on a Linux host in this case. The client then compares the sent and received data for integrity and the result is printed on the client console. The client application is also delivered as part of package and is located at <i>SitaraWare_xx_yy_mm_pp/host_apps/enet_client</i>.
</p><p><br />Before executing the example, ensure that the serial port on board is connected to the host machine and a serial terminal application (like TeraTem/Hyperterminal/minicom) is running on the host. The example uses a serial console to display the dynamic IP address assigned for the EVM by the DHCP server. Flash the Ethernet example application or load the executable ELF (.out) file on to the EVM.
</p>
<ul><li>Testing by connecting peer to peer with a host machine:
<ul><li>Connect the Ethernet port on board to the host Ethernet port via an Ethernet cable</li>
<li>Assign a static IP address to the host machine.</li>
<li>Run a DHCP server application on the host.</li>
<li>Execute the example application on the target</li></ul></li></ul>
<ul><li>Testing by connecting to a corporate network:
<ul><li>Connect the Ethernet port on board to a port on the corporate network.</li>
<li>Execute the example application on the target.</li>
<li>Note the dynamic IP address assigned which displayed on the serial console.</li></ul></li></ul>
<p>Now execute the client application on the host. 
</p>
<pre>   $ ./client &lt;ip-address-announced-by-the-echo-server&gt;
</pre>
<p>The client prints the status of the application on the console
</p>
<h3><span class="mw-headline" id="makefsfile_utility">makefsfile utility</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AM18XX_SitaraWare_EMAC&amp;action=edit&amp;section=13" title="Edit section: makefsfile utility">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>'makefsfile' may be used to create file system images to embed in ethernet applications offering web server interfaces. It can be used to generate an ASCII C file containing initialized data structures, which represents the html pages which need to be embedded in the application. 'makefsfile' is at "tools/makefsfile/", provided in source and binary form. Executing the binary without any input provides a detailed help menu which guides the user.
</p>
<h4><span class="mw-headline" id="Executing_makefsfile_utility">Executing makefsfile utility</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AM18XX_SitaraWare_EMAC&amp;action=edit&amp;section=14" title="Edit section: Executing makefsfile utility">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p><i>$ ./makefsfile</i> <br />
This prints a detailed help menu
</p><p><i>$./makefsfile  -i  &lt;directory-path&gt;</i> <br />
This takes an input directory path which contains the saved html pages which need to be converted to a C file which can be embedded in an application. The file fsdata.c will be generated inside directory from where makefsfile is executed.
</p>
<!-- 
NewPP limit report
Cached time: 20201130233321
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.061 seconds
Real time usage: 0.064 seconds
Preprocessor visited node count: 61/1000000
Preprocessor generated node count: 74/1000000
Post‐expand include size: 327/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 0/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    1.379      1 SitaraWare_Under_Construction
100.00%    1.379      1 -total
-->
</div>
<!-- Saved in parser cache with key procwiki:pcache:idhash:11108-0!canonical and timestamp 20201130233321 and revision id 216169
 -->
<div class='hf-nsfooter' id='hf-nsfooter-'><table style="text-align:center; background:white; width:100%; text-align:left; height: 65px border-top: 1px solid; border-bottom: 1px solid; border-left: 1px solid; border-right: 1px solid; border-width: 1px; border-style: solid;">
<tr>
<td width="305px"><a href="File_E2e.html" class="image"><img alt="E2e.jpg" src="https://processors.wiki.ti.com/images/8/82/E2e.jpg" width="305" height="63" /></a>
</td>
<td>{{
<ol><li>switchcategory:MultiCore=</li></ol>
<ul><li>For technical support on MultiCore devices, please post your questions in the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/c6000_multi-core_dsps/default.aspx">C6000 MultiCore Forum</a></li>
<li>For questions related to the BIOS MultiCore SDK (MCSDK), please use the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/embedded/f/355.aspx">BIOS Forum</a></li></ul>
<p>Please post only comments related to the article <b>AM18XX SitaraWare EMAC</b> here.<i></i>
</p>
</td>
<td>Keystone=
<ul><li>For technical support on MultiCore devices, please post your questions in the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/c6000_multi-core_dsps/default.aspx">C6000 MultiCore Forum</a></li>
<li>For questions related to the BIOS MultiCore SDK (MCSDK), please use the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/embedded/f/355.aspx">BIOS Forum</a></li></ul>
<p>Please post only comments related to the article <b>AM18XX SitaraWare EMAC</b> here.<i></i>
</p>
</td>
<td>C2000=<i>For technical support on the C2000 please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/microcontrollers/tms320c2000_32-bit_real-time_mcus/f/171.aspx">The C2000 Forum</a>. Please post only comments about the article <b>AM18XX SitaraWare EMAC</b> here.</i>
</td>
<td>DaVinci=<i>For technical support on DaVincoplease post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/davinci_digital_media_processors/default.aspx">The DaVinci Forum</a>. Please post only comments about the article <b>AM18XX SitaraWare EMAC</b> here.</i>
</td>
<td>MSP430=<i>For technical support on MSP430 please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/microcontrollers/msp43016-bit_ultra-low_power_mcus/default.aspx">The MSP430 Forum</a>. Please post only comments about the article <b>AM18XX SitaraWare EMAC</b> here.</i>
</td>
<td>OMAP35x=<i>For technical support on OMAP please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/omap_applications_processors/default.aspx">The OMAP Forum</a>. Please post only comments about the article <b>AM18XX SitaraWare EMAC</b> here.</i>
</td>
<td>OMAPL1=<i>For technical support on OMAP please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/omap_applications_processors/default.aspx">The OMAP Forum</a>. Please post only comments about the article <b>AM18XX SitaraWare EMAC</b> here.</i>
</td>
<td>MAVRK=<i>For technical support on MAVRK please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/development_tools/mavrk/default.aspx">The MAVRK Toolbox Forum</a>. Please post only comments about the article <b>AM18XX SitaraWare EMAC</b> here.</i>
</td>
<td><i>For technical support please post your questions at <a rel="nofollow" class="external text" href="http://e2e.ti.com/">http://e2e.ti.com</a>. Please post only comments about the article <b>AM18XX SitaraWare EMAC</b> here.</i>
<p>}}
</p>
</td></tr></table>
<table style="border-style:solid; border-width:1px; text-align:center; width:100%;">

<tr style="font-size:150%;">
<td rowspan="2"><a href="File_Hyperlink_blue.html" class="image"><img alt="Hyperlink blue.png" src="https://processors.wiki.ti.com/images/9/9f/Hyperlink_blue.png" width="96" height="96" /></a>
</td>
<td><b>Links</b>
</td></tr>
<tr>
<td>
<table style="text-align: left;">
<tr>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/amplifier_and_linear.page">Amplifiers &amp; Linear</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/audio/audio_overview.page">Audio</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/rfif.page">Broadband RF/IF &amp; Digital Radio</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/clocksandtimers/clocks_and_timers.page">Clocks &amp; Timers</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/dataconverters/data_converter.page">Data Converters</a>
</p>
</td>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/mems/mems.page">DLP &amp; MEMS</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/high_reliability.page">High-Reliability</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/interface/interface.page">Interface</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/logic/home_overview.page">Logic</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/powermanagement/power_portal.page">Power Management</a>
</p>
</td>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/dsp/embedded_processor.page">Processors</a>
</p>
<ul><li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/dsp/arm.page">ARM Processors</a></li>
<li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/dsp/home.page">Digital Signal Processors (DSP)</a></li>
<li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/microcontroller/home.page">Microcontrollers (MCU)</a></li>
<li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/omap-applications-processors/the-omap-experience.page">OMAP Applications Processors</a></li></ul>
</td>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/switches_and_multiplexers.page">Switches &amp; Multiplexers</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/temperature_sensor.page">Temperature Sensors &amp; Control ICs</a><br/>
<a rel="nofollow" class="external text" href="http://focus.ti.com/wireless/docs/wirelessoverview.tsp?familyId=2003&amp;sectionId=646&amp;tabId=2735">Wireless Connectivity</a>
</p>
</td></tr></table>
</td></tr></table>
<div id="tiPrivacy"></div>
</div></div>					<div class="printfooter">
						Retrieved from "<a dir="ltr" href="https://processors.wiki.ti.com/index.php?title=AM18XX_SitaraWare_EMAC&amp;oldid=216169">https://processors.wiki.ti.com/index.php?title=AM18XX_SitaraWare_EMAC&amp;oldid=216169</a>"					</div>
				<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="Special_Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="Category_AM18x.html" title="Category:AM18x">AM18x</a></li></ul></div></div>				<div class="visualClear"></div>
							</div>
		</div>
		<div id="mw-navigation">
			<h2>Navigation menu</h2>
			<div id="mw-head">
									<div id="p-personal" role="navigation" class="" aria-labelledby="p-personal-label">
						<h3 id="p-personal-label">Personal tools</h3>
						<ul>
							<li id="pt-login"><a href="https://processors.wiki.ti.com/index.php?title=Special:UserLogin&amp;returnto=AM18XX+SitaraWare+EMAC" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li><li id="pt-createaccount"><a href="Special_RequestAccount.html" title="You are encouraged to create an account and log in; however, it is not mandatory">Request account</a></li>						</ul>
					</div>
									<div id="left-navigation">
										<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
						<h3 id="p-namespaces-label">Namespaces</h3>
						<ul>
							<li id="ca-nstab-main" class="selected"><span><a href="AM18XX_SitaraWare_EMAC.html" title="View the content page [c]" accesskey="c">Page</a></span></li><li id="ca-talk" class="new"><span><a href="https://processors.wiki.ti.com/index.php?title=Talk:AM18XX_SitaraWare_EMAC&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page (page does not exist) [t]" accesskey="t">Discussion</a></span></li>						</ul>
					</div>
										<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
												<input type="checkbox" class="vectorMenuCheckbox" aria-labelledby="p-variants-label" />
						<h3 id="p-variants-label">
							<span>Variants</span>
						</h3>
						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
									</div>
				<div id="right-navigation">
										<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
						<h3 id="p-views-label">Views</h3>
						<ul>
							<li id="ca-view" class="collapsible selected"><span><a href="AM18XX_SitaraWare_EMAC.html">Read</a></span></li><li id="ca-viewsource" class="collapsible"><span><a href="https://processors.wiki.ti.com/index.php?title=AM18XX_SitaraWare_EMAC&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></span></li><li id="ca-history" class="collapsible"><span><a href="https://processors.wiki.ti.com/index.php?title=AM18XX_SitaraWare_EMAC&amp;action=history" title="Past revisions of this page [h]" accesskey="h">View history</a></span></li>						</ul>
					</div>
										<div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label">
						<input type="checkbox" class="vectorMenuCheckbox" aria-labelledby="p-cactions-label" />
						<h3 id="p-cactions-label"><span>More</span></h3>
						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
										<div id="p-search" role="search">
						<h3>
							<label for="searchInput">Search</label>
						</h3>
						<form action="https://processors.wiki.ti.com/index.php" id="searchform">
							<div id="simpleSearch">
								<input type="search" name="search" placeholder="Search Texas Instruments Wiki" title="Search Texas Instruments Wiki [f]" accesskey="f" id="searchInput"/><input type="hidden" value="Special:Search" name="title"/><input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton mw-fallbackSearchButton"/><input type="submit" name="go" value="Go" title="Go to a page with this exact name if it exists" id="searchButton" class="searchButton"/>							</div>
						</form>
					</div>
									</div>
			</div>
			<div id="mw-panel">
				<div id="p-logo" role="banner"><a class="mw-wiki-logo" href="Main_Page.html"  title="Visit the main page"></a></div>
						<div class="portal" role="navigation" id="p-navigation" aria-labelledby="p-navigation-label">
			<h3 id="p-navigation-label">Navigation</h3>
			<div class="body">
								<ul>
					<li id="n-mainpage"><a href="Main_Page.html" title="Visit the main page [z]" accesskey="z">Main Page</a></li><li id="n-All-pages"><a href="Special_AllPages.html">All pages</a></li><li id="n-All-categories"><a href="Special_Categories.html">All categories</a></li><li id="n-recentchanges"><a href="Special_RecentChanges.html" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li><li id="n-randompage"><a href="Package_Reflow_Profiles.html" title="Load a random page [x]" accesskey="x">Random page</a></li><li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" title="The place to find out">Help</a></li>				</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id="p-tb" aria-labelledby="p-tb-label">
			<h3 id="p-tb-label">Toolbox</h3>
			<div class="body">
								<ul>
					<li id="t-whatlinkshere"><a href="Special_WhatLinksHere/AM18XX_SitaraWare_EMAC.html" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li><li id="t-recentchangeslinked"><a href="Special_RecentChangesLinked/AM18XX_SitaraWare_EMAC.html" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li><li id="t-specialpages"><a href="Special_SpecialPages.html" title="A list of all special pages [q]" accesskey="q">Special pages</a></li><li id="t-print"><a href="https://processors.wiki.ti.com/index.php?title=AM18XX_SitaraWare_EMAC&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li><li id="t-permalink"><a href="https://processors.wiki.ti.com/index.php?title=AM18XX_SitaraWare_EMAC&amp;oldid=216169" title="Permanent link to this revision of the page">Permanent link</a></li><li id="t-info"><a href="https://processors.wiki.ti.com/index.php?title=AM18XX_SitaraWare_EMAC&amp;action=info" title="More information about this page">Page information</a></li>				</ul>
							</div>
		</div>
				</div>
		</div>
				<div id="footer" role="contentinfo">
						<ul id="footer-info">
								<li id="footer-info-lastmod"> This page was last edited on 9 May 2016, at 10:01.</li>
								<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-ShareAlike</a> unless otherwise noted.</li>
							</ul>
						<ul id="footer-places">
								<li id="footer-places-privacy"><a href="Project_Privacy_policy.html" title="Project:Privacy policy">Privacy policy</a></li>
								<li id="footer-places-about"><a href="Project_About.html" title="Project:About">About Texas Instruments Wiki</a></li>
								<li id="footer-places-disclaimer"><a href="Project_General_disclaimer.html" title="Project:General disclaimer">Disclaimers</a></li>
								<li id="footer-places-termsofservice"><a href="Project_Terms_of_Service.html" title="Project:Terms of Service">Terms of Use</a></li>
							</ul>
										<ul id="footer-icons" class="noprint">
										<li id="footer-copyrightico">
						<a href="http://creativecommons.org/licenses/by-sa/3.0/"><img src="https://processors.wiki.ti.com/resources/assets/licenses/cc-by-sa.png" alt="Creative Commons Attribution-ShareAlike" width="88" height="31"/></a>					</li>
										<li id="footer-poweredbyico">
						<a href="http://www.mediawiki.org/"><img src="https://processors.wiki.ti.com/resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31"/></a>					</li>
									</ul>
						<div style="clear: both;"></div>
		</div>
		<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgPageParseReport":{"limitreport":{"cputime":"0.061","walltime":"0.064","ppvisitednodes":{"value":61,"limit":1000000},"ppgeneratednodes":{"value":74,"limit":1000000},"postexpandincludesize":{"value":327,"limit":2097152},"templateargumentsize":{"value":0,"limit":2097152},"expansiondepth":{"value":2,"limit":40},"expensivefunctioncount":{"value":0,"limit":100},"unstrip-depth":{"value":0,"limit":20},"unstrip-size":{"value":0,"limit":5000000},"timingprofile":["100.00%    1.379      1 SitaraWare_Under_Construction","100.00%    1.379      1 -total"]},"cachereport":{"timestamp":"20201130233321","ttl":86400,"transientcontent":false}}});});</script><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":229});});</script>
	</body>

<!-- Mirrored from processors.wiki.ti.com/index.php/AM18XX_SitaraWare_EMAC by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 01 Dec 2020 09:55:36 GMT -->
</html>
