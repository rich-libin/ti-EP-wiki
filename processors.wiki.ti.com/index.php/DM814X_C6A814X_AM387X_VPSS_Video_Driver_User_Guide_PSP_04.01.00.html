<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">

<!-- Mirrored from processors.wiki.ti.com/index.php/DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 01 Dec 2020 03:55:18 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8"/>
<title>DM814X C6A814X AM387X VPSS Video Driver User Guide PSP 04.01.00.04 - Texas Instruments Wiki</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04","wgTitle":"DM814X C6A814X AM387X VPSS Video Driver User Guide PSP 04.01.00.04","wgCurRevisionId":182396,"wgRevisionId":182396,"wgArticleId":8910,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["TI814x","Linux","PSP"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04","wgRelevantArticleId":8910,"wgRequestId":"ddc8b661091673a426792aaa","wgIsProbablyEditable":false,"wgRelevantPageIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[]});mw.loader.state({"site.styles":"ready","noscript":"ready","user.styles":"ready","user":"ready","user.options":"ready","user.tokens":"loading","mediawiki.legacy.shared":"ready","mediawiki.legacy.commonPrint":"ready","mediawiki.sectionAnchor":"ready","mediawiki.skinning.interface":"ready","skins.vector.styles":"ready"});mw.loader.implement("user.tokens@19o3a1s",function($,jQuery,require,module){/*@nomin*/mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});
});mw.loader.load(["site","mediawiki.page.startup","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.toc","mediawiki.searchSuggest","skins.vector.js"]);});</script>
<link rel="stylesheet" href="https://processors.wiki.ti.com/load.php?debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.interface%7Cskins.vector.styles&amp;only=styles&amp;skin=vector"/>
<script async="" src="https://processors.wiki.ti.com/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=vector"></script>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="https://processors.wiki.ti.com/load.php?debug=false&amp;lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=vector"/>
<meta name="generator" content="MediaWiki 1.31.6"/>
<link rel="shortcut icon" href="https://processors.wiki.ti.com/favicon.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="https://processors.wiki.ti.com/opensearch_desc.php" title="Texas Instruments Wiki (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="https://processors.wiki.ti.com/api.php?action=rsd"/>
<link rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/"/>
<link rel="alternate" type="application/atom+xml" title="Texas Instruments Wiki Atom feed" href="https://processors.wiki.ti.com/index.php?title=Special:RecentChanges&amp;feed=atom"/>
<!--[if lt IE 9]><script src="/load.php?debug=false&amp;lang=en&amp;modules=html5shiv&amp;only=scripts&amp;skin=Vector&amp;sync=1"></script><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04_01_00_04 rootpage-DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04_01_00_04 skin-vector action-view">		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<div id="content" class="mw-body" role="main">
			<a id="top"></a>
			<div id="siteNotice" class="mw-body-content"><div id="localNotice" lang="en" dir="ltr"><div class="mw-parser-output"><p><br />
<span style="color:#ff0000"><b>NOTICE: The Processors Wiki will End-of-Life on January 15, 2021. It is recommended to download any files or other content you may need that are hosted on processors.wiki.ti.com. The site is now set to read only.</b></span>
</p></div></div></div><div class="mw-indicators mw-body-content">
</div>
<h1 id="firstHeading" class="firstHeading" lang="en">DM814X C6A814X AM387X VPSS Video Driver User Guide PSP 04.01.00.04</h1>			<div id="bodyContent" class="mw-body-content">
				<div id="siteSub" class="noprint">From Texas Instruments Wiki</div>				<div id="contentSub"></div>
								<div id="jump-to-nav" class="mw-jump">
					Jump to:					<a href="#mw-head">navigation</a>, 					<a href="#p-search">search</a>
				</div>
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output"><p><b>Video Driver</b>
</p>
<div id="toc" class="toc"><div class="toctitle" lang="en" dir="ltr"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Read_This_First"><span class="tocnumber">1</span> <span class="toctext"><b>Read This First </b></span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Installation_Guide"><span class="tocnumber">2</span> <span class="toctext"><b>Installation Guide</b></span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Introduction"><span class="tocnumber">2.1</span> <span class="toctext"><b>Introduction</b></span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Preliminary_Work"><span class="tocnumber">2.2</span> <span class="toctext"><b>Preliminary Work</b></span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Build_Linux_VPSS.2C_Fbdev_and_V4L2_Display_Drivers"><span class="tocnumber">2.3</span> <span class="toctext"><b>Build Linux VPSS, Fbdev and V4L2 Display Drivers</b></span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Prerequisites"><span class="tocnumber">2.4</span> <span class="toctext"><b>Prerequisites </b></span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Load_VPSS_and_Fbdev_Driver_Modules"><span class="tocnumber">2.5</span> <span class="toctext"><b>Load VPSS and Fbdev Driver Modules</b></span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Load_On-Chip_HDMI_Module"><span class="tocnumber">2.6</span> <span class="toctext"><b>Load On-Chip HDMI Module</b></span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-9"><a href="#Introduction_2"><span class="tocnumber">3</span> <span class="toctext"><b>Introduction</b></span></a>
<ul>
<li class="toclevel-2 tocsection-10"><a href="#References"><span class="tocnumber">3.1</span> <span class="toctext"><b>References</b></span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Acronyms_.26_Definitions"><span class="tocnumber">3.2</span> <span class="toctext"><b>Acronyms &amp; Definitions</b></span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Hardware_Overview"><span class="tocnumber">3.3</span> <span class="toctext"><b>Hardware Overview</b></span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-13"><a href="#Features"><span class="tocnumber">4</span> <span class="toctext"><b>Features</b></span></a></li>
<li class="toclevel-1 tocsection-14"><a href="#Architecture"><span class="tocnumber">5</span> <span class="toctext"><b>Architecture</b></span></a>
<ul>
<li class="toclevel-2 tocsection-15"><a href="#Driver_Architecture"><span class="tocnumber">5.1</span> <span class="toctext"><b>Driver Architecture</b></span></a></li>
<li class="toclevel-2 tocsection-16"><a href="#Software_Design_Interfaces"><span class="tocnumber">5.2</span> <span class="toctext"><b>Software Design Interfaces</b></span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-17"><a href="#Usage"><span class="tocnumber">6</span> <span class="toctext"><b>Usage</b></span></a>
<ul>
<li class="toclevel-2 tocsection-18"><a href="#Opening_and_Closing_of_Driver"><span class="tocnumber">6.1</span> <span class="toctext"><b>Opening and Closing of Driver</b></span></a></li>
<li class="toclevel-2 tocsection-19"><a href="#Command_Line_arguments"><span class="tocnumber">6.2</span> <span class="toctext"><b>Command Line arguments</b></span></a>
<ul>
<li class="toclevel-3 tocsection-20"><a href="#FBDEV_Driver"><span class="tocnumber">6.2.1</span> <span class="toctext"><b>FBDEV Driver</b></span></a></li>
<li class="toclevel-3 tocsection-21"><a href="#V4L2_Driver"><span class="tocnumber">6.2.2</span> <span class="toctext"><b>V4L2 Driver</b></span></a></li>
<li class="toclevel-3 tocsection-22"><a href="#VPSS_Driver.27"><span class="tocnumber">6.2.3</span> <span class="toctext"><i>VPSS Driver'</i></span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-23"><a href="#Buffer_Management"><span class="tocnumber">6.3</span> <span class="toctext"><b>Buffer Management</b></span></a>
<ul>
<li class="toclevel-3 tocsection-24"><a href="#FBDEV_Driver_2"><span class="tocnumber">6.3.1</span> <span class="toctext"><b>FBDEV Driver</b></span></a></li>
<li class="toclevel-3 tocsection-25"><a href="#V4L2_Driver_2"><span class="tocnumber">6.3.2</span> <span class="toctext"><b>V4L2 Driver</b></span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-26"><a href="#Transparency_Keying"><span class="tocnumber">6.4</span> <span class="toctext"><b>Transparency Keying</b></span></a>
<ul>
<li class="toclevel-3 tocsection-27"><a href="#Using_V4L2_IOCTL"><span class="tocnumber">6.4.1</span> <span class="toctext"><b>Using V4L2 IOCTL</b></span></a></li>
<li class="toclevel-3 tocsection-28"><a href="#Using_Sysfs"><span class="tocnumber">6.4.2</span> <span class="toctext"><b>Using Sysfs</b></span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-29"><a href="#Alpha_Blending"><span class="tocnumber">6.5</span> <span class="toctext"><b>Alpha Blending</b></span></a>
<ul>
<li class="toclevel-3 tocsection-30"><a href="#FBDev_IOCTL"><span class="tocnumber">6.5.1</span> <span class="toctext"><b>FBDev IOCTL</b></span></a></li>
<li class="toclevel-3 tocsection-31"><a href="#V4L2_IOCTLs"><span class="tocnumber">6.5.2</span> <span class="toctext"><b>V4L2 IOCTLs</b></span></a></li>
<li class="toclevel-3 tocsection-32"><a href="#Using_Sysfs_2"><span class="tocnumber">6.5.3</span> <span class="toctext"><b>Using Sysfs </b></span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-33"><a href="#Scaling"><span class="tocnumber">6.6</span> <span class="toctext"><b> Scaling </b></span></a></li>
<li class="toclevel-2 tocsection-34"><a href="#Stenciling"><span class="tocnumber">6.7</span> <span class="toctext"><b> Stenciling</b></span></a></li>
<li class="toclevel-2 tocsection-35"><a href="#Bound_Box_Blending"><span class="tocnumber">6.8</span> <span class="toctext"><b> Bound Box Blending</b></span></a></li>
<li class="toclevel-2 tocsection-36"><a href="#Buffer_Format"><span class="tocnumber">6.9</span> <span class="toctext"><b>Buffer Format</b></span></a>
<ul>
<li class="toclevel-3 tocsection-37"><a href="#FBDEV_Driver_3"><span class="tocnumber">6.9.1</span> <span class="toctext"><b>FBDEV Driver</b></span></a></li>
<li class="toclevel-3 tocsection-38"><a href="#V4L2_Driver_3"><span class="tocnumber">6.9.2</span> <span class="toctext"><b>V4L2 Driver</b></span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-39"><a href="#Display_Position_of_Graphics"><span class="tocnumber">6.10</span> <span class="toctext"><b>Display Position of Graphics</b></span></a>
<ul>
<li class="toclevel-3 tocsection-40"><a href="#FBDev_IOCTL_2"><span class="tocnumber">6.10.1</span> <span class="toctext"><b>FBDev IOCTL</b></span></a></li>
<li class="toclevel-3 tocsection-41"><a href="#V4L2_IOCTL"><span class="tocnumber">6.10.2</span> <span class="toctext"><b>V4L2 IOCTL</b></span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-42"><a href="#Cropping"><span class="tocnumber">6.11</span> <span class="toctext"><b>Cropping</b></span></a></li>
<li class="toclevel-2 tocsection-43"><a href="#Color_look_table"><span class="tocnumber">6.12</span> <span class="toctext"><b>Color look table</b></span></a></li>
<li class="toclevel-2 tocsection-44"><a href="#Streaming"><span class="tocnumber">6.13</span> <span class="toctext"><b>Streaming</b></span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-45"><a href="#Software_Interfaces"><span class="tocnumber">7</span> <span class="toctext"><b>Software Interfaces</b></span></a>
<ul>
<li class="toclevel-2 tocsection-46"><a href="#Frame-Buffer_Driver_Interface"><span class="tocnumber">7.1</span> <span class="toctext"><b>Frame-Buffer Driver Interface</b></span></a>
<ul>
<li class="toclevel-3 tocsection-47"><a href="#Application_Interface"><span class="tocnumber">7.1.1</span> <span class="toctext"><b>Application Interface</b></span></a></li>
<li class="toclevel-3 tocsection-48"><a href="#Supported_Standard_IOCTLs"><span class="tocnumber">7.1.2</span> <span class="toctext"><b>Supported Standard IOCTLs</b></span></a></li>
<li class="toclevel-3 tocsection-49"><a href="#Supported_Custom_IOCTLs"><span class="tocnumber">7.1.3</span> <span class="toctext"><b>Supported Custom IOCTLs</b></span></a></li>
<li class="toclevel-3 tocsection-50"><a href="#OMAPFB_Compatible_IOCTLS"><span class="tocnumber">7.1.4</span> <span class="toctext"><b> OMAPFB Compatible IOCTLS</b></span></a></li>
<li class="toclevel-3 tocsection-51"><a href="#Data_Structures"><span class="tocnumber">7.1.5</span> <span class="toctext"><b>Data Structures</b></span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-52"><a href="#V4L2_Driver_Interface"><span class="tocnumber">7.2</span> <span class="toctext"><b>V4L2 Driver Interface</b></span></a>
<ul>
<li class="toclevel-3 tocsection-53"><a href="#Application_Interface_2"><span class="tocnumber">7.2.1</span> <span class="toctext"><b>Application Interface</b></span></a></li>
<li class="toclevel-3 tocsection-54"><a href="#Supported_Standard_IOCTLs_2"><span class="tocnumber">7.2.2</span> <span class="toctext"><b>Supported Standard IOCTLs</b></span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-55"><a href="#SYSFS_Software_Interfaces"><span class="tocnumber">7.3</span> <span class="toctext"><b>SYSFS Software Interfaces</b></span></a>
<ul>
<li class="toclevel-3 tocsection-56"><a href="#Frame-buffer_Driver_sysfs_attributes"><span class="tocnumber">7.3.1</span> <span class="toctext"><b>Frame-buffer Driver sysfs attributes</b></span></a></li>
<li class="toclevel-3 tocsection-57"><a href="#VPSS_Library_sysfs_attributes"><span class="tocnumber">7.3.2</span> <span class="toctext"><b>VPSS Library sysfs attributes</b></span></a>
<ul>
<li class="toclevel-4 tocsection-58"><a href="#VPSS_Library:_system"><span class="tocnumber">7.3.2.1</span> <span class="toctext"><b>VPSS Library: system </b></span></a></li>
<li class="toclevel-4 tocsection-59"><a href="#VPSS_Library:_display"><span class="tocnumber">7.3.2.2</span> <span class="toctext"><b> VPSS Library: display</b></span></a>
<ul>
<li class="toclevel-5 tocsection-60"><a href="#VPSS_Library:_display0"><span class="tocnumber">7.3.2.2.1</span> <span class="toctext"><b>VPSS Library: display0</b></span></a></li>
<li class="toclevel-5 tocsection-61"><a href="#VPSS_Library:_display1"><span class="tocnumber">7.3.2.2.2</span> <span class="toctext"><b>VPSS Library: display1</b></span></a></li>
<li class="toclevel-5 tocsection-62"><a href="#VPSS_Library:_display2"><span class="tocnumber">7.3.2.2.3</span> <span class="toctext"><b>VPSS Library: display2</b></span></a></li>
</ul>
</li>
<li class="toclevel-4 tocsection-63"><a href="#VPSS_Library:_graphics0.2F1.2F2"><span class="tocnumber">7.3.2.3</span> <span class="toctext"><b>VPSS Library: graphics0/1/2</b></span></a></li>
<li class="toclevel-4 tocsection-64"><a href="#VPSS_Library:_Video0.2F1.2F2"><span class="tocnumber">7.3.2.4</span> <span class="toctext"><b>VPSS Library: Video0/1/2</b></span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-2 tocsection-65"><a href="#Miscellaneous_Configurations"><span class="tocnumber">7.4</span> <span class="toctext"><b>Miscellaneous Configurations</b></span></a>
<ul>
<li class="toclevel-3 tocsection-66"><a href="#Switching_fb0.28graphics0.29_output_from_HDMI_VEVC.28display0.29_to_DVO2_VENC.28display1.29"><span class="tocnumber">7.4.1</span> <span class="toctext"><b>Switching fb0(graphics0) output from HDMI VEVC(display0) to DVO2 VENC(display1)</b></span></a></li>
<li class="toclevel-3 tocsection-67"><a href="#Switching_.2Fdev.2Fvideo1.28video0.29_from_vcompmux_-_HDMI_VEVC.28display0.29_to_vcompmux_-_DVO2_VENC.28display1.29"><span class="tocnumber">7.4.2</span> <span class="toctext"><b>Switching /dev/video1(video0) from vcompmux - HDMI VEVC(display0) to vcompmux - DVO2 VENC(display1)</b></span></a></li>
<li class="toclevel-3 tocsection-68"><a href="#Switching_.2Fdev.2Fvideo1.28video0.29_from_vcompmux_-_HDMI_VEVC.28display0.29_to_hdcompmux_-_DVO2_VENC.28display1.29"><span class="tocnumber">7.4.3</span> <span class="toctext"><b>Switching /dev/video1(video0) from vcompmux - HDMI VEVC(display0) to hdcompmux - DVO2 VENC(display1)</b></span></a></li>
<li class="toclevel-3 tocsection-69"><a href="#Cloning_fb0.28graphics0.29_output_to_both_HDMI_VENC.28display0.29_and_DVO2_VENC.28display1.29"><span class="tocnumber">7.4.4</span> <span class="toctext"><b>Cloning fb0(graphics0) output to both HDMI VENC(display0) and DVO2 VENC(display1)</b></span></a></li>
<li class="toclevel-3 tocsection-70"><a href="#Cloning_.2Fdev.2Fvideo1.28video0.29_output_to_both_vcompmux-HDMI_VENC.28display0.29_and_vcompmux-DVO2_VENC.28display1.29"><span class="tocnumber">7.4.5</span> <span class="toctext"><b>Cloning /dev/video1(video0) output to both vcompmux-HDMI VENC(display0) and vcompmux-DVO2 VENC(display1)</b></span></a></li>
<li class="toclevel-3 tocsection-71"><a href="#Change_the_mode_on_HDMI_VENC.28display0.29"><span class="tocnumber">7.4.6</span> <span class="toctext"><b> Change the mode on HDMI VENC(display0)</b></span></a></li>
<li class="toclevel-3 tocsection-72"><a href="#Change_display_timing_on_DVO2_VENC.28display1.29"><span class="tocnumber">7.4.7</span> <span class="toctext"><b> Change display timing on DVO2 VENC(display1)</b></span></a></li>
<li class="toclevel-3 tocsection-73"><a href="#Reshuffle_display_order_on_HDMI_VENC.28display0.29"><span class="tocnumber">7.4.8</span> <span class="toctext"><b> Reshuffle display order on HDMI VENC(display0)</b></span></a></li>
<li class="toclevel-3 tocsection-74"><a href="#Change_the_clock_source_on_HDMI_VENC.28display0.29"><span class="tocnumber">7.4.9</span> <span class="toctext"><b> Change the clock source on HDMI VENC(display0)</b></span></a></li>
<li class="toclevel-3 tocsection-75"><a href="#Change_the_OUTPUT_of_HDMI_VENC.28display0.29"><span class="tocnumber">7.4.10</span> <span class="toctext"><b> Change the OUTPUT of HDMI VENC(display0)</b></span></a></li>
<li class="toclevel-3 tocsection-76"><a href="#Change_Video_PLL_Clock"><span class="tocnumber">7.4.11</span> <span class="toctext"><b> Change Video PLL Clock </b></span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-77"><a href="#Driver_Configuration"><span class="tocnumber">8</span> <span class="toctext"><b>Driver Configuration</b></span></a>
<ul>
<li class="toclevel-2 tocsection-78"><a href="#Framebuffer_driver"><span class="tocnumber">8.1</span> <span class="toctext"><b>Framebuffer driver</b></span></a></li>
<li class="toclevel-2 tocsection-79"><a href="#V4L2_video_driver"><span class="tocnumber">8.2</span> <span class="toctext"><b>V4L2 video driver</b></span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-80"><a href="#Sample_Application_Flow"><span class="tocnumber">9</span> <span class="toctext"><b>Sample Application Flow</b></span></a>
<ul>
<li class="toclevel-2 tocsection-81"><a href="#Fbdev-Display_Application_Flow"><span class="tocnumber">9.1</span> <span class="toctext"><b>Fbdev-Display Application Flow</b></span></a></li>
<li class="toclevel-2 tocsection-82"><a href="#V4L2-Display_Application_Flow"><span class="tocnumber">9.2</span> <span class="toctext"><b>V4L2-Display Application Flow</b></span></a></li>
</ul>
</li>
</ul>
</div>

<h1><span class="mw-headline" id="Read_This_First"><b>Read This First </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=1" title="Edit section: Read This First">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<div style="padding: 5px; background: none repeat scroll 0% 0% rgb(238, 238, 238); color: rgb(255, 0, 0);">
<p>This section show the major updates since last release, please review this section before any SW activities.
</p>
<ul><li>V4L2 Display driver has been added into this release. Please check the corresponding sections to get the right information.</li></ul>
<ul><li>The following sysfs video nodes have been added for each V4L2 display node</li></ul>
<pre>/sys/devices/platform/vpss/video0      ---&gt; /dev/video1
/sys/devices/platform/vpss/video1      ---&gt; /dev/video2
/sys/devices/platform/vpss/video2      ---&gt; /dev/video3
</pre>
<p><br />
</p>
<ul><li>The following sysfs entries have been added to support alpha blending for each video plane.(Not available for /dev/video3)</li></ul>
<pre>/sys/devices/platform/vpss/video#/alpha_blending_enabled       --&gt; enable the alpha blending
/sys/devices/platform/vpss/video#/global_alpha                 --&gt; set the alpha value
</pre>
<ul><li>The following sysfs entries have been added to support transparency for each video plane.(Not available for /dev/video3)</li></ul>
<pre>/sys/devices/platform/vpss/video#/trans_key_enabled    --&gt; enable the transparency
/sys/devices/platform/vpss/video#/trans_key_type       --&gt; set the transparency bit maks type
/sys/devices/platform/vpss/video#/trans_key_value      --&gt; set the transparency key value
</pre>
<ul><li>The following sysfs entries have been added to switch connection between video input and venc output for each video plane</li></ul>
<pre>/sys/devices/platform/vpss/video#/nodes
</pre>
<ul><li>/dev/video3 node does not support the following features:</li></ul>
<p>croping, video size small than the display resolution
</p>
</div>
<h1><span class="mw-headline" id="Installation_Guide"><b>Installation Guide</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=2" title="Edit section: Installation Guide">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h2><span class="mw-headline" id="Introduction"><b>Introduction</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=3" title="Edit section: Introduction">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>This is the TI81XX Linux VPSS and Fbdev Driver user installation guide. This documents the steps to get the VPSS Driver worked up on TI814X based EVM(Simulator is not tested). This documetns deatils the steps in load syslink, M3 BIOS VPSS firmware and VPSS symbol. This driver has the following dependencies outside of Kernel.
</p>
<ul><li>TI814X PSP 04.01.00.04 release</li>
<li>syslink_02_00_00_67_alpha release</li>
<li>HDVPSS 01.00.01.26 release</li></ul>
<p><b>Note:</b> Only the above mentioned version of the components are verified and tested.
</p>
<h2><span class="mw-headline" id="Preliminary_Work"><b>Preliminary Work</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=4" title="Edit section: Preliminary Work">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li>Build the Linux Uboot and Kernel following the installation guide of TI814x PSP 04.01.00.04 release.</li></ul>
<ul><li>As both VPSS and Fbdev driver are built over Syslink linux Kernel driver. It is required to build syslink kernel driver before building VPSS and Fbdev Driver. Please Follow installation guide and release notes of syslink 02.00.00.67_alpha2 to build syslink.ko.</li></ul>
<ul><li>M3 BIOS VPSS Firmware(c6a814x_hdvpss.xem3/ti814x_hdvpss.xem3) is loaded by the procmgrapp, which is the user space program from syslink. Please follow installatation guide of syslink 02.00.00.67_alpha2 to generate procmgrapp.</li></ul>
<ul><li>M3 BIOS VPSS Firmware(c6a814x_hdvpss.xem3/ti814x_hdvpss.xem3) is the software running over the VPSS M3 Processor.</li></ul>
<h2><span id="Build_Linux_VPSS,_Fbdev_and_V4L2_Display_Drivers"></span><span class="mw-headline" id="Build_Linux_VPSS.2C_Fbdev_and_V4L2_Display_Drivers"><b>Build Linux VPSS, Fbdev and V4L2 Display Drivers</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=5" title="Edit section: Build Linux VPSS, Fbdev and V4L2 Display Drivers">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Since Syslink kernel driver is not part of the TI816x PSP release packages, VPSS, Fbdev and V4L2 Display Drive supports dynamic build only, which are parts of the PSP release. The pre-build uImage inside of PSP release package supports the prebuit VPSS/Fbdev/V4L2 modules.
<br />
</p><p><b>NOTE:</b> Applications are not required to rebuild the uImage or VPSS/FBDev/V4L2 module unless VPSS/FBDev/V4L2 drivers are changed.
</p>
<ul><li>Enable the VPSS and Fbdev in menuconfig</li></ul>
<p><br />
</p>
<pre>$ make ARCH=arm CROSS_COMPILE=PATH_TO_TOOLCHAIN/bin/arm-none-linux-gnueabi- ti8168_evm_defconfig
$ make ARCH=arm CROSS_COMPILE=PATH_TO_TOOLCHAIN/bin/arm-none-linux-gnueabi- menuconfig
</pre>
<p>select Device Drivers
</p>
<pre>   Userspace binary formats  ---&gt;
   Power management options  ---&gt;
   [*] Networking support  ---&gt;
 " Device Drivers  ---&gt;    "
   CBUS support  ---&gt;
   File systems  ---&gt;
</pre>
<p>select graphics support:
</p>
<pre>   Multifunction device drivers  ---&gt;
   [ ] Voltage and Current Regulator Support  ---&gt;
   &lt; &gt; Multimedia support  ---&gt;
 " Graphics support  ---&gt;     "
   &lt;*&gt; Sound card support  ---&gt;
   [*] HID Devices  ---&gt;
</pre>
<p>Select TI81XX Video Processing Subsystem (EXPERIMENTAL)
</p>
<pre>   &lt; &gt; Fujitsu MB862xx GDC support
   &lt; &gt; E-Ink Broadsheet/Epson S1D13521 controller support
   &lt; &gt; OMAP frame buffer support (EXPERIMENTAL)
 " &lt;M&gt; TI81XX Video Processing Subsystem (EXPERIMENTAL)  ---&gt; "
   [ ] Backlight &amp; LCD device support  ---&gt;
</pre>
<p>Setup the VPSS configuraiton.
</p>
<pre> --- TI81XX Video Processing Subsystem (EXPERIMENTAL)
   (50)  VRAM size (MB)
   [*]   Debug support
    &lt;&gt;   TI81XX frame buffer support (EXPERIMENTAL)  ---&gt;
</pre>
<p>select TI81XX frame buffer support (EXPERIMENTAL)
</p>
<pre> --- TI81XX Video Processing Subsystem (EXPERIMENTAL)
   (50)  VRAM size (MB)
   [*]   Debug support
   " &lt;M&gt;   TI81XX frame buffer support (EXPERIMENTAL)  ---&gt; "
</pre>
<p><br />
</p>
<pre>--- TI81XX frame buffer support (EXPERIMENTAL)
   [*]   Debug support for TI81XX FB
   (3)   Number of framebuffers
</pre>
<ul><li>Enable V4L2 Display Driver in Menuconfig</li></ul>
<p>Select Device Drivers from the main menu.
</p>
<pre>...
    ...
    Kernel Features  ---&gt;
    Boot options  ---&gt;
    CPU Power Management  ---&gt;
    Floating point emulation  ---&gt;
    Userspace binary formats  ---&gt;
    Power management options  ---&gt;
[*] Networking support  ---&gt;
"   Device Drivers  ---&gt;"
    ...
    ...
</pre>
<p><br />
Select Multimedia support from the menu.
</p>
<pre>    ...
    ...
    Sonics Silicon Backplane  ---&gt;
    Multifunction device drivers  ---&gt;
[*] Voltage and Current Regulator Support  ---&gt;
"&lt;*&gt; Multimedia support  ---&gt;"
    Graphics support  ---&gt;
&lt;*&gt; Sound card support  ---&gt;
[*] HID Devices  ---&gt;
[*] USB support  ---&gt;
    ...
    ...
</pre>
<p><br />
Select Video For Linux from the menu.
</p>
<pre>    ...
    ...
    *** Multimedia core support ***
[ ]   Media Controller API (EXPERIMENTAL)
"&lt;*&gt;   Video For Linux"
[*]     Enable Video For Linux API 1 (DEPRECATED)
&lt; &gt;   DVB for Linux
    ...
    ...
</pre>
<p><br />
Select Video capture adapters from the same menu. Press &lt;ENTER&gt; to enter the corresponding sub-menu.
</p>
<pre>    ...
    ...
[ ]   Customize analog and hybrid tuner modules to build  ---&gt;
"[*]   Video capture adapters  ---&gt;"
[ ]   Memory-to-memory multimedia devices  ---&gt;
[ ]   Radio Adapters  ---&gt;
    ...
    ...
</pre>
<p><br />
Select TI81XX V4L2-Display driver
</p>
<pre>[ ]   Autoselect pertinent encoders/decoders and other helper chi
      Encoders/decoders and other helper chips  ---&gt;
"&lt;M&gt;   TI81XX V4L2-Display driver"
&lt; &gt;   CPiA2 Video For Linux
&lt; &gt;   Philips SAA7134 support
</pre>
<p><br />
</p>
<ul><li>Rebuild the Kernel uImage</li></ul>
<pre>$ make ARCH=arm CROSS_COMPILE=PATH_TO_TOOLCHAIN/bin/arm-none-linux-gnueabi- uImage
</pre>
<ul><li>Set SYSLINK_ROOT environment variable</li></ul>
<pre> $ export SYSLINK_ROOT = $(PATH_WHERE_SYSLINK_IS_INSTALLED)
</pre>
<ul><li>Set IPCDIR environment variable</li></ul>
<pre> $ export IPCDIR = $(PATH_WHERE_IPC_IS_INSTALLED/packages)
</pre>
<ul><li>Build module for the drivers</li></ul>
<pre>$ make ARCH=arm CROSS_COMPILE=PATH_TO_TOOLCHAIN/bin/arm-none-linux-gnueabi- KBUILD_EXTRA_SYMBOLS=$SYSLINK_ROOT/ti/syslink/utils/hlos/knl/Linux/Module.symvers modules
</pre>
<ul><li>vpss.ko is generated under drivers/video/ti81xx/vpss， ti81xxfb.ko is generated under drivers/video/ti81xx/ti81xxfb and ti81xxvo.ko is generated under derivers/media/video/ti81xx</li></ul>
<h2><span class="mw-headline" id="Prerequisites"><b>Prerequisites </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=6" title="Edit section: Prerequisites">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The following files will be available after the above steps have been executed:
</p>
<ol><li>syslink kernel dirver module, referred as "syslink.ko"</li>
<li>Proc manager user space program, referred as "procmgrapp"</li>
<li>M3 BIOS Firmware binary, referred as "c6a814x_hdvpss.xem3/ti814x_hdvpss.xem3"</li>
<li>VPSS kernel driver module, referred as "vpss.ko"</li>
<li>FBDev kernel driver module, referred as "ti81xxfb.ko"</li>
<li>V4L2 kernel display module, referred as "ti81xxvo.ko"</li></ol>
<h2><span class="mw-headline" id="Load_VPSS_and_Fbdev_Driver_Modules"><b>Load VPSS and Fbdev Driver Modules</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=7" title="Edit section: Load VPSS and Fbdev Driver Modules">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li>After seeing Linux booting log at Hyper Terminal or Tera Term, type "root" to log int.</li></ul>
<pre>$ cd to the folder where those Prerequisites are stored in the NFS or RamDisk
</pre>
<ul><li><b>Load Syslink Module</b></li></ul>
<p><br />
</p>
<pre>$ insmode syslink.ko
</pre>
<ul><li><b>load VPSS-M3 Firmware</b></li></ul>
<p><br />
</p>
<ul><li>DM814X Platform</li></ul>
<p><br />
</p>
<pre> $ ./procmgrapp 2 ti814x_hdvpss.xem3 0
</pre>
<ul><li>C6A814X Platform</li></ul>
<p><br />
</p>
<pre>$ ./procmgrapp 2 c6a814x_hdvpss.xem3 0
</pre>
<ul><li><b>Load VPSS Module</b></li></ul>
<p><br />
</p>
<ul><li>DM814X Platform</li></ul>
<p><br />
</p>
<pre>$ insmod vpss.ko sbufaddr=0xCFE00000
</pre>
<ul><li>C6A814x Platform</li></ul>
<p><br />
</p>
<pre>&amp; insmod vpss.ko
</pre>
<ul><li><b>Load FBDev Module</b></li></ul>
<p><br />
</p>
<pre>$ insmod ti81xxfb.ko
</pre>
<ul><li><b>Load V4L2 Display Module</b></li></ul>
<p><br />
</p>
<pre>$ insmod ti81xxvo.ko
</pre>
<ul><li>Now Fbdev module is loaded and application can be executed from here.</li></ul>
<p><b>NOTE:</b>
</p>
<pre> HDMI Kernel module is required to view the output from On-Chip HDMI, see next section.
 Application need develop their own software component to support the external display device connected with DVO2 VENC.
 Add debug=1 to enable the debug function of vpss.ko,ti81xxfb.ko and ti81xxvo.ko
 Application need assign the framebuffer size when loading ti81xxfb.ko if accessing /dev/fb1 and /dev/fb2 nodes
    $ insmod ti81xxfb.ko vram=0:XXM,1:YYM,2:ZZM
</pre>
<h2><span class="mw-headline" id="Load_On-Chip_HDMI_Module"><b>Load On-Chip HDMI Module</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=8" title="Edit section: Load On-Chip HDMI Module">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>On-Chip HDMI hardware is controlled through another kernel driver, which should be loaded after vpss.ko is loadded. Please refer TI81XX HDMI user guide  for details.
</p>
<ul><li>Load HDMI Module</li></ul>
<p><br />
</p>
<pre>$ insmod TI81xx_hdmi.ko hdmi_mode=2
</pre>
<p><b>NOTE:</b>
</p>
<ul><li>Please note that HDMI module parameter(hdmi_mode) is required to set to appropirate value (2 for 1080P60), failing which the HDMI display will NOT be started. However, applications can start the HDMI after insertion of the module. How to start the HDMI after insertion is not part of FBDEV sample application. Please refer TI81XX HDMI user guide for details.</li></ul>
<h1><span class="mw-headline" id="Introduction_2"><b>Introduction</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=9" title="Edit section: Introduction">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>Video Processing Sub-System hardware integrates theee graphics pipeline, five video pipelines, two capture ports and 4 video compositors. Video compositors are connected
to four VENCs to support various output format and mode.
</p><p><br />The primary functionality of the VPSS driver is to provide interfaces to user level applications and management of Video Processing Sub-System hardware.
</p><p><br />This section defines and describes the usage of user level interfaces of VPSS Driver.
</p><p><br />
</p>
<h2><span class="mw-headline" id="References"><b>References</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=10" title="Edit section: References">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ol><li>Video for Linux Two Home Page [<a rel="nofollow" class="external text" href="http://linux.bytesex.org/v4l2/">http://linux.bytesex.org/v4l2/</a>]</li>
<li>Video for Linux Two API Specification [[<a rel="nofollow" class="external text" href="http://v4l2spec.bytesex.org/v4l2spec/v4l2.pdf">http://v4l2spec.bytesex.org/v4l2spec/v4l2.pdf</a>]</li></ol>
<p><br />
</p>
<h2><span id="Acronyms_&amp;_Definitions"></span><span class="mw-headline" id="Acronyms_.26_Definitions"><b>Acronyms &amp; Definitions</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=11" title="Edit section: Acronyms &amp; Definitions">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<table border="1" cellspacing="0" cellpadding="5" width="40%">
<caption><b>Display Driver: Acronyms</b>
</caption>
<tbody><tr>
<th align="left">Acronym
</th>
<th align="left">Definition
</th></tr>
<tr>
<td>V4L2
</td>
<td>Video for Linux Two
</td></tr>
<tr>
<td>VPSS
</td>
<td>Vidoe Processing SubSystem
</td></tr>
<tr>
<td>HDMI
</td>
<td>Hight Definition Multimedia Interface
</td></tr>
<tr>
<td>DVO
</td>
<td>Digital Video Output
</td></tr>
<tr>
<td>VENC
</td>
<td>Video Encoder
</td></tr>
<tr>
<td>NTSC
</td>
<td>National Television System Committee
</td></tr>
<tr>
<td>PAL
</td>
<td>Phase Alternating Line
</td></tr>
<tr>
<td>SD
</td>
<td>Standard Definitions
</td></tr>
<tr>
<td>SDK
</td>
<td>Software Development Kit
</td></tr>
<tr>
<td>VCOMP
</td>
<td>Video Compositor
</td></tr>
<tr>
<td>COMP
</td>
<td>Compsoitor
</td></tr></tbody></table>
<p><br />
</p>
<table border="1" cellspacing="0" cellpadding="5">
<caption><b>Display Port and VENC name</b>
</caption>
<tbody><tr>
<th align="left">Display Port Name
</th>
<th align="left">Type
</th>
<th align="left">VENC Name
</th>
<th align="left">Port Num for Pin
</th>
<th align="left">Sysfs Name
</th></tr>
<tr>
<td>HDMI/DVO1
</td>
<td>Digital
</td>
<td>HDMI
</td>
<td>VOUT1
</td>
<td>Display0
</td></tr>
<tr>
<td>DVO2
</td>
<td>Digital
</td>
<td>DVO2
</td>
<td>VOUT0
</td>
<td>Display1
</td></tr>
<tr>
<td>SD
</td>
<td>Analog
</td>
<td>SD
</td>
<td>N/A
</td>
<td>Display2
</td></tr></tbody></table>
<h2><span class="mw-headline" id="Hardware_Overview"><b>Hardware Overview</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=12" title="Edit section: Hardware Overview">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The video processing subsystem provides the functions to
display a video frame from the memory frame buffer to
external display device, such as LCD,TV;
or capture a video frame from external camera to memory.
The video processing subsystem integrates the
following main elements
</p><p><br />
</p>
<ul><li>Graphics processing modules</li>
<li>Video Capture processing modules</li>
<li>Video display processing modules</li>
<li>Video Compositor modules</li></ul>
<h1><span class="mw-headline" id="Features"><b>Features</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=13" title="Edit section: Features">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>The VPSS driver supports the following features:
</p>
<ul><li>Supports 3 Graphics pipelines throught fbdev interface</li>
<li>Supports 3 Video pipelines through V4L2 interface</li>
<li>Supported color formats on Graphics pipeline: RGB565, ARGB1555, RGBA5551, ARGB4444, RGBA4444, ARGB6666,RGBA6666,RGB888, ARGB8888 and RGBA8888, BMP 1/2/4/8.</li>
<li>Support Color formats on Video pipeline; 422 Interleave, 420 semi-planar and 422 semi-planar.</li>
<li>Configuration of Graphics parameters such as height and width of display graphics, position of the display graphics, bits-per-pixel etc.</li>
<li>Supports setting up of Graphics pipeline and VENCs destination(HDMI, DVO2 or SDVENC) through syfs interface.</li>
<li>Supports buffer management through memory mapped (mmaped) on both FBDev and V4l2.</li>
<li>Supports user pointer buffer exchange for application usage on V4L2 only(mmaped).</li>
<li>Supports global alpha blending on RGB format, pixel alpha blending on ARGB/RGBA format and palette alpha blending on BMP formats.</li>
<li>Supports colorkeying on graphics pipelines through FBDev.</li>
<li>Supports scaling on graphcis pilelines through FBDev</li>
<li>Supports boundbox on graphcis pipelines through FBDev</li>
<li>Supports display priority on graphics pipelines throug FBDev</li>
<li>support  global alpha blending on video pipeline through V4L2</li>
<li>Support  colorkeying on video pipeline through V4L2</li>
<li>Supports various display mode on HDMI/DVO2 VENCs through sysfs</li>
<li>Support various Video PLL frequency through sysfs</li>
<li>Support various VENC clock source through sysfs</li>
<li>Support various output for VENC through sysfs.</li>
<li>Support reshuffle display order through sysfs</li>
<li>Support customized timing configuraiton for VENCs through sysfs</li></ul>
<h1><span class="mw-headline" id="Architecture"><b>Architecture</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=14" title="Edit section: Architecture">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>This chapter describes the Driver Architecture and Design concepts
</p>
<h2><span class="mw-headline" id="Driver_Architecture"><b>Driver Architecture</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=15" title="Edit section: Driver Architecture">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>TI81XX Video Processing hardware integrates three graphics pipeline, five video
pipelines, 2 capture ports and 3 video compositors. Video compositors are connected
to three VENCs to support various output format and mode.
</p><p><br />The primary functionality of the VPSS driver is to provide interfaces to
user level applications and management to video processing subsystem hardware.
</p><p><br />This includes, but is not limited to:
</p>
<ul><li>GUI rendering through graphics pipelines.</li>
<li>Video rendering through video pipelines.</li>
<li>Connecting each of three graphics pipelines to four compositors so the display layer is presented on the selected output path.</li>
<li>Connecting each of three video pipelines to four compositors so the display layer is presented on the selected output path.</li>
<li>Image/Video processing( alpha blending, colorkeying, cropping )</li></ul>
<p><br />
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:787px;"><a href="File_Vpss_linux_sw_arch_2.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/c/c5/Vpss_linux_sw_arch_2.png" width="785" height="642" class="thumbimage" /></a>  <div class="thumbcaption">Video Processing Subsystem Architecture</div></div></div></div>
<p><br />
</p>
<h2><span class="mw-headline" id="Software_Design_Interfaces"><b>Software Design Interfaces</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=16" title="Edit section: Software Design Interfaces">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Above figure (Video Processing Subsystem Architecture) shows the major components that makes up the VPSS
software sub-system
<br />
</p>
<ul><li><b>M3 VPSS Firmware</b></li></ul>
<p>This is a firmware running over processor Cotex M3 controlling the Video Processing subsystem hardware.
<br />
</p>
<ul><li><b>Syslink Library</b></li></ul>
<p>This is a funcional layer controlling the inter-processor communction between Cotex A8 and Cotex M3.
<br />
</p>
<ul><li><b>VPSS FVID2 Library</b></li></ul>
<p>This is a HAL/functional layer controlling the Firmware running over the M3. It exposes the number of APIs controlling the video compositors, VENCs, graphics/video pipelines to the user interface drivers like V4L2 and FBDEV. It translates the V4L2/Fbdev data structures and ioctl to FVID2 data structures and command, and call the Linux Syslink IPC notify function to pass FVID2 data structures and commands to Firmware running over the M3 processor.
<br />
</p>
<ul><li><b>SYSFS interfaces</b></li></ul>
<p>The SYSFS interfaces are mostly used as the control path for configuring the VPSS parameters which are common between FBDEV and V4L2 like the venc modes etc. It is also used for switching the output of the pipeline to different video compositors.
<br />
</p>
<ul><li><b>Frame Buffer Driver</b></li></ul>
<p>This driver is registered with the FBDEV subsystem, and is responsible for managing the graphics layer frame buffer. Driver creates /dev/fb0, /dev/fb1 and /dev/fb2 as the device nodes. Application can open these device nodes to open the driver and negotiate parameters with the driver through frame buffer ioctls. Application maps driver allocated buffers in the application memory space and fills them for the driver to display.
<br />
</p>
<ul><li><b>Video Applications &amp; V4L2 subsystem</b></li></ul>
<p>Video applications (camera, camcorder, image viewer, etc.) use the standard V4L2 APIs to render static images and video to the video layers, or capture/preview camera images.
<br />
</p>
<h1><span class="mw-headline" id="Usage"><b>Usage</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=17" title="Edit section: Usage">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h2><span class="mw-headline" id="Opening_and_Closing_of_Driver"><b>Opening and Closing of Driver</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=18" title="Edit section: Opening and Closing of Driver">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The device can be opened using open call from the application, with the device name and mode of operation as parameters. Application can open the driver only in blocking mode. Non-blocking mode of open is not supported.
</p>
<ul><li><b>FBDEV Driver</b></li></ul>
<p>The driver will expose three software channels (/dev/fb0, /dev/fb1, /dev/fb2) for the graphics pipeline.
</p><p>&lt;syntaxhighlight lang='c'&gt;
/* Open a graphics Display logical channel in blocking mode */
fd = open ("/dev/fb0", O_RDWR);
if (fd == -1) {
</p>
<pre>   perror("failed to open display device\n");
   return -1;
</pre>
<p>}
</p><p>/* ... */
</p><p>/* Closing of channels */
close (fd);
&lt;/syntaxhighlight&gt;
</p><p><br />
</p>
<ul><li><b>V4L2 Driver</b></li></ul>
<p>The driver will expose three software channels (/dev/video1, /dev/video2 and /dev/video3), one for each video pipeline. All of these channels supports only blocking mode of operations.
</p><p><br />
&lt;syntaxhighlight lang='c'&gt;
/* Open a video Display logical channel in blocking mode */
fd = open ("/dev/video1", O_RDWR);
if (fd == -1) {
</p>
<pre>   perror("Failed to open display device\n");
   return -1;
</pre>
<p>}
/* Closing of channel */
close (fd);
&lt;/syntaxhighlight&gt;
<br />
</p>
<h2><span class="mw-headline" id="Command_Line_arguments"><b>Command Line arguments</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=19" title="Edit section: Command Line arguments">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<table border="1" cellspacing="0" cellpadding="5">
<caption><b>Command Line Arguments</b>
</caption>
<tbody><tr>
<th align="left">Argument
</th>
<th align="left">Description
</th></tr>
<tr>
<td>vram
</td>
<td>Total framebuffer memory reserverd for the Fbdev driver
</td></tr></tbody></table>
<p><br />
Following example shows how to specify total framebuffer size as boot time argument
</p>
<pre>setenv bootargs console=ttyO0,115200n8 mem=128M noinitrd root=/dev/nfs nfsroot=nfs-server/home,nolock ip=dhcp vram=50M
</pre>
<p><br />
</p>
<h3><span class="mw-headline" id="FBDEV_Driver"><b>FBDEV Driver</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=20" title="Edit section: FBDEV Driver">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>FBDEV driver supports set of command line argument for size of vram and debug option. These argument are only specified at the time of inserting the driver since FBDev driver only supports dynamic build.
<br />
Below is the list of arguments which Fbdev driver supports -
</p>
<table border="1" cellspacing="0" cellpadding="5">
<caption><b>Fbdev Driver Command Line Arguments</b>
</caption>
<tbody><tr>
<th align="left">Argument
</th>
<th align="left">Description
</th></tr>
<tr>
<td>vram
</td>
<td>VRAM allocated memory for a framebuffer, user can individually configure VRAM buffers for each plane/device node
</td></tr>
<tr>
<td>debug
</td>
<td>Enable Fbdev driver debug messaging
</td></tr></tbody></table>
<p>Following example shows how to specify size of framebuffer in module argument:
</p>
<pre>$ insmod ti81xxfb.ko vram=0:16M,1:16M,2:6M
</pre>
<p><br />
Following example shows how to enable debug of Fbdev in module argument:
</p>
<pre>$ insmod ti81xxfb.ko debug=1
</pre>
<p><br />
<br />
</p>
<h3><span class="mw-headline" id="V4L2_Driver"><b>V4L2 Driver</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=21" title="Edit section: V4L2 Driver">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>V4L2 driver supports set of command line argument for default number of buffers, their buffer size, and debug option for both the video pipelines. These argument are only  specified at the time of inserting the driver since V4L2 driver only supports dynamic build.
</p><p><br />
<br />
Below is the list of arguments which V4L2 driver supports -
</p><p><br />
</p>
<table border="1" cellspacing="0" cellpadding="&quot;5&quot;&quot;">
<caption><b>V4L2 Driver Command Line Arguments</b>
</caption>
<tbody><tr>
<th align="left">Argument
</th>
<th align="left">Description
</th></tr>
<tr>
<td>video1_numbuffers
</td>
<td>Number of buffers to be allocated at init time for Video1 device
</td></tr>
<tr>
<td>video2_numbuffers
</td>
<td>Number of buffers to be allocated at init time for Video2 device
</td></tr>
<tr>
<td>video3_numbuffers
</td>
<td>Number of buffers to be allocated at init time for Video3 device
</td></tr>
<tr>
<td>video1_bufsize
</td>
<td>Size of the buffer to be allocated for video1 device, no bigger than 4MB
</td></tr>
<tr>
<td>video2_bufsize
</td>
<td>Size of the buffer to be allocated for video2 device, no bigger than 4MB
</td></tr>
<tr>
<td>video3_bufsize
</td>
<td>Size of the buffer to be allocated for video3 device, no bigger than 4MB
</td></tr>
<tr>
<td>video3_memtype
</td>
<td>memory type for video 3 device(0:non-tiled memory, 1:tiled memory). video1 and video2 device supports non-tiled memory only
</td></tr>
<tr>
<td>debug
</td>
<td>Enable debug messaging
</td></tr></tbody></table>
<p><br />
<br />
Insert the dynamically built module with following parameters:
</p>
<pre># insmod ti81xxvo.ko video1_numbuffers=3 video2_numbuffers=3 video1_bufsize=4147200 video2_bufsize=4147200
</pre>
<p><br />
</p><p>Following example shows how to enable debug of V4L2:
</p>
<pre>$ insmod ti81xxvo.ko debug=1
</pre>
<p><br />
</p>
<h3><span id="VPSS_Driver'"></span><span class="mw-headline" id="VPSS_Driver.27"><i>VPSS Driver'</i></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=22" title="Edit section: VPSS Driver&#039;">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>VPSS driver supports set of command line argument for mode, tied venc, venc clock source. These argument are only specified at the time of inserting the driver since VPSS only supports dynamic build.
</p><p><br />
Below is the list of arguments which VPSS driver supports -
</p>
<table border="1" cellspacing="0" cellpadding="5">
<caption><b>VPSS Driver Command Line Arguments</b>
</caption>
<tbody><tr>
<th align="left">Argument
</th>
<th align="left">Description
</th></tr>
<tr>
<td>clksrc
</td>
<td>clock source for hdmi/dvo2 VENC. .
<p>hdmi:dclk/dclkdiv2/dclkdiff,dvo2:aclk/aclkdiv2/aclkdiff
</p>
</td></tr>
<tr>
<td>debug
</td>
<td>Enable VPSS Driver debug messaging
</td></tr>
<tr>
<td>mode
</td>
<td>Default video mode(1080p-60/1080p-30/1080i-60/720p-60/ntsc/pal) for specified VENC(hdmi, dvo2,sdvenc)
<p>if mode is not assigned during the boot time, driver uses the following mode:
hdmi: 1080p-60, dvo2:1080p-60, sd:ntsc
</p>
</td></tr>
<tr>
<td>tiedvencs
</td>
<td>OR value of the VENCs(1:hdmi venc, 4:dvo2 venc, 8:sdvenc venc)
</td></tr>
<tr>
<td>sbufaddr
</td>
<td>Physical DDR address of the sharing buffer between Processor A8 and M3. This sharing buffer is used as payload to store FVID2 structurs communicated bewteen A8 and M3. The buffer must be non-cacheable DDR from Ducati side and should not be accessed by any other software components.
<p>This buffer should be predefined in the M3 Fimrware.
</p>
</td></tr>
<tr>
<td>sbufsize
</td>
<td>Size of the sharing buffer between processor A8 and M3.
</td></tr>
<tr>
<td>timeout
</td>
<td>timeout value(ms) to be set in driver to determine how long driver should wait the response from M3. If it is set to zero, driver waits infinitely. By default, this is set to 2000 ms
</td>
<td>
</td></tr></tbody></table>
<p><br />
Following example shows how to specify HDMI VENC mode as module argument:
</p>
<pre>$ insmod vpss.ko mode=hdmi:1080p-60
</pre>
<p><br />
Following example shows how to tie hdmi(1) venc and dvo2(4) venc together as module argument:
</p>
<ul><li><b>NOTE:</b> Application should make sure the tied vencs have the same timing. VPSS driver does not check for this.</li></ul>
<pre>$ insmod vpss.ko tiedvencs=5
</pre>
<p><br />
Following example shows how to set up the sharing buffer address
</p>
<ul><li><b>NOTE:</b> If sbufaddr is not set, driver sets sharing buffer base address to 0x8DE00000. If this release is used on the DM814X Platform, it is responsibility of the application to set sbufaddr=0xCFE00000 when inserting the modules.</li></ul>
<table border="1" cellspacing="0" cellpadding="5">
<caption><b>Sharing buffer Address</b>
</caption>
<tbody><tr>
<th align="left">Platform
</th>
<th align="left">VPSS-M3 Firmware
</th>
<th align="left">Default Value
</th></tr>
<tr>
<td>DM814X
</td>
<td>ti814x_hdvpss.xem3
</td>
<td>0xCFE00000
</td></tr>
<tr>
<td>C6A814X
</td>
<td>c6a814x_hdvpss.xem3
</td>
<td>0x8DE00000
</td></tr></tbody></table>
<pre>$insmod vpss.ko sbufaddr=0xCFE00000
</pre>
<p><br />
<br />
Following example shows how to set up the sharing buffer size. This size can not be over 2MB.
</p>
<ul><li><b>NOTE:</b> If sbufsize is not set, driver sets buffer size equal to 2MB.</li></ul>
<pre>$insmod vpss.ko sbufsize=1024K
</pre>
<p><br />
Below is the list of arguments of clksrc supports
</p>
<table border="1" cellspacing="0" cellpadding="5">
<caption><b>VPSS Driver Clock Source Arguments</b>
</caption>
<tbody><tr>
<th align="left">Argument
</th>
<th align="left">Description
</th></tr>
<tr>
<td>dclk
</td>
<td>clk1x/dvo1_clk/dvo2_clk/vbi_clk_hd uses hd_venc_d_clk as clock source
</td></tr>
<tr>
<td>dclkdiv2
</td>
<td>clk1x/dvo1_clk/dvo2_clk/vbi_clk_hd used hd_venc_d_clk/2 as clock source
</td></tr>
<tr>
<td>dclkdiff
</td>
<td>clk1x uses hd_venc_d_clk/2 as clocksource, while dvo1_clk/dvo2_clk/vbi_clk_hd used hd_venc_d_clk as clock source
</td></tr>
<tr>
<td>aclk
</td>
<td>clk1x/dvo2_clk/vbi_clk_hd uses hd_venc_a_clk as clock source
</td></tr>
<tr>
<td>aclkdiv2
</td>
<td>clk1x/dvo2_clk/vbi_clk_hd uses hd_venc_a_clk/2 as clock source
</td></tr>
<tr>
<td>aclkdiff
</td>
<td>clk1x uses hd_vencc_a_clk/2 as clock source while dvo2_clk/vbi_clk_hd uses hd_venc_a_clk as clock source
</td></tr></tbody></table>
<p>Following example show how to choose a clock as the source clock of DVO2 VENC.
</p>
<pre>$ insmod vpss.ko clksrc=dvo2:aclk
</pre>
<p>Following example show how to enable debug of VPSS driver
</p>
<pre>$ insmod vpss.ko debug=1
</pre>
<h2><span class="mw-headline" id="Buffer_Management"><b>Buffer Management</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=23" title="Edit section: Buffer Management">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<table border="1" cellspacing="0" cellpadding="5">
<caption><b>Memory requirement for V4L2 and FBDEV driver</b>
</caption>
<tbody><tr>
<th align="left">Driver
</th>
<th align="left">FB0(dev/fb0)
</th>
<th align="left">FB1(dev/fb1)
</th>
<th align="left">FB2(dev/fb2)
</th></tr>
<tr>
<td>Fbdev Driver
</td>
<td>A single buffer of size 1920*1080*4*2 bytes, can be changed through bootargs
</td>
<td>0 bytes if app does not assign size for this node through bootargs
</td>
<td>0 bytes if app does not assign size for this node through bootargs
</td></tr></tbody></table>
<p><br />
</p>
<h3><span class="mw-headline" id="FBDEV_Driver_2"><b>FBDEV Driver</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=24" title="Edit section: FBDEV Driver">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>FBDEV driver supports only memory mapped buffers. Driver allocates one physically contiguous buffers for each node, which can support up to 1920x1080 resolution 32 bpp format. By default, driver only allocates the memory for FB0(dev/fb0) node. Application need set the memory size if accessing /dev/fb1 and /dev/fb2 when loading FBDev modules.
</p><p><br />
<b>Set Frame Buffer size for FB Nodes</b>
</p>
<pre>$ insmod ti81xxfb.ko vram=0:XXM,1:YYM,2:ZZM
</pre>
<p>Following steps are required to map buffers in application memory space.
</p><p><b>Getting fix screen information</b>
<br />
<code>FBIOGET_FSCREENINFO</code> ioctl is used to get the not-changing screen information like physical address of the buffer, size of the buffer, line length.
</p><p>&lt;syntaxhighlight lang='c'&gt;
/* Getting fix screen information */
struct fb_fix_screeninfo fix;
</p><p>ret = ioctl(fd, FBIOGET_FSCREENINFO, &amp;fix);
if (ret &lt; 0) {
</p>
<pre>   printf("FBIOGET_FSCREENINFO\n");
   close(fd);
   exit(0);
</pre>
<p>}
</p><p>printf("Line length =&#160;%d\n", fix.line_length);
printf("Physical Address =&#160;%x\n", fix.smem_start);
printf("Buffer Length =&#160;%d\n", fix.smem_len);
&lt;/syntaxhighlight&gt;
</p><p><b>Getting Variable screen information</b>
<br />
<code>FBIOGET_VSCREENINFO</code> ioctl is used to get the variable screen information like resolution, bits per pixel etc...
</p><p>&lt;syntaxhighlight lang='c'&gt;
/* Getting fix screen information */
struct fb_var_screeninfo var;
</p><p>if (ioctl(fd, FBIOGET_VSCREENINFO, &amp;var) &lt; 0) {
</p>
<pre>   printf("FBIOGET_VSCREENINFO\n");
   close(fd);
   exit(0);
</pre>
<p>}
</p><p>printf("Resolution =&#160;%dx%d\n", var.xred, var.yres);
printf("bites per pixel =&#160;%d\n", var.bpp);
&lt;/syntaxhighlight&gt;
</p><p><b>Mapping Kernel space address to user space</b>
<br />
Mapping the kernel buffer to the user space can be done via mmap system call.
&lt;syntaxhighlight lang='c'&gt;
/* addr hold the user space address */
unsigned int addr, buffersize;
</p><p>/* Get the fix screen info */
</p><p>/* Get the variable screen information */
</p><p>buffersize = fix.line_length * var.yres;
addr = mmap(NULL, buffersize, PROT_READ | PROT_WRITE, MAP_SHARED, fd, 0);
&lt;/syntaxhighlight&gt;
</p>
<h3><span class="mw-headline" id="V4L2_Driver_2"><b>V4L2 Driver</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=25" title="Edit section: V4L2 Driver">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<table border="1" cellspacing="0" cellpadding="5">
<caption><b>Memory requirement for V4L2 driver</b>
</caption>
<tbody><tr>
<th align="left">Driver
</th>
<th align="left">video1
</th>
<th align="left">video2
</th>
<th align="left">video3
</th></tr>
<tr>
<td>V4L2 Driver
</td>
<td>three buffers of size 4MB each, can be changed by module parameters.
</td>
<td>three buffers of size 4MB each, can be changed by module parameters..
</td>
<td>three buffers of size 720x576*2 bytes each, can be changed by module parameters.
</td></tr></tbody></table>
<p>Memory Mapped buffer mode and User pointer buffer mode are the two memory allocation modes supported by driver. In Memory map buffer mode, application can request memory from the driver by calling VIDIOC_REQBUFS ioctl. In this mode, maximum number of buffers is limited to VIDEO_MAX_FRAME (defined in driver header files) and is limited by the available memory in the kernel. If driver is not able to allocate the requested number of buffer, it will return the number of buffer it is able to allocate.
</p><p><b>NOTE:</b> Memoy Mapped buffer mode only support non-tiled memmory allocation with MAX size 4MB. User pointer buffer mode must be use if applicaiton want to use either tiled memory or buffer size bigger than 4MB.
</p><p><br />
The main steps that the application must perform for buffer allocation are:
<br />
</p>
<ul><li><b>Allocating Memory</b></li></ul>
<p>&lt;syntaxhighlight lang='c'&gt;VIDIOC_REQBUFS&lt;/syntaxhighlight&gt;
</p><p>This is a necessary ioctl for streaming IO. It has to be called for both drivers buffer mode and user buffer mode. Using this ioctl, driver will identify whether driver buffer mode or user buffer mode will be used.
</p><p>It takes a pointer to instance of the &lt;syntaxhighlight lang='c'&gt;v4l2_requestbuffers&lt;/syntaxhighlight&gt; structure as an argument.
</p><p>User can specify the buffer type (V4L2_BUF_TYPE_VIDEO_OUTPUT), number of buffers, and memory type (V4L2_MEMORY_MMAP, V4L2_MEMORY_USERPTR)at the time of buffer allocation. In case of driver buffer mode, this ioctl also returns the actual number of buffers allocated in count member of v4l2_requestbuffer structure.
</p><p>It can be called with zero number of buffers to free up all the buffers already allocated. It also frees allocated buffers when application changes buffer exchange mechanism. Driver always allocates buffers
of maximum image size supported. If application wants to change buffer size, it can be done through video1_buffsize and video2_buffsize command line arguments.
</p><p><br />
&lt;syntaxhighlight lang='c'&gt;
/* structure to store buffer request parameters */
struct v4l2_requestbuffers reqbuf;
reqbuf.count = numbuffers;
reqbuf.type = V4L2_BUF_TYPE_VIDEO_OUTPUT;
reqbuf.memory = V4L2_MEMORY_MMAP;
ret = ioctl(fd , VIDIOC_REQBUFS, &amp;reqbuf);
if(ret &lt; 0) {
</p>
<pre>   printf("cannot allocate memory\n");
   close(fd);
   return -1;
</pre>
<p>}
&lt;/syntaxhighlight&gt;
<br />
</p>
<ul><li><b>Getting physical address</b></li></ul>
<p>&lt;syntaxhighlight lang='c'&gt;VIDIOC_QUERYBUF&lt;/syntaxhighlight&gt;
</p><p>This ioctl is used to query buffer information like buffer size and buffer physical address. This physical address is used in m-mapping the buffers. This ioctl is necessary for driver buffer mode as it provides the physical address of buffers, which are used to mmap system call the buffers.
</p><p>It takes a pointer to instance of v4l2_buffer structure as an argument. User has to specify the buffer type (V4L2_BUF_TYPE_VIDEO_OUTPUT), buffer index, and memory type (V4L2_MEMORY_MMAP)at the time of querying.
</p><p><br />
&lt;syntaxhighlight lang='c'&gt;
/* allocate buffer by VIDIOC_REQBUFS */
/* structure to query the physical address
of allocated buffer */
struct v4l2_buffer buffer;
/* buffer index for querying -0 */
buffer.index = 0;
buffer.type = V4L2_BUF_TYPE_VIDEO_OUTPUT;
buffer.memory = V4L2_MEMORY_MMAP;
if (ioctl(fd, VIDIOC_QUERYBUF, &amp;buffer) &lt; 0) {
</p>
<pre>   printf("buffer query error.\n");
   close(fd);
   exit(-1);
</pre>
<p>}
/*The buffer.m.offset will contain the physical address returned from driver*/
&lt;/syntaxhighlight&gt;
</p><p><br />
</p>
<ul><li><b>Mapping Kernel space address to user space</b></li></ul>
<p>&lt;syntaxhighlight lang='c'&gt;mmap&lt;/syntaxhighlight&gt;
</p><p>Mapping the kernel buffer to the user space can be done via mmap. User can pass buffer size and physical address of buffer for getting the user space address
</p><p><br />
&lt;syntaxhighlight lang='c'&gt;
/* allocate buffer by VIDIOC_REQBUFS */
/* query the buffer using VIDIOC_QUERYBUF */
/* addr hold the user space address */
unsigned int addr;
addr = mmap(NULL, buffer.size, PROT_READ | PROT_WRITE, MAP_SHARED, fd, buffer.m.offset);
/* buffer.m.offset is same as returned from VIDIOC_QUERYBUF */
</p><p>&lt;/syntaxhighlight&gt;
<br />
</p>
<h2><span class="mw-headline" id="Transparency_Keying"><b>Transparency Keying</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=26" title="Edit section: Transparency Keying">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The encoded pixel color value is compared to the application defined transparency color key(RGB888) based the LSB bits mask set by the application to determine whether the pixel is to be transparent or not. There are four types of the bit mask offered by the hardware: No Masking, whole pixel color value is compared to the transparency color key; Mask[0]: MSB[7:1] of the encoded pixel color value is compared to the corresponding 7 bits of transparency color key; MASK[1:0]: MSB[7:2] of the encoded pixel color value is compared to the corresponding bits of transparency color key; MAKS[2:0]: MSB[7:3] of the encoded pixel color value is compared to the corresponding bits of transparency color key.
</p><p>User can enable/disable color key function, set color keying and mask type through Fbdev Driver private IOCTL interface, V4L2 IOCTL or Sysfs.
FBDev is used to configure the transparency of graphics pipeline while V4L2/Syfs is used to configure the transparency of video pipeline.
</p>
<ul><li><b>Using fbdev IOCTL</b></li></ul>
<p>Enable Transparency Keying:
</p><p>&lt;syntaxhighlight lang='c'&gt;
struct ti81xxfb_region_params regp;
</p><p>if (ioctl(fd, TIFB_GET_PARAMS, &amp;regp) &lt; 0) {
	perror("TIFB_GET_PARAMS\n");
</p>
<pre>       close(fd);
</pre>
<p>	exit(1);
}
</p><p>/* Enable the Transparency Keying */
regp.transen = TI81XXFB_FEATURE_ENABLE;
if (ioctl(fd, TIFB_SET_PARAMS, &amp;regp) &lt; 0) {
</p>
<pre>   perror ("TIFB_SET_PARAMS.\n");
   close(fd);
   exit(1);
</pre>
<p>}
&lt;/syntaxhighlight&gt;
</p><p>Disable Transparency Keying:
</p><p>&lt;syntaxhighlight lang='c'&gt;
struct ti81xxfb_region_params regp;
</p><p>if (ioctl(fd, TIFB_GET_PARAMS, &amp;regp) &lt; 0) {
	perror("TIFB_GET_PARAMS\n");
</p>
<pre>       close(fd);
</pre>
<p>	exit(1);
}
</p><p>/* Disable the Transparency Keying */
regp.transen = TI81XXFB_FEATURE_DISABLE;
if (ioctl(fd, TIFB_SET_PARAMS, &amp;regp) &lt; 0) {
</p>
<pre>   perror ("TIFB_SET_PARAMS.\n");
   close(fd);
   exit(1);
</pre>
<p>}
&lt;/syntaxhighlight&gt;
</p><p>Set Transparency Keying Value(RGB888):
</p><p>&lt;syntaxhighlight lang='c'&gt;
struct ti81xxfb_region_params regp;
u8 key_rgb888; /*RGB888 format*/
</p><p>if (ioctl(fd, TIFB_GET_PARAMS, &amp;regp) &lt; 0) {
	perror("TIFB_GET_PARAMS\n");
</p>
<pre>       close(fd);
</pre>
<p>	exit(1);
}
/* Set the Transparency Keying */
regp.transcolor = key_rgb888;
if (ioctl(fd, TIFB_SET_PARAMS, &amp;regp) &lt; 0) {
</p>
<pre>   perror ("TIFB_SET_PARAMS.\n");
   close(fd);
   exit(1);
</pre>
<p>}
&lt;/syntaxhighlight&gt;
</p><p>Set Transparency Keying Mask Type:
</p><p>&lt;syntaxhighlight lang='c'&gt;
struct ti81xxfb_region_params regp;
struct ti81xxfb_transparancy_type trans_type;
</p><p>if (ioctl(fd, TIFB_GET_PARAMS, &amp;regp) &lt; 0) {
	perror("TIFB_GET_PARAMS\n");
</p>
<pre>       close(fd);
</pre>
<p>	exit(1);
}
</p><p>/* Set the Transparency Keying Mask type */
regp.transtype= trans_type;
if (ioctl(fd, TIFB_SET_PARAMS, &amp;regp) &lt; 0) {
</p>
<pre>   perror ("TIFB_SET_PARAMS.\n");
   close(fd);
   exit(1);
</pre>
<p>}
&lt;/syntaxhighlight&gt;
</p>
<h3><span class="mw-headline" id="Using_V4L2_IOCTL"><b>Using V4L2 IOCTL</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=27" title="Edit section: Using V4L2 IOCTL">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ul><li><b>NOTE:</b>: /dev/video3 does not support transparency.</li></ul>
<p><br />
</p>
<ul><li>Enable the transparency Keying</li></ul>
<p>&lt;syntaxhighlight lang='c'&gt;
struct v4l2_framebuffer framebuffer;
ret = ioctl (fd, VIDIOC_G_FBUF, &amp;framebuffer);
if (ret &lt; 0) {
</p>
<pre>   perror ("VIDIOC_G_FBUF");
   close(fd);
   exit(1);
</pre>
<p>}
/* Set SRC_COLOR_KEYING if device supports that */
if(framebuffer.capability &amp; V4L2_FBUF_CAP_SRC_CHROMAKEY) {
</p>
<pre>   framebuffer.flags |= V4L2_FBUF_FLAG_SRC_CHROMAKEY;
   framebuffer.flags &amp;= ~V4L2_FBUF_FLAG_CHROMAKEY;
   ret = ioctl (fd, VIDIOC_S_FBUF, &amp;framebuffer);
   if (ret &lt; 0) {
       perror ("VIDIOC_S_FBUF");
       close(fd);
       exit(1);
   }
</pre>
<p>}
&lt;/syntaxhighlight&gt;
<br />
</p>
<ul><li>Disabling the Transparency Keying:</li></ul>
<p>&lt;syntaxhighlight lang='c'&gt;
struct v4l2_framebuffer framebuffer;
ret = ioctl (fd, VIDIOC_G_FBUF, &amp;framebuffer);
if (ret &lt; 0) {
</p>
<pre>   perror ("VIDIOC_G_FBUF");
   close(fd);
   exit(1);
</pre>
<p>}
if(framebuffer.capability &amp; V4L2_FBUF_CAP_SRC_CHROMAKEY) {
</p>
<pre>   framebuffer.flags &amp;= ~V4L2_FBUF_FLAG_SRC_CHROMAKEY;
   ret = ioctl (fd, VIDIOC_S_FBUF, &amp;framebuffer);
   if (ret &lt; 0) {
       perror ("VIDIOC_S_FBUF");
       close(fd);
       exit(1);
   }
</pre>
<p>}
&lt;/syntaxhighlight&gt;
</p><p><br />
</p>
<ul><li>Set the Transparency Keying value(RGB888,).</li></ul>
<p>&lt;syntaxhighlight lang='c'&gt;
struct v4l2_format fmt;
u8 chromakey = R&gt;&gt;16 | G&gt;&gt;8 | B; /* Chromakey is RGB888 format */
fmt.type = V4L2_BUF_TYPE_VIDEO_OVERLAY;
ret = ioctl(fd, VIDIOC_G_FMT, &amp;fmt);
if (ret &lt; 0) {
</p>
<pre>   perror("VIDIOC_G_FMT\n");
   close(fd);
   exit(0);
</pre>
<p>}
fmt.fmt.win.chromakey = chromakey;
ret = ioctl(fd, VIDIOC_S_FMT, &amp;fmt);
if (ret &lt; 0) {
</p>
<pre>   perror("VIDIOC_G_FMT\n");
   close(fd);
   exit(0);
</pre>
<p>}
&lt;/syntaxhighlight&gt;
<br />
</p>
<ul><li>Get the Transparency Keying value.</li></ul>
<p>&lt;syntaxhighlight lang='c'&gt;
struct v4l2_format fmt;
fmt.type = V4L2_BUF_TYPE_VIDEO_OVERLAY;
ret = ioctl(fd, VIDIOC_G_FMT, &amp;fmt);
if (ret &lt; 0) {
</p>
<pre>   perror("VIDIOC_G_FMT\n");
   close(fd);
   exit(0);
</pre>
<p>}
printf("Croma value read is&#160;%d\n", fmt.fmt.win.chromakey);
&lt;/syntaxhighlight&gt;
</p><p><br />
</p>
<h3><span class="mw-headline" id="Using_Sysfs"><b>Using Sysfs</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=28" title="Edit section: Using Sysfs">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Sysfs is only valid for video devices(not for graphcis devices).
</p>
<ul><li><b>NOTE:</b> /dev/video3(/sys/devices/platform/vpss/video2) does not support transparency.</li>
<li>Enable/Disable the Transparency keying</li></ul>
<pre>echo 0/1 &gt; /sys/devices/platform/vpss/video#/trans_key_enabled
       where 0/1: 0 - &gt; disable, 1 - &gt; enable
       #: 0-1 video device
</pre>
<p><br />
</p>
<ul><li>Set the Transparency Keying Value (RGB888 format, hex only)</li></ul>
<pre>echo  0xRRBBGG&gt; /sys/devices/platform/vpss/video#/trans_key_value
      where #: 0-1 video device
</pre>
<ul><li>Set the Transparency Keying Mask type</li></ul>
<p>number of LSB bits to maks when checking for pixel color keying
</p>
<pre>echo  0/1/2/3 &gt; /sys/devices/platform/vpss/video#/trans_key_type
       where 0: no maksing, 1: mask 1 LSB bit,2: mask 2 LSB bits;3: mask 3 LSB bits
       #: 0-1 video device

</pre>
<h2><span class="mw-headline" id="Alpha_Blending"><b>Alpha Blending</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=29" title="Edit section: Alpha Blending">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Alpha blending is a process of blending a foreground color with a background color and producing a new blended color. New blended color depends on the transparency factor referred to as alpha factor of the
foreground color. If the alpha factor is 100% then blended image will have only foreground color. If the alpha factor is 0% blended image will have only back ground color. Any value between 0 to 100% will blend the foreground and background color to produce new blended color depending upon the alpha factor.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:452px;"><a href="File_Transparency-50.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/7/7c/Transparency-50.png" width="450" height="338" class="thumbimage" /></a>  <div class="thumbcaption">Alpha blending with almost 50% transparency</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:452px;"><a href="File_Transparency-100.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/d/d5/Transparency-100.png" width="450" height="338" class="thumbimage" /></a>  <div class="thumbcaption">Alpha blending with almost 100% transparency</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:452px;"><a href="File_Transparency-0.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/5/59/Transparency-0.png" width="450" height="338" class="thumbimage" /></a>  <div class="thumbcaption">Alpha blending with almost 0% transparency</div></div></div></div>
<p><br />
</p><p><br />
Graphics pipelines of the VPSS are capable of supporting alpha blending. Three types of alpha blending is supported global, palette and pixel alpha blending. RGB formtas of graphics pipeline support global alpha blending, BMP formats of graphcis pipeline support palette alpha blending, ARGB and RGBA formats of graphics pipeline supports pixel based alpha blending.  In which A represent the alpha value for each pixel. Thus, each pixel can have different alpha value. While global alpha is the constant alpha factor for the pipeline for all the pixels.
</p>
<h3><span class="mw-headline" id="FBDev_IOCTL"><b>FBDev IOCTL</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=30" title="Edit section: FBDev IOCTL">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>All three kind of blending are support through fbdev driver.
</p>
<ul><li>Disable alpha blending</li></ul>
<p><br />
&lt;syntaxhighlight lang='c'&gt;
struct ti81xxfb_region_params  regp;
if (ioctl(fd, TIFB_GET_PARAMS, &amp;regp) &lt; 0) {
	perror("TIFB_GET_PARAMS\n");
</p>
<pre>       close(fd);
</pre>
<p>	exit(1);
}
/*Disable Alpha Blending*/
regp.blendtype = TI81XXFB_BLENDING_NO;
if (ioctl(fd, TIFB_SET_PARAMS, &amp;regp) &lt; 0) {
</p>
<pre>   perror ("TIFB_SET_PARAMS.\n");
   close(fd);
   exit(1);
</pre>
<p>}
&lt;/syntaxhighlight&gt;
</p><p><br />
</p>
<ul><li><b>Global Alpha blending</b></li></ul>
<p>User can configure global alpha value either through FBDEV ioctl.
</p><p>Below programlisting shows how to set the global alpha value for graphics pipeline.
</p><p><br />
&lt;syntaxhighlight lang='c'&gt;
struct ti81xxfb_region_params  regp;
u8    alpha;
if (ioctl(fd, TIFB_GET_PARAMS, &amp;regp) &lt; 0) {
	perror("TIFB_GET_PARAMS\n");
</p>
<pre>       close(fd);
</pre>
<p>	exit(1);
}
/*Set Global Alpha Blending*/
regp.blendtype = TI81XXFB_BLENDING_GLOBAL;
regp.blendalpha = alpha;
if (ioctl(fd, TIFB_SET_PARAMS, &amp;regp) &lt; 0) {
</p>
<pre>   perror ("TIFB_SET_PARAMS.\n");
   close(fd);
   exit(1);
</pre>
<p>}
&lt;/syntaxhighlight&gt;
</p><p><br />
</p>
<ul><li><b>Pixel Based Alpha blending</b></li></ul>
<p>FBDEV driver supports alpha blending through ARGB/RGBA pixel format
</p><p>Below programlisting shows how to set the pxiel alpha value for graphics pipeline.
</p><p><br />
&lt;syntaxhighlight lang='c'&gt;
struct ti81xxfb_region_params  regp;
if (ioctl(fd, TIFB_GET_PARAMS, &amp;regp) &lt; 0) {
	perror("TIFB_GET_PARAMS\n");
</p>
<pre>       close(fd);
</pre>
<p>	exit(1);
}
/*Set Pixel Alpha Blending*/
regp.blendtype = TI81XXFB_BLENDING_PIXEL;
if (ioctl(fd, TIFB_SET_PARAMS, &amp;regp) &lt; 0) {
</p>
<pre>   perror ("TIFB_SET_PARAMS.\n");
   close(fd);
   exit(1);
</pre>
<p>}
&lt;/syntaxhighlight&gt;
</p><p><br />
</p>
<ul><li><b>Palette Based Alpha blending</b></li></ul>
<p>FBDEV driver supports alpha blending through CLUT data, the data must be BMP format.
</p><p>Below programlisting shows how to set the palette alpha value for graphics pipeline.
</p><p><br />
&lt;syntaxhighlight lang='c'&gt;
struct ti81xxfb_region_params  regp;
if (ioctl(fd, TIFB_GET_PARAMS, &amp;regp) &lt; 0) {
	perror("TIFB_GET_PARAMS\n");
</p>
<pre>       close(fd);
</pre>
<p>	exit(1);
}
/*Set Palette Alpha Blending*/
regp.blendtype = TI81XXFB_BLENDING_PALETTE;
if (ioctl(fd, TIFB_SET_PARAMS, &amp;regp) &lt; 0) {
</p>
<pre>   perror ("TIFB_SET_PARAMS.\n");
   close(fd);
   exit(1);
</pre>
<p>}
&lt;/syntaxhighlight&gt;
</p>
<h3><span class="mw-headline" id="V4L2_IOCTLs"><b>V4L2 IOCTLs</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=31" title="Edit section: V4L2 IOCTLs">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ul><li><b>NOTE:</b>: /dev/video3 does not support alpha blending.</li></ul>
<p><br />
</p>
<ul><li>Eenable alpha blending</li></ul>
<p>&lt;syntaxhighlight lang='c'&gt;
struct v4l2_framebuffer framebuffer;
ret = ioctl (fd, VIDIOC_G_FBUF, &amp;framebuffer);
if (ret &lt; 0) {
</p>
<pre>   perror ("VIDIOC_S_FBUF");
   close(fd);
   return 0;
</pre>
<p>}
framebuffer.flags |= V4L2_FBUF_FLAG_LOCAL_ALPHA;
ret = ioctl (fd, VIDIOC_S_FBUF, &amp;framebuffer);
if (ret &lt; 0) {
</p>
<pre>   perror ("VIDIOC_S_FBUF");
   close(fd);
   return 0;
</pre>
<p>}
&lt;/syntaxhighlight&gt;
</p><p><br />
</p>
<ul><li>Disable alpha blending</li></ul>
<p>&lt;syntaxhighlight lang='c'&gt;
struct v4l2_framebuffer framebuffer;
ret = ioctl (fd, VIDIOC_G_FBUF, &amp;framebuffer);
if (ret &lt; 0) {
</p>
<pre>   perror ("VIDIOC_S_FBUF");
   close(fd);
   return 0;
</pre>
<p>}
framebuffer.flags &amp;= ~V4L2_FBUF_FLAG_LOCAL_ALPHA;
ret = ioctl (fd, VIDIOC_S_FBUF, &amp;framebuffer);
if (ret &lt; 0) {
</p>
<pre>   perror ("VIDIOC_S_FBUF");
   close(fd);
   return 0;
</pre>
<p>}
&lt;/syntaxhighlight&gt;
</p><p><br />
</p>
<ul><li>Set the global alpha value</li></ul>
<p>&lt;syntaxhighlight lang='c'&gt;
struct v4l2_format fmt;
u8 global_alpha = 128;
fmt.type = V4L2_BUF_TYPE_VIDEO_OVERLAY;
ret = ioctl(fd, VIDIOC_G_FMT, &amp;fmt);
if (ret &lt; 0) {
</p>
<pre>   perror("VIDIOC_G_FMT\n");
   close(fd);
   exit(0);
</pre>
<p>}
fmt.fmt.win.global_alpha = global_alpha;
ret = ioctl(fd, VIDIOC_S_FMT, &amp;fmt);
if (ret &lt; 0) {
</p>
<pre>   perror("VIDIOC_G_FMT\n");
   close(fd);
   exit(0);
</pre>
<p>}
&lt;/syntaxhighlight&gt;
</p>
<h3><span class="mw-headline" id="Using_Sysfs_2"><b>Using Sysfs </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=32" title="Edit section: Using Sysfs">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>This section is for video device only(not for graphics device)
</p>
<ul><li><b>NOTE:</b> /dev/video3(/sys/devices/platform/vpss/video2) does not support alpha blending.</li>
<li>Enable/disable alpha blending</li></ul>
<pre># echo 0/1 &gt; /sys/devices/platform/vpssss/video#/alpha_blending_enabled

Where,
      0/1   =&gt; 0 - Disable, 1 - Enable.
      #: 0-1 Video device
</pre>
<p><br />
</p>
<ul><li>Set the global alpha value</li></ul>
<pre># echo 0-255&gt; /sys/devices/platform/vpss/video#/global_alpha

Where,
      #: 0-1 Video device
</pre>
<h2><span class="mw-headline" id="Scaling"><b> Scaling </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=33" title="Edit section: Scaling">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Graphics pipeline supports 0.25x-4x scaling with a step size of 0.01. The scalar has 5tap/8phase polyphase horizontal filter and 4taps/8phase polyphase vertical filter. Meanwhile, When the target display of the graphics pipeline conncted to is in a interlaced scan mode, graphics pipeline could also performs anti-flicker filtering using the including scalar. This can be achieved by seting scaling ratio 1.
</p><p>Below shows how to enable the scaling feature
</p><p>&lt;syntaxhighlight lang='c'&gt;
struct ti81xxfb_region_params  regp;
if (ioctl(fd, TIFB_GET_PARAMS, &amp;regp) &lt; 0) {
	perror("TIFB_GET_PARAMS\n");
</p>
<pre>       close(fd);
</pre>
<p>	exit(1);
}
</p><p>regp.scalaren = TI81XXFB_FEATURE_ENABLE;
if (ioctl(fd, TIFB_SET_PARAMS, &amp;regp) &lt; 0) {
	perror("TIFB_SET_PARAMS\n");
</p>
<pre>       close(fd);
</pre>
<p>	exit(1);
}
&lt;/syntaxhighlight&gt;
</p><p>Below shows how to disable the scaling feature
</p><p>&lt;syntaxhighlight lang='c'&gt;
struct ti81xxfb_region_params  regp;
if (ioctl(fd, TIFB_GET_PARAMS, &amp;regp) &lt; 0) {
	perror("TIFB_GET_PARAMS\n");
</p>
<pre>       close(fd);
</pre>
<p>	exit(1);
}
regp.scalaren = TI81XXFB_FEATURE_DISABLE;
if (ioctl(fd, TIFB_SET_PARAMS, &amp;regp) &lt; 0) {
	perror("TIFB_SET_PARAMS\n");
</p>
<pre>       close(fd);
</pre>
<p>	exit(1);
}
&lt;/syntaxhighlight&gt;
</p><p><b>NOTE</b>
<br /> When graphics scalar performs scaling up or down, it could output maximum 2 more lines/pixels than what it is configured. App should consider this into design to not out of the display frame boundary.
<br /> TIFB_SET_SCINFO ioctl must be called before enabling the scaling feature. See Section 5.1.3<a rel="nofollow" class="external autonumber" href="http://ap-fpdsp-swapps.dal.design.ti.com/index.php/VPSS_Video_Driver_UserGuide#Supported_Custom_IOCTLs">[1]</a>.
</p>
<h2><span class="mw-headline" id="Stenciling"><b> Stenciling</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=34" title="Edit section: Stenciling">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Graphics pipeline  support a 1-bit for each pixel of a image that has "stenciling" feature enabled. This bit is used to force the alpha value of the pixel to ZERO in order to "mask"-off the pixel(such as transparent).
</p><p>Video pipelines do not support stenciling function.
Below shows how to enable the stenciling feature
</p><p>&lt;syntaxhighlight lang='c'&gt;
struct ti81xxfb_region_params  regp;
if (ioctl(fd, TIFB_GET_PARAMS, &amp;regp) &lt; 0) {
	perror("TIFB_GET_PARAMS\n");
</p>
<pre>       close(fd);
</pre>
<p>	exit(1);
}
regp.stencilingen = TI81XXFB_FEATURE_ENABLE;
if (ioctl(fd, TIFB_SET_PARAMS, &amp;regp) &lt; 0) {
	perror("TIFB_SET_PARAMS\n");
</p>
<pre>       close(fd);
</pre>
<p>	exit(1);
}
&lt;/syntaxhighlight&gt;
</p><p>Below shows how to disable the stenciling feature
</p><p>&lt;syntaxhighlight lang='c'&gt;
struct ti81xxfb_region_params  regp;
if (ioctl(fd, TIFB_GET_PARAMS, &amp;regp) &lt; 0) {
	perror("TIFB_GET_PARAMS\n");
</p>
<pre>       close(fd);
</pre>
<p>	exit(1);
}
regp.stencilingen = TI81XXFB_FEATURE_DISABLE;
if (ioctl(fd, TIFB_SET_PARAMS, &amp;regp) &lt; 0) {
	perror("TIFB_SET_PARAMS\n");
</p>
<pre>       close(fd);
</pre>
<p>	exit(1);
}
&lt;/syntaxhighlight&gt;
</p><p><b>NOTE</b>
<br /> TIFB_ALLOC and TIFB_SET_STENC ioctl must be called before enabling the scaling feature. See Section 5.1.3<a rel="nofollow" class="external autonumber" href="http://ap-fpdsp-swapps.dal.design.ti.com/index.php/VPSS_Video_Driver_UserGuide#Supported_Custom_IOCTLs">[2]</a>.
</p>
<h2><span class="mw-headline" id="Bound_Box_Blending"><b> Bound Box Blending</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=35" title="Edit section: Bound Box Blending">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Graphics pipleline supports overwriting alpha values of piels that make up a 1-pixel wide boundary box of a image with a semi-transparnt value(0x80,default) so the flickering around the edges can be minimized.
</p><p>Video pipelines does not support bound box function.
Below shows how to enable boundbox feature and change the bound box alpha value
&lt;syntaxhighlight lang='c'&gt;
struct ti81xxfb_region_params  regp;
if (ioctl(fd, TIFB_GET_PARAMS, &amp;regp) &lt; 0) {
	perror("TIFB_GET_PARAMS\n");
</p>
<pre>       close(fd);
</pre>
<p>	exit(1);
}
regp.bbalpha = 0x40;
regp.bben = TI81XXFB_FEATURE_ENABLE;
if (ioctl(fd, TIFB_SET_PARAMS, &amp;regp) &lt; 0) {
	perror("TIFB_SET_PARAMS\n");
</p>
<pre>       close(fd);
</pre>
<p>	exit(1);
}
&lt;/syntaxhighlight&gt;
</p><p>Below shows how to disable boundbox feature
&lt;syntaxhighlight lang='c'&gt;
struct ti81xxfb_region_params  regp;
if (ioctl(fd, TIFB_GET_PARAMS, &amp;regp) &lt; 0) {
	perror("TIFB_GET_PARAMS\n");
</p>
<pre>       close(fd);
</pre>
<p>	exit(1);
}
regp.bben = TI81XXFB_FEATURE_DISABLE;
if (ioctl(fd, TIFB_SET_PARAMS, &amp;regp) &lt; 0) {
	perror("TIFB_SET_PARAMS\n");
</p>
<pre>       close(fd);
</pre>
<p>	exit(1);
}
&lt;/syntaxhighlight&gt;
</p>
<h2><span class="mw-headline" id="Buffer_Format"><b>Buffer Format</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=36" title="Edit section: Buffer Format">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Buffer format describes the pixel format in the image. It also describes the memory organization of each color component within the pixel format. <br />
</p>
<h3><span class="mw-headline" id="FBDEV_Driver_3"><b>FBDEV Driver</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=37" title="Edit section: FBDEV Driver">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>In all buffer formats, blue value is always stored in least significant bits, then green value and then red value. The alpha value stored is up to the RGBA or ARGB format.
</p><p>Graphics pipeline supports following buffer format: RGB565, ARGB1555, RGBA5551, ARGB4444,RGBA4444, ARGB6666, RGBA6666, RGB888, ARGB8888 and RGBA8888. Moreover graphics pipeline supports 1/2/4/8 BMP format. Buffer format can be changed in FBDEV driver by using bpp, red, green, ,blue and transparency fields of fb_vscreeninfo structure and ioctl FBIOPUT_VSCREENINFO. Application needs to specify bits per pixel and length and offset of red, green, blue and transparnecy component to let driver know the right pixel format.
</p><p><br />
Extra care must be taken by the application when dealing with 1/2/4 BMP format. Graphis pipeline support 8 different 1b BMP formats, 4 different 2b BMP formats and 2 different 4b BMP formats. By default, if bits_per_pixel was assigned to 1,  TI81XXFB_BMP1_OFF0 format will be used by the driver. if bits_per_pixel was assigned to 2, TI81XXFB_BMP2_OFF0 will be used by the driver. If bits_per_pixel was assigend to 4, TI81XXFB_BMP1_L will be used by the driver. If default value is not meeting application's requirements, please use nonstd filed in the fb_vscreeninfo structure to set the right 1/2/4 BMP format. Do not forget to set nonstd to 0 when switching to different pixel format.
</p><p>Following example shows how to ARGB666 bits per pixels.
</p><p>&lt;syntaxhighlight lang='c'&gt;
struct fb_varscreeninfo var;
if (ioctl(fd, FBIOGET_VSCREENINFO, &amp;var) &lt; 0) {
</p>
<pre>   perror("FBIOGET_VSCREENINFO\n");
   close(fd);
   exit(0);
</pre>
<p>}
var.bpp = 24;
var.red.length = var.green.length = var.blue.length = var.transp.length = 4;
var.transp.offset = 18;
var.red.offset = 12;
var.green.offset = 6;
var.blue.offset = 0;
if (ioctl(fd, FBIOPUT_VSCREENINFO, &amp;var) &lt; 0) {
</p>
<pre>   perror("FBIOPUT_VSCREENINFO\n");
   close(fd);
   exit(0);
</pre>
<p>}
&lt;/syntaxhighlight&gt;
</p><p><br />
<b>Buffer Formats</b>
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:752px;"><a href="File_Rgb565.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/6/62/Rgb565.png" width="750" height="86" class="thumbimage" /></a>  <div class="thumbcaption">RGB565 Data Memory Organization</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:752px;"><a href="File_Argb1555.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/a/ad/Argb1555.png" width="750" height="83" class="thumbimage" /></a>  <div class="thumbcaption">ARGB1555 Data Memory Organization</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:752px;"><a href="File_Argb4444.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/1/10/Argb4444.png" width="750" height="83" class="thumbimage" /></a>  <div class="thumbcaption">ARGB444 Data Memory Organization</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:752px;"><a href="File_Rgba5551.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/b/be/Rgba5551.png" width="750" height="83" class="thumbimage" /></a>  <div class="thumbcaption">RGBA5551 Data Memory Organization</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:752px;"><a href="File_Rgba4444.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/5/56/Rgba4444.png" width="750" height="83" class="thumbimage" /></a>  <div class="thumbcaption">RGBA4444 Data Memory Organization</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:752px;"><a href="File_Rgb888.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/5/56/Rgb888.png" width="750" height="86" class="thumbimage" /></a>  <div class="thumbcaption">RGB888 Data Memory Organization</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:752px;"><a href="File_Argb6666.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/6/6a/Argb6666.png" width="750" height="86" class="thumbimage" /></a>  <div class="thumbcaption">ARGB6666 Data Memory Organization</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:752px;"><a href="File_Rgba6666.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/4/44/Rgba6666.png" width="750" height="86" class="thumbimage" /></a>  <div class="thumbcaption">RGBA6666 Data Memory Organization</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:752px;"><a href="File_Argb8888.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/f/f6/Argb8888.png" width="750" height="86" class="thumbimage" /></a>  <div class="thumbcaption">ARGB8888 Data Memory Organization</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:752px;"><a href="File_Rgba8888.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/6/6d/Rgba8888.png" width="750" height="86" class="thumbimage" /></a>  <div class="thumbcaption">RGBA8888 Data Memory Organization</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:752px;"><a href="File_Bitmap_8_bpp.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/7/76/Bitmap_8_bpp.png" width="750" height="312" class="thumbimage" /></a>  <div class="thumbcaption">BPP8 Data Memory Organization</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:752px;"><a href="File_Bitmap_4_bpp_lower.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/0/0e/Bitmap_4_bpp_lower.png" width="750" height="313" class="thumbimage" /></a>  <div class="thumbcaption">BPP4 LOWER Data Memory Organization</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:752px;"><a href="File_Bitmap_4_bpp_upper.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/b/bc/Bitmap_4_bpp_upper.png" width="750" height="313" class="thumbimage" /></a>  <div class="thumbcaption">BPP4 UPPER Data Memory Organization</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:758px;"><a href="File_Bitmap_2_bpp_offset0.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/2/23/Bitmap_2_bpp_offset0.png" width="756" height="323" class="thumbimage" /></a>  <div class="thumbcaption">BPP2 OFFSET0 Data Memory Organization</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:752px;"><a href="File_Bitmap_2_bpp_offset1.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/b/be/Bitmap_2_bpp_offset1.png" width="750" height="328" class="thumbimage" /></a>  <div class="thumbcaption">BPP2 OFFSET1 Data Memory Organization</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:751px;"><a href="File_Bitmap_2_bpp_offset2.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/0/04/Bitmap_2_bpp_offset2.png" width="749" height="313" class="thumbimage" /></a>  <div class="thumbcaption">BPP2 OFFSET2 Data Memory Organization</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:755px;"><a href="File_Bitmap_2_bpp_offset3.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/9/94/Bitmap_2_bpp_offset3.png" width="753" height="314" class="thumbimage" /></a>  <div class="thumbcaption">BPP2 OFFSET3 Data Memory Organization</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:752px;"><a href="File_Bitmap_1_bpp_offset0.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/6/6e/Bitmap_1_bpp_offset0.png" width="750" height="313" class="thumbimage" /></a>  <div class="thumbcaption">BPP1 OFFSET0 Data Memory Organization</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:752px;"><a href="File_Bitmap_1_bpp_offset1.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/f/f3/Bitmap_1_bpp_offset1.png" width="750" height="341" class="thumbimage" /></a>  <div class="thumbcaption">BPP1 OFFSET1 Data Memory Organization</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:752px;"><a href="File_Bitmap_1_bpp_offset2.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/d/dd/Bitmap_1_bpp_offset2.png" width="750" height="310" class="thumbimage" /></a>  <div class="thumbcaption">BPP1 OFFSET2 Data Memory Organization</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:752px;"><a href="File_Bitmap_1_bpp_offset3.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/5/5d/Bitmap_1_bpp_offset3.png" width="750" height="315" class="thumbimage" /></a>  <div class="thumbcaption">BPP1 OFFSET3 Data Memory Organization</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:752px;"><a href="File_Bitmap_1_bpp_offset4.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/c/cd/Bitmap_1_bpp_offset4.png" width="750" height="329" class="thumbimage" /></a>  <div class="thumbcaption">BPP1 OFFSET4 Data Memory Organization</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:752px;"><a href="File_Bitmap_1_bpp_offset5.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/5/50/Bitmap_1_bpp_offset5.png" width="750" height="320" class="thumbimage" /></a>  <div class="thumbcaption">BPP1 OFFSET5 Data Memory Organization</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:752px;"><a href="File_Bitmap_1_bpp_offset6.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/e/e7/Bitmap_1_bpp_offset6.png" width="750" height="320" class="thumbimage" /></a>  <div class="thumbcaption">BPP1 OFFSET6 Data Memory Organization</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:752px;"><a href="File_Bitmap_1_bpp_offset7.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/8/8e/Bitmap_1_bpp_offset7.png" width="750" height="320" class="thumbimage" /></a>  <div class="thumbcaption">BPP1 OFFSET7 Data Memory Organization</div></div></div></div>
<p><br />
<br />
</p>
<h3><span class="mw-headline" id="V4L2_Driver_3"><b>V4L2 Driver</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=38" title="Edit section: V4L2 Driver">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>video layer supports following buffer format: YUYV and Y/UV. The corresponding v4l2 defines for pixel format are V4L2_PIX_FMT_YUYV, V4L2_PIX_FMT_NV12, V4L2_PIX_FMT_NV16.
Buffer format can be changed using VIDIOC_S_FMT ioctl with type as V4L2_BUF_TYPE_VIDEO_OUTPUT and appropriate pixel format type.
</p>
<table border="1" cellspacing="0" cellpadding="5" width="40%">
<caption><b>Video Deviceo Buffer Format </b>
</caption>
<tbody><tr>
<th align="left">Buffer Format
</th>
<th align="left">/dev/video1
</th>
<th align="left">/dev/video2
</th>
<th align="left">/dev/video3
</th></tr>
<tr>
<td>V4L2_PIX_FMT_YUYV
</td>
<td>Y
</td>
<td>Y
</td>
<td>Y
</td></tr>
<tr>
<td>V4L2_PIX_FMT_NV12
</td>
<td>N
</td>
<td>N
</td>
<td>Y
</td></tr>
<tr>
<td>V4L2_PIX_FMT_NV16
</td>
<td>N
</td>
<td>N
</td>
<td>Y
</td></tr></tbody></table>
<ul><li><b>NOTE:</b>: For the NV12/NV16 format, even the Y and UV(CbCr) components are stored separated, the buffer address of Y and UV(CbCr) component should be continuous or driver can not handle these two formats.</li></ul>
<p>Following example shows how to change pixel format to YUYV
</p><p><br />
</p>
<pre>struct v4l2_format fmt;
fmt.type = V4L2_BUF_TYPE_VIDEO_OUTPUT;
fmt.fmt.pix.pixelformat = V4L2_PIX_FMT_YUYV;
ret = ioctl(fd, VIDIOC_S_FMT, &amp;fmt);
if (ret &lt; 0) {
    perror("VIDIOC_S_FMT\n");
    close(fd);
    exit(0);
}
</pre>
<p><br />
<b>Buffer Formats</b>
</p>
<ul><li>YUYV422 Interleaved Format</li></ul>
<p>YUYV422 is expected to be packed with Y0 in the lowest byte followed by U(Cb) followed by Y1 finally V(Cr) in the upper most byte.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:492px;"><a href="File_Yuyv.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/7/74/Yuyv.png" width="490" height="268" class="thumbimage" /></a>  <div class="thumbcaption">YUYV422 Interleaved Data Memory Organization</div></div></div></div>
<ul><li>YUV422 Semi-planar Format</li></ul>
<p>Y and UV are stored separately. UV is expected to be packed with U(Cb) in the lower byte and V(Cr) in the upper byte.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:492px;"><a href="File_Yuv422sp.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/e/eb/Yuv422sp.png" width="490" height="240" class="thumbimage" /></a>  <div class="thumbcaption">YUV422 semi-planar Data Memory Organization</div></div></div></div>
<ul><li>YUV420 Semi-planar Format</li></ul>
<p>Y and UV are stored separately. UV is expected to be packed with U(Cb) in the lower byte and V(Cr) in the upper byte.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:492px;"><a href="File_Yuv420sp.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/9/95/Yuv420sp.png" width="490" height="231" class="thumbimage" /></a>  <div class="thumbcaption">YUV420 semi-planar Data Memory Organization</div></div></div></div>
<h2><span class="mw-headline" id="Display_Position_of_Graphics"><b>Display Position of Graphics</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=39" title="Edit section: Display Position of Graphics">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h3><span class="mw-headline" id="FBDev_IOCTL_2"><b>FBDev IOCTL</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=40" title="Edit section: FBDev IOCTL">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The display position of graphics pipeline is able to changed within the resolution defined by the VENCs which graphics pipiline is connected.
</p><p>Following example shows how to change display position graphics.
</p><p>&lt;syntaxhighlight lang='c'&gt;
struct ti81xxfb_region_params  regp;
if (ioctl(fd, TIFB_GET_PARAMS, &amp;regp) &lt; 0) {
	perror("TIFB_GET_PARAMS\n");
</p>
<pre>       close(fd);
</pre>
<p>	exit(1);
}
/*Set the Display position*/
regp.pos_x = 10;
regp.pos_y = 20;
if (ioctl(fd, TIFB_SET_PARAMS, &amp;regp) &lt; 0) {
</p>
<pre>   perror ("TIFB_SET_PARAMS\n");
   close(fd);
   exit(1);
</pre>
<p>}
&lt;/syntaxhighlight&gt;
</p><p><br />
</p>
<h3><span class="mw-headline" id="V4L2_IOCTL"><b>V4L2 IOCTL</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=41" title="Edit section: V4L2 IOCTL">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The video pipelines can be connected to various output interface through SYSFS interface. Although the display Driver computes a default display window whenever the image size or cropping is changed, an application should position the display window via the VIDIOC_S_FMT I/O control with the V4L2_BUF_TYPE_VIDEO_OVERLAY buffer type. When a switch from one display interface to the onther happens, an application is expected to adjust the display window. V4L2 driver only supports change of display window.
</p><p>Following example shows how to change display window size.
</p><p>&lt;syntaxhighlight lang='c'&gt;
struct v4l2_format fmt;
Fmt.type = V4L2_BUF_TYPE_VIDEO_OVERLAY;
fmt.fmt.win.w.left = 0;
fmt.fmt.win.w.top = 0;
fmt.fmt.win.w.width = 200;
fmt.fmt.win.w.height = 200;
ret = ioctl(fd, VIDIOC_S_FMT, &amp;fmt);
if (ret &lt; 0) {
</p>
<pre>   perror("VIDIOC_S_FMT\n");
   close(fd);
   exit(0);
</pre>
<p>}
/* Display window size and position is changed now */
&lt;/syntaxhighlight&gt;
</p>
<ul><li><b>NOTE:</b>: the width and height should match the width and height of the VIDIOC_S_FMT I/O control with the V4L2_BUF_TYPE_VIDEO buffer type if cropping is no used; the width and height should match the width and height of the VIDIOC_S_CROP I/O control with V4L2_BUF_TYPE_VIDEO buffer type if cropping is used, otherwise driver reports error back to caller.</li></ul>
<p><br />
</p>
<h2><span class="mw-headline" id="Cropping"><b>Cropping</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=42" title="Edit section: Cropping">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The V4L2 Driver allows an application to define a rectangular portion of the image to be rendered via the VIDIOC_S_CROP Ioctl with the V4L2_BUF_TYPE_VIDEO_OUTPUT buffer type. When application calls VIDIOC_S_FMT ioctl, driver sets default cropping rectangle that is the largest rectangle no larger than the image size and display windows size. The default cropping rectangle is centered in the image. All cropping dimensions are rounded down to even numbers. Changing the size of the cropping rectangle will in general also result in a new default display window. As stated above, an application must adjust the display window accordingly.
</p><p>Following example shows how to change crop size.
</p><p>&lt;syntaxhighlight lang='c'&gt;
struct v4l2_crop crop;
crop.type = V4L2_BUF_TYPE_VIDEO_OUTPUT;
crop.c.left = 0;
crop.c.top = 0;
crop.c.width = 320;
crop.c.height = 320;
ret = ioctl(fd, VIDIOC_S_CROP, &amp;crop);
if (ret &lt; 0) {
</p>
<pre>   perror("VIDIOC_S_CROP\n");
   close(fd);
   exit(0);
</pre>
<p>}
/* Image cropping rectangle is now changed */
&lt;/syntaxhighlight&gt;
</p><p><br />
</p>
<h2><span class="mw-headline" id="Color_look_table"><b>Color look table</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=43" title="Edit section: Color look table">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The graphics pipeline supports the color look up table. The CLUT mode uses the encoded pixel values from the input image as pointers to index the 32-bit-wide CLUT value: 1-BPP pixels address 2 entries, 2-BPP pixels address 4 entries, 4-BPP pixels address 16 entries, and 8-BPP pixels address 256 entries.
</p><p>Driver supports 1, 2, 4 and 8 bits per pixel image format using color lookup table. FBIOPUTCMAP and FBIOGETCMAP can be used to set and get the color map table. When CLUT is set, the driver makes the hardware to reload the CLUT.
</p><p>Following example shows how to change CLUT.
</p><p>&lt;syntaxhighlight lang='c'&gt;
struct fb_cmap cmap;
unsigned short r[256]={0xFF, 0x00, 0x00, 0xFF};
unsigned short g[256]={0x00, 0xFF, 0x00, 0xFF};
unsigned short b[256]={0x00, 0x00, 0xFF, 0x00};
unsigned short t[256]={0xFF, 0xFF, 0xFF, 0xFF};
cmap.len = 256;
cmap.red = r;
cmap.green = g;
cmap.blue = b;
cmap.transp = t;
if (ioctl(fd, FBIOPUTCMAP, &amp;cmap)) {
</p>
<pre>   perror("FBIOPUTCMAP\n");
   close(fd);
   exit(3);
</pre>
<p>}
&lt;/syntaxhighlight&gt;
</p><p><br />
</p>
<h2><span class="mw-headline" id="Streaming"><b>Streaming</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=44" title="Edit section: Streaming">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>V4L2 driver supports the streaming of the buffer. To do streaming minimum of three buffers should be requested by the application by using VIDIOC_REQBUFS ioctl. Once driver allocates the requested buffers application should call VIDIOC_QUERYBUF and mmap to get the physical address of the buffers and map the kernel memory to user space as explained earlier. Following are the steps to enable streaming.
</p><p><br />
</p>
<ol><li>Fill the buffers with the image to be displayed in the proper format</li>
<li>Queue buffers to the driver queue using VIDIOC_QBUF ioctl</li>
<li>Start streaming using VIDIOC_STREAMON ioctl</li>
<li>Call VIDIOC_DQBUF to get the displayed buffer</li>
<li>Repeat steps 1, 2, 4 and 5 in a loop for the frame count to be displayed</li>
<li>Call VIDIOC_STREAMOFF ioctl to stop streaming</li></ol>
<p><br />
Following example shows how to do streaming with V4l2 driver
</p><p>&lt;syntaxhighlight lang='c'&gt;
/* Initially fill the buffer */
struct v4l2_requestbuffers req;
struct v4l2_buffer buf;
struct v4l2_format fmt;
/* Fill the buffers with the image */
/* Enqueue buffers */
for (i = 0; i &lt; req.count; i++) {
</p>
<pre>   buf.type = V4L2_BUF_TYPE_VIDEO_OUTPUT;
   buf.index = i;
   buf.memory = V4L2_MEMORY_MMAP;
   ret = ioctl(fd, VIDIOC_QBUF, &amp;buf);
   if (ret &lt; 0) {
       perror("VIDIOC_QBUF\n");
       for (j = 0; j &lt; req.count; j++){
           /* Unmap all the buffers if call fails */
           exit(0);
       }
       printf("VIDIOC_QBUF =&#160;%d\n",i);
   }
</pre>
<p>}
/* Start streaming */
a = 0;
ret = ioctl(fd, VIDIOC_STREAMON, &amp;a);
if (ret &lt; 0) {
</p>
<pre>   perror("VIDIOC_STREAMON\n");
   for (i = 0; i &lt; req.count; i++)
       /* Unmap all the buffers if call fails */
   exit(0);
</pre>
<p>}
/* loop for streaming with 500 Frames*/
for(i = 0&#160;;i &lt; LOOPCOUNT&#160;;i ++) {
</p>
<pre>   ret = ioctl(fd, VIDIOC_DQBUF, &amp;buf);
   if(ret &lt; 0){
       perror("VIDIOC_DQBUF\n");
       for (j = 0; j &lt; req.count; j++){
           /* Unmap all the buffers if call fails */
       }
       exit(0);
   }
   /* Fill the buffer with new data
   fill(buff_info[buf.index].start, fmt.fmt.pix.width, fmt.fmt.pix.height,0);
   /Queue the buffer again */
   ret = ioctl(fd, VIDIOC_QBUF, &amp;buf);
   if(ret &lt; 0){
       perror("VIDIOC_QBUF\n");
       for (j = 0; j &lt; req.count; j++){
            /* Unmap all the buffers if call fails */
       }
       exit(0);
   }
</pre>
<p>}
/* Streaming off */
ret = ioctl(fd, VIDIOC_STREAMOFF, &amp;a);
if (ret &lt; 0) {
</p>
<pre>   perror("VIDIOC_STREAMOFF\n");
   for (i = 0; i &lt; req.count; i++){
       /* Unmap all the buffers if call fails */
   exit(0);
</pre>
<p>}
&lt;/syntaxhighlight&gt;
</p><p><br />
</p>
<h1><span class="mw-headline" id="Software_Interfaces"><b>Software Interfaces</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=45" title="Edit section: Software Interfaces">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h2><span class="mw-headline" id="Frame-Buffer_Driver_Interface"><b>Frame-Buffer Driver Interface</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=46" title="Edit section: Frame-Buffer Driver Interface">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h3><span class="mw-headline" id="Application_Interface"><b>Application Interface</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=47" title="Edit section: Application Interface">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p><i>open ()</i>
<br />
To open a framebuffer device
<br />
<i>close ()</i>
<br />
To close a framebuffer device
<br />
<i>ioctl ()</i>
<br />
To send ioctl commands to the framebuffer driver.
<br />
<i>mmap ()</i>
<br />
To obtain the framebuffer region as mmap'ed area in user space.
<br />
</p>
<h3><span class="mw-headline" id="Supported_Standard_IOCTLs"><b>Supported Standard IOCTLs</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=48" title="Edit section: Supported Standard IOCTLs">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p><i><b>FBIOGET_VSCREENINFO, FBIOPUT_VSCREENINFO</b></i>
<br />
These I/O controls are used to query and set the so-called variable screen info. This allows an application to query or change the display mode, including the color depth, resolution, timing etc. These I/O controls accept a pointer to a struct fb_var_screeninfo structure. The video mode data supplied in the fb_var_screeninfo struct is translated to values loaded into the display controller registers.
</p><p><br />
<i><b>FBIOGET_FSCREENINFO</b></i>
<br />
This I/O control can be used by applications to get the fixed properties of the display, e.g. the start address of the framebuffer memory. This I/O control accepts a pointer to a struct fb_fix_screeninfo.
</p><p><br />
<i><b>FBIOGETCMAP, FBIOPUTCMAP</b></i>
<br />
These I/O controls are used to get and set the color-map for the framebuffer. These I/O controls accept a pointer to a struct fb_cmap structure. TI81XX supports 256*32(RGBT) color-map, so the len of the fb_cmap should be 256, or driver returns error.
</p><p><br />
<i><b>FBIO_BLANK</b></i>
<br />
This I/O control is used to blank or unblank the framebuffer console.
</p><p><br />
<i><b>FBIO_WAITFORVSYNC</b></i>
<br />
This I/O control is used to put an application to sleep until next vertical
sync interval of the display.
</p><p><br />
</p>
<h3><span class="mw-headline" id="Supported_Custom_IOCTLs"><b>Supported Custom IOCTLs</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=49" title="Edit section: Supported Custom IOCTLs">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p><i><b>TIFB_GET_PARAMS</b></i>
<br />Ioctl returns the parameters of the current graphics features.
</p><p><b>Data Structure:</b>
&lt;syntaxhighlight lang='c'&gt;
enum ti81xxfb_status {
</p>
<pre>TI81XXFB_FEATURE_DISABLE = 0,
TI81XXFB_FEATURE_ENABLE
</pre>
<p>};
</p><p>enum ti81xxfb_blending_type {
</p>
<pre>/*alpha blending disable*/
TI81XXFB_BLENDING_NO = 0,
/* global alpha blending*/
TI81XXFB_BLENDING_GLOBAL,
/* PALETTE alpha blending, the alpha value in CLUT is used for blending*/
TI81XXFB_BLENDING_PALETTE,
 /*PIXEL alpha blending, valid for ARGB/RGBA format only, the embedded alpha value is used*/
TI81XXFB_BLENDING_PIXEL
</pre>
<p>};
</p><p>enum ti81xxfb_transparancy_type {
</p>
<pre>/*when performing color comparison, no MASK*/
TI81XXFB_TRANSP_LSPMASK_NO = 0,
/*MASK the LSB bit0 for each color component*/
TI81XXFB_TRANSP_LSPMASK_1,
/*MASK the LSB bit[1:0] for each color component*/
TI81XXFB_TRANSP_LSPMASK_2,
/*MASK the LSB bit[2:0] for each color component*/
TI81XXFB_TRANSP_LSMMASK_3
</pre>
<p>};
</p><p><br />
struct ti81xxfb_region_params {
</p>
<pre>__u16 				ridx;
__u16 				pos_x;
__u16 				pos_y;
__u16 				priority;
/*enum ti81xxfb_status*/
__u32		  		firstregion;
/*enum ti81xxfb_status*/
__u32				lastregion;
/*enum ti81xxfb_status*/
__u32		  		scalaren;
/*enum ti81xxfb_status*/
__u32		  		stencilingen;
/*enum ti81xxfb_status*/
__u32				bben;
/*enum ti81xxfb_status*/
__u32		  		transen;
/*enum ti81xxfb_blending_type*/
__u32				blendtype;
/*enum ti81xxfb_transparancy_type*/
__u32 				transtype;
__u32  			transcolor;
__u8  				bbalpha;
__u8   			blendalpha;
__u8				reserved[2];
</pre>
<p>};
&lt;/syntaxhighlight&gt;
</p>
<ul><li><b>NOTE:</b> firstregion and lastregion must be set to 1, these two fields are reserved for future usages.</li></ul>
<p><b>Usage:</b>
&lt;syntaxhighlight lang='c'&gt;
struct ti81xxfb_region_params regp;
if (ioctl(fd, TIFB_GET_PARAMS, &amp;regp) &lt; 0) {
</p>
<pre>perror("TIFB_GET_PARAMS\n");
close(fd);
exit(1);
</pre>
<p>}
</p><p>&lt;/syntaxhighlight&gt;
<br />
<i><b>TIFB_SET_PARAMS</b></i>
<br />
Ioctl set the current graphics features.
</p><p><b>Data Structure:</b>
&lt;syntaxhighlight lang='c'&gt;
enum ti81xxfb_status {
</p>
<pre>TI81XXFB_FEATURE_DISABLE = 0,
TI81XXFB_FEATURE_ENABLE
</pre>
<p>};
</p><p>enum ti81xxfb_blending_type {
</p>
<pre>/*alpha blending disable*/
TI81XXFB_BLENDING_NO = 0,
/* global alpha blending*/
TI81XXFB_BLENDING_GLOBAL,
/* PALETTE alpha blending, the alpha value in CLUT is used for blending*/
TI81XXFB_BLENDING_PALETTE,
 /*PIXEL alpha blending, valid for ARGB/RGBA format only, the embedded alpha value is used*/
TI81XXFB_BLENDING_PIXEL
</pre>
<p>};
</p><p>enum ti81xxfb_transparancy_type {
</p>
<pre>/*when performing color comparison, no MASK*/
TI81XXFB_TRANSP_LSPMASK_NO = 0,
/*MASK the LSB bit0 for each color component*/
TI81XXFB_TRANSP_LSPMASK_1,
/*MASK the LSB bit[1:0] for each color component*/
TI81XXFB_TRANSP_LSPMASK_2,
/*MASK the LSB bit[2:0] for each color component*/
TI81XXFB_TRANSP_LSMMASK_3
</pre>
<p>};
</p><p><br />
struct ti81xxfb_region_params {
</p>
<pre>__u16 				ridx;
__u16 				pos_x;
__u16 				pos_y;
__u16 				priority;
/*enum ti81xxfb_status*/
__u32		  		firstregion;
/*enum ti81xxfb_status*/
__u32				lastregion;
/*enum ti81xxfb_status*/
__u32		  		scalaren;
/*enum ti81xxfb_status*/
__u32		  		stencilingen;
/*enum ti81xxfb_status*/
__u32				bben;
/*enum ti81xxfb_status*/
__u32		  		transen;
/*enum ti81xxfb_blending_type*/
__u32				blendtype;
/*enum ti81xxfb_transparancy_type*/
__u32 				transtype;
__u32  			transcolor;
__u8  				bbalpha;
__u8   			blendalpha;
__u8				reserved[2];
</pre>
<p>};
&lt;/syntaxhighlight&gt;
</p>
<ul><li><b>NOTE:</b> firstregion and lastregion must be set to 1, these two fields are reserved for future usages.</li></ul>
<p><b>Usage:</b>
</p>
<ul><li>Enable Global Alpha Blending with alpha value (0x40)</li></ul>
<p>&lt;syntaxhighlight lang='c'&gt;
struct ti81xxfb_region_params regp;
if (ioctl(fd, TIFB_GET_PARAMS, &amp;regp) &lt; 0) {
</p>
<pre>perror("TIFB_GET_PARAMS\n");
close(fd);
exit(1);
</pre>
<p>}
regp.blendtype = TI81XXFB_BLENDING_GLOBAL;
regp.blendalpha = 0x40;
if (ioctl(fd, TIFB_SET_PARAMS, &amp;regp) &lt; 0) {
</p>
<pre>perror("TIFB_SET_PARAMS\n");
close(fd);
exit(1);
</pre>
<p>}
</p><p>&lt;/syntaxhighlight&gt;
</p>
<ul><li>Enable Transparency without masking, the RGB color key is 0x123456</li></ul>
<p>&lt;syntaxhighlight lang='c'&gt;
struct ti81xxfb_region_params regp;
if (ioctl(fd, TIFB_GET_PARAMS, &amp;regp) &lt; 0) {
</p>
<pre>perror("TIFB_GET_PARAMS\n");
close(fd);
exit(1);
</pre>
<p>}
regp.transen = TI81XXFB_FEATURE_ENABLE;
regp.transtype = TI81XXFB_TRANSP_LSPMASK_NO;
regp.transcolor = 0x123456;
if (ioctl(fd, TIFB_SET_PARAMS, &amp;regp) &lt; 0) {
</p>
<pre>perror("TIFB_SET_PARAMS\n");
close(fd);
exit(1);
</pre>
<p>}
</p><p>&lt;/syntaxhighlight&gt;
<br />
<b>NOTE</b>: Only TI81XXFB_MEM_NONTILER is supported currently.
</p><p><b>Usage:</b>
&lt;syntaxhighlight lang='c'&gt;
struct ti81xxfb_mem_info mi;
if (ioctl(fb, TIFB_QUERY_MEM, &amp;mi)) {
</p>
<pre>perror("TIFB_QUERY_MEM.\n");
close(fd);
exit(1);
</pre>
<p>}
&lt;/syntaxhighlight&gt;
</p><p><br />
<i><b>TI81XX_SETUP_MEM</b></i>
<br />
Allows user to setup the frame buffer memory, like size and type.
</p><p><b>Data Structure:</b>
</p><p>&lt;syntaxhighlight lang='c'&gt;
enum ti81xxfb_mem_mode {
</p>
<pre>TI81XXFB_MEM_NONTILER = 0,
TI81XXFB_MEM_TILER_PAGE ,
TI81XXFB_MEM_TILER_8,
TI81XXFB_MEM_TILER_16,
TI81XXFB_MEM_TILER_32
</pre>
<p>};
struct ti81xxfb_mem_info {
</p>
<pre>__u32 size;
/*ti81xxfb_mem_mode*/
__u32  type;
</pre>
<p>};
&lt;/syntaxhighlight&gt;
<br />
<b>NOTE</b>: Only TI81XXFB_MEM_NONTILER is supported currently.
</p><p><b>Usage:</b>
&lt;syntaxhighlight lang='c'&gt;
struct ti81xxfb_mem_info mi;
if (ioctl(fb, TIFB_QUERY_MEM, &amp;mi)) {
</p>
<pre>perror("TIFB_QUERY_MEM.\n");
close(fd);
exit(1);
</pre>
<p>}
</p><p>mi.size = &lt;Expected size of buffer&gt;
mi.type = &lt;Expected type of buffer&gt;
if (ioctl(fb, TIFB_SETUP_MEM, &amp;mi)) {
</p>
<pre>perror("TIFB_SETUP_MEM.\n");
close(fd);
exit(1);
</pre>
<p>}
&lt;/syntaxhighlight&gt;
</p><p><br />
<br />
<i><b>TIFB_SET_SCINFO</b></i>
</p><p><br /> Allow users to config the scalar ratio
</p><p><b>Data Structure:</b>
</p><p>&lt;syntaxhighlight lang='c'&gt;
</p><p>struct ti81xxfb_coeff {
</p>
<pre>__u16     horcoeff[TI81XXFB_COEFF_HOR_TAP][TI81XXFB_COEFF_PHASE];
__u16     vercoeff[TI81XXFB_COEFF_VER_TAP][TI81XXFB_COEFF_PHASE];
</pre>
<p>};
&lt;/syntaxhighlight&gt;
<b>NOTE:</b>
<br /> each coefficient is 10 bit wide, so MSB[15:10] will be truncated by the driver.
</p><p>&lt;syntaxhighlight lang='c'&gt;
struct ti81xxfb_scparams {
</p>
<pre>__u16                  inwidth;
__u16                  inheight;
__u16                  outwidth;
__u16                  outheight;
struct ti81xxfb_coeff  *coeff
</pre>
<p>};
&lt;/syntaxhighlight&gt;
<b>NOTE:</b>
</p>
<ul><li>If input is scaled either up or down to full screen of the display output format, the outwidth and outheight should be set to VENC output resolution -2. For example: if display output format is 1280x720, then outwidht is set to 1280 - 2 = 1178, outheight is set to 720 - 2 = 718. If the outwidth and outheight is not following the rule, a distorted image could be obtained.</li>
<li>0.25x-4x scaling is supported for both horizontal and vertical direction.</li>
<li>if 1x is selected, hardware performs anti-flicker filtering.</li>
<li>If app wants to use preloaded coefficients, please set coeff = NULL.</li></ul>
<p><b>Usage: scale input image to 2x(horizontal) and 1.5x(vertical) with app's own coefficients</b>
&lt;syntaxhighlight lang='c'&gt;
struct ti81xxfb_scparams  scprms;
struct ti81xxfb_coeff    coeff;
struct ti81xxfb_region_params regp;
</p><p>scprms.inwidth = x;
scprms.inheight = y;
scprms.outwidth = 2*x;
scprms.outheight = 1.5*y,
scprms.coeff = &amp;coeff;
</p><p>if (ioctl(fd, TIFB_SET_SCINFO, &amp;scprms) &lt; 0) {
</p>
<pre>perror("TIFB_SET_SCINFO.\n");
close(fd);
exit(1);
</pre>
<p>}
</p><p>if (ioctl(fd, TIFB_GET_PARAMS, &amp;regp) &lt; 0) {
</p>
<pre>perror("TIFB_GET_PARAMS\n");
close(fd);
exit(1);
</pre>
<p>}
</p><p>regp.scalaren = TI81XXFB_FEATURE_ENABLE;
if (ioctl(fd, TIFB_SET_PARAMS, &amp;regp)&lt; 0) {
</p>
<pre>perror("TIFB_SET_PARAMS\n");
close(fd);
exit(1);
</pre>
<p>}
</p><p>&lt;/syntaxhighlight&gt;
</p><p><b>Usage: scale input image to 2x(horizontal) and 1.5x(vertical) with preloaded coefficients</b>
&lt;syntaxhighlight lang='c'&gt;
struct ti81xxfb_scparams  scprms;
struct ti81xxfb_region_params regp;
</p><p>scprms.inwidth = x;
scprms.inheight = y;
scprms.outwidth = 2 * x;
scprms.outheight = 1.5 * y,
scprms.coeff = NULL;
</p><p>if (ioctl(fd, TIFB_SET_SCINFO, &amp;scprms) &lt; 0) {
</p>
<pre>perror("TIFB_SET_SCINFO.\n");
close(fd);
exit(1);
</pre>
<p>}
if (ioctl(fd, TIFB_GET_PARAMS, &amp;regp) &lt; 0) {
</p>
<pre>perror("TIFB_GET_PARAMS\n");
close(fd);
exit(1);
</pre>
<p>}
</p><p>regp.scalaren = TI81XXFB_FEATURE_ENABLE;
if (ioctl(fd, TIFB_SET_PARAMS, &amp;regp)&lt; 0) {
</p>
<pre>perror("TIFB_SET_PARAMS\n");
close(fd);
exit(1);
</pre>
<p>}
</p><p><br />
&lt;/syntaxhighlight&gt;
</p><p><b>Usage: Anti-Flicker Implementation</b>
</p><p>&lt;syntaxhighlight lang='c'&gt;
struct ti81xxfb_scparams  scprms;
struct ti81xxfb_region_params regp;
</p><p>scprms.inwidth = x;
scprms.inheight = y;
scprms.outwidth = x;
scprms.outheight = y,
scprms.coeff = NULL;
</p><p>if (ioctl(fd, TIFB_SET_SCINFO, &amp;scprms) &lt; 0) {
</p>
<pre>perror("TIFB_SET_SCINFO.\n");
close(fd);
exit(1);
</pre>
<p>}
</p><p>if (ioctl(fd, TIFB_GET_PARAMS, &amp;regp) &lt; 0) {
</p>
<pre>perror("TIFB_GET_PARAMS\n");
close(fd);
exit(1);
</pre>
<p>}
</p><p>regp.scalaren = TI81XXFB_FEATURE_ENABLE;
if (ioctl(fd, TIFB_SET_PARAMS, &amp;regp)&lt; 0) {
</p>
<pre>perror("TIFB_SET_PARAMS\n");
close(fd);
exit(1);
</pre>
<p>}
</p><p>&lt;/syntaxhighlight&gt;
</p><p><br />
<i><b>TIFB_GET_SCINFO</b></i>
<br /> Allow users to get current scalar ratio
</p><p><b>Data Structure:</b>
</p><p>&lt;syntaxhighlight lang='c'&gt;
struct ti81xxfb_scparams {
</p>
<pre>__u16                  inwidth;
__u16                  inheight;
__u16                  outwidth;
__u16                  outheight;
struct ti81xxfb_coeff  *coeff;
</pre>
<p>};
&lt;/syntaxhighlight&gt;
<b>NOTE:</b>
<br /> coeff is not used when called TIFB_GET_SCINFO ioctl.
</p><p><b>Usage:</b>
&lt;syntaxhighlight lang='c'&gt;
struct ti81xxfb_scparams  scprms;
if (ioctl(fd, TIFB_GET_SCINFO, &amp;scprms) {
</p>
<pre>perror("TIFB_GET_SCINFO.\n");
close(fd);
exit(1);
</pre>
<p>}
&lt;/syntaxhighlight&gt;
</p><p><br />
<i><b>TIFB_ALLOC</b></i>
<br />
This ioctl is used to allocate a memory from reserved pool and return the physical addres back to app. This memory can be used by the stenciling data buffer.
</p><p><b>USAGE: allocate a buffer</b>
&lt;syntaxhighlight lang='c'&gt;
unsigned long size;
unsigned long phy_addr;
unsigned long temp;
</p><p>size = 8*1024;
temp = size;
if(ioctl(fd, TIFB_ALLOC, &amp;size)) {
</p>
<pre>perror(“TIFB_ALLOC.\n");
close(fd);
exit(1);
</pre>
<p>}
phy_addr = size;
&lt;/syntaxhighlight&gt;
</p><p><br />
<i><b>TIFB_FREE</b></i>
<br />
This ioctl is to free a memory allocated by the TIFB_ALLOC.
</p><p><b>USAGE</b>
&lt;syntaxhighlight lang='c'&gt;
unsigned long phy_addr;
void virt_addr;
unsigned long size;
</p><p>munmap(virt_addr, stensize);
if (ioctl(fd,TIFB_FREE, &amp;phy_addr)) {
</p>
<pre>perror(" TIFB_FREE.\n");
close(fd);
exit(1);
</pre>
<p>}
&lt;/syntaxhighlight&gt;
<b>NOTE:</b>
<br /> If the memory is used by the stenciling, please disable stenciling feature before freeing it.
</p><p><br />
<i><b>TIFB_SET_STENC</b></i>
<br />
Allow user to config stenciling.
</p><p><b>Data Structure:</b>
&lt;syntaxhighlight lang='c'&gt;
struct ti81xxfb_stenciling_params {
</p>
<pre>__u32               pitch;
__u32               paddr;
</pre>
<p>};
&lt;/syntaxhighlight&gt;
<b>NOTE:</b>
<br /> pitch must be 16 byte alignment.
</p><p><b>USAGE: how to enable the stenciling feature</b>
&lt;syntaxhighlight lang='c'&gt;
struct ti81xxfb_stenciling_params stenprms;
struct fb_var_screeninfo var;
struct ti81xxfb_region_params regp;
unsigned long size;
unsigned long temp;
</p><p>if (ioctl(fd, FBIOGET_VSCREENINFO, &amp;var)) {
</p>
<pre>perror("FBIOGET_VSCREENINFO.\n");
close(fd);
exit(1);
</pre>
<p>}
</p><p>stenprms.pitch = var.xres &gt;&gt; 3;
if (stenprms.pitch &amp; 0xF)
</p>
<pre>   stenprms.pitch += 0xF - (stenprms.pitch &amp; 0xF);
</pre>
<p>size = stenprms.pitch * var.yres;
</p><p>temp = size;
if(ioctl(fd, TIFB_ALLOC, &amp;size)) {
</p>
<pre>perror("TIFB_ALLOC.\n");
close(fd);
exit(1);
</pre>
<p>}
</p><p>stenprms.paddr = size;
size = temp;
</p><p>virt_addr = (unsigned char *)mmap(0, size,
	(PROT_READ | PROT_WRITE),
	MAP_SHARED, fd, stenprms.paddr);
if ((int)stenbuf == -1) {
</p>
<pre>perror("sten MMAP failed.\n");
close(fd);
exit(1);
</pre>
<p>}
</p><p>if (ioctl(fd, TIFB_GET_PARAMS, &amp;regp) &lt; 0) {
</p>
<pre>perror("TIFB_GET_PARAMS\n");
close(fd);
exit(1);
</pre>
<p>}
</p><p>regp.stencilingen = TI81XXFB_FEATURE_ENABLE;
if (ioctl(fd, TIFB_SET_PARAMS, &amp;regp)&lt; 0) {
</p>
<pre>perror("TIFB_SET_PARAMS\n");
close(fd);
exit(1);
</pre>
<p>}
</p><p>&lt;/syntaxhighlight&gt;
</p><p><b>USAGE: how to disable the stenciling feature</b>
&lt;syntaxhighlight lang='c'&gt;
struct ti81xxfb_stenciling_params stenprms;
struct ti81xxfb_region_params regp;
unsigned long size;
</p><p>if (ioctl(fd, FBIOGET_VSCREENINFO, &amp;var)) {
</p>
<pre>perror("FBIOGET_VSCREENINFO.\n");
close(fd);
exit(1);
</pre>
<p>}
</p><p>stenprms.pitch = var.xres &gt;&gt; 3;
if (stenprms.pitch &amp; 0xF)
</p>
<pre>   stenprms.pitch += 0xF - (stenprms.pitch &amp; 0xF);
</pre>
<p>size = stenprms.pitch * var.yres;
</p><p><br />
if (ioctl(fd, TIFB_GET_PARAMS, &amp;regp) &lt; 0) {
</p>
<pre>perror("TIFB_GET_PARAMS\n");
close(fd);
exit(1);
</pre>
<p>}
</p><p>regp.stencilingen = TI81XXFB_FEATURE_DISABLE;
if (ioctl(fd, TIFB_SET_PARAMS, &amp;regp)&lt; 0) {
</p>
<pre>perror("TIFB_SET_PARAMS\n");
close(fd);
exit(1);
</pre>
<p>}
</p><p>munmap(virt_addr, size);
if (ioctl(fd,TIFB_FREE, &amp;stenprms.paddr)) {
</p>
<pre>perror(" Failed to free memory.\n");
close(fd);
exit(1);
</pre>
<p>}
</p><p><br />
&lt;/syntaxhighlight&gt;
</p><p><br />
</p>
<h3><span class="mw-headline" id="OMAPFB_Compatible_IOCTLS"><b> OMAPFB Compatible IOCTLS</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=50" title="Edit section: OMAPFB Compatible IOCTLS">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>TI81XX Fbdev driver also supports the following OMAPFB IOCTLs.
</p><p><br />
<i><b>OMAPFB_SETUP_MEM</b></i>
<br />
check OMAPFB userguide for the usage
</p><p><br />
<i><b>OMAPFB_QUERY_MEM</b></i>
<br />
check OMAPFB userguide for the usage
</p><p><br />
<i><b>OMAPFB_SETUP_PLANE</b></i>
<br />
<i><b>Data Structure:</b></i>
&lt;syntaxhighlight lang='c'&gt;
struct omapfb_plane_info {
	__u32 pos_x;
	__u32 pos_y;
	__u8  enabled;
	__u8  channel_out;
	__u8  mirror;
	__u8  reserved1;
	__u32 out_width;
	__u32 out_height;
	__u32 reserved2[12];
};
&lt;/syntaxhighlight&gt;
</p><p><i><b>Usage:</b></i>
<br />
Only pos_x/pos_y/enabled/out_width/out_height are valid for this ioctl. pos_x/pos_y change the display starting location. enabled bit enable/disable the corresponding graphcis port. out_width/out_height enable the scaling feature of the graphics ports. if both out_width/out_height are set to zero, driver treat is as non-scaling case.
</p><p><b>NOTE:</b>
<br />
application need make sure the pos_x/pos_y and out_width/out_height do not out of the current display frame boundary.
</p><p><br />
<i><b>OMAPFB_QUERY_PLANE</b></i>
<br />
</p><p><br />
<i><b>OMAPFB_GET_VRAM_INFO</b></i>
<br />
check OMAPFB userguide for the usage
<br />
</p>
<h3><span class="mw-headline" id="Data_Structures"><b>Data Structures</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=51" title="Edit section: Data Structures">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p><i><b>fb_var_screeninfo</b></i>
<br />
This structure is used to query and set the so-called variable screen information. This allows an application to query or change the display mode, including the color depth, resolution, timing etc.
</p><p><br />
<i><b>fb_fix_screeninfo</b></i>
<br />
This structure is used by applications to get the fixed properties of the display, e.g. the start address of the framebuffer memory, framebuffer length etc.
</p><p><br />
<i><b>fb_cmap</b></i>
<br />
This structure is used to get/set the color-map for the framebuffer.
</p><p><br />
</p>
<h2><span class="mw-headline" id="V4L2_Driver_Interface"><b>V4L2 Driver Interface</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=52" title="Edit section: V4L2 Driver Interface">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h3><span class="mw-headline" id="Application_Interface_2"><b>Application Interface</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=53" title="Edit section: Application Interface">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p><b>open()</b>
<br />
To open a video device
</p><p><br />
<b>close()</b>
<br />
To close a video device
</p><p><br />
<b>ioctl()</b>
<br />
To send ioctl commands to the display driver.
</p><p><br />
<b>mmap()</b>
<br />
To memory map a driver allocated buffer to user space
</p><p><br />
</p>
<h3><span class="mw-headline" id="Supported_Standard_IOCTLs_2"><b>Supported Standard IOCTLs</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=54" title="Edit section: Supported Standard IOCTLs">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>This section describes the standard V4L2 IOCTLs supported by the Display Driver.
<br />
<b>NOTE:</b> Standard IOCTLs that are not listed here are not supported. The Display Driver handles the unsupported ones by returning EINVALerror code.
</p><p><br />
<i><b>VIDIOC_QUERYCAP</b></i>
<br />
This is used to query the driver's capability. The video driver fills a v4l2_capability struct indicating the driver is capable of output and streaming.
</p><p><br />
<i><b>VIDIOC_ENUM_FMT</b></i>
<br />
This is used to enumerate the image formats that are supported by the driver. The driver fills a v4l2_fmtdesc struct.
</p><p><br />
<i><b>VIDIOC_G_FMT</b></i>
<br />
This is used to get the current image format or display window depending on the buffer type. The driver fills the information to a <i>v4l2_format</i> struct.
</p><p><br />
<i><b>VIDIOC_TRY_FMT</b></i>
<br />
This is used to validate a new image format or a new display window depending on the buffer type. The driver may change the passed values if they are not supported. Application should check what is granted.
</p><p><br />
<i><b>VIDIOC_S_FMT</b></i>
<br />
This is used to set a new image format or a new display window depending on the buffer type. The driver may change the passed values if they are not supported. Application should check what is granted if <i>VIDIOC_TRY_FMT</i> is not used first.
</p><p><br />
<i><b>VIDIOC_CROPCAP</b></i>
<br />
This is used to get the default cropping rectangle based on the current image size and the current display panel size. The driver fills a <i>v4l2_cropcap</i> struct.
</p><p><br />
<i><b>VIDIOC_G_CROP</b></i>
<br />
This is used to get the current cropping rectangle. The driver fills a <i>v4l2_crop</i> struct.
</p><p><br />
<i><b>VIDIOC_S_CROP</b></i>
<br />
This is used to set a new cropping rectangle. The driver fills a <i>v4l2_crop</i> struct. Application should check what is granted.
</p><p><br />
<i><b>VIDIOC_REQBUFS</b></i>
<br />
This is used to request a number of buffers that can later be memory mapped. The driver fills a <i>v4l2_request</i> buffers struct. Application should check how many buffers are granted.
</p><p><br />
<i><b>VIDIOC_QUERYBUF</b></i>
<br />
This is used to get a buffer's information so mmap can be called for that buffer. The driver fills a <i>v4l2_buffer</i> struct.
</p><p><br />
<i><b>VIDIOC_QBUF</b></i>
<br />
This is used to queue a buffer by passing a <i>v4l2_buffer</i> struct associated to that buffer.
</p><p><br />
<i><b>VIDIOC_DQBUF</b></i>
<br />
This is used to dequeue a buffer by passing a <i>v4l2_buffer</i> struct associated to that buffer.
</p><p><br />
<i><b>VIDIOC_STREAMON</b></i>
<br />
This is used to turn on streaming. After that, any <i>VIDIOC_QBUF</i> results in an image being rendered.
</p><p><br />
<i><b>VIDIOC_S_CTRL, VIDIOC_G_CTRL, VIDIOC_QUERYCTRL</b></i>
<br />
These ioctls are used to set/get and query various V4L2 controls like rotation, mirror and background color. Currently only rotation is supported.
</p><p><br />
<i><b>VIDIOC_STREAMOFF</b></i>
<br />
This is used to turn off streaming.
</p><p><br />
</p>
<h2><span class="mw-headline" id="SYSFS_Software_Interfaces"><b>SYSFS Software Interfaces</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=55" title="Edit section: SYSFS Software Interfaces">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>User can control all dynamic configuration of VPSS, Fbdev and V4L2 Display functionality thorugh SYSFS interface.
</p>
<h3><span class="mw-headline" id="Frame-buffer_Driver_sysfs_attributes"><b>Frame-buffer Driver sysfs attributes</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=56" title="Edit section: Frame-buffer Driver sysfs attributes">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Following attributes are available for user control.
</p>
<pre>#
# ls -1 /sys/class/graphics/fb0/
bits_per_pixel
blank
console
cursor
dev
device
mode
modes
name
rotate
pan
phys_addr
rotate
size
state
stride
subsystem
uevent
virt_addr
virtual_size
#
</pre>
<p><br />
</p>
<table border="1" cellspacing="0" cellpadding="5" width="40%">
<caption><b>Frame-buffer Driver sysfs attributes</b>
</caption>
<tbody><tr>
<th align="left">Acronym
</th>
<th align="left">Definition
</th></tr>
<tr>
<td>bits_per_pixel
</td>
<td>Allows user to control bits per pixel configuration, currently the supported values are 1, 2, 4, 8, 16, 24 and 32.
<pre># echo 1/2/4/8/16/24/32 &gt; /sys/class/graphics/fb0/ bits_per_pixel
</pre>
</td></tr>
<tr>
<td>blank
</td>
<td>Allows user to control lcd display blanking configuration independently.
<pre># echo 0/1  &gt; /sys/class/graphics/fb0/blank

Values only 0(FB_BLANK_UNBLANK) and 4(FB_BLANK_NORMAL) is supported
</pre>
</td></tr>
<tr>
<td>virtual_size
</td>
<td>Allows user to configure xres_virtual and yres_virtual parameters of frame-buffer,
<pre># cat /sys/class/graphics/fb0/virtual_size
480,640
</pre>
</td></tr>
<tr>
<td>virt_addr
</td>
<td>Readonly entry, displays virtual address of the frame-buffer memory.
</td></tr>
<tr>
<td>phys_addr
</td>
<td>Readonly entry, displays physical address of the frame-buffer memory.
</td></tr></tbody></table>
<h3><span class="mw-headline" id="VPSS_Library_sysfs_attributes"><b>VPSS Library sysfs attributes</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=57" title="Edit section: VPSS Library sysfs attributes">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>VPSS library provides/exports following attributes, which explained in detail below -
</p>
<pre>#
# ls -1 /sys/devices/platform/vpss/
display0
display1
display2
graphics0
graphics1
graphics2
modalias
subsystem
system
uevent
video0
video1
video2
#
</pre>
<p><br />
</p>
<h4><span class="mw-headline" id="VPSS_Library:_system"><b>VPSS Library: system </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=58" title="Edit section: VPSS Library: system">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Config Display Controller
</p>
<pre>#
# ls -1 /sys/devices/platform/vpss/system/
automode
pllclks
tiedvencs
#
</pre>
<table border="1" cellspacing="0" cellpadding="5" width="40%">
<caption><b>VPSS Library-system: sysfs attributes</b>
</caption>
<tbody><tr>
<th align="left">Acronym
</th>
<th align="left">Definition
</th></tr>
<tr>
<td>automode
</td>
<td>allow the vpss driver set the video PLL clock automatically based on the VENC mode
<pre>echo 0/1 &gt; /sys/devices/platform/vpss/system/automode
</pre>
</td></tr>
<tr>
<td>pllclks
</td>
<td>change the clocks for three video PLLs. automode need be turned off before using this.
<pre>echo rfclk:54000,dclk:XKHz&gt; /sys/devices/platform/vpss/system/pllclks
rfclk only support 54000KHz Clock.
</pre>
</td></tr>
<tr>
<td>tiedvencs
</td>
<td>tie multiple vencs together: hdmi id = 1, dvo2 id = 4, sdid = 8
<pre># echo XX &gt; /sys/devices/platform/vpss/system/tiedvencs
</pre>
<p>where XX: OR value of the venc id.
</p>
</td></tr></tbody></table>
<p><b>NOTE:</b>
</p>
<ul><li>By Default, VPSS driver automatically configures the PLL clock based on the display mode setuped by the application for individual VENC without considering the PLL clock is shared or not with other VENC. So it is application's responsiblity to make sure that PLL clock and clock source of VENC are coupled well to supported the desired display mode.</li></ul>
<p><br />
</p>
<h4><span class="mw-headline" id="VPSS_Library:_display"><b> VPSS Library: display</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=59" title="Edit section: VPSS Library: display">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<table border="1" cellspacing="0" cellpadding="5" width="40%">
<caption><b>display Output </b>
</caption>
<tbody><tr>
<th align="left">Arguments
</th>
<th align="left">Definition
</th></tr>
<tr>
<td>single
</td>
<td>An 10-bit wide, single channel CCIR656 video stream
</td></tr>
<tr>
<td>double
</td>
<td>Two 10-bit wide video streams in CCIR656 format. The video data is YUV422 format
</td></tr>
<tr>
<td>triple
</td>
<td>Three channel 10-bit video streams with embedded sync SAV/EAV. The video format can be YCbCr 444 or RGB
</td></tr>
<tr>
<td>doublediscrete
</td>
<td>Two channel 10-bit video streams with dedicated HS/VS/FID/ACTVID sync signals.
<p>The video data format is YUV 422. The first channel is Y; and CbCr are multiplexed on the second channel
</p>
</td></tr>
<tr>
<td>triplediscrete
</td>
<td>Three channel 10-bit video streams with dedicated HS/VS/FID/ACTVID sync signals. The three channel component digital video can be RGB or YUV 444 format
</td></tr></tbody></table>
<p><br />
</p>
<h5><span class="mw-headline" id="VPSS_Library:_display0"><b>VPSS Library: display0</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=60" title="Edit section: VPSS Library: display0">edit</a><span class="mw-editsection-bracket">]</span></span></h5>
<p>Configure the HDMI VENC, which is connected to the On-chip HDMI module.
</p>
<pre>#
# ls -1 /sys/devices/platform/vpss/display0/
clksrc
enabled
mode
order
output
timing
#
</pre>
<table border="1" cellspacing="0" cellpadding="5" width="40%">
<caption><b>VPSS Library-display0: sysfs attributes</b>
</caption>
<tbody><tr>
<th align="left">Acronym
</th>
<th align="left">Definition
</th></tr>
<tr>
<td>clksrc
</td>
<td>Set the right clock source for the VENC
<pre>echo dclk/dclkdiv2/dclkdiff &gt; /sys/devices/platform/vpss/display0/clksrc
</pre>
</td></tr>
<tr>
<td>enabled
</td>
<td>Enable/Disable the VENC.
<pre># echo 0/1 &gt; /sys/devices/platform/vpss/display0/enabled
</pre>
</td></tr>
<tr>
<td>mode
</td>
<td>Set the right VENC mode:1080p-60/1080p-30/1080i-60/1080p-30/720p-60 are supported (default 1080p-60).
<pre># echo 1080p-60/1080p-30/1080i-60/1080p-30/720p-60 &gt; /sys/devices/platform/vpss/display0/mode
</pre>
<p>if automode is on, driver will set the PLL accordingly based on the mode, otherwise it is application's responsibility to set the right PLL clock before changing mode.
</p>
</td></tr>
<tr>
<td>order
</td>
<td>reshuffle display order
<pre>echo A,B/C/D/E &gt; /sys/devices/platform/vpss/display0/order
A: enable(1)/disable(0) global reorder. if 0 is set, then only B value is required, C,D and E should not be used.
B: 0-3: display order of video(0:lowest, 3:highest)
C: 0-3: display order of graphics0
D: 0-3: display order of graphics1
E: 0-3: display order of graphics2
</pre>
</td></tr>
<tr>
<td>output
</td>
<td>Set the right VENC output
<pre>echo single/double/doublediscrete/triple/triplediscrete, rgb888/yuv444p/yuv422spuv &gt; /sys/devices/platform/vpss/display0/output
</pre>
<p>the first part is the sync mode, the second part is output data format.
</p>
</td></tr>
<tr>
<td>timings
</td>
<td>Display timing configuration.
<pre>echo 148500,1920/88/148/44,1080/4/36/5,1 &gt; /sys/devices/platform/vpss/display0/timings
where:
148500: display pixel clock(KHz)
1920: display width
88: horizontal front porch
148: horizontal back porch
44: horizontal sync width
1080: display height
4: vertical front porch
36: vertical back porch
5: vertical sync width
1: progressive output
</pre>
</td></tr></tbody></table>
<h5><span class="mw-headline" id="VPSS_Library:_display1"><b>VPSS Library: display1</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=61" title="Edit section: VPSS Library: display1">edit</a><span class="mw-editsection-bracket">]</span></span></h5>
<p>Configure DVO2 VENC, which is connceted to the external display device,such as LCD panel, HDMI transmitter, etc. This document does not cover any such information.
</p>
<pre>#
# ls -1 /sys/devices/platform/vpss/display1/
clksrc
enabled
mode
order
output
timings
#
</pre>
<table border="1" cellspacing="0" cellpadding="5" width="40%">
<caption><b>VPSS Library-display1: sysfs attributes</b>
</caption>
<tbody><tr>
<th align="left">Acronym
</th>
<th align="left">Definition
</th></tr>
<tr>
<td>clksrc
</td>
<td>Set the right clock source for the VENC
<pre>echo aclk/aclkdiv2/aclkdiff &gt; /sys/devices/platform/vpss/display1/clksrc
</pre>
</td></tr>
<tr>
<td>enabled
</td>
<td>Enable/Disable the VENC.
<pre># echo 0/1 &gt; /sys/devices/platform/vpss/display1/enabled
</pre>
</td></tr>
<tr>
<td>mode
</td>
<td>Set the right VENC mode:1080p-60/1080p-30/1080i-60/720p-60 are supported(default 1080p-60).
<pre># echo 1080p-60/1080p-30/1080i-60/720p-60 &gt; /sys/devices/platform/vpss/display1/mode
</pre>
<p>if automode is on, driver will set the PLL accordingly based on the mode, otherwise it is application's responsibility to set the right PLL clock before changing mode.
</p>
</td></tr>
<tr>
<td>order
</td>
<td>reshuffle display order
<pre>echo A,B/C/D/E &gt; /sys/devices/platform/vpss/display1/order
A: enable(1)/disable(0) global reorder. If 0 is set, then only B value is required, C,D and E should not be used.
B: 0-3: display order of video(0:lowest, 3:highest)
C: 0-3: display order of graphics0
D: 0-3: display order of graphics1
E: 0-3: display order of graphics2
</pre>
</td></tr>
<tr>
<td>output
</td>
<td>Set the right VENC output
<pre>echo single/double/doublediscrete/triple/triplediscrete, rgb888/yuv444p/yuv422spuv &gt; /sys/devices/platform/vpss/display1/output
</pre>
<p>the first part is the sync mode, the second part is output data format.
</p>
</td></tr>
<tr>
<td>timings
</td>
<td>Display timing configuration.
<pre>echo 148500,1920/88/148/44,1080/4/36/5,1 &gt; /sys/devices/platform/vpss/display1/timings
where:
148500: display pixel clock(KHz)
1920: display width
88: horizontal front porch
148: horizontal back porch
44: horizontal sync width
1080: display height
4: vertical front porch
36: vertical back porch
5: vertical sync width
1: progressive output
</pre>
</td></tr></tbody></table>
<h5><span class="mw-headline" id="VPSS_Library:_display2"><b>VPSS Library: display2</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=62" title="Edit section: VPSS Library: display2">edit</a><span class="mw-editsection-bracket">]</span></span></h5>
<p>Configure the SD VENC(SVIDEO output)
</p>
<pre>#
# ls -1 /sys/devices/platform/vpss/display2/
clksrc
enabled
mode
order
output
timing
#
</pre>
<table border="1" cellspacing="0" cellpadding="5" width="40%">
<caption><b>VPSS Library-display2: sysfs attributes</b>
</caption>
<tbody><tr>
<th align="left">Acronym
</th>
<th align="left">Definition
</th></tr>
<tr>
<td>clksrc
</td>
<td>not supported
</td></tr>
<tr>
<td>enabled
</td>
<td>Enable/Disable the VENC.
<pre># echo 0/1 &gt; /sys/devices/platform/vpss/display2/enabled
</pre>
</td></tr>
<tr>
<td>mode
</td>
<td>Set the right VENC mode:ntsc/pal are supported (default ntsc).
<pre># echo ntsc/pal &gt; /sys/devices/platform/vpss/display2/mode
</pre>
</td></tr>
<tr>
<td>order
</td>
<td>reshuffle display order
<pre>echo A,B/C/D/E &gt; /sys/devices/platform/vpss/display2/order
A: enable(1)/disable(0) global reorder. If 0 is set, then only B value is required, C,D and E should not be used.
B: 0-3: display order of video(0:lowest, 3:highest)
C: 0-3: display order of graphics0
D: 0-3: display order of graphics1
E: 0-3: display order of graphics2
</pre>
</td></tr>
<tr>
<td>output
</td>
<td>set the output for SDVENC
<pre>echo composite/svideo &gt; /sys/devices/platform/vpss/display2/output
</pre>
</td></tr>
<tr>
<td>timings
</td>
<td>Display timing configuration. (Not Supported)
</td></tr></tbody></table>
<h4><span id="VPSS_Library:_graphics0/1/2"></span><span class="mw-headline" id="VPSS_Library:_graphics0.2F1.2F2"><b>VPSS Library: graphics0/1/2</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=63" title="Edit section: VPSS Library: graphics0/1/2">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>In all total 3 graphics pipelines are supported on hardware,
</p>
<pre>#
# ls -1 /sys/devices/platform/vpss/graphics0/
enabled
nodes
#
</pre>
<table border="1" cellspacing="0" cellpadding="5" width="40%">
<caption><b>VPSS Library-graphics0/1/2: sysfs attributes</b>
</caption>
<tbody><tr>
<th align="left">Acronym
</th>
<th align="left">Definition
</th></tr>
<tr>
<td>enabled
</td>
<td>User can enable/disable overlay through this entry.
<pre># echo 0/1 &gt; /sys/devices/platform/vpss/graphics0/enabled
</pre>
</td></tr>
<tr>
<td>nodes
</td>
<td>User can configure which vencs(hdmi/dvo2/sd) this graphics pipeline connected to.
<pre>One graphics pipeline can be connected to multiple video compositor as long
as those VENCs associated with video compositor are in the same timing.
</pre>
<pre># echo XX:outputs &gt; /sys/devices/platform/vpss/graphics0/nodes
</pre>
<p>where XX: 1-4 number of vencs connected, outputs: see below table.
</p>
</td></tr></tbody></table>
<table border="1" cellspacing="0" cellpadding="5" width="40%">
<caption><b>Graphics Notes input/output table</b>
</caption>
<tbody><tr>
<th align="center"><b>device</b><br />
</th>
<th align="center"><b>output</b><br />
</th></tr>
<tr>
<td>fb0
</td>
<td>hdmi(display0) <br /> dvo2(display1) br&gt; sd(display2)
</td></tr>
<tr>
<td>fb1
</td>
<td>hdmi(display0) <br /> dvo2(display1) <br /> sd(display2)
</td></tr>
<tr>
<td>fb2
</td>
<td>hdmi(display0) <br /> dvo2(display1  <br /> sd(display2)
</td></tr></tbody></table>
<h4><span id="VPSS_Library:_Video0/1/2"></span><span class="mw-headline" id="VPSS_Library:_Video0.2F1.2F2"><b>VPSS Library: Video0/1/2</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=64" title="Edit section: VPSS Library: Video0/1/2">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>In all total 3 video pipelines are supported on hardware,
</p>
<pre>#
# ls -1 /sys/devices/platform/vpss/video0/
alpha_blending_enabled
default_color
enabled
global_alpha
nodes
trans_key_enabled
trans_key_type
trans_key_value
#
</pre>
<table border="1" cellspacing="0" cellpadding="5" width="40%">
<caption><b>VPSS Library-video0/1/2: sysfs attributes</b>
</caption>
<tbody><tr>
<th align="left">Acronym
</th>
<th align="left">Definition
</th></tr>
<tr>
<td>alpha_blending_enabled
</td>
<td>User can enable/disable alpha blending for the video pipeline. Not available for video2.
<pre>echo 0/1 &gt; /sys/devices/platform/vpss/video0/alpha_blending_enabled
     where 0/1: 0 -&gt; disable, 1 -&gt; enable
</pre>
</td></tr>
<tr>
<td>default_color
</td>
<td>Not available
</td></tr>
<tr>
<td>enabled
</td>
<td>Not available
</td></tr>
<tr>
<td>global_alpha
</td>
<td>User can set the global alpha blending value for the video pipeline. Not available for video2.
<pre>echo 0-255 &gt; /sys/devices/platform/vpss/video0/global_alpha
</pre>
</td></tr>
<tr>
<td>nodes
</td>
<td>User can configure how many vencs(hdmi/hdcomp/dvo2/sd) this video pipeline connected to.
<pre>One video pipeline can be connected to multiple video VENCs as long
as those VENCs associated with video compositor are in the same timing.
</pre>
<pre># echo input:output1,output2,output3 &gt; /sys/devices/platform/vpss/video0/nodes
</pre>
<p>see below table for details
</p>
</td></tr>
<tr>
<td>trans_key_enabled
</td>
<td>User can enable/disable transparency keying for the video pipeline. Not available for video2.
<pre>echo 0/1 &gt; /sys/devices/platform/vpss/video0/trans_key_enabled
     where 0/1: 0 -&gt; disable, 1 -&gt; enable
</pre>
</td></tr>
<tr>
<td>trans_key_type
</td>
<td>User can set transparency keying mask type for the video pipeline. Not available for video2.
<pre>echo 0/1/2/3 &gt; /sys/devices/platform/vpss/video0/trans_key_enabled
     where 0/1/2/3 defines how many LSB bit to be masking when performing keying
</pre>
</td></tr>
<tr>
<td>trans_key_value
</td>
<td>User can set transparency keying value(RGB888, hex value only) for the video pipeline. Not available for video2.
<pre>echo 0xRRGGBB &gt; /sys/devices/platform/vpss/video0/trans_key_value
     where 0xRRGGBB: R in the upper byte, B in the lower byte.
</pre>
</td></tr></tbody></table>
<table border="1" cellspacing="0" cellpadding="5" width="40%">
<caption><b>Video Notes input/output table</b>
</caption>
<tbody><tr>
<th align="center" rowspan="2"><b>device</b><br />
</th>
<th align="center" colspan="3"><b>input</b><br />
</th></tr>
<tr>
<td><b>vcompmux</b>
</td>
<td><b>hdcompmux</b>
</td>
<td><b>sdmux</b>
</td></tr>
<tr>
<td>video0 (/dev/video1)
</td>
<td>hdmi(display0) <br /> dvo2(display1)<br /> sd(display3)<br />
</td>
<td>hdmi(display0) <br /> dvo2(display1)<br /> sd(display3)<br />
</td>
<td>sd(display2)
</td></tr>
<tr>
<td>video1(/dev/video2)
</td>
<td>hdmi(display0) <br /> dvo2(display1)<br /> sd(display3)<br />
</td>
<td>hdmi(display0) <br /> dvo2(display1)<br /> sd(display3)<br />
</td>
<td>sd(display2)
</td></tr>
<tr>
<td>video2(/dev/video3)
</td>
<td>N/A
</td>
<td>N/A
</td>
<td>sd(display2)
</td></tr></tbody></table>
<h2><span class="mw-headline" id="Miscellaneous_Configurations"><b>Miscellaneous Configurations</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=65" title="Edit section: Miscellaneous Configurations">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The default setup/configuration is -
</p><p><br />
</p>
<pre>fb0  -- =&gt; graphics0 - - =&gt; hdmi_venc(display0) -&gt; On_Chip_HDMI output

fb1  -- =&gt; graphics1 - - =&gt; dvo2_venc(display1) -&gt; LCD pannel or external display device

fb2  -- =&gt; graphics2 - - =&gt; sdvenc(display2) -&gt; SVIDEO output
</pre>
<p><br />
</p>
<pre>/dev/video1  -- =&gt; video0 -- =&gt; vcompmux  -- =&gt; hdmi_venc(display0)-&gt; on_Chip_Hdmi output

/dev/video2  -- =&gt; video1 -- =&gt; hdcompmux -- =&gt; dvo2_venc(display1)-&gt; LCD Pannel or external dispaly device

/dev/video3  -- =&gt; video2 -- =&gt;   sdmux   -- =&gt; sd_venc(display2)-&gt; SVIDEO output
</pre>
<p><br />
</p><p>User can control/configure the various graphics/video pipeline to different video compositor(VENCs). This section demonstrate/explains the switching of output using above interfaces.
</p><p><br />
<b>NOTE:</b>
<br />
The connections between fb nodes and graphics pipelines are fixed and not able to change.
<br />
The connections between /dev/video nodes and video pipelines are fixed and not able to change.
</p>
<h3><span id="Switching_fb0(graphics0)_output_from_HDMI_VEVC(display0)_to_DVO2_VENC(display1)"></span><span class="mw-headline" id="Switching_fb0.28graphics0.29_output_from_HDMI_VEVC.28display0.29_to_DVO2_VENC.28display1.29"><b>Switching fb0(graphics0) output from HDMI VEVC(display0) to DVO2 VENC(display1)</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=66" title="Edit section: Switching fb0(graphics0) output from HDMI VEVC(display0) to DVO2 VENC(display1)">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Follow the steps below to switch graphics0(fb0)output from HDMI to DVO2 VENC
</p>
<ul><li>Disable graphics 0</li></ul>
<pre>#echo 0 &gt; /sys/devices/platform/vpss/graphics0/enabled
</pre>
<ul><li>Switch output VENC</li></ul>
<pre># echo 1:dvo2 &gt; /sys/devices/platform/vpss/graphics0/nodes
</pre>
<ul><li>Enable graphics 0</li></ul>
<pre>#echo 1 &gt; /sys/devices/platform/vpss/graphics0/enabled
</pre>
<p><b>NOTE:</b>
<br />
Similar steps must be followed for switching other graphcis piple line to different VENC.
<br />
</p>
<h3><span id="Switching_/dev/video1(video0)_from_vcompmux_-_HDMI_VEVC(display0)_to_vcompmux_-_DVO2_VENC(display1)"></span><span class="mw-headline" id="Switching_.2Fdev.2Fvideo1.28video0.29_from_vcompmux_-_HDMI_VEVC.28display0.29_to_vcompmux_-_DVO2_VENC.28display1.29"><b>Switching /dev/video1(video0) from vcompmux - HDMI VEVC(display0) to vcompmux - DVO2 VENC(display1)</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=67" title="Edit section: Switching /dev/video1(video0) from vcompmux - HDMI VEVC(display0) to vcompmux - DVO2 VENC(display1)">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<pre># echo vcompmux:dvo2 &gt; /sys/devices/platform/vpss/video0/nodes
</pre>
<ul><li><b>NOTE:</b></li></ul>
<p>Application should make sure /dev/video1 device node is closed when performing the above step
<br />
Similar steps must be followed for switching other video pipeline to different input/output configurations.
</p>
<h3><span id="Switching_/dev/video1(video0)_from_vcompmux_-_HDMI_VEVC(display0)_to_hdcompmux_-_DVO2_VENC(display1)"></span><span class="mw-headline" id="Switching_.2Fdev.2Fvideo1.28video0.29_from_vcompmux_-_HDMI_VEVC.28display0.29_to_hdcompmux_-_DVO2_VENC.28display1.29"><b>Switching /dev/video1(video0) from vcompmux - HDMI VEVC(display0) to hdcompmux - DVO2 VENC(display1)</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=68" title="Edit section: Switching /dev/video1(video0) from vcompmux - HDMI VEVC(display0) to hdcompmux - DVO2 VENC(display1)">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<pre># echo hdcompmux:dvo2 &gt; /sys/devices/platform/vpss/video0/nodes
</pre>
<ul><li><b>NOTE:</b></li></ul>
<p>Application should make sure /dev/video1 device node is closed when performing the above step
<br />
Similar steps must be followed for switching other video pipeline to different input/output configurations.
</p>
<h3><span id="Cloning_fb0(graphics0)_output_to_both_HDMI_VENC(display0)_and_DVO2_VENC(display1)"></span><span class="mw-headline" id="Cloning_fb0.28graphics0.29_output_to_both_HDMI_VENC.28display0.29_and_DVO2_VENC.28display1.29"><b>Cloning fb0(graphics0) output to both HDMI VENC(display0) and DVO2 VENC(display1)</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=69" title="Edit section: Cloning fb0(graphics0) output to both HDMI VENC(display0) and DVO2 VENC(display1)">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Follow below steps to clone GFX overlay output to both HDMI and DVO2 VENC.
</p><p><b>NOTE:</b>
<br />
Appliation should make sure that both VENC has the same timing.
<br />
If one graphics plane is connected to multiple vencs, those vencs must tied.
</p>
<ul><li>Disable graphics0 pipeline</li></ul>
<pre>#echo 0 &gt; /sys/devices/platform/vpss/graphics0/enabled
</pre>
<ul><li>Disable hdmi VENC</li></ul>
<pre>#echo 0 &gt; /sys/devices/platform/vpss/display0/enabled
</pre>
<ul><li>Disable dvo2 venc</li></ul>
<pre>#echo 0 &gt; /sys/devices/platform/vpss/display1/enabled
</pre>
<ul><li>Tited the VENCs</li></ul>
<pre># echo 5 &gt; /sys/devices/platform/vpss/system/tiedvenc
</pre>
<ul><li>Switch the both HDMI and DVO2 VENCs</li></ul>
<pre># echo 2:hdmi,dvo2 &gt; /sys/devices/platform/vpss/graphics0/nodes
</pre>
<ul><li>Enable graphics 0 pipeline</li></ul>
<pre>#echo 0 &gt; /sys/devices/platform/vpss/graphics0/enabled
</pre>
<p><b>NOTE:</b>
<br />
The similar stpes must be following when cloning other graphics pipeline to multiple VENCs
</p><p><br />
</p>
<h3><span id="Cloning_/dev/video1(video0)_output_to_both_vcompmux-HDMI_VENC(display0)_and_vcompmux-DVO2_VENC(display1)"></span><span class="mw-headline" id="Cloning_.2Fdev.2Fvideo1.28video0.29_output_to_both_vcompmux-HDMI_VENC.28display0.29_and_vcompmux-DVO2_VENC.28display1.29"><b>Cloning /dev/video1(video0) output to both vcompmux-HDMI VENC(display0) and vcompmux-DVO2 VENC(display1)</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=70" title="Edit section: Cloning /dev/video1(video0) output to both vcompmux-HDMI VENC(display0) and vcompmux-DVO2 VENC(display1)">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Follow below steps to clone video0 output to both HDMI and DVO2 VENC through vcompmux.
</p><p><b>NOTE:</b>
<br />
Appliation should make sure that both VENC has the same timing.
<br />
If one video pipeline is connected to multiple vencs, those vencs must tied.
</p>
<ul><li>Disable hdmi VENC</li></ul>
<pre>#echo 0 &gt; /sys/devices/platform/vpss/display0/enabled
</pre>
<ul><li>Disable dvo2 venc</li></ul>
<pre>#echo 0 &gt; /sys/devices/platform/vpss/display1/enabled
</pre>
<ul><li>Tited the VENCs</li></ul>
<pre># echo 5 &gt; /sys/devices/platform/vpss/system/tiedvenc
</pre>
<ul><li>Switch the both HDMI and DVO2 VENCs</li></ul>
<pre># echo vcompmux:hdmi,dvo2 &gt; /sys/devices/platform/vpss/video0/nodes
</pre>
<p><b>NOTE:</b>
Application must make sure that /dev/video0 is closed when performing above steps.
<br />
The similar stpes must be following when cloning other video pipelines to multiple VENCs
</p>
<h3><span id="Change_the_mode_on_HDMI_VENC(display0)"></span><span class="mw-headline" id="Change_the_mode_on_HDMI_VENC.28display0.29"><b> Change the mode on HDMI VENC(display0)</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=71" title="Edit section: Change the mode on HDMI VENC(display0)">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Follow below steps to change the VENC mode on HDMI, assuming that Graphics0(fb0) is connected to HDMI
</p>
<ul><li>Disable graphics0 pipeline</li></ul>
<pre>#echo 0 &gt; /sys/devices/platform/vpss/graphics0/enabled
</pre>
<ul><li>Disable hdmi VENC</li></ul>
<pre>#echo 0 &gt; /sys/devices/platform/vpss/display0/enabled
</pre>
<ul><li>Set the new VENC mode</li></ul>
<pre>#echo 720p-60 &gt; /sys/devices/platform/vpss/display0/mode
</pre>
<ul><li>Enable hdmi VENC</li></ul>
<pre>#echo 1 &gt; /sys/devices/platform/vpss/display0/enabled
</pre>
<ul><li>Enable graphics0 pipeline</li></ul>
<pre>#echo 1 &gt; /sys/devices/platform/vpss/graphics0/enabled
</pre>
<p><b>NOTE:</b>
<br />
The similar stpes must be following when change mode of other VENCs.
<br />
application should disable all the pipeline connected to the HDMI venc before performing the above steps.
</p>
<h3><span id="Change_display_timing_on_DVO2_VENC(display1)"></span><span class="mw-headline" id="Change_display_timing_on_DVO2_VENC.28display1.29"><b> Change display timing on DVO2 VENC(display1)</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=72" title="Edit section: Change display timing on DVO2 VENC(display1)">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Follow below steps to change the display timing on DVO2 VENC
</p>
<ul><li>Disable DVO2 VENC</li></ul>
<pre>#echo 0 &gt; /sys/devices/platform/vpss/display1/enabled
</pre>
<ul><li>set new display timings</li></ul>
<pre>#echo 74250,1280/110/220/40,720/5/20/5,1/3 &gt; /sys/devices/platform/vpss/dvo2/timings
</pre>
<ul><li>Enable DVO2 VENC</li></ul>
<pre>#echo 1 &gt; /sys/devices/platform/vpss/display1/enabled
</pre>
<p><b>NOTE:</b>
<br />
The similar stpes must be following when change mode of other VENCs.
<br />
application should disable all the pipeline connected to the HDMI venc before performing the above steps.
</p>
<h3><span id="Reshuffle_display_order_on_HDMI_VENC(display0)"></span><span class="mw-headline" id="Reshuffle_display_order_on_HDMI_VENC.28display0.29"><b> Reshuffle display order on HDMI VENC(display0)</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=73" title="Edit section: Reshuffle display order on HDMI VENC(display0)">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Follow below steps to reshuffle the display order on HDMI VENC
</p>
<ul><li>set up new display order(graphics0 has higher displar order than graphics1 &amp; graphics2)</li></ul>
<pre>echo 1:0/3/1/1 &gt; /sys/devices/platform/vpss/display0/order
</pre>
<p><b>NOTE:</b>
<br />
The similar stpes must be followed when change order of other VENCs.
<br />
Reshuffling order is runing time parameter operation.
</p>
<h3><span id="Change_the_clock_source_on_HDMI_VENC(display0)"></span><span class="mw-headline" id="Change_the_clock_source_on_HDMI_VENC.28display0.29"><b> Change the clock source on HDMI VENC(display0)</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=74" title="Edit section: Change the clock source on HDMI VENC(display0)">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Follow below steps to change the clock source on HDMI VENC.
</p>
<ul><li>Disable hdmi VENC</li></ul>
<pre>#echo 0 &gt; /sys/devices/platform/vpss/display0/enabled
</pre>
<ul><li>Set the new clock source</li></ul>
<pre>#echo dclkdiff &gt; /sys/devices/platform/vpss/display0/clksrc
</pre>
<ul><li>Enable hdmi VENC</li></ul>
<pre>#echo 1 &gt; /sys/devices/platform/vpss/display0/enabled
</pre>
<p><b>NOTE:</b>
<br />
The similar stpes must be following when change mode of other VENCs.
<br />
application should disable all the pipeline connected to the HDMI venc before performing the above steps.
</p>
<h3><span id="Change_the_OUTPUT_of_HDMI_VENC(display0)"></span><span class="mw-headline" id="Change_the_OUTPUT_of_HDMI_VENC.28display0.29"><b> Change the OUTPUT of HDMI VENC(display0)</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=75" title="Edit section: Change the OUTPUT of HDMI VENC(display0)">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Follow below steps to change the OUTPUT of HDMI VENC.
</p>
<ul><li>Disable hdmi VENC</li></ul>
<pre>#echo 0 &gt; /sys/devices/platform/vpss/display0/enabled
</pre>
<ul><li>Set the new clock source</li></ul>
<pre>#echo double &gt; /sys/devices/platform/vpss/display0/output
</pre>
<ul><li>Enable hdmi VENC</li></ul>
<pre>#echo 1 &gt; /sys/devices/platform/vpss/display0/enabled
</pre>
<p><b>NOTE:</b>
<br />
The similar stpes must be following when change mode of other VENCs.
<br />
application should disable all the pipeline connected to the HDMI venc before performing the above steps.
</p>
<h3><span class="mw-headline" id="Change_Video_PLL_Clock"><b> Change Video PLL Clock </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=76" title="Edit section: Change Video PLL Clock">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Follow below steps to change the video pll clock for the vencs
</p><p><br />
</p>
<ul><li>Disable the auto mode</li></ul>
<pre>$ echo 0 &gt; /sys/devices/platform/vpss/system/automode
</pre>
<ul><li>Change the D clock to 148.5MHz</li></ul>
<pre>echo dclk:148.5 &gt; /sys/devices/platform/vpss/system/pllclks
</pre>
<p><b>Note:</b>
<br />
If automode is off, vpss driver does not change PLL clock accordingly when application tunes to different mode.
</p>
<h1><span class="mw-headline" id="Driver_Configuration"><b>Driver Configuration</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=77" title="Edit section: Driver Configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h2><span class="mw-headline" id="Framebuffer_driver"><b>Framebuffer driver</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=78" title="Edit section: Framebuffer driver">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<pre>$ make ARCH=arm CROSS_COMPILE=$(PATH_TO_TOOLCHAIN)/bin/arm-none-linux-gnueabi- menuconfig
</pre>
<ul><li>Select Device Drivers from the main menu.</li></ul>
<pre>...
    ...
    Kernel Features  ---&gt;
    Boot options  ---&gt;
    CPU Power Management  ---&gt;
    Floating point emulation  ---&gt;
    Userspace binary formats  ---&gt;
    Power management options  ---&gt;
[*] Networking support  ---&gt;
"   Device Drivers  ---&gt;"
    ...
    ...
</pre>
<p><br />
</p>
<ul><li>Select Graphics support from the menu.</li></ul>
<pre>    ...
    ...
    Sonics Silicon Backplane  ---&gt;
    Multifunction device drivers  ---&gt;
[*] Voltage and Current Regulator Support  ---&gt;
&lt;*&gt; Multimedia support  ---&gt;
"    Graphics support  ---&gt;"
&lt;*&gt; Sound card support  ---&gt;
[*] HID Devices  ---&gt;
[*] USB support  ---&gt;
    ...
    ...
</pre>
<p><br />
</p>
<ul><li>Select Support for frame buffer devices from the menu.</li></ul>
<pre>    ...
    ...
&lt;M&gt; Lowlevel video output switch controls
&lt;*&gt; Support for frame buffer devices  ---&gt;
&lt; &gt; E-Ink Broadsheet/Epson S1D13521 controller support
&lt;M&gt; TI81XX Viddeo Processing Subsystem support (EXPERIMENTAL)  ---&gt;
[ ] Backlight &amp; LCD device support  ---&gt;
    ...
    ...
</pre>
<p><br />
</p>
<ul><li>Select TI81XX Viddeo Processing Subsystem support (EXPERIMENTAL) from the same menu.</li></ul>
<pre>    ...
    ...
&lt;*&gt; Support for frame buffer devices  ---&gt;
(50)   VRAM size (MB)
[*]   Debug support
&lt;M&gt; TI81XX frame buffer support (EXPERIMENTAL)  ---&gt;
</pre>
<p><br />
</p>
<ul><li>Configure default VRAM size to the required/expected size of buffer, the default is 50MB.</li></ul>
<pre>    ...
    ...
--- Select TI81XX Viddeo Processing Subsystem support (EXPERIMENTAL)
"(50)   VRAM size (MB)"
[*]   Debug support
    ...
    ...
</pre>
<p><br />
</p>
<ul><li>Enable/Disable Debug function of VPSS</li></ul>
<pre>[*]   Debug support
</pre>
<p><br />
</p>
<ul><li>Select TI81XX frame buffer support (EXPERIMENTAL) from the same menu. Press &lt;ENTER&gt; to enter the corresponding sub-menu.</li></ul>
<pre>    ...
    ...
[*]   Debug support for TI81XXFB
"(3)   Number of framebuffers"
    ...
    ...
</pre>
<p><b>NOTE:</b> If this value is set as 1, only fb0(graphics0) is availabe in the fbdev.
<br />
If this value is set as 2, then graphics0(fb0) and graphics1(fb1) pipeline are available in FBDEV.
<br />
If this value is set as 3, all 3 graphics0/1/2(fb0/1/2) pipelines are available the FBDEV interface.
</p>
<h2><span class="mw-headline" id="V4L2_video_driver"><b>V4L2 video driver</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=79" title="Edit section: V4L2 video driver">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<pre>$ make ARCH=arm CROSS_COMPILE=$(PATH_TO_TOOLCHAIN)/bin/arm-none-linux-gnueabi- menuconfig
</pre>
<ul><li>Select Device Drivers from the main menu.</li></ul>
<pre>...
    ...
    Kernel Features  ---&gt;
    Boot options  ---&gt;
    CPU Power Management  ---&gt;
    Floating point emulation  ---&gt;
    Userspace binary formats  ---&gt;
    Power management options  ---&gt;
[*] Networking support  ---&gt;
"   Device Drivers  ---&gt;"
    ...
    ...
</pre>
<p><br />
</p>
<ul><li>Select Multimedia support from the menu.</li></ul>
<pre>    ...
    ...
    Sonics Silicon Backplane  ---&gt;
    Multifunction device drivers  ---&gt;
[*] Voltage and Current Regulator Support  ---&gt;
"&lt;*&gt; Multimedia support  ---&gt;"
    Graphics support  ---&gt;
&lt;*&gt; Sound card support  ---&gt;
[*] HID Devices  ---&gt;
[*] USB support  ---&gt;
    ...
    ...
</pre>
<p><br />
</p>
<ul><li>Select Video For Linux from the menu.</li></ul>
<pre>    ...
    ...
    *** Multimedia core support ***
[ ]   Media Controller API (EXPERIMENTAL)
"&lt;*&gt;   Video For Linux"
[*]     Enable Video For Linux API 1 (DEPRECATED)
&lt; &gt;   DVB for Linux
    ...
    ...
</pre>
<p><br />
</p>
<ul><li>Select Video capture adapters from the same menu. Press &lt;ENTER&gt; to enter the corresponding sub-menu.</li></ul>
<pre>    ...
    ...
[ ]   Customize analog and hybrid tuner modules to build  ---&gt;
"[*]   Video capture adapters  ---&gt;"
[ ]   Memory-to-memory multimedia devices  ---&gt;
[ ]   Radio Adapters  ---&gt;
    ...
    ...
</pre>
<p><br />
</p>
<ul><li>Select TI81XX V4L2-Display driver</li></ul>
<pre>[ ]   Autoselect pertinent encoders/decoders and other helper chi
      Encoders/decoders and other helper chips  ---&gt;
"&lt;M&gt;   TI81XX V4L2-Display driver"
&lt; &gt;   CPiA2 Video For Linux
&lt; &gt;   Philips SAA7134 support
</pre>
<h1><span class="mw-headline" id="Sample_Application_Flow"><b>Sample Application Flow</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=80" title="Edit section: Sample Application Flow">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>This chapter describes the application flow using the V4l2 and FBDEV drivers.
</p>
<h2><span class="mw-headline" id="Fbdev-Display_Application_Flow"><b>Fbdev-Display Application Flow</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=81" title="Edit section: Fbdev-Display Application Flow">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p><br />
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:259px;"><a href="File_Fbdev_apps_flow.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/5/5c/Fbdev_apps_flow.png" width="257" height="480" class="thumbimage" /></a>  <div class="thumbcaption">Application for FBDEV driver</div></div></div></div>
<h2><span class="mw-headline" id="V4L2-Display_Application_Flow"><b>V4L2-Display Application Flow</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;section=82" title="Edit section: V4L2-Display Application Flow">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p><br />
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:294px;"><a href="File_V4l2_apps_flow.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/1/18/V4l2_apps_flow.png" width="292" height="783" class="thumbimage" /></a>  <div class="thumbcaption">Application for v4l2 driver</div></div></div></div>
<p><br />
</p>
<!-- 
NewPP limit report
Cached time: 20201130024707
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.266 seconds
Real time usage: 0.286 seconds
Preprocessor visited node count: 1444/1000000
Preprocessor generated node count: 2814/1000000
Post‐expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 16699/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 -total
-->
</div>
<!-- Saved in parser cache with key procwiki:pcache:idhash:8910-0!canonical and timestamp 20201130024706 and revision id 182396
 -->
<div class='hf-nsfooter' id='hf-nsfooter-'><table style="text-align:center; background:white; width:100%; text-align:left; height: 65px border-top: 1px solid; border-bottom: 1px solid; border-left: 1px solid; border-right: 1px solid; border-width: 1px; border-style: solid;">
<tr>
<td width="305px"><a href="File_E2e.html" class="image"><img alt="E2e.jpg" src="https://processors.wiki.ti.com/images/8/82/E2e.jpg" width="305" height="63" /></a>
</td>
<td>{{
<ol><li>switchcategory:MultiCore=</li></ol>
<ul><li>For technical support on MultiCore devices, please post your questions in the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/c6000_multi-core_dsps/default.aspx">C6000 MultiCore Forum</a></li>
<li>For questions related to the BIOS MultiCore SDK (MCSDK), please use the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/embedded/f/355.aspx">BIOS Forum</a></li></ul>
<p>Please post only comments related to the article <b>DM814X C6A814X AM387X VPSS Video Driver User Guide PSP 04.01.00.04</b> here.<i></i>
</p>
</td>
<td>Keystone=
<ul><li>For technical support on MultiCore devices, please post your questions in the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/c6000_multi-core_dsps/default.aspx">C6000 MultiCore Forum</a></li>
<li>For questions related to the BIOS MultiCore SDK (MCSDK), please use the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/embedded/f/355.aspx">BIOS Forum</a></li></ul>
<p>Please post only comments related to the article <b>DM814X C6A814X AM387X VPSS Video Driver User Guide PSP 04.01.00.04</b> here.<i></i>
</p>
</td>
<td>C2000=<i>For technical support on the C2000 please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/microcontrollers/tms320c2000_32-bit_real-time_mcus/f/171.aspx">The C2000 Forum</a>. Please post only comments about the article <b>DM814X C6A814X AM387X VPSS Video Driver User Guide PSP 04.01.00.04</b> here.</i>
</td>
<td>DaVinci=<i>For technical support on DaVincoplease post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/davinci_digital_media_processors/default.aspx">The DaVinci Forum</a>. Please post only comments about the article <b>DM814X C6A814X AM387X VPSS Video Driver User Guide PSP 04.01.00.04</b> here.</i>
</td>
<td>MSP430=<i>For technical support on MSP430 please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/microcontrollers/msp43016-bit_ultra-low_power_mcus/default.aspx">The MSP430 Forum</a>. Please post only comments about the article <b>DM814X C6A814X AM387X VPSS Video Driver User Guide PSP 04.01.00.04</b> here.</i>
</td>
<td>OMAP35x=<i>For technical support on OMAP please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/omap_applications_processors/default.aspx">The OMAP Forum</a>. Please post only comments about the article <b>DM814X C6A814X AM387X VPSS Video Driver User Guide PSP 04.01.00.04</b> here.</i>
</td>
<td>OMAPL1=<i>For technical support on OMAP please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/omap_applications_processors/default.aspx">The OMAP Forum</a>. Please post only comments about the article <b>DM814X C6A814X AM387X VPSS Video Driver User Guide PSP 04.01.00.04</b> here.</i>
</td>
<td>MAVRK=<i>For technical support on MAVRK please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/development_tools/mavrk/default.aspx">The MAVRK Toolbox Forum</a>. Please post only comments about the article <b>DM814X C6A814X AM387X VPSS Video Driver User Guide PSP 04.01.00.04</b> here.</i>
</td>
<td><i>For technical support please post your questions at <a rel="nofollow" class="external text" href="http://e2e.ti.com/">http://e2e.ti.com</a>. Please post only comments about the article <b>DM814X C6A814X AM387X VPSS Video Driver User Guide PSP 04.01.00.04</b> here.</i>
<p>}}
</p>
</td></tr></table>
<table style="border-style:solid; border-width:1px; text-align:center; width:100%;">

<tr style="font-size:150%;">
<td rowspan="2"><a href="File_Hyperlink_blue.html" class="image"><img alt="Hyperlink blue.png" src="https://processors.wiki.ti.com/images/9/9f/Hyperlink_blue.png" width="96" height="96" /></a>
</td>
<td><b>Links</b>
</td></tr>
<tr>
<td>
<table style="text-align: left;">
<tr>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/amplifier_and_linear.page">Amplifiers &amp; Linear</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/audio/audio_overview.page">Audio</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/rfif.page">Broadband RF/IF &amp; Digital Radio</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/clocksandtimers/clocks_and_timers.page">Clocks &amp; Timers</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/dataconverters/data_converter.page">Data Converters</a>
</p>
</td>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/mems/mems.page">DLP &amp; MEMS</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/high_reliability.page">High-Reliability</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/interface/interface.page">Interface</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/logic/home_overview.page">Logic</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/powermanagement/power_portal.page">Power Management</a>
</p>
</td>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/dsp/embedded_processor.page">Processors</a>
</p>
<ul><li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/dsp/arm.page">ARM Processors</a></li>
<li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/dsp/home.page">Digital Signal Processors (DSP)</a></li>
<li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/microcontroller/home.page">Microcontrollers (MCU)</a></li>
<li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/omap-applications-processors/the-omap-experience.page">OMAP Applications Processors</a></li></ul>
</td>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/switches_and_multiplexers.page">Switches &amp; Multiplexers</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/temperature_sensor.page">Temperature Sensors &amp; Control ICs</a><br/>
<a rel="nofollow" class="external text" href="http://focus.ti.com/wireless/docs/wirelessoverview.tsp?familyId=2003&amp;sectionId=646&amp;tabId=2735">Wireless Connectivity</a>
</p>
</td></tr></table>
</td></tr></table>
<div id="tiPrivacy"></div>
</div></div>					<div class="printfooter">
						Retrieved from "<a dir="ltr" href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;oldid=182396">https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;oldid=182396</a>"					</div>
				<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="Special_Categories.html" title="Special:Categories">Categories</a>: <ul><li><a href="https://processors.wiki.ti.com/index.php?title=Category:TI814x&amp;action=edit&amp;redlink=1" class="new" title="Category:TI814x (page does not exist)">TI814x</a></li><li><a href="Category_Linux.html" title="Category:Linux">Linux</a></li><li><a href="Category_PSP.html" title="Category:PSP">PSP</a></li></ul></div></div>				<div class="visualClear"></div>
							</div>
		</div>
		<div id="mw-navigation">
			<h2>Navigation menu</h2>
			<div id="mw-head">
									<div id="p-personal" role="navigation" class="" aria-labelledby="p-personal-label">
						<h3 id="p-personal-label">Personal tools</h3>
						<ul>
							<li id="pt-login"><a href="https://processors.wiki.ti.com/index.php?title=Special:UserLogin&amp;returnto=DM814X+C6A814X+AM387X+VPSS+Video+Driver+User+Guide+PSP+04.01.00.04" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li><li id="pt-createaccount"><a href="Special_RequestAccount.html" title="You are encouraged to create an account and log in; however, it is not mandatory">Request account</a></li>						</ul>
					</div>
									<div id="left-navigation">
										<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
						<h3 id="p-namespaces-label">Namespaces</h3>
						<ul>
							<li id="ca-nstab-main" class="selected"><span><a href="DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.html" title="View the content page [c]" accesskey="c">Page</a></span></li><li id="ca-talk" class="new"><span><a href="https://processors.wiki.ti.com/index.php?title=Talk:DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page (page does not exist) [t]" accesskey="t">Discussion</a></span></li>						</ul>
					</div>
										<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
												<input type="checkbox" class="vectorMenuCheckbox" aria-labelledby="p-variants-label" />
						<h3 id="p-variants-label">
							<span>Variants</span>
						</h3>
						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
									</div>
				<div id="right-navigation">
										<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
						<h3 id="p-views-label">Views</h3>
						<ul>
							<li id="ca-view" class="collapsible selected"><span><a href="DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.html">Read</a></span></li><li id="ca-viewsource" class="collapsible"><span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></span></li><li id="ca-history" class="collapsible"><span><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=history" title="Past revisions of this page [h]" accesskey="h">View history</a></span></li>						</ul>
					</div>
										<div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label">
						<input type="checkbox" class="vectorMenuCheckbox" aria-labelledby="p-cactions-label" />
						<h3 id="p-cactions-label"><span>More</span></h3>
						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
										<div id="p-search" role="search">
						<h3>
							<label for="searchInput">Search</label>
						</h3>
						<form action="https://processors.wiki.ti.com/index.php" id="searchform">
							<div id="simpleSearch">
								<input type="search" name="search" placeholder="Search Texas Instruments Wiki" title="Search Texas Instruments Wiki [f]" accesskey="f" id="searchInput"/><input type="hidden" value="Special:Search" name="title"/><input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton mw-fallbackSearchButton"/><input type="submit" name="go" value="Go" title="Go to a page with this exact name if it exists" id="searchButton" class="searchButton"/>							</div>
						</form>
					</div>
									</div>
			</div>
			<div id="mw-panel">
				<div id="p-logo" role="banner"><a class="mw-wiki-logo" href="Main_Page.html"  title="Visit the main page"></a></div>
						<div class="portal" role="navigation" id="p-navigation" aria-labelledby="p-navigation-label">
			<h3 id="p-navigation-label">Navigation</h3>
			<div class="body">
								<ul>
					<li id="n-mainpage"><a href="Main_Page.html" title="Visit the main page [z]" accesskey="z">Main Page</a></li><li id="n-All-pages"><a href="Special_AllPages.html">All pages</a></li><li id="n-All-categories"><a href="Special_Categories.html">All categories</a></li><li id="n-recentchanges"><a href="Special_RecentChanges.html" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li><li id="n-randompage"><a href="Package_Reflow_Profiles.html" title="Load a random page [x]" accesskey="x">Random page</a></li><li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" title="The place to find out">Help</a></li>				</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id="p-tb" aria-labelledby="p-tb-label">
			<h3 id="p-tb-label">Toolbox</h3>
			<div class="body">
								<ul>
					<li id="t-whatlinkshere"><a href="Special_WhatLinksHere/DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.html" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li><li id="t-recentchangeslinked"><a href="Special_RecentChangesLinked/DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.html" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li><li id="t-specialpages"><a href="Special_SpecialPages.html" title="A list of all special pages [q]" accesskey="q">Special pages</a></li><li id="t-print"><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li><li id="t-permalink"><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;oldid=182396" title="Permanent link to this revision of the page">Permanent link</a></li><li id="t-info"><a href="https://processors.wiki.ti.com/index.php?title=DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04&amp;action=info" title="More information about this page">Page information</a></li>				</ul>
							</div>
		</div>
				</div>
		</div>
				<div id="footer" role="contentinfo">
						<ul id="footer-info">
								<li id="footer-info-lastmod"> This page was last edited on 28 July 2014, at 03:47.</li>
								<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-ShareAlike</a> unless otherwise noted.</li>
							</ul>
						<ul id="footer-places">
								<li id="footer-places-privacy"><a href="Project_Privacy_policy.html" title="Project:Privacy policy">Privacy policy</a></li>
								<li id="footer-places-about"><a href="Project_About.html" title="Project:About">About Texas Instruments Wiki</a></li>
								<li id="footer-places-disclaimer"><a href="Project_General_disclaimer.html" title="Project:General disclaimer">Disclaimers</a></li>
								<li id="footer-places-termsofservice"><a href="Project_Terms_of_Service.html" title="Project:Terms of Service">Terms of Use</a></li>
							</ul>
										<ul id="footer-icons" class="noprint">
										<li id="footer-copyrightico">
						<a href="http://creativecommons.org/licenses/by-sa/3.0/"><img src="https://processors.wiki.ti.com/resources/assets/licenses/cc-by-sa.png" alt="Creative Commons Attribution-ShareAlike" width="88" height="31"/></a>					</li>
										<li id="footer-poweredbyico">
						<a href="http://www.mediawiki.org/"><img src="https://processors.wiki.ti.com/resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31"/></a>					</li>
									</ul>
						<div style="clear: both;"></div>
		</div>
		<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgPageParseReport":{"limitreport":{"cputime":"0.266","walltime":"0.286","ppvisitednodes":{"value":1444,"limit":1000000},"ppgeneratednodes":{"value":2814,"limit":1000000},"postexpandincludesize":{"value":0,"limit":2097152},"templateargumentsize":{"value":0,"limit":2097152},"expansiondepth":{"value":2,"limit":40},"expensivefunctioncount":{"value":0,"limit":100},"unstrip-depth":{"value":0,"limit":20},"unstrip-size":{"value":16699,"limit":5000000},"timingprofile":["100.00%    0.000      1 -total"]},"cachereport":{"timestamp":"20201130024707","ttl":86400,"transientcontent":false}}});});</script><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":237});});</script>
	</body>

<!-- Mirrored from processors.wiki.ti.com/index.php/DM814X_C6A814X_AM387X_VPSS_Video_Driver_User_Guide_PSP_04.01.00.04 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 01 Dec 2020 03:55:54 GMT -->
</html>
