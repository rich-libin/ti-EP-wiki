<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">

<!-- Mirrored from processors.wiki.ti.com/index.php/TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 01 Dec 2020 06:30:38 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8"/>
<title>TI81XX PSP PCI Express Endpoint Boot Driver User Guide - Texas Instruments Wiki</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide","wgTitle":"TI81XX PSP PCI Express Endpoint Boot Driver User Guide","wgCurRevisionId":124077,"wgRevisionId":124077,"wgArticleId":15254,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["TI816X","AM389x","TI814X","AM387x","DaVinci","PSP"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide","wgRelevantArticleId":15254,"wgRequestId":"842e52020af8a7217e1aab56","wgIsProbablyEditable":false,"wgRelevantPageIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[]});mw.loader.state({"site.styles":"ready","noscript":"ready","user.styles":"ready","user":"ready","user.options":"ready","user.tokens":"loading","mediawiki.legacy.shared":"ready","mediawiki.legacy.commonPrint":"ready","mediawiki.sectionAnchor":"ready","mediawiki.skinning.interface":"ready","skins.vector.styles":"ready"});mw.loader.implement("user.tokens@19o3a1s",function($,jQuery,require,module){/*@nomin*/mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});
});mw.loader.load(["site","mediawiki.page.startup","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.toc","mediawiki.searchSuggest","skins.vector.js"]);});</script>
<link rel="stylesheet" href="https://processors.wiki.ti.com/load.php?debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.interface%7Cskins.vector.styles&amp;only=styles&amp;skin=vector"/>
<script async="" src="https://processors.wiki.ti.com/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=vector"></script>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="https://processors.wiki.ti.com/load.php?debug=false&amp;lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=vector"/>
<meta name="generator" content="MediaWiki 1.31.6"/>
<link rel="shortcut icon" href="https://processors.wiki.ti.com/favicon.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="https://processors.wiki.ti.com/opensearch_desc.php" title="Texas Instruments Wiki (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="https://processors.wiki.ti.com/api.php?action=rsd"/>
<link rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/"/>
<link rel="alternate" type="application/atom+xml" title="Texas Instruments Wiki Atom feed" href="https://processors.wiki.ti.com/index.php?title=Special:RecentChanges&amp;feed=atom"/>
<!--[if lt IE 9]><script src="/load.php?debug=false&amp;lang=en&amp;modules=html5shiv&amp;only=scripts&amp;skin=Vector&amp;sync=1"></script><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide rootpage-TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide skin-vector action-view">		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<div id="content" class="mw-body" role="main">
			<a id="top"></a>
			<div id="siteNotice" class="mw-body-content"><div id="localNotice" lang="en" dir="ltr"><div class="mw-parser-output"><p><br />
<span style="color:#ff0000"><b>NOTICE: The Processors Wiki will End-of-Life on January 15, 2021. It is recommended to download any files or other content you may need that are hosted on processors.wiki.ti.com. The site is now set to read only.</b></span>
</p></div></div></div><div class="mw-indicators mw-body-content">
</div>
<h1 id="firstHeading" class="firstHeading" lang="en">TI81XX PSP PCI Express Endpoint Boot Driver User Guide</h1>			<div id="bodyContent" class="mw-body-content">
				<div id="siteSub" class="noprint">From Texas Instruments Wiki</div>				<div id="contentSub"></div>
								<div id="jump-to-nav" class="mw-jump">
					Jump to:					<a href="#mw-head">navigation</a>, 					<a href="#p-search">search</a>
				</div>
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output"><div style="width:800px; text-align:justify;"> 
<div style="display:block; clear: both; margin: 10px 0px; padding: 0px; background-color: #ee1d23; text-align:right;"><a href="File_TIBanner.html" class="image"><img alt="TIBanner.png" src="https://processors.wiki.ti.com/images/c/cd/TIBanner.png" width="667" height="87" /></a></div>
<div style="display:block; margin: 5px 0px; padding: 2px 5px; font-size:1.5em; font-weight:bold; text-align:left;">TI81XX PCI Express Endpoint Boot Driver User Guide</div>
<div style="display:block; margin: 5px 0px; padding: 2px; color: #666666; font-size:1.0em; font-weight:bold; text-align:right;">Hemant Pedanekar</div> 
<p><br />
</p>
<div id="toc" class="toc"><div class="toctitle" lang="en" dir="ltr"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Introduction"><span class="tocnumber">1</span> <span class="toctext"><b>Introduction</b></span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Scope"><span class="tocnumber">2</span> <span class="toctext"><b>Scope</b></span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Conventions"><span class="tocnumber">3</span> <span class="toctext"><b>Conventions</b></span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Known_Issues.2FRestrictions_.28Read_this_before_you_proceed.29"><span class="tocnumber">4</span> <span class="toctext"><b>Known Issues/Restrictions </b><span><b>(Read this before you proceed)</b></span></span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Setup"><span class="tocnumber">5</span> <span class="toctext"><b>Setup</b></span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#Conflict_with_NAND.2FNOR_and_TI814X.2FTI813X.2FTI816X_PCIe_Boot_Mode_setting"><span class="tocnumber">5.1</span> <span class="toctext"><b>Conflict with NAND/NOR and TI814X/TI813X/TI816X PCIe Boot Mode setting</b></span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Setting_up_the_TI816X_RC"><span class="tocnumber">5.2</span> <span class="toctext"><b>Setting up the TI816X RC</b></span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Setting_up_the_PC_as_RC"><span class="tocnumber">5.3</span> <span class="toctext"><b>Setting up the PC as RC</b></span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Setting_up_TI816X_EP"><span class="tocnumber">5.4</span> <span class="toctext"><b>Setting up TI816X EP</b></span></a>
<ul>
<li class="toclevel-3 tocsection-10"><a href="#Taking_care_of_PERSTn"><span class="tocnumber">5.4.1</span> <span class="toctext"><b>Taking care of PERSTn</b></span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-11"><a href="#Setting_up_the_TI814X_RC"><span class="tocnumber">5.5</span> <span class="toctext"><b>Setting up the TI814X RC</b></span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Setting_up_TI814X.2FTI813X_EP"><span class="tocnumber">5.6</span> <span class="toctext"><b>Setting up TI814X/TI813X EP</b></span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-13"><a href="#Keeping_the_Required_Modules_Ready"><span class="tocnumber">6</span> <span class="toctext"><b>Keeping the Required Modules Ready</b></span></a>
<ul>
<li class="toclevel-2 tocsection-14"><a href="#PCIe_EP_Boot_Driver"><span class="tocnumber">6.1</span> <span class="toctext"><b>PCIe EP Boot Driver</b></span></a>
<ul>
<li class="toclevel-3 tocsection-15"><a href="#Features_Supported"><span class="tocnumber">6.1.1</span> <span class="toctext"><b>Features Supported</b></span></a></li>
<li class="toclevel-3 tocsection-16"><a href="#Features_NOT_Supported"><span class="tocnumber">6.1.2</span> <span class="toctext"><b>Features NOT Supported</b></span></a></li>
<li class="toclevel-3 tocsection-17"><a href="#Supported_IOCTLs"><span class="tocnumber">6.1.3</span> <span class="toctext"><b>Supported IOCTLs</b></span></a></li>
<li class="toclevel-3 tocsection-18"><a href="#Source_Files"><span class="tocnumber">6.1.4</span> <span class="toctext"><b>Source Files</b></span></a></li>
<li class="toclevel-3 tocsection-19"><a href="#Steps_for_Building_for_TI81XX_Kernel"><span class="tocnumber">6.1.5</span> <span class="toctext"><b>Steps for Building for TI81XX Kernel</b></span></a></li>
<li class="toclevel-3 tocsection-20"><a href="#Steps_for_Building_for_x86_Kernel"><span class="tocnumber">6.1.6</span> <span class="toctext"><b>Steps for Building for x86 Kernel</b></span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-21"><a href="#U-Boot"><span class="tocnumber">6.2</span> <span class="toctext"><b>U-Boot</b></span></a>
<ul>
<li class="toclevel-3 tocsection-22"><a href="#TI816X"><span class="tocnumber">6.2.1</span> <span class="toctext">TI816X</span></a></li>
<li class="toclevel-3 tocsection-23"><a href="#TI814X"><span class="tocnumber">6.2.2</span> <span class="toctext">TI814X</span></a></li>
<li class="toclevel-3 tocsection-24"><a href="#TI813X"><span class="tocnumber">6.2.3</span> <span class="toctext">TI813X</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-25"><a href="#PCIe_EP_Boot_Application"><span class="tocnumber">6.3</span> <span class="toctext"><b>PCIe EP Boot Application</b></span></a>
<ul>
<li class="toclevel-3 tocsection-26"><a href="#Features_Supported_2"><span class="tocnumber">6.3.1</span> <span class="toctext"><b>Features Supported</b></span></a></li>
<li class="toclevel-3 tocsection-27"><a href="#Features_NOT_Supported_2"><span class="tocnumber">6.3.2</span> <span class="toctext"><b>Features NOT Supported</b></span></a></li>
<li class="toclevel-3 tocsection-28"><a href="#Steps_for_Building_for_TI81XX_RC"><span class="tocnumber">6.3.3</span> <span class="toctext"><b>Steps for Building for TI81XX RC</b></span></a></li>
<li class="toclevel-3 tocsection-29"><a href="#Steps_for_Building_for_PC"><span class="tocnumber">6.3.4</span> <span class="toctext"><b>Steps for Building for PC</b></span></a></li>
<li class="toclevel-3 tocsection-30"><a href="#Tuning_Boot_Application"><span class="tocnumber">6.3.5</span> <span class="toctext"><b>Tuning Boot Application</b></span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-31"><a href="#PCIe_EP_U-Boot_Boot_Script"><span class="tocnumber">6.4</span> <span class="toctext"><b>PCIe EP U-Boot Boot Script</b></span></a>
<ul>
<li class="toclevel-3 tocsection-32"><a href="#Creating_U-Boot_Script"><span class="tocnumber">6.4.1</span> <span class="toctext"><b>Creating U-Boot Script</b></span></a></li>
<li class="toclevel-3 tocsection-33"><a href="#Auto_Booting_with_the_Bootscript"><span class="tocnumber">6.4.2</span> <span class="toctext"><b>Auto Booting with the Bootscript</b></span></a>
<ul>
<li class="toclevel-4 tocsection-34"><a href="#Updating_U-Boot"><span class="tocnumber">6.4.2.1</span> <span class="toctext"><b>Updating U-Boot</b></span></a></li>
<li class="toclevel-4 tocsection-35"><a href="#TI816X_2"><span class="tocnumber">6.4.2.2</span> <span class="toctext">TI816X</span></a></li>
<li class="toclevel-4 tocsection-36"><a href="#TI814X.2FTI813X"><span class="tocnumber">6.4.2.3</span> <span class="toctext">TI814X/TI813X</span></a></li>
<li class="toclevel-4 tocsection-37"><a href="#Saving_Boot_Command_on_EP_Storage"><span class="tocnumber">6.4.2.4</span> <span class="toctext"><b>Saving Boot Command on EP Storage</b></span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-2 tocsection-38"><a href="#Building_Kernel_for_EP"><span class="tocnumber">6.5</span> <span class="toctext"><b>Building Kernel for EP</b></span></a></li>
<li class="toclevel-2 tocsection-39"><a href="#Updating_the_Filesystem"><span class="tocnumber">6.6</span> <span class="toctext"><b>Updating the Filesystem</b></span></a></li>
<li class="toclevel-2 tocsection-40"><a href="#Updating_the_RC_Kernel"><span class="tocnumber">6.7</span> <span class="toctext"><b>Updating the RC Kernel</b></span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-41"><a href="#Ensuring_the_PCIe_System_Initialization"><span class="tocnumber">7</span> <span class="toctext"><b>Ensuring the PCIe System Initialization</b></span></a></li>
<li class="toclevel-1 tocsection-42"><a href="#Load_Addresses"><span class="tocnumber">8</span> <span class="toctext"><b> Load Addresses</b></span></a></li>
<li class="toclevel-1 tocsection-43"><a href="#Booting_EP"><span class="tocnumber">9</span> <span class="toctext"><b>Booting EP</b></span></a></li>
</ul>
</div>

<h1><span class="mw-headline" id="Introduction"><b>Introduction</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;action=edit&amp;section=1" title="Edit section: Introduction">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<div style="padding: 5px; background: none repeat scroll 0% 0% rgb(238, 238, 238); color: rgb(21, 27, 84);">
<p><b>This document is applicable to DM816x/AM389x, DM814x/AM387x and DM813x family of devices referred hereafter as TI816X, TI814X and TI813x respectively.</b>
</p><p><b>Descriptions common across these device families use the term TI81XX/ti81xx.</b>
</p>
</div>
<p>TI81XX devices have a PCI Express hardware module which can either be configured to act as a Root Complex or a PCIe Endpoint. When configured as PCIe Endpoint (EP), the device can be set to boot over PCIe. This document caters to the Endpoint boot operation and describes the Driver needed to configure and operate on TI81XX PCI Express Endpoint to perform booting. A sample application (part of release package) is used to carry out boot operation.
</p>
<div style="padding: 5px; background: none repeat scroll 0% 0% rgb(238, 238, 238); color: rgb(255, 0, 0);">
<p><b>NOTE1: Support for TI814X Root Complex is added from 04.01.00.06 release, hence the references/setups described in this document related to TI814X as Root Complex are not applicable for prior TI814X releases.</b>  
</p><p><b>NOTE2: Support for TI813X Root Complex or EP mode is currently not part of any release and is applicable only for latest kernel used from ti81xx-master branch on Arago git.</b>  
</p><p><b>NOTE3: Various code snippets now use term <tt>ti81xx</tt> when referring to code common for TI81XX devices. For releases prior to 04.00.00.12 (TI816X) please consider the code snippets as having <tt>ti816x</tt> prefix, otherwise, refer the PDF of this user guide from respective release package.</b>  
</p>
</div>
<h1><span class="mw-headline" id="Scope"><b>Scope</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;action=edit&amp;section=2" title="Edit section: Scope">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>This document covers the setup involving two TI816X/Dm814x EVMs connected together over PCIe using a PCIe cable having male connectors on both the ends. Here one device is set to boot in any other peripheral or memory boot mode (e.g., NAND) which will be designated as Root Complex (RC) and other TI81XX device configured in PCIe Boot mode (EP).
</p><p>It is also possible to connect a TI816X EP device to any other PCIe RC. For the scope of this document, we will consider a x86 PC running Linux.
</p>
<div style="padding: 5px; background: none repeat scroll 0% 0% rgb(238, 238, 238); color: rgb(21, 27, 84);">
<p><b>Note:</b> In case of TI814X/TI813X EVM with device in PCIe boot mode, booting from TI816X or TI814X Root Complex is supported currently (post 04.01.00.06 release for TI814X RC, latest kernel on Arago for TI813X). 
</p>
</div> 
<p>Also note that only 32-bit PCIe mode is supported currently on both RC and EP.
</p>
<h1><span class="mw-headline" id="Conventions"><b>Conventions</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;action=edit&amp;section=3" title="Edit section: Conventions">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<ul><li>This document refers TI816X device set up in PCIe boot mode as EP (Endpoint) and the TI816X device acting as PCIe Root Complex as RC.</li>
<li>The shell commands executed on Linux host machine as preceded with <tt>LINUXHOST$</tt> and the commands to be executed on TI816X RC are preceded with <tt>ti8168-evm#</tt>.</li>
<li>It is assumed that the same Linux host machine is used as Root Complex when having PC to TI816X EVM EP connectivity.</li></ul>
<div style="padding: 5px; background: none repeat scroll 0% 0% rgb(238, 238, 238); color: rgb(21, 27, 84);">
<p><b>NOTE 1:</b> The only major difference between TI816X and TI814X/TI813X PCIe is TI816X has a x2 link while TI814X/TI813X has x1 link. Since this doesn't lead to any differences in topology and software execution impact on TI81XX Root Complex, all of the descriptions considering TI816X as Root Complex in rest of the document apply equally to TI814X/TI813X as RC as well, unless otherwise stated.
</p><p><b>NOTE 2:</b> Though we cover EP device as TI816X mainly, most of the description is applicable to TI814X/TI813X EP device also except for sections covering TI816X EVM modifications and booting from PC. Any other specific differences with TI816X devices are highlighted wherever applicable.
</p>
</div>
<h1><span id="Known_Issues/Restrictions_(Read_this_before_you_proceed)"></span><span class="mw-headline" id="Known_Issues.2FRestrictions_.28Read_this_before_you_proceed.29"><b>Known Issues/Restrictions </b><span style="color: rgb(255, 0, 0);"><b>(Read this before you proceed)</b></span></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;action=edit&amp;section=4" title="Edit section: Known Issues/Restrictions (Read this before you proceed)">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>This section lists various constraints applicable on TI81XX PCIe EP boot operation. Most the the points listed below are covered in respective sections of this document. 
</p>
<ul><li>Only 32-bit PCIe boot mode is supported, 64-bit mode not supported currently.</li>
<li>At the minimum, 3 BARs - BAR0, BAR1 and BAR2 are needed for boot operation and hence only the switch setting mentioned in next section is supported on EP.</li>
<li>Other possible switch settings which may set up additional BARs may lead to issues in case RC is not able to allocate those BARs.</li>
<li>Boot driver and application cannot handle multiple TI81XX EPs. Will only boot the first detected EP. If the setup involves combination of TI816X/TI814X/TI813X devices, TI816X device will be detected and configured for boot.</li>
<li>In case ramdisk image is used as filesystem on EP, it cannot exceed 8MB. This restriction is imposed by the sample boot application to avoid exceeding the minimum BAR2 size (8MB) on TI816X.</li>
<li><i>Booting EP from a non-TI81XX RC is possible for <b>TI816X EP</b></i> but will require the boot driver and application to be built on respective RC. <i>Note that the boot driver and application are written and tested to work with Linux kernel version 2.6.32 onwards.</i> So make sure that the RC is running Linux kernel as supported. This document will cover steps for building these components on a PC as RC running Linux. <b>In addition, you may need to do hardware modifications/configurations as described in <a href="DM816x_C6A816x_AM389x_PCIe_Clocking_Schemes.html" class="mw-redirect" title="DM816x C6A816x AM389x PCIe Clocking Schemes"> Clocking Schemes Guide</a></b></li>
<li>Current configuration of boot application skips checking boot flag clear indication from EP U-Boot (indicating DDR setup done) and proceeds to load other images to DDR. This may fail in case EP U-Boot is yet to set up the DDR. Try increasing boot flag check delay in this case. Refer Boot Application section below.</li>
<li>Similarly, EP U-Boot doesn't check for any boot flag indication from the boot application (to notify about completion of subsequent download) and may proceed to load kernel (or ramdisk or 2nd stage U-Boot where applicable) even before it is completely loaded by boot application. In such cases, you can precede 'sleep 3' (or more) in the boot script or bootcmd. Alternately, you can also tune CONFIG_BOOTDELAY in U-Boot header file for corresponding board to a higher value to delay auto booting.</li>
<li>Though the boot driver supports static build (building into kernel), some filesystem changes are required if you are using Arago/OE based filesystem with udev device cache. Please refer Updating the Filesystem section for details.</li></ul>
<h1><span class="mw-headline" id="Setup"><b>Setup</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;action=edit&amp;section=5" title="Edit section: Setup">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>This document considers following distinct setups:
</p>
<ol><li><b>TI816X EVM RC - TI816X EVM EP: </b> This setup requires two DM8168 boards (EVMs). Ensure that serial port (UART2) on each board is connected to host terminals.</li>
<li><b>TI816X EVM RC - TI814X EVM EP: </b> This setup requires one DM8168 EVM set up as RC while DM8148 EVM set up as EP with PCIe-32-bit boot mode. Ensure that serial port on each board (UART2 on DM8168 EVM and UART0 on DM8148 EVM) is connected to host terminals.</li>
<li><b>TI814X EVM RC - TI814X EVM EP: </b> This setup requires two DM8148 boards (EVMs). Ensure that serial port (UART0) on each board is connected to host terminals.</li>
<li><b>TI814X EVM RC - TI816X EVM EP: </b> This setup requires one DM8148 EVM set up as RC while DM8168 EVM set up as EP with PCIe-32-bit boot mode. Ensure that serial port on each board (UART0 on DM8148 EVM and UART2 on DM8168 EVM) is connected to host terminals.</li>
<li><b>x86 PC as RC - TI816X EVM EP: </b> In this setup, the PC is RC and is running Ubuntu 10.04 LTS with Linux kernel 2.6.32. Ensure that serial port (UART2) on TI816X EVM used as EP is connected to host serial port.</li>
<li><b>TI816X EVM RC - TI813X EVM EP: </b> This setup requires one DM8168 EVM set up as RC while TI813X EVM set up as EP with PCIe-32-bit boot mode. Ensure that serial port on each board (UART2 on DM8168 EVM and UART0 on TI813X EVM) is connected to host terminals.</li></ol>
<div style="padding: 5px; background: none repeat scroll 0% 0% rgb(238, 238, 238); color: rgb(21, 27, 84);">
<p><b>Note:</b> In any of the cases covered here, it is advised to power on the EP device first and then RC. 
</p>
</div>
<h2><span id="Conflict_with_NAND/NOR_and_TI814X/TI813X/TI816X_PCIe_Boot_Mode_setting"></span><span class="mw-headline" id="Conflict_with_NAND.2FNOR_and_TI814X.2FTI813X.2FTI816X_PCIe_Boot_Mode_setting"><b>Conflict with NAND/NOR and TI814X/TI813X/TI816X PCIe Boot Mode setting</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;action=edit&amp;section=6" title="Edit section: Conflict with NAND/NOR and TI814X/TI813X/TI816X PCIe Boot Mode setting">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<div style="padding: 5px; background: none repeat scroll 0% 0% rgb(238, 238, 238); color: rgb(21, 27, 84);">
<p><b>Note:</b> This section applies when using U-Boot and/or kernel from PSP releases 04.01.00.06 (TI814X) or 04.00.01.13 (TI816X) or later. For older releases, this issue does not exist and you can skip this section.
</p>
</div>
<p>The GPMC related boot pin CS0BW used for PCIe boot mode configuration is checked by u-boot and kernel to determine the 8-bit/16-bit NAND/NOR type connected on the board.
</p><p>This will lead to conflict in few cases such as:
</p>
<ol><li>PCIe 32-bit boot mode with CS0BW=1 for BAR2 will require the DIP switch associated with CS0BW pin to be set to ON but U-Boot will take it as 8-bit NAND even if actual NAND on board was 16-bit. This will lead to NAND detection failures</li>
<li>Similar issue would occur when using 8-bit NOR where CS0BW=1 will be taken by NOR driver on Linux or U-Boot as NOR being 16-bit</li></ol>
<div style="padding: 5px; background: none repeat scroll 0% 0% rgb(238, 238, 238); color: rgb(255, 0, 0);">
<p><b>Thus, with kernel and/or U-Boot from above mentioned releases, NAND and/or NOR may not be accessible when using PCIe boot mode of TI816X/TI814X/TI813X EP.</b> 
</p>
</div>
<h2><span class="mw-headline" id="Setting_up_the_TI816X_RC"><b>Setting up the TI816X RC</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;action=edit&amp;section=7" title="Edit section: Setting up the TI816X RC">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li>Flash the TI816X RC on board NAND with U-Boot. Refer <a href="https://processors.wiki.ti.com/index.php?title=TI816X_PSP_Flashing_Tools_Guide&amp;action=edit&amp;redlink=1" class="new" title="TI816X PSP Flashing Tools Guide (page does not exist)">PSP Flashing Tools Guide</a> document for details.</li>
<li>Set the DM8168 EVM switch settings to enable NAND boot mode. Refer <a href="TI81XX_PSP_U-Boot.html" class="mw-redirect" title="TI81XX PSP U-Boot">U-Boot User Guide</a> for details about building U-Boot for NAND boot mode and switch settings.</li>
<li>Use Male-Male (x2 or x4) PCIe cable to connect RC and PCIe slot on EP (minimum x4).</li>
<li>Alternatively, you can set up RC to boot in any other (non-PCIe) boot mode.</li></ul>
<h2><span class="mw-headline" id="Setting_up_the_PC_as_RC"><b>Setting up the PC as RC</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;action=edit&amp;section=8" title="Edit section: Setting up the PC as RC">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li>Use Male-Male (x2 or x4) PCIe cable to connect to the PCIe slot on PC motherboard and the DM8168 Board (EP).</li></ul>
<div style="padding: 5px; background: none repeat scroll 0% 0% rgb(238, 238, 238); color: rgb(21, 27, 84);">
<p><b>Note:</b> The cable needs to be modified as described in <a href="DM816x_C6A816x_AM389x_PCIe_Clocking_Schemes.html" class="mw-redirect" title="DM816x C6A816x AM389x PCIe Clocking Schemes"> Clocking Schemes Guide</a> 
</p>
</div>
<h2><span class="mw-headline" id="Setting_up_TI816X_EP"><b>Setting up TI816X EP</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;action=edit&amp;section=9" title="Edit section: Setting up TI816X EP">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li>Set the board designated as PCIe EP in PCIe 32-bit Boot mode as follows:</li></ul>
<pre>SW3[5:1] ---&gt; BTM[4:0] = 01000 and SW3[8] ---&gt; CS0BW = 1. Rest all switches should be '0' (zero) or 'OFF'
</pre>
<ul><li>This results into following boot pin configuration for TI816X device</li></ul>
<pre>SYSBOOT[4:0] = 01000 ==&gt; 32-bit PCIe Boot mode
CS0BW        = 1     ==&gt; for 8MB BAR2, in addition to default 8MB BAR1 and 4KB BAR0
</pre>
<ul><li>Note: Setting up any other combination of switch settings with PCIe Boot mode is not supported/validated.</li></ul>
<div style="padding: 5px; background: none repeat scroll 0% 0% rgb(238, 238, 238); color: rgb(21, 27, 84);">
<p><b>Note:</b> When using with non-TI816X device as RC, DM8168 EVM to be set as EP needs to be modified as described in <a href="DM816x_C6A816x_AM389x_PCIe_Clocking_Schemes.html" class="mw-redirect" title="DM816x C6A816x AM389x PCIe Clocking Schemes"> Clocking Schemes Guide</a>. 
</p>
</div>
<h3><span class="mw-headline" id="Taking_care_of_PERSTn"><b>Taking care of PERSTn</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;action=edit&amp;section=10" title="Edit section: Taking care of PERSTn">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>On DM8168 EVMs the SW5 DIP switch has a switch for "PCIe RST". This corresponds to the in/out mode of the PERSTn line of the PCIe slot which in turn is tied to PCIe_PORz. The switch position 'OFF' (or '0') means the pin is set as INPUT while switch position 'ON' means the pin is in OUTPUT mode. Thus, having this switch in ON state (OUTPUT) on EP EVM OFF state (INPUT) on RC EVM will lead to conflicting configuration and the RC may not boot.
</p>
<div style="padding: 5px; background: none repeat scroll 0% 0% rgb(238, 238, 238); color: rgb(21, 27, 84);">
<ul><li>Ensure that the SW5 "PCIe RST" switch on both EP and RC EVMs is set in OFF (INPUT) state.</li>
<li>For setup involving PC as RC, it is mandatory is set SW5-1 to OFF (INPUT) state otherwise PC may not boot.</li>
<li>For setup where DM8168 is RC and TI814X/TI813X device is EP, it is mandatory is set SW5-1 to OFF (INPUT) state otherwise the EP will not get detected from RC.</li></ul>
</div> 
<pre>SW5[1] ---&gt; PCIe RST = 0
</pre>
<p>Alternately, you can set the above switch on both the EVMs in ON state (OUTPUT).
</p>
<div style="padding: 5px; background: none repeat scroll 0% 0% rgb(238, 238, 238); color: rgb(21, 27, 84);">
<p><b>Note:</b> Setting SW5 PCIe RST as OFF (INPUT) on EP and ON (OUTPUT) on RC is not supported due to issue SDOCM00077550 (refer Release Notes for the release you are using)
</p>
</div>
<h2><span class="mw-headline" id="Setting_up_the_TI814X_RC"><b>Setting up the TI814X RC</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;action=edit&amp;section=11" title="Edit section: Setting up the TI814X RC">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li>Flash the TI814X RC on board NAND with U-Boot. Refer <a href="https://processors.wiki.ti.com/index.php?title=TI814X_PSP_Flashing_Tools_Guide&amp;action=edit&amp;redlink=1" class="new" title="TI814X PSP Flashing Tools Guide (page does not exist)">PSP Flashing Tools Guide</a> document for details.</li>
<li>Set the DM8148 EVM switch settings to enable NAND boot mode. Refer <a href="TI81XX_PSP_U-Boot.html" class="mw-redirect" title="TI81XX PSP U-Boot">U-Boot User Guide</a> for details about building U-Boot for NAND boot mode and switch settings.</li>
<li>Use Male-Male (x2 or x4) PCIe cable to connect RC and with the PCIe slot (minimum x4) on EP.</li>
<li>Alternatively, you can set up RC to boot in any other (non-PCIe) boot mode.</li></ul>
<h2><span id="Setting_up_TI814X/TI813X_EP"></span><span class="mw-headline" id="Setting_up_TI814X.2FTI813X_EP"><b>Setting up TI814X/TI813X EP</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;action=edit&amp;section=12" title="Edit section: Setting up TI814X/TI813X EP">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li>Set the TI814X/TI813X EVM designated as PCIe EP in PCIe 32-bit Boot mode as follows:</li></ul>
<pre>Boot mode select switch S1[5:1] = 01000 and S1[8] = 1. Rest all switches should be '0' (zero) or 'OFF'
</pre>
<ul><li>This results into following boot pin configuration for TI814X/TI813X device</li></ul>
<pre>BTMODE[[4:0]/SYSBOOT[4:0] = 01000 ==&gt; 32-bit PCIe Boot mode
BTMODE[12]/CS0BW        = 1     ==&gt; for 16MB BAR2, in addition to default 8MB BAR1 and 4KB BAR0
</pre>
<ul><li><b>Note: Setting up any other combination of switch settings with PCIe Boot mode is not supported/validated.</b></li></ul>
<h1><span class="mw-headline" id="Keeping_the_Required_Modules_Ready"><b>Keeping the Required Modules Ready</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;action=edit&amp;section=13" title="Edit section: Keeping the Required Modules Ready">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>Following section describes various modules involved in EP boot operation and steps for preparing binaries and U-Boot script required to be present on PCIe RC to boot TI81XX EP. In addition, it is assumed that a ramdisk filesystem or NFS based filesystem for EP are available. 
</p>
<div style="padding: 5px; background: none repeat scroll 0% 0% rgb(238, 238, 238); color: rgb(21, 27, 84);">
<p><b>Note:</b> Though the kernel (uImage) built with default config for TI81XX RC will boot on TI81XX EP, it will lead to conflicting configuration of the system since the kernel booting on EP will switch the PCIe mode from EP to RC. Due to this, the communication between PCIe RC and EP will no longer happen. For this, the kernel needs to be re-built with PCI support removed for booting on EP. 
</p>
</div> 
<p>Also note that the sections below assume you have extracted the TI81XX release package to a directory referred as $PKGDIR and build environment is setup as described in <a href="TI81XX_PSP_User_Guide.html" title="TI81XX PSP User Guide"> TI81XX PSP User Guide</a>. 
</p>
<h2><span class="mw-headline" id="PCIe_EP_Boot_Driver"><b>PCIe EP Boot Driver</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;action=edit&amp;section=14" title="Edit section: PCIe EP Boot Driver">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<div style="padding: 5px; background: none repeat scroll 0% 0% rgb(238, 238, 238); color: rgb(21, 27, 84);">
<p><b>Note:</b> The default kernel build configuration does not select the driver and needs to be enabled for respective kernels (e.g., TI816X, TI814X, TI813X, x86 etc) as explained in respective sections below. 
</p>
</div>
<p>This driver runs on TI81XX RC or an x86 PC running Linux kernel 2.6.32 onwards. It configures the first TI81XX EP device detected in the system and configures it to be able to carry boot operation. 
</p>
<h3><span class="mw-headline" id="Features_Supported"><b>Features Supported</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;action=edit&amp;section=15" title="Edit section: Features Supported">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ul><li>Support for detecting and configuring TI816X/TI814X/TI813X devices</li>
<li>Provides character device interface on Linux Kernel to PCIe boot user-space application</li>
<li>Provide mmap support to enable the boot application to copy image files (U-Boot, kernel etc) to EP memory</li>
<li>Can be built as loadable module or into kernel</li></ul>
<h3><span class="mw-headline" id="Features_NOT_Supported"><b>Features NOT Supported</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;action=edit&amp;section=16" title="Edit section: Features NOT Supported">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ul><li>Operate more than one TI81XX EP. If more than one TI81XX EPs are connected in the system, this driver operates only on the first detected TI816X/TI814X/TI813X device detected in order.</li>
<li>No interrupt support</li>
<li>Not validated on any other RC than TI81XX and x86 PC. This driver will require porting in case you are using Linux kernel prior to 2.6.32 or any other h/w platform than TI81XX or x86 PC.</li>
<li>No support for power management (e.g., suspend/resume)</li></ul>
<h3><span class="mw-headline" id="Supported_IOCTLs"><b>Supported IOCTLs</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;action=edit&amp;section=17" title="Edit section: Supported IOCTLs">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ul><li>TI81XX_PCI_GET_BAR_INFO: Returns the size in bytes of the specified BAR.</li></ul>
<pre>int dev_desc;
dev_desc = open("/dev/ti81xx_pcie_ep", O_RDWR);
...
struct ti81xx_bar_info bar;
bar.num = bar_number;
ioctl(dev_desc, TI81XX_PCI_GET_BAR_INFO, &amp;bar);
...
</pre>
<p>In the above code fragment, the driver returns BAR size in 'size' field of the 'bar' structure object on success.
</p>
<ul><li>TI81XX_PCI_SET_BAR_WINDOW: Application can specify the internal address on EP for specified BAR. For example, the boot application sets BAR1 to OCMC1 start on EP (0x40400000) for TI816X EP using this ioctl.</li></ul>
<pre>...
struct ti81xx_bar_info bar;
bar.num = 1;
bar.addr = 0x40400000;
ioctl(dev_desc, TI81XX_PCI_SET_BAR_WINDOW, &amp;bar);
...
</pre>
<ul><li>TI81XX_PCI_SET_DWNLD_DONE: Set the bootflag on EP. The driver writes '1' to the location 0x4043FFFC on TI816X EP or at address 0x4031B7FC in case of TI814X EP and waits for the flag to be cleared till maximum of the time (in seconds) as specified by the application. Timeout of '0' means no wait for the flag clearing.</li></ul>
<pre>...
ioctl(dev_desc, TI81XX_PCI_SET_DWNLD_DONE, 3);
...
</pre>
<p>The IOCTL and data structure declarations are in drivers/char/ti81xx_pcie_bootdrv.h file in TI81XX kernel source.
</p>
<h3><span class="mw-headline" id="Source_Files"><b>Source Files</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;action=edit&amp;section=18" title="Edit section: Source Files">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The driver files are present at following path relative to extracted kernel source directory for TI81XX.
</p>
<ul><li>drivers/char/ti81xx_pcie_bootdrv.h</li>
<li>drivers/char/ti81xx_pcie_bootdrv.c</li></ul>
<h3><span class="mw-headline" id="Steps_for_Building_for_TI81XX_Kernel"><b>Steps for Building for TI81XX Kernel</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;action=edit&amp;section=19" title="Edit section: Steps for Building for TI81XX Kernel">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ul><li>The steps listed below cover building details for TI816X but similar steps are applicable for building TI814X/TI813X kernel with only differences being for TI814X, you will need to use TI814X kernel release (04.01.00.06 onwards) and the EVM default configuration name is <tt>ti8148_evm_defconfig</tt>, while for TI813X, latest kernel from <a rel="nofollow" class="external text" href="http://arago-project.org/git/projects/?p=linux-omap3.git;a=shortlog;h=refs/heads/ti81xx-master"><i>ti81xx-master</i></a> branch on Arago needs to be built with configuration <tt>dm385_evm_defconfig</tt></li>
<li>Navigate to TI81XX kernel source directory and extract the kernel source and create default TI8168 EVM configuration. Note that the release version  suffix used in example below can be any later PSP version.</li></ul>
<pre>LINUXHOST$ cd $PKGDIR/src/kernel
LINUXHOST$ tar -xzf linux-04.00.00.09.tar.gz
LINUXHOST$ cd linux-04.00.00.09
LINUXHOST$ make CROSS_COMPILE=arm-none-linux-gnueabi- ARCH=arm ti8168_evm_defconfig
</pre>
<ul><li>Enter the kernel configuration menu</li></ul>
<pre>LINUXHOST$ make CROSS_COMPILE=arm-none-linux-gnueabi- ARCH=arm menuconfig
</pre>
<ul><li>This will open the kernel configuration menu</li>
<li>Use DOWN Arrow key to till "Device Drivers" is highlighted</li></ul>
<pre>    General setup  ---&gt;
[*] Enable loadable module support  ---&gt;
...
Device Drivers  ---&gt;
</pre>
<ul><li>Press ENTER to go inside this section. Use DOWN Arrow key to select "Character devices"</li></ul>
<pre>    Generic Driver Options  ---&gt;
...
    Character devices  ---&gt;
</pre>
<ul><li>Again press ENTER and scroll down to select "TI81XX PCIe Endpoint Boot Driver". Press 'm' to enable to build as a loadable module.</li></ul>
<pre>-*- Virtual terminal
...
&lt;M&gt; TI81XX PCIe Endpoint Boot Driver
</pre>
<div style="padding: 5px; background: none repeat scroll 0% 0% rgb(238, 238, 238); color: rgb(21, 27, 84);">
<p><b>Note</b> that the above option will be shown only if PCI Bus support is enabled in kernel configuration. This is default in ti8168_evm_defconfig.
</p>
</div> 
<ul><li>Use RIGHT Arrow key to bring focus on 'Exit' and press ENTER. Repeat this to return to previous menu(s) and eventually back to the shell. Make sure to save the changes you have made when prompted at exit.</li>
<li>Build the driver</li></ul>
<pre>LINUXHOST$ make modules.
</pre>
<ul><li>The module will be built as drivers/char/ti81xx_pcie_bootdrv.ko</li>
<li>The above steps build the driver as loadable kernel module but it can also be built into kernel by pressing 'y' instead of 'm' in kernel menu configuration mentioned above.</li></ul>
<h3><span class="mw-headline" id="Steps_for_Building_for_x86_Kernel"><b>Steps for Building for x86 Kernel</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;action=edit&amp;section=20" title="Edit section: Steps for Building for x86 Kernel">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Following assumptions are made before proceeding to build the boot driver for PC:
</p>
<ul><li>The PC is running x86 Linux Kernel 2.6.32 or latest (till 2.6.37)</li>
<li>The source for the kernel running on the PC is available. We will assume this source is extracted in directory <tt>/home/builduser/kernel/src</tt> on the PC which is being used as RC.</li>
<li>The native GNU toolchain installed on the PC.</li>
<li>The user has 'root' or 'sudo' privileges on the PC host.</li></ul>
<p>Building the boot driver as loadable kernel module:
</p>
<ul><li>Transfer the boot driver files (.c and .h) to <tt>drivers/char</tt> folder inside kernel source directory, e.g.,</li></ul>
<pre>/home/builduser/kernel/src/drivers/char/ti81xx_pcie_bootdrv.h
/home/builduser/kernel/src/drivers/char/ti81xx_pcie_bootdrv.c
</pre>
<ul><li>Navigate to the kernel source directory</li></ul>
<pre>LINUXHOST$ cd /home/builduser/kernel/src 
</pre>
<ul><li>Open the <tt>Makefile</tt> in <tt>drivers/char</tt> and add following line at the end:</li></ul>
<pre>obj-m                           += ti81xx_pcie_bootdrv.o
</pre>
<ul><li>You may as well choose to build the driver into kernel in which case, the above line would be changed as:</li></ul>
<pre>obj-y                           += ti81xx_pcie_bootdrv.o
</pre>
<ul><li>Build the module:</li></ul>
<pre>LINUXHOST$ make modules
</pre>
<ul><li>You might get some warning related to type casting and/or section mismatch, these can be safely ignored.</li>
<li>The driver should get built as <tt>ti81xx_pcie_bootdrv.ko</tt> inside <tt>/home/builduser/kernel/src</tt> directory</li>
<li>Though the above steps consider x86 kernel, same should be applicable for any 32-bit kernel (2.6.32 or later till 2.6.37).</li></ul>
<h2><span class="mw-headline" id="U-Boot"><b>U-Boot</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;action=edit&amp;section=21" title="Edit section: U-Boot">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>For PCIe boot, the ROM on the EP directly jumps to the start of OCMC RAM when indicated by the boot driver (on RC) that the boot image is copied. <b>This means that the raw U-Boot binary (without any preceding header) must be used for booting.</b>
</p>
<h3><span class="mw-headline" id="TI816X">TI816X</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;action=edit&amp;section=22" title="Edit section: TI816X">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>For booting TI816X EP, the pre-built U-Boot binary u-boot.bin from $PKGDIR/images/u-boot/ti816x directory of TI816X release can be used.
</p><p>In case you need to make any changes or add/update autoboot delay/command, follow steps mentioned in TI81XX PSP U-Boot User Guide to obtain u-boot.bin generated as part of MMC/SD image build.
</p>
<h3><span class="mw-headline" id="TI814X">TI814X</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;action=edit&amp;section=23" title="Edit section: TI814X">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>For booting TI814X EP, you will need U-Boot binaries for 2 stages:
</p>
<ul><li>For 1st stage, you will need to build the U-Boot binary with following steps:</li></ul>
<dl><dd>1. Extract the U-Boot sources and navigate to the base directory of U-Boot source</dd>
<dd>2. Make sure that the complete build environment as required for U-Boot build is setup on Linux host. For details, refer U-Boot User Guide from the release package or online <a href="TI81XX_PSP_U-Boot.html" class="mw-redirect" title="TI81XX PSP U-Boot">here</a></dd>
<dd>3. Prepare the configuration for build</dd></dl>
<pre>make ti8148_evm_min_sd
</pre>
<dl><dd>4. Build U-Boot</dd></dl>
<pre>make
</pre>
<dl><dd>5. This will create u-boot.bin file, rename this to MLO</dd></dl>
<ul><li>For 2nd stage, you can use the pre-built U-Boot binary u-boot.bin from $PKGDIR/images/u-boot/ti814x directory</li></ul>
<div style="padding: 5px; background: none repeat scroll 0% 0% rgb(238, 238, 238); color: rgb(21, 27, 84);">
<p><b>Note:</b> You can even use the pre-built MLO image from the $PKGDIR/images/u-boot/ti814x in release package provided the first 8 bytes are removed using binary editor.
</p><p><b>TIP:</b> Use following command at Linux shell to strip off 8 bytes -
</p>
<pre># dd skip=8 if=MLO of=MLO.no_header bs=1
# mv MLO.no_header MLO  
</pre>
</div>
<h3><span class="mw-headline" id="TI813X">TI813X</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;action=edit&amp;section=24" title="Edit section: TI813X">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>For booting TI813X EP, you will need U-Boot binaries for 2 stages:
</p>
<ul><li>For 1st stage, you will need to build the U-Boot binary with following steps:</li></ul>
<dl><dd>1. Extract the U-Boot sources and navigate to the base directory of U-Boot source</dd>
<dd>2. Make sure that the complete build environment as required for U-Boot build is setup on Linux host. For details, refer U-Boot User Guide from the release package or online <a href="TI81XX_PSP_U-Boot.html" class="mw-redirect" title="TI81XX PSP U-Boot">here</a></dd>
<dd>3. Prepare the configuration for build</dd></dl>
<pre>make ti813x_evm_min_sd
</pre>
<dl><dd>4. Build U-Boot</dd></dl>
<pre>make
</pre>
<dl><dd>5. This will create u-boot.bin file, rename this to MLO</dd></dl>
<ul><li>For 2nd stage, re-configure U-Boot as</li></ul>
<pre>make ti813x_evm_config_sd
</pre>
<ul><li>Build u-boot.bin by followng command</li></ul>
<pre>make
</pre>
<h2><span class="mw-headline" id="PCIe_EP_Boot_Application"><b>PCIe EP Boot Application</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;action=edit&amp;section=25" title="Edit section: PCIe EP Boot Application">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>This application runs on TI81XX/x86 (or any other) RC running Linux and accesses the interfaces provided by the EP Boot Driver to download U-Boot, Kernel, etc images to EP and trigger EP boot. 
</p><p>You need not follow the build steps mentioned below if you want to use pre-built saBootApp ELF present in $PKGDIR/images/examples/pcie directory. Note that, this ELF is built to be executed on TI81XX RC. 
</p>
<h3><span class="mw-headline" id="Features_Supported_2"><b>Features Supported</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;action=edit&amp;section=26" title="Edit section: Features Supported">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ul><li>Download U-Boot, U-Boot bootscript, Kernel and (optionally) filesystem images to EP memory</li>
<li>Uses 2 stage boot loading in case of TI814X/TI813X EP -</li>
<li>Requires only 3 BARs (BAR0, BAR1 and BAR2) to perform complete boot operation. Uses EP boot driver to move internal EP windows to access OCMC and DDR.</li></ul>
<h3><span class="mw-headline" id="Features_NOT_Supported_2"><b>Features NOT Supported</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;action=edit&amp;section=27" title="Edit section: Features NOT Supported">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ul><li>Cannot operate without EP Boot Driver</li>
<li>Does not support ramdisk filesystem size greater than 8MB</li>
<li>Kernel image size limit is 8MB and bootscript size if 2MB maximum</li></ul>
<h3><span class="mw-headline" id="Steps_for_Building_for_TI81XX_RC"><b>Steps for Building for TI81XX RC</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;action=edit&amp;section=28" title="Edit section: Steps for Building for TI81XX RC">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ul><li>Navigate to TI81XX examples source directory</li></ul>
<pre>LINUXHOST$ cd $PKGDIR/examples/pcie
</pre>
<ul><li>Open file Makefile and set the path to kernel source directory as applicable. For more details, refer README file present in the directory.</li>
<li>Build the application by typing 'make' at the shell. This will create an ELF file named 'saBootApp'.</li></ul>
<h3><span class="mw-headline" id="Steps_for_Building_for_PC"><b>Steps for Building for PC</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;action=edit&amp;section=29" title="Edit section: Steps for Building for PC">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ul><li>Note all that assumptions listed earlier for building boot driver on x86 PC are applicable.</li>
<li>Create a directory for boot application source and Makefile. For simplicity, we will create a directory inside kernel source prepared earlier for building boot driver on PC.</li></ul>
<pre>LINUXHOST$ cd /home/builduser/kernel/src/  
LINUXHOST$ mkdir pci
</pre>
<ul><li>Copy saBootApp.c and Makefile to this directory</li>
<li>Edit Makefile to change following files</li></ul>
<pre>CC=arm-none-linux-gnueabi-gcc
KERNEL_DIR=../../linux-omap-2.6
CFLAGS=-I $(KERNEL_DIR)/include -I $(KERNEL_DIR)/arch/arm/include -I $(KERNEL_DIR)/drivers/char
</pre>
<ul><li>respectively, as follows:</li></ul>
<pre>CC=gcc
KERNEL_DIR=../
CFLAGS=-I $(KERNEL_DIR)/include -I $(KERNEL_DIR)/arch/x86/include -I $(KERNEL_DIR)/drivers/char
</pre>
<ul><li>Build the application</li></ul>
<pre>LINUXHOST$ make -C pci
</pre>
<ul><li>The boot application <tt>saBootApp</tt> should get built inside <tt>pci</tt> directory.</li></ul>
<h3><span class="mw-headline" id="Tuning_Boot_Application"><b>Tuning Boot Application</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;action=edit&amp;section=30" title="Edit section: Tuning Boot Application">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>In some cases, the defaults chosen by the boot application may require to be changed. Various such options are covered below with their default settings. Note that in such case, you cannot use the pre-built Boot Application ELF file and will need to build the application as mentioned above. 
</p><p>Following options are defined in saBootApp.c file: -
</p>
<ul><li>CONFIG_IGNORE_BOOTFLAG_FAIL: This flag is enabled by default (set to '1') which directs the boot application to proceed even if the boot flag is not cleared. This is enabled currently since present U-Boot doesn't clear the boot flag and having this flag enables the boot application to proceed to load kernel and boot EP. You can set this flag to '0' if you update the U-Boot to clear the boot flag after setting DDR (refer Boot ROM spec for location of boot flag).</li>
<li>CONFIG_BOOTFLAG_FAIL_DELAY: Time in seconds to wait for boot flag to be cleared. Default is 3 sec. You can lower/increase this value if you face booting issues</li></ul>
<p>Additional configuration options such as load addresses for various images, etc., are present in Boot Driver header file ti81xx_pcie_bootdrv.h located in $PKGDIR/src/kernel/linux-04.00.00.09/driver/char directory and are used by the boot application.
</p>
<h2><span class="mw-headline" id="PCIe_EP_U-Boot_Boot_Script"><b>PCIe EP U-Boot Boot Script</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;action=edit&amp;section=31" title="Edit section: PCIe EP U-Boot Boot Script">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>In PCIe boot scenario, the U-Boot environment storage may not be available on EP. In such cases loading a U-Boot script file (referred as 'bootscript') on EP with various environment variables set helps simulating environment storage. This also adds flexibility in a way that the various boot parameters such as kernel boot arguments, filesystem type, paths for EP can be changed though this script without any need to rebuild the U-Boot or need to explicitly set the U-Boot environment variables on EP. Also, setting U-Boot parameters on EP will require to have UART console connected to EP every time. 
</p>
<h3><span class="mw-headline" id="Creating_U-Boot_Script"><b>Creating U-Boot Script</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;action=edit&amp;section=32" title="Edit section: Creating U-Boot Script">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ul><li>Refer sample script file named bootscript.txt is provided in $PKGDIR/src/examples/pcie directory.</li>
<li>Edit/add parameters as per your requirement. The default script sets up kernel to use RAMDISK image.</li>
<li>You will need U-Boot's 'mkimage' utility to build the script image from this file. Refer <a href="TI81XX_PSP_U-Boot.html" class="mw-redirect" title="TI81XX PSP U-Boot">U-Boot User Guide</a> for details about 'mkimage'</li>
<li>Ensure that the PATH is set to point to 'mkimage'</li>
<li>Build the boot script as</li></ul>
<pre>LINUXHOST$ cd $PKGDIR/src/examples/pcie
LINUXHOST$ mkimage -A arm -O linux -T script -C none -n 'PCIe Boot Script' -d bootscript.txt boot.scr
</pre>
<ul><li>Alternatively, for booting TI816X EP, you can use pre-built boot.scr present inside $PKGDIR/images/examples/pcie directory. This is built from sample bootscript.txt</li></ul>
<div style="padding: 5px; background: none repeat scroll 0% 0% rgb(238, 238, 238); color: rgb(21, 27, 84);">
<p><b>Note:</b> The sample boot script packaged in release is for TI816X EP only and needs to be changed and re-built for TI814X/TI813X EP. Especially, ttyO2 needs to be changed to ttyO0 for TI814X/TI813X boot arguments.  
</p>
</div>
<h3><span class="mw-headline" id="Auto_Booting_with_the_Bootscript"><b>Auto Booting with the Bootscript</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;action=edit&amp;section=33" title="Edit section: Auto Booting with the Bootscript">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>This approach requires modifying and re-building U-Boot. The release version numbers used in examples below will vary depending upon the TI81XX PSP release being used.
</p>
<div style="padding: 5px; background: none repeat scroll 0% 0% rgb(238, 238, 238); color: rgb(21, 27, 84);">
<p><b>Note:</b> The current U-Boot default boot command is set to load the bootscript from MMC. Thus, pre-built u-boot.bin U-Boot binary from the release package, loaded on EP using boot application will not auto boot the kernel image downloaded over PCIe. The same issue applies if the U-Boot is built from source for SD boot. In case of TI814X/TI813X, other 1st stage U-Boot modes select autoload of 2nd stage from respective boot medium/methods, thus will bypass loading U-Boot downloaded over PCIe.  
</p>
</div> 
<p>This can be resolved by directing the U-Boot running on EP to load the bootscript from DDR location 0x80400000 (as loaded by the boot application) in case of TI816X U-Boot as well as TI814X/TI813X 2nd stage U-Boot. In addition, for TI814X/TI813X where 2 stage boot loading is used, the 1st stage U-Boot needs to be directed to autoload 2nd stage U-Boot from DDR. 
</p><p>This can be done as described in following sections: 
</p>
<h4><span class="mw-headline" id="Updating_U-Boot"><b>Updating U-Boot</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;action=edit&amp;section=34" title="Edit section: Updating U-Boot">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<h4><span class="mw-headline" id="TI816X_2">TI816X</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;action=edit&amp;section=35" title="Edit section: TI816X">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<ul><li>Navigate to $PKGDIR/src/u-boot directory and extract U-Boot source tarball</li></ul>
<pre>LINUXHOST$ cd $PKGDIR/src/u-boot
LINUXHOST$ tar -xzf u-boot-04.00.00.09.tar.gz
LINUXHOST$ cd u-boot-04.00.00.09
</pre>
<ul><li>Edit include/configs/ti8168_evm.h file to change <tt>CONFIG_BOOTCOMMAND</tt> as below:</li></ul>
<pre>#define CONFIG_BOOTCOMMAND "source 0x80400000"
</pre>
<ul><li>Build the U-Boot</li></ul>
<pre>LINUXHOST$ make CROSS_COMPILE=arm-none-linux-gnueabi- ti8168_evm_config 
LINUXHOST$ make CROSS_COMPILE=arm-none-linux-gnueabi-
</pre>
<ul><li>Note that in the 1st step above, you can chose U-Boot configuration for any boot mode other than NOR boot mode.</li></ul>
<h4><span id="TI814X/TI813X"></span><span class="mw-headline" id="TI814X.2FTI813X">TI814X/TI813X</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;action=edit&amp;section=36" title="Edit section: TI814X/TI813X">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Extract the U-Boot source as per the approach described above and open following file to update: 
</p>
<ul><li>TI814X: include/configs/ti8148_evm.h</li>
<li>TI813X: include/configs/ti813x_evm.h</li></ul>
<p>For 1st stage U-Boot, change <tt>bootcmd</tt> as part of <tt>CONFIG_EXTRA_ENV_SETTINGS</tt> for respective boot mode configuration being used:
</p><p>E.g., for TI813X when using SD boot 1st stage U-Boot,
</p>
<ul><li>Go inside the CONFIG_TI813X_MIN_CONFIG section in the above file and look for following</li></ul>
<pre># elif defined(CONFIG_SD_BOOT)          /* Autoload the 2nd stage from SD */
</pre>
<ul><li>In CONFIG_EXTRA_ENV_SETTINGS, set the bootcmd (removing original line for bootcmd) as</li></ul>
<pre>"bootcmd=go 0x80800000\0" \
</pre>
<ul><li>Save the file and build U-Boot</li></ul>
<pre>LINUXHOST$ make clean 
LINUXHOST$ make ti813x_evm_min_sd
LINUXHOST$ make
</pre>
<ul><li>Use the u-boot.bin built in the above step as 1st stage U-Boot (MLO)</li></ul>
<p>For 2nd stage U-Boot, change <tt>bootcmd</tt> as part of <tt>CONFIG_BOOTCOMMAND</tt>:
</p><p>E.g., for TI813X,
</p>
<ul><li>Go inside the #else part of CONFIG_TI813X_MIN_CONFIG section in the EVM header file mentioned above and look for following</li></ul>
<pre># define CONFIG_BOOTCOMMAND \
</pre>
<ul><li>Replace the #define as follows to run bootscript</li></ul>
<pre>#define CONFIG_BOOTCOMMAND "source 0x80400000"
</pre>
<ul><li>Save and build the 2nd stage for desired medium (e.g., SD)</li></ul>
<pre>LINUXHOST$ make clean 
LINUXHOST$ make ti813x_evm_config_sd
LINUXHOST$ make
</pre>
<ul><li>The u-boot.bin built in above step can be used as 2nd stage U-Boot.</li></ul>
<div style="padding: 5px; background: none repeat scroll 0% 0% rgb(238, 238, 238); color: rgb(21, 27, 84);">
<p><b>Note:</b> bootcmd set explicitly in storage medium used will take precedence over the bootcmd set above in the source. 
</p>
</div>
<h4><span class="mw-headline" id="Saving_Boot_Command_on_EP_Storage"><b>Saving Boot Command on EP Storage</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;action=edit&amp;section=37" title="Edit section: Saving Boot Command on EP Storage">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>This approach requires access to U-Boot console and availability of persistent storage such as NAND on EP.
</p><p>In case of TI814X/TI813X, this is only possible for 2nd stage U-Boot. 
</p>
<ul><li>Boot U-Boot on EP using PCIe Boot procedure described in next sections</li>
<li>Halt U-Boot countdown by pressing ENTER at EP console</li>
<li>Set 'bootcmd' at U-Boot prompt on EP as:</li></ul>
<pre>set bootcmd 'source 0x80400000'
saveenv
</pre>
<ul><li>Note that this is a one time operation and U-Boot will jump to correct script location on subsequent resets.</li></ul>
<h2><span class="mw-headline" id="Building_Kernel_for_EP"><b>Building Kernel for EP</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;action=edit&amp;section=38" title="Edit section: Building Kernel for EP">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<div style="padding: 5px; background: none repeat scroll 0% 0% rgb(238, 238, 238); color: rgb(21, 27, 84);">
<p><b>Note:</b> The change mentioned below is not needed for TI814X when using release 04.01.00.05 or older and the kernel uImage built with ti8148_evm_defconfig can be used. For 04.01.00.06 and onwards release of TI814X kernel, the steps mentioned below should be followed since they have Root Complex support included. For TI813X, the steps below are only needed if you use latest kernel from Arago.
</p>
</div>
<p>As mentioned earlier in this section, the kernel built with PCIe RC support will result into conflicting configuration when booted on EP. To avoid this, it is recommended to rebuild the kernel with PCIe RC support disabled. 
</p>
<ul><li>As explained before, extract kernel source tarball and enter kernel configuration menu.</li></ul>
<pre>    General setup  ---&gt;
[*] Enable loadable module support  ---&gt;
-*- Enable the block layer  ---&gt;
   System Type  ---&gt;
   Bus support  ---&gt;
...
</pre>
<ul><li>Scroll down with the DOWN Arrow key till "Bus Support" gets selected. Press ENTER. This will show following menu:</li></ul>
<pre>[*] PCI support
[*] Message Signaled Interrupts (MSI and MSI-X)
...
</pre>
<ul><li>Disable "PCI support" by pressing 'n' key or SPACE key. This will automatically hide other dependent configurations and the above configuration menu will look like as shown below:</li></ul>
<pre>[ ] PCI support 
&lt; &gt; PCCard (PCMCIA/CardBus) support  ---&gt;
</pre>
<ul><li>Use RIGHT Arrow key to bring focus on 'Exit' and press ENTER. Repeat this to return to previous menu(s) and eventually back to the shell. Make sure to save the changes you have made when prompted at exit.</li>
<li>Build the kernel.</li></ul>
<h2><span class="mw-headline" id="Updating_the_Filesystem"><b>Updating the Filesystem</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;action=edit&amp;section=39" title="Edit section: Updating the Filesystem">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The kernel may not boot or provide shell prompt when the boot driver is built into kernel. This issue is due to the device node numbers (major numbers) used for console device(s) not getting updated as udev in the filesystem still uses stale nodes from the device cache in the filesystem even on detection or removal of EP device across RC reboots.
</p><p>This issue can be avoided by forcing the rebuild of device cache on detecting change in boot time device detection. This can be achieved by updating the filesystem as follows:
</p>
<ul><li>Add following check in /etc/rcS.d/S03udev inside DEVCACHE block</li></ul>
<pre>[ -r /proc/devices ] &amp;&amp; cat /proc/devices &gt; /tmp/devices || touch /tmp/devices
</pre>
<ul><li>Similarly, add comparison for saved device list to detect changes in devices</li></ul>
<pre>cmp -s /tmp/devices /etc/udev/saved.devices &amp;&amp; \
</pre>
<ul><li>Now the devcache block will look as follows</li></ul>
<pre>if [ "$DEVCACHE"&#160;!= "" ]; then
        # Invalidate udev cache if the kernel or its bootargs/cmdline have changed
        [ -x /bin/uname ] &amp;&amp; /bin/uname -mrspv &gt; /tmp/uname || touch /tmp/uname
        [ -r /proc/cmdline ] &amp;&amp; cat /proc/cmdline &gt; /tmp/cmdline || touch /tmp/cmdline
        [ -r /proc/devices ] &amp;&amp; cat /proc/devices &gt; /tmp/devices || touch /tmp/devices
        [ -r /proc/atags ] &amp;&amp; cat /proc/atags &gt; /tmp/atags || touch /tmp/atags
        if [ -e $DEVCACHE ] &amp;&amp; \
           cmp -s /tmp/uname /etc/udev/saved.uname &amp;&amp; \
           cmp -s /tmp/cmdline /etc/udev/saved.cmdline &amp;&amp; \
           cmp -s /tmp/devices /etc/udev/saved.devices &amp;&amp; \
           cmp -s /tmp/atags /etc/udev/saved.atags; then
                (cd /; tar xf $DEVCACHE &gt; /dev/null 2&gt;&amp;1)
                not_first_boot=1
        fi
fi
</pre>
<ul><li>Update udev devcache script /etc/rcS.d/S12udev-cache to save device list by adding following line</li></ul>
<pre>mv /tmp/devices /etc/udev/saved.devices
</pre>
<ul><li>Update the same file with a line to delete temporary device list</li></ul>
<pre>rm -f /tmp/devices
</pre>
<ul><li>Now the dev cache code in this file will look like</li></ul>
<pre>if [ "$DEVCACHE"&#160;!= "" ]; then
        echo -n "Populating dev cache"
        (cd /; tar cf $DEVCACHE dev)
        mv /tmp/uname /etc/udev/saved.uname
        mv /tmp/cmdline /etc/udev/saved.cmdline
        mv /tmp/atags /etc/udev/saved.atags
        mv /tmp/devices /etc/udev/saved.devices
        echo
else
        rm -f /tmp/uname
        rm -f /tmp/cmdline
        rm -f /tmp/atags
        rm -f /tmp/devices
fi
</pre>
<ul><li>The above changes will ensure that udev will rebuild the device cache depending upon detection of PCIe EP presence or removal across RC reboots.</li></ul>
<p>Other simpler (but not recommended) option is to turn of the device cache altogether. This can be done by commenting the DEVCACHE line in /etc/default/udev of the filesystem.
</p>
<h2><span class="mw-headline" id="Updating_the_RC_Kernel"><b>Updating the RC Kernel</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;action=edit&amp;section=40" title="Edit section: Updating the RC Kernel">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<pre><b>Note:</b> You will need RC kernel source to follow this section.
</pre>
<p>If you are using a non-TI81XX Root Complex device, you will need to patch the kernel to assign a valid class code to the TI816X EP detected. This is required because, TI816X devices configured to boot as PCIe Endpoint have class code = 0. This makes kernel PCI bus code to skip allocating BARs to these devices resulting into following type of error when trying to enable them:
</p>
<pre>"Device 0000:01:00.0 not available because of resource collisions"
</pre>
<p>The device cannot be operated because of the above issue.
</p><p>Following patch would be required to be applied on RC kernel. Copy and save the text below in a file and apply patch using <tt>patch -p 1 -i &lt;filename&gt;</tt> command (replace &lt;filename&gt; with the name of the file where the patch is saved) in the RC kernel source tree.
</p>
<pre>diff --git a/drivers/pci/quirks.c b/drivers/pci/quirks.c
index 53a786f..2087f3d 100644
--- a/drivers/pci/quirks.c
+++ b/drivers/pci/quirks.c
@@ -2791,6 +2791,17 @@ DECLARE_PCI_FIXUP_EARLY(PCI_VENDOR_ID_INTEL, 0x342e, vtd_mask_spec_errors);
 DECLARE_PCI_FIXUP_EARLY(PCI_VENDOR_ID_INTEL, 0x3c28, vtd_mask_spec_errors);
 #endif

+static void __devinit fixup_ti81xx_class(struct pci_dev* dev)
+{
+       /* TI 81xx devices do not have class code set when in PCIe boot mode */
+       if (dev-&gt;class == PCI_CLASS_NOT_DEFINED) {
+               dev_info(&amp;dev-&gt;dev, "Setting PCI class for 81xx PCIe device\n");
+               dev-&gt;class = PCI_CLASS_MULTIMEDIA_VIDEO;
+       }
+}
+DECLARE_PCI_FIXUP_EARLY(PCI_VENDOR_ID_TI, 0xb800, fixup_ti81xx_class);
+DECLARE_PCI_FIXUP_EARLY(PCI_VENDOR_ID_TI, 0xb801, fixup_ti81xx_class);
+
 static void pci_do_fixups(struct pci_dev *dev, struct pci_fixup *f,
                          struct pci_fixup *end)
 {
</pre>
<p><b>Note 1:</b> You may need to manually resolve conflicts if RC kernel version is not 2.6.37.<br />
<b>Note 2:</b> The above patch is not required to be applied if the RC is TI81XX and kernel used is from release 04.00.00.09 or onwards since it already comes with above patch applied.
</p>
<div style="padding: 5px; background: none repeat scroll 0% 0% rgb(238, 238, 238); color: rgb(21, 27, 84);">
<p><b>Note:</b> The above mentioned patch is needed only when you are relying on resource assignment from kernel. If the kernel is just using BIOS allocated resources (which is normal case on PCs), you need not apply this patch. Of course your device will be labeled as "unclassified" device when using a kernel without this patch.
</p>
</div>
<p>For example:
</p>
<pre>LINUXHOST$ sudo lspci -v
...
 01:00.0 Non-VGA unclassified device: Texas Instruments Device b800 (rev 01)
    Flags: bus master, fast devsel, latency 0, IRQ 11
    Memory at fe9ff000 (32-bit, non-prefetchable) [size=4K]
    Memory at f0800000 (32-bit, prefetchable) [size=8M]
    Memory at f0000000 (32-bit, prefetchable) [size=8M]
    Memory at &lt;unassigned&gt; (32-bit, prefetchable)
    Capabilities: [40] Power Management version 3
    Capabilities: [50] Message Signalled Interrupts: Mask- 64bit+ Queue=0/0 Enable-
    Capabilities: [70] Express Endpoint, MSI 00
    Capabilities: [100] Advanced Error Reporting &lt;?&gt;
...
</pre>
<h1><span class="mw-headline" id="Ensuring_the_PCIe_System_Initialization"><b>Ensuring the PCIe System Initialization</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;action=edit&amp;section=41" title="Edit section: Ensuring the PCIe System Initialization">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>Before proceeding to using the TI81XX PCIe EP in the system, we must ensure that the RC is up and has detected and configured the PCIe EP. Steps mentioned below should be carried out before actually accessing the EP and proceeding for boot.
</p>
<ul><li>Make sure that the board setup instructions mentioned in earlier section are followed.</li>
<li>Power on EP</li>
<li>Power on RC</li>
<li>Once shell is available at RC, type 'lspci' command, it should show following two devices (EP in this example is TI816X):</li></ul>
<pre>ti8168-evm# lspci -v
00:00.0 Class 0604: Device 104c:8888 (rev 01)
        Flags: bus master, fast devsel, latency 0
        Memory at &lt;ignored&gt; (32-bit, non-prefetchable)
        Memory at &lt;ignored&gt; (32-bit, prefetchable)
        Bus: primary=00, secondary=01, subordinate=01, sec-latency=0
        Memory behind bridge: 21000000-210fffff
        Prefetchable memory behind bridge: 20000000-20ffffff
        Capabilities: [40] Power Management version 3
        Capabilities: [50] MSI: Enable- Count=1/1 Maskable- 64bit+
        Capabilities: [70] Express Root Port (Slot-), MSI 00
        Capabilities: [100] Advanced Error Reporting<br />
01:00.0 Class 0004: Device 104c:b800 (rev 01)
        Flags: fast devsel, IRQ 48
        Memory at 21000000 (32-bit, non-prefetchable) [size=4K]
        Memory at 20000000 (32-bit, prefetchable) [size=8M]
        Memory at 20800000 (32-bit, prefetchable) [size=8M]
        Memory at &lt;unassigned&gt; (32-bit, prefetchable)
        Capabilities: [40] Power Management version 3
        Capabilities: [50] MSI: Enable- Count=1/1 Maskable- 64bit+
        Capabilities: [70] Express Endpoint, MSI 00
        Capabilities: [100] Advanced Error Reporting
</pre>
<ul><li>If 'lspci' is not available in your filesystem, look into <tt>/sys/bus/pci/devices</tt> directory to see if EP is detected. You should see two sub directories in this directory, e.g., see following command and its output:</li></ul>
<pre>cat /sys/bus/pci/devices/0000\:0*/device
 0x8888
 0xb800
</pre>
<ul><li>The first device is RC itself and the second device is EP</li>
<li>Note that, in case the x86 PC is used as RC, the "lspci" would only show TI816X EP along with other PCI/PCIe devices connected to PC motherboard.</li>
<li>Notice that the EP is allocated three BARs - BAR0, BAR1 and BAR2 of size 4KB, 8MB and 8MB respectively.</li>
<li>In case the EP is TI814X/TI813X device, BAR2 size will be 16MB</li></ul>
<h1><span class="mw-headline" id="Load_Addresses"><b> Load Addresses</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;action=edit&amp;section=42" title="Edit section: Load Addresses">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>The boot application loads various images at following addresses on EP:
</p>
<table border="1" cellspacing="0" cellpadding="4" rules="all" style="margin:1em 1em 1em 0; border:solid 1px #aaa; border-collapse:collapse;empty-cells:show;">
  
<tbody><tr>
<th>Image
</th>
<th>EP Device
</th>
<th>Load Address
</th></tr>
<tr>
<td>U-Boot 1st Stage
</td>
<td>TI814X/TI813X
</td>
<td>0x40300000
</td></tr>
<tr>
<td rowspan="2">U-Boot
</td>
<td>TI816X
</td>
<td>0x40400000
</td></tr>
<tr>
<td>TI814X/TI813X (2nd Stage)
</td>
<td>0x80800000
</td></tr>
<tr>
<td rowspan="2">Kernel
</td>
<td>TI816X
</td>
<td rowspan="2">0x80900000
</td></tr>
<tr>
<td>TI814X/TI813X
</td></tr>
<tr>
<td rowspan="2">Ramdisk
</td>
<td>TI816X
</td>
<td rowspan="2">0x81000000
</td></tr>
<tr>
<td>TI814X/TI813X
</td></tr>
<tr>
<td rowspan="2">Bootscript
</td>
<td>TI816X
</td>
<td rowspan="2">0x80400000
</td></tr>
<tr>
<td>TI814X/TI813X
</td></tr></tbody></table>
<h1><span class="mw-headline" id="Booting_EP"><b>Booting EP</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;action=edit&amp;section=43" title="Edit section: Booting EP">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<ul><li>Download PCIe EP Boot driver, U-Boot, U-Boot script, kernel image and ramdisk file (optional) on RC.</li>
<li>These files can be downloaded over network using TFTP or can be copied to NFS mounted filesystem</li>
<li>In our example, we will use following commands on RC:</li></ul>
<pre>ti8168-evm# tftp -m binary 192.168.0.1 -c get ti81xx_pcie_bootdrv.ko
ti8168-evm# tftp -m binary 192.168.0.1 -c get saBootApp
ti8168-evm# tftp -m binary 192.168.0.1 -c get u-boot.bin
ti8168-evm# tftp -m binary 192.168.0.1 -c get boot.scr
ti8168-evm# tftp -m binary 192.168.0.1 -c get uImage
ti8168-evm# tftp -m binary 192.168.0.1 -c get ramdisk.gz
</pre>
<div style="padding: 5px; background: none repeat scroll 0% 0% rgb(238, 238, 238); color: rgb(21, 27, 84);">
<p><b>Note:</b> Additionally, transfer the 1st stage U-Boot MLO used for MMC/SD boot in case of TI814X/TI813X EP. 
</p>
</div>
<ul><li>Make boot application as executable:</li></ul>
<pre>ti8168-evm# chmod a+x saBootApp
</pre>
<ul><li>Insert boot driver:</li></ul>
<pre>ti8168-evm# insmod ti81xx_pcie_bootdrv.ko
 ti81xx_pcie_ep: Found TI816x PCIe EP @0xc781ec00
 pci 0000:01:00.0: This driver supports booting the first TI816x or TI814x target found on the bus
 pci 0000:01:00.0: Major number 253 assigned
 pci 0000:01:00.0: Added device to the sys file system
 pci 0000:01:00.0: BAR Configuration -
            Start        |       Length  |       Flags
 pci 0000:01:00.0:       0x21000000      |       4096    |       0x00040200
 pci 0000:01:00.0:       0x20000000      |       8388608 |       0x00042208
 pci 0000:01:00.0:       0x20800000      |       8388608 |       0x00042208
 pci 0000:01:00.0: TI81XX registers mapped to 0xc8886000
 pci 0000:01:00.0: TI81XX OCMC1 mapped to 0xca000000
 pci 0000:01:00.0: TI81XX DDR mapped to 0xcb000000
</pre>
<div style="padding: 5px; background: none repeat scroll 0% 0% rgb(238, 238, 238); color: rgb(255, 0, 0);">
<p><b>Note:</b> Due to an errata on PCIe ROM boot mode of TI813X devices, the execution on EP needs to be reset (from RC) before carrying out normal boot process. Since the TI813X EP comes up with device ID same as TI814X, the EP driver cannot distinguish between TI814X and TI813X and user needs to pass module parameter <tt>eprst=1</tt> in case TI813X PCIe ROM boot mode is used. This will direct the driver to execute errata workaround to reset EP.
</p><p>E.g., the <tt>insmod</tt> command on RC when using TI813X EP in ROM PCIe boot mode should then be,
</p>
<pre> ti8168-evm# insmod ti81xx_pcie_bootdrv.ko <b>eprst=1</b>
</pre>
</div>
<ul><li>Or, if the Linux PC is set up as as RC (assuming the source directory mentioned in earlier sections is used):</li></ul>
<pre>LINUXHOST$ cd /home/builduser/kernel/src/
LINUXHOST$ sudo insmod drivers/char/ti81xx_pcie_bootdrv.ko
</pre>
<ul><li>The above log shows that three BARs on the EP are set up with 4KB, 8MB and 8MB size respectively.</li>
<li>You may need to create node "/dev/ti81xx_pcie_ep" with the major number displayed when PCIe Boot Driver module is inserted. This depends on the filesystem and configuration, e.g., 'udev' should do this automatically.</li>
<li>In case the device node is not created automatically, use following command sequence:</li></ul>
<pre>ti8168-evm# cat /proc/devices
 Character devices:
    1 mem
   &#160;:
   &#160;: 
    253 ti81xx_pcie_ep            &lt;--- Our device major number is 253
   &#160;:
ti8168-evm# mknod /dev/ti81xx_pcie_ep c 253 0
</pre>
<ul><li>Run the boot application providing U-Boot, bootscript, kernel and ramdisk names as:</li></ul>
<pre>ti8168-evm# ./saBootApp u-boot.bin boot.scr uImage ramdisk.gz
</pre>
<ul><li>For TI814X/TI813X EP, ensure that MLO binary is present in same directory as boot application</li>
<li>Or on PC (assuming all required binaries are present in current directory):</li></ul>
<pre>LINUXHOST$ sudo ./saBootApp u-boot.bin boot.scr uImage ramdisk.gz 
</pre>
<ul><li>Alternatively, you can use NFS root system on EP by updating the bootscript.txt accordingly and using the corresponding bootscript image. In this case, you need not download the ramdisk image.</li></ul>
<pre>ti8168-evm# ./saBootApp u-boot.bin boot.scr uImage
</pre>
<ul><li>The boot application will use boot driver to configure the EP and download the images to complete boot operation.</li></ul>
<div style="padding: 5px; background: none repeat scroll 0% 0% rgb(238, 238, 238); color: rgb(21, 27, 84);">
<p><b>Note:</b> You will see some messages about "Bootflag clear timed out" during the boot process. This is normal since the current U-Boot doesn't support clearing the boot flag in OCMC1 RAM at EP (location 0x40403FFC in case of TI816X EP and 0x4031b7fc for TI814X/TI813X) as set by the PCIe Boot code running on RC. The application will still proceed to complete boot operation.
</p>
</div>
</div>
<!-- 
NewPP limit report
Cached time: 20201201001421
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.111 seconds
Real time usage: 0.115 seconds
Preprocessor visited node count: 226/1000000
Preprocessor generated node count: 329/1000000
Postexpand include size: 668/2097152 bytes
Template argument size: 66/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip postexpand size: 962/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    5.490      1 -total
 28.51%    1.565      1 Template:SpArticleStart
 27.23%    1.495      1 Template:SpLicenseCC-SA
 25.15%    1.381      1 Template:Prettytable
-->
</div>
<!-- Saved in parser cache with key procwiki:pcache:idhash:15254-0!canonical and timestamp 20201201001421 and revision id 124077
 -->
<div class='hf-nsfooter' id='hf-nsfooter-'><table style="text-align:center; background:white; width:100%; text-align:left; height: 65px border-top: 1px solid; border-bottom: 1px solid; border-left: 1px solid; border-right: 1px solid; border-width: 1px; border-style: solid;">
<tr>
<td width="305px"><a href="File_E2e.html" class="image"><img alt="E2e.jpg" src="https://processors.wiki.ti.com/images/8/82/E2e.jpg" width="305" height="63" /></a>
</td>
<td>{{
<ol><li>switchcategory:MultiCore=</li></ol>
<ul><li>For technical support on MultiCore devices, please post your questions in the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/c6000_multi-core_dsps/default.aspx">C6000 MultiCore Forum</a></li>
<li>For questions related to the BIOS MultiCore SDK (MCSDK), please use the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/embedded/f/355.aspx">BIOS Forum</a></li></ul>
<p>Please post only comments related to the article <b>TI81XX PSP PCI Express Endpoint Boot Driver User Guide</b> here.<i></i>
</p>
</td>
<td>Keystone=
<ul><li>For technical support on MultiCore devices, please post your questions in the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/c6000_multi-core_dsps/default.aspx">C6000 MultiCore Forum</a></li>
<li>For questions related to the BIOS MultiCore SDK (MCSDK), please use the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/embedded/f/355.aspx">BIOS Forum</a></li></ul>
<p>Please post only comments related to the article <b>TI81XX PSP PCI Express Endpoint Boot Driver User Guide</b> here.<i></i>
</p>
</td>
<td>C2000=<i>For technical support on the C2000 please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/microcontrollers/tms320c2000_32-bit_real-time_mcus/f/171.aspx">The C2000 Forum</a>. Please post only comments about the article <b>TI81XX PSP PCI Express Endpoint Boot Driver User Guide</b> here.</i>
</td>
<td>DaVinci=<i>For technical support on DaVincoplease post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/davinci_digital_media_processors/default.aspx">The DaVinci Forum</a>. Please post only comments about the article <b>TI81XX PSP PCI Express Endpoint Boot Driver User Guide</b> here.</i>
</td>
<td>MSP430=<i>For technical support on MSP430 please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/microcontrollers/msp43016-bit_ultra-low_power_mcus/default.aspx">The MSP430 Forum</a>. Please post only comments about the article <b>TI81XX PSP PCI Express Endpoint Boot Driver User Guide</b> here.</i>
</td>
<td>OMAP35x=<i>For technical support on OMAP please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/omap_applications_processors/default.aspx">The OMAP Forum</a>. Please post only comments about the article <b>TI81XX PSP PCI Express Endpoint Boot Driver User Guide</b> here.</i>
</td>
<td>OMAPL1=<i>For technical support on OMAP please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/omap_applications_processors/default.aspx">The OMAP Forum</a>. Please post only comments about the article <b>TI81XX PSP PCI Express Endpoint Boot Driver User Guide</b> here.</i>
</td>
<td>MAVRK=<i>For technical support on MAVRK please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/development_tools/mavrk/default.aspx">The MAVRK Toolbox Forum</a>. Please post only comments about the article <b>TI81XX PSP PCI Express Endpoint Boot Driver User Guide</b> here.</i>
</td>
<td><i>For technical support please post your questions at <a rel="nofollow" class="external text" href="http://e2e.ti.com/">http://e2e.ti.com</a>. Please post only comments about the article <b>TI81XX PSP PCI Express Endpoint Boot Driver User Guide</b> here.</i>
<p>}}
</p>
</td></tr></table>
<table style="border-style:solid; border-width:1px; text-align:center; width:100%;">

<tr style="font-size:150%;">
<td rowspan="2"><a href="File_Hyperlink_blue.html" class="image"><img alt="Hyperlink blue.png" src="https://processors.wiki.ti.com/images/9/9f/Hyperlink_blue.png" width="96" height="96" /></a>
</td>
<td><b>Links</b>
</td></tr>
<tr>
<td>
<table style="text-align: left;">
<tr>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/amplifier_and_linear.page">Amplifiers &amp; Linear</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/audio/audio_overview.page">Audio</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/rfif.page">Broadband RF/IF &amp; Digital Radio</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/clocksandtimers/clocks_and_timers.page">Clocks &amp; Timers</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/dataconverters/data_converter.page">Data Converters</a>
</p>
</td>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/mems/mems.page">DLP &amp; MEMS</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/high_reliability.page">High-Reliability</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/interface/interface.page">Interface</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/logic/home_overview.page">Logic</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/powermanagement/power_portal.page">Power Management</a>
</p>
</td>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/dsp/embedded_processor.page">Processors</a>
</p>
<ul><li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/dsp/arm.page">ARM Processors</a></li>
<li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/dsp/home.page">Digital Signal Processors (DSP)</a></li>
<li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/microcontroller/home.page">Microcontrollers (MCU)</a></li>
<li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/omap-applications-processors/the-omap-experience.page">OMAP Applications Processors</a></li></ul>
</td>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/switches_and_multiplexers.page">Switches &amp; Multiplexers</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/temperature_sensor.page">Temperature Sensors &amp; Control ICs</a><br/>
<a rel="nofollow" class="external text" href="http://focus.ti.com/wireless/docs/wirelessoverview.tsp?familyId=2003&amp;sectionId=646&amp;tabId=2735">Wireless Connectivity</a>
</p>
</td></tr></table>
</td></tr></table>
<div id="tiPrivacy"></div>
</div></div>					<div class="printfooter">
						Retrieved from "<a dir="ltr" href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;oldid=124077">https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;oldid=124077</a>"					</div>
				<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="Special_Categories.html" title="Special:Categories">Categories</a>: <ul><li><a href="Category_TI816X-2.html" title="Category:TI816X">TI816X</a></li><li><a href="Category_AM389x.html" title="Category:AM389x">AM389x</a></li><li><a href="Category_TI814X.html" title="Category:TI814X">TI814X</a></li><li><a href="Category_AM387x.html" title="Category:AM387x">AM387x</a></li><li><a href="Category_DaVinci.html" title="Category:DaVinci">DaVinci</a></li><li><a href="Category_PSP.html" title="Category:PSP">PSP</a></li></ul></div></div>				<div class="visualClear"></div>
							</div>
		</div>
		<div id="mw-navigation">
			<h2>Navigation menu</h2>
			<div id="mw-head">
									<div id="p-personal" role="navigation" class="" aria-labelledby="p-personal-label">
						<h3 id="p-personal-label">Personal tools</h3>
						<ul>
							<li id="pt-login"><a href="https://processors.wiki.ti.com/index.php?title=Special:UserLogin&amp;returnto=TI81XX+PSP+PCI+Express+Endpoint+Boot+Driver+User+Guide" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li><li id="pt-createaccount"><a href="Special_RequestAccount.html" title="You are encouraged to create an account and log in; however, it is not mandatory">Request account</a></li>						</ul>
					</div>
									<div id="left-navigation">
										<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
						<h3 id="p-namespaces-label">Namespaces</h3>
						<ul>
							<li id="ca-nstab-main" class="selected"><span><a href="TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide.html" title="View the content page [c]" accesskey="c">Page</a></span></li><li id="ca-talk" class="new"><span><a href="https://processors.wiki.ti.com/index.php?title=Talk:TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page (page does not exist) [t]" accesskey="t">Discussion</a></span></li>						</ul>
					</div>
										<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
												<input type="checkbox" class="vectorMenuCheckbox" aria-labelledby="p-variants-label" />
						<h3 id="p-variants-label">
							<span>Variants</span>
						</h3>
						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
									</div>
				<div id="right-navigation">
										<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
						<h3 id="p-views-label">Views</h3>
						<ul>
							<li id="ca-view" class="collapsible selected"><span><a href="TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide.html">Read</a></span></li><li id="ca-viewsource" class="collapsible"><span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></span></li><li id="ca-history" class="collapsible"><span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;action=history" title="Past revisions of this page [h]" accesskey="h">View history</a></span></li>						</ul>
					</div>
										<div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label">
						<input type="checkbox" class="vectorMenuCheckbox" aria-labelledby="p-cactions-label" />
						<h3 id="p-cactions-label"><span>More</span></h3>
						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
										<div id="p-search" role="search">
						<h3>
							<label for="searchInput">Search</label>
						</h3>
						<form action="https://processors.wiki.ti.com/index.php" id="searchform">
							<div id="simpleSearch">
								<input type="search" name="search" placeholder="Search Texas Instruments Wiki" title="Search Texas Instruments Wiki [f]" accesskey="f" id="searchInput"/><input type="hidden" value="Special:Search" name="title"/><input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton mw-fallbackSearchButton"/><input type="submit" name="go" value="Go" title="Go to a page with this exact name if it exists" id="searchButton" class="searchButton"/>							</div>
						</form>
					</div>
									</div>
			</div>
			<div id="mw-panel">
				<div id="p-logo" role="banner"><a class="mw-wiki-logo" href="Main_Page.html"  title="Visit the main page"></a></div>
						<div class="portal" role="navigation" id="p-navigation" aria-labelledby="p-navigation-label">
			<h3 id="p-navigation-label">Navigation</h3>
			<div class="body">
								<ul>
					<li id="n-mainpage"><a href="Main_Page.html" title="Visit the main page [z]" accesskey="z">Main Page</a></li><li id="n-All-pages"><a href="Special_AllPages.html">All pages</a></li><li id="n-All-categories"><a href="Special_Categories.html">All categories</a></li><li id="n-recentchanges"><a href="Special_RecentChanges.html" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li><li id="n-randompage"><a href="Package_Reflow_Profiles.html" title="Load a random page [x]" accesskey="x">Random page</a></li><li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" title="The place to find out">Help</a></li>				</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id="p-tb" aria-labelledby="p-tb-label">
			<h3 id="p-tb-label">Toolbox</h3>
			<div class="body">
								<ul>
					<li id="t-whatlinkshere"><a href="Special_WhatLinksHere/TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide.html" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li><li id="t-recentchangeslinked"><a href="Special_RecentChangesLinked/TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide.html" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li><li id="t-specialpages"><a href="Special_SpecialPages.html" title="A list of all special pages [q]" accesskey="q">Special pages</a></li><li id="t-print"><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li><li id="t-permalink"><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;oldid=124077" title="Permanent link to this revision of the page">Permanent link</a></li><li id="t-info"><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide&amp;action=info" title="More information about this page">Page information</a></li>				</ul>
							</div>
		</div>
				</div>
		</div>
				<div id="footer" role="contentinfo">
						<ul id="footer-info">
								<li id="footer-info-lastmod"> This page was last edited on 19 October 2012, at 01:33.</li>
								<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-ShareAlike</a> unless otherwise noted.</li>
							</ul>
						<ul id="footer-places">
								<li id="footer-places-privacy"><a href="Project_Privacy_policy.html" title="Project:Privacy policy">Privacy policy</a></li>
								<li id="footer-places-about"><a href="Project_About.html" title="Project:About">About Texas Instruments Wiki</a></li>
								<li id="footer-places-disclaimer"><a href="Project_General_disclaimer.html" title="Project:General disclaimer">Disclaimers</a></li>
								<li id="footer-places-termsofservice"><a href="Project_Terms_of_Service.html" title="Project:Terms of Service">Terms of Use</a></li>
							</ul>
										<ul id="footer-icons" class="noprint">
										<li id="footer-copyrightico">
						<a href="http://creativecommons.org/licenses/by-sa/3.0/"><img src="https://processors.wiki.ti.com/resources/assets/licenses/cc-by-sa.png" alt="Creative Commons Attribution-ShareAlike" width="88" height="31"/></a>					</li>
										<li id="footer-poweredbyico">
						<a href="http://www.mediawiki.org/"><img src="https://processors.wiki.ti.com/resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31"/></a>					</li>
									</ul>
						<div style="clear: both;"></div>
		</div>
		<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgPageParseReport":{"limitreport":{"cputime":"0.111","walltime":"0.115","ppvisitednodes":{"value":226,"limit":1000000},"ppgeneratednodes":{"value":329,"limit":1000000},"postexpandincludesize":{"value":668,"limit":2097152},"templateargumentsize":{"value":66,"limit":2097152},"expansiondepth":{"value":2,"limit":40},"expensivefunctioncount":{"value":0,"limit":100},"unstrip-depth":{"value":0,"limit":20},"unstrip-size":{"value":962,"limit":5000000},"timingprofile":["100.00%    5.490      1 -total"," 28.51%    1.565      1 Template:SpArticleStart"," 27.23%    1.495      1 Template:SpLicenseCC-SA"," 25.15%    1.381      1 Template:Prettytable"]},"cachereport":{"timestamp":"20201201001421","ttl":86400,"transientcontent":false}}});});</script><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":229});});</script>
	</body>

<!-- Mirrored from processors.wiki.ti.com/index.php/TI81XX_PSP_PCI_Express_Endpoint_Boot_Driver_User_Guide by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 01 Dec 2020 06:30:40 GMT -->
</html>
