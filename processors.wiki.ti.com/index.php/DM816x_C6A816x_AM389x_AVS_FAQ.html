<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">

<!-- Mirrored from processors.wiki.ti.com/index.php/DM816x_C6A816x_AM389x_AVS_FAQ by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 01 Dec 2020 11:01:21 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8"/>
<title>TI81XX PSP AVS FAQ - Texas Instruments Wiki</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"TI81XX_PSP_AVS_FAQ","wgTitle":"TI81XX PSP AVS FAQ","wgCurRevisionId":184692,"wgRevisionId":184692,"wgArticleId":10816,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["TI816x","Linux","PSP"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"TI81XX_PSP_AVS_FAQ","wgRelevantArticleId":10816,"wgRequestId":"1df7f6653bf6578586832463","wgIsProbablyEditable":false,"wgRelevantPageIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgRedirectedFrom":"DM816x_C6A816x_AM389x_AVS_FAQ","wgInternalRedirectTargetUrl":"/index.php/TI81XX_PSP_AVS_FAQ"});mw.loader.state({"site.styles":"ready","noscript":"ready","user.styles":"ready","user":"ready","user.options":"ready","user.tokens":"loading","mediawiki.legacy.shared":"ready","mediawiki.legacy.commonPrint":"ready","mediawiki.sectionAnchor":"ready","mediawiki.skinning.interface":"ready","skins.vector.styles":"ready"});mw.loader.implement("user.tokens@19o3a1s",function($,jQuery,require,module){/*@nomin*/mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});
});mw.loader.load(["mediawiki.action.view.redirect","site","mediawiki.page.startup","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.toc","mediawiki.searchSuggest","skins.vector.js"]);});</script>
<link rel="stylesheet" href="https://processors.wiki.ti.com/load.php?debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.interface%7Cskins.vector.styles&amp;only=styles&amp;skin=vector"/>
<script async="" src="https://processors.wiki.ti.com/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=vector"></script>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="https://processors.wiki.ti.com/load.php?debug=false&amp;lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=vector"/>
<meta name="generator" content="MediaWiki 1.31.6"/>
<link rel="shortcut icon" href="https://processors.wiki.ti.com/favicon.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="https://processors.wiki.ti.com/opensearch_desc.php" title="Texas Instruments Wiki (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="https://processors.wiki.ti.com/api.php?action=rsd"/>
<link rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/"/>
<link rel="alternate" type="application/atom+xml" title="Texas Instruments Wiki Atom feed" href="https://processors.wiki.ti.com/index.php?title=Special:RecentChanges&amp;feed=atom"/>
<link rel="canonical" href="TI81XX_PSP_AVS_FAQ.html"/>
<!--[if lt IE 9]><script src="/load.php?debug=false&amp;lang=en&amp;modules=html5shiv&amp;only=scripts&amp;skin=Vector&amp;sync=1"></script><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-TI81XX_PSP_AVS_FAQ rootpage-TI81XX_PSP_AVS_FAQ skin-vector action-view">		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<div id="content" class="mw-body" role="main">
			<a id="top"></a>
			<div id="siteNotice" class="mw-body-content"><div id="localNotice" lang="en" dir="ltr"><div class="mw-parser-output"><p><br />
<span style="color:#ff0000"><b>NOTICE: The Processors Wiki will End-of-Life on January 15, 2021. It is recommended to download any files or other content you may need that are hosted on processors.wiki.ti.com. The site is now set to read only.</b></span>
</p></div></div></div><div class="mw-indicators mw-body-content">
</div>
<h1 id="firstHeading" class="firstHeading" lang="en">TI81XX PSP AVS FAQ</h1>			<div id="bodyContent" class="mw-body-content">
				<div id="siteSub" class="noprint">From Texas Instruments Wiki</div>				<div id="contentSub"><span class="mw-redirectedfrom">(Redirected from <a href="https://processors.wiki.ti.com/index.php?title=DM816x_C6A816x_AM389x_AVS_FAQ&amp;redirect=no" class="mw-redirect" title="DM816x C6A816x AM389x AVS FAQ">DM816x C6A816x AM389x AVS FAQ</a>)</span></div>
								<div id="jump-to-nav" class="mw-jump">
					Jump to:					<a href="#mw-head">navigation</a>, 					<a href="#p-search">search</a>
				</div>
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output"><div style="width:800px; text-align:justify;"> 
<div style="display:block; clear: both; margin: 10px 0px; padding: 0px; background-color: #ee1d23; text-align:right;"><a href="File_TIBanner.html" class="image"><img alt="TIBanner.png" src="https://processors.wiki.ti.com/images/c/cd/TIBanner.png" width="667" height="87" /></a></div>
<div style="display:block; margin: 5px 0px; padding: 2px 5px; font-size:1.5em; font-weight:bold; text-align:left;">Linux AVS FAQ</div>
<div style="display:block; margin: 5px 0px; padding: 2px; color: #666666; font-size:1.0em; font-weight:bold; text-align:right;">Linux PSP</div> 
<div style="width:800px; text-align:left;"><div style="display:block; margin: 10px 0px; padding: 0px; text-align:left;">
<div style="margin: 5px; padding: 5px 10px; background-color: #ffffec; border-left: 5px solid #ff6600;"><b>IMPORTANT</b><br /><br />TI816X refers to TI816X/DM816X/C6A816x/AM389x devices unless specified.<br /></div>
</div></div>
<div id="toc" class="toc"><div class="toctitle" lang="en" dir="ltr"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#About_This_Document"><span class="tocnumber">1</span> <span class="toctext"><span> About This Document</span></span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#AVS_Background"><span class="tocnumber">2</span> <span class="toctext"><span><b>AVS Background</b></span></span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#What_is_AVS.3F"><span class="tocnumber">2.1</span> <span class="toctext"><span>What is AVS?</span></span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#What_is_the_advantage_of_using_AVS.3F"><span class="tocnumber">2.2</span> <span class="toctext"><span>What is the advantage of using AVS?</span></span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5"><a href="#SmartReflex_HW.2FIP"><span class="tocnumber">3</span> <span class="toctext"><span><b>SmartReflex HW/IP</b></span></span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#Difference_between_DVFS_and_SmartReflex.3F"><span class="tocnumber">3.1</span> <span class="toctext"><span>Difference between DVFS and SmartReflex?</span></span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#What_is_SmartReflex.3F"><span class="tocnumber">3.2</span> <span class="toctext"><span>What is SmartReflex?</span></span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Where_can_I_find_if_my_device_has_SmartReflex_module.2FHw_support.3F"><span class="tocnumber">3.3</span> <span class="toctext"><span> Where can I find if my device has SmartReflex module/Hw support? </span></span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#What_is_Class2_SmartReflex.E2.84.A2_Operation.3F"><span class="tocnumber">3.4</span> <span class="toctext"><span> What is Class2 SmartReflex™ Operation? </span></span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-10"><a href="#AVS_Driver"><span class="tocnumber">4</span> <span class="toctext"><span><b>AVS Driver </b></span></span></a>
<ul>
<li class="toclevel-2 tocsection-11"><a href="#What.27s_the_role_of_AVS.2FSR_Driver.3F"><span class="tocnumber">4.1</span> <span class="toctext"><span>What's the role of AVS/SR Driver?</span></span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Is_AVS_Driver_support_available_for_all_TI81XX_devices.3F"><span class="tocnumber">4.2</span> <span class="toctext"><span>Is AVS Driver support available for all TI81XX devices? </span></span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-13"><a href="#Voltage_Regulator_Driver"><span class="tocnumber">5</span> <span class="toctext"><span><b>Voltage Regulator Driver</b></span></span></a>
<ul>
<li class="toclevel-2 tocsection-14"><a href="#What_is_the_role_of_PMIC_in_AVS_operation.3F"><span class="tocnumber">5.1</span> <span class="toctext"><span>What is the role of PMIC in AVS operation?  </span></span></a></li>
<li class="toclevel-2 tocsection-15"><a href="#What_is_Regulator_Driver.3F_How_is_implemented.3F"><span class="tocnumber">5.2</span> <span class="toctext"><span>What is Regulator Driver? How is implemented?  </span></span></a></li>
<li class="toclevel-2 tocsection-16"><a href="#What_is_PMIC.2FRegulator_step_size.3F_How_does_this_impact_AVS.3F"><span class="tocnumber">5.3</span> <span class="toctext"><span>What is PMIC/Regulator step size? How does this impact AVS?</span></span></a>
<ul>
<li class="toclevel-3 tocsection-17"><a href="#Is_step_size_constant_or_variable.3F"><span class="tocnumber">5.3.1</span> <span class="toctext"><span>Is step size constant or variable?</span></span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-18"><a href="#TI816X_Specific"><span class="tocnumber">6</span> <span class="toctext"><span>TI816X Specific</span></span></a>
<ul>
<li class="toclevel-2 tocsection-19"><a href="#Device_Verification"><span class="tocnumber">6.1</span> <span class="toctext"><span>Device Verification </span></span></a>
<ul>
<li class="toclevel-3 tocsection-20"><a href="#How_can_I_verify_that_my_device_is_meant_for_AVS_operation.3F"><span class="tocnumber">6.1.1</span> <span class="toctext"><span>How can I verify that my device is meant for AVS operation?</span></span></a></li>
<li class="toclevel-3 tocsection-21"><a href="#What_are_the_GPIO_lines_used_for_voltage_control.3F"><span class="tocnumber">6.1.2</span> <span class="toctext"><span>What are the GPIO lines used for voltage control?</span></span></a></li>
<li class="toclevel-3 tocsection-22"><a href="#What_is_the_default_voltage_step_size_on_TI816X_with_TPS40041.3F"><span class="tocnumber">6.1.3</span> <span class="toctext"><span>What is the default voltage step size on TI816X with TPS40041? </span></span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-23"><a href="#Software.2Fdriver_related_Questions"><span class="tocnumber">6.2</span> <span class="toctext"><span>Software/driver related Questions </span></span></a>
<ul>
<li class="toclevel-3 tocsection-24"><a href="#What_is_the_default_voltage_regulator_driver_provided_in_Kernel.3F"><span class="tocnumber">6.2.1</span> <span class="toctext"><span>What is the default voltage regulator driver provided in Kernel?</span></span></a></li>
<li class="toclevel-3 tocsection-25"><a href="#What_are_the_parameters_that_need_to_be_changed_when_voltage_step_size_changes.3F"><span class="tocnumber">6.2.2</span> <span class="toctext"><span>What are the parameters that need to be changed when voltage step size changes?</span></span></a></li>
<li class="toclevel-3 tocsection-26"><a href="#How_to_implement_a_driver_for_TPS65911x_PMIC.3F"><span class="tocnumber">6.2.3</span> <span class="toctext"><span>How to implement a driver for TPS65911x PMIC?</span></span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-27"><a href="#Modifications_required_for_AVS_operation_on_older_revisions_of_the_TI816X_EVM"><span class="tocnumber">6.3</span> <span class="toctext"><span>Modifications required for AVS operation on older revisions of the TI816X EVM</span></span></a>
<ul>
<li class="toclevel-3 tocsection-28"><a href="#Reason_for_TI816X_EVM_modification"><span class="tocnumber">6.3.1</span> <span class="toctext"><span>Reason for TI816X EVM modification  </span></span></a>
<ul>
<li class="toclevel-4 tocsection-29"><a href="#What_is_the_impact_in_software_.28driver.29_after_board_modifications.3F"><span class="tocnumber">6.3.1.1</span> <span class="toctext"><span>What is the impact in software (driver) after board modifications?</span></span></a></li>
<li class="toclevel-4 tocsection-30"><a href="#What_happens_if_I_do_not_modify_the_board.2C_but_using_latest_code.3C.3F.2Fspan.3E"><span class="tocnumber">6.3.1.2</span> <span class="toctext"><span>What happens if I do not modify the board, but using latest code&lt;?/span&gt;</span></span></a></li>
<li class="toclevel-4 tocsection-31"><a href="#What_will_happen_if_I_use_the_new_board_with_old_driver.3F"><span class="tocnumber">6.3.1.3</span> <span class="toctext"><span>What will happen if I use the new board with old driver?</span></span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-2 tocsection-32"><a href="#Software_changes_if_default_GPIO_pin_configuration_changes"><span class="tocnumber">6.4</span> <span class="toctext"><span>Software changes if default GPIO pin configuration changes</span></span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-33"><a href="#Useful_Links"><span class="tocnumber">7</span> <span class="toctext"><span>Useful Links</span></span></a></li>
</ul>
</div>

<h1><span class="mw-headline" id="About_This_Document"><span style="color:green"> About This Document</span></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_AVS_FAQ&amp;action=edit&amp;section=1" title="Edit section: About This Document">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>This document provides Answers for Frequently Asked Questions about Adaptive Voltage Scaling supported on TI81XX devices only.
This is a dynamic document meaning content is added/modified as and when new information is available.
</p>
<h1><span class="mw-headline" id="AVS_Background"><span style="color:green"><b>AVS Background</b></span></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_AVS_FAQ&amp;action=edit&amp;section=2" title="Edit section: AVS Background">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h2><span id="What_is_AVS?"></span><span class="mw-headline" id="What_is_AVS.3F"><span style="color:green">What is AVS?</span></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_AVS_FAQ&amp;action=edit&amp;section=3" title="Edit section: What is AVS?">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Adaptive Voltage Scaling(AVS) is a technology which modifies the voltage of system/component by comparing the system performance against targeted performance.
</p><p>On TI81XX devices, AVS makes use of the HW technology called "SmartReflex" for comparing the on chip performance against target performance.
</p><p>The target performance is calculated during product engineering which is called "Characterization of the Silicon(chip)" and blown into the efuses on the chip.
</p><p>The AVS driver then acts on the information provided by SmartReflex and modifies the voltage accordingly using a voltage controller(PMIC).
</p><p><span style="color:green">AVS solution comprises following <b>components</b>:</span>
</p>
<ol><li><span style="color:green"><b>SmartReflex HW/IP</b></span></li>
<li><span style="color:green"><b>AVS Driver (used interchangeably with SR driver)</b></span></li>
<li><span style="color:green"><b>Software Controllable PMIC with working Software Driver(Voltage Regulator Driver)</b></span></li></ol>
<p>For further details on the "SmartReflex" IP/HW refer to the TRM/DataSheet available for TI81XX devices.<br />
For PMICs that can be used with TI81XX devices look for Power Management solutions on <a rel="nofollow" class="external text" href="http://www.ti.com/">TI website</a>
</p>
<h2><span id="What_is_the_advantage_of_using_AVS?"></span><span class="mw-headline" id="What_is_the_advantage_of_using_AVS.3F"><span style="color:green">What is the advantage of using AVS?</span></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_AVS_FAQ&amp;action=edit&amp;section=4" title="Edit section: What is the advantage of using AVS?">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>By enabling the AVS we can see less power consumption of the device while maintaining the same performance
</p>
<h1><span id="SmartReflex_HW/IP"></span><span class="mw-headline" id="SmartReflex_HW.2FIP"><span style="color:green"><b>SmartReflex HW/IP</b></span></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_AVS_FAQ&amp;action=edit&amp;section=5" title="Edit section: SmartReflex HW/IP">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h2><span id="Difference_between_DVFS_and_SmartReflex?"></span><span class="mw-headline" id="Difference_between_DVFS_and_SmartReflex.3F"><span style="color:green">Difference between DVFS and SmartReflex?</span></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_AVS_FAQ&amp;action=edit&amp;section=6" title="Edit section: Difference between DVFS and SmartReflex?">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Dynamic Voltage Frequency Scaling (DVFS) changes the operating frequency and voltage based on the application needs.
</p><p>On the other hand, SmartReflex reduces the supply voltage as much as possible at a given Operating Performance Point (OPP). It does this while ensuring that performance is maintained in real-time system environment (silicon performance, temperature, etc).
</p>
<h2><span id="What_is_SmartReflex?"></span><span class="mw-headline" id="What_is_SmartReflex.3F"><span style="color:green">What is SmartReflex?</span></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_AVS_FAQ&amp;action=edit&amp;section=7" title="Edit section: What is SmartReflex?">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>SmartReflex is a TI proprietary Hardware technology that measures performance of components using sensors and compares against target performance. SmartReflex IP provides the results(Error values) to the software through Memory Mapped Registers which is used by Software to adjust the voltage.
</p>
<h2><span id="Where_can_I_find_if_my_device_has_SmartReflex_module/Hw_support?"></span><span class="mw-headline" id="Where_can_I_find_if_my_device_has_SmartReflex_module.2FHw_support.3F"><span style="color:green"> Where can I find if my device has SmartReflex module/Hw support? </span></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_AVS_FAQ&amp;action=edit&amp;section=8" title="Edit section: Where can I find if my device has SmartReflex module/Hw support?">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The information of all available hardware features/modules is published in the DataSheet of the device. Please refer to the DataSheet of the device available on <a rel="nofollow" class="external text" href="http://www.ti.com/">TI Website</a>
</p>
<h2><span id="What_is_Class2_SmartReflex™_Operation?"></span><span class="mw-headline" id="What_is_Class2_SmartReflex.E2.84.A2_Operation.3F"><span style="color:green"> What is Class2 SmartReflex™ Operation? </span></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_AVS_FAQ&amp;action=edit&amp;section=9" title="Edit section: What is Class2 SmartReflex™ Operation?">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The hardware monitors real-time performance; small software loop runs on ARM processor to change voltage whenever necessary. With a Class 2 SmartReflex implementation, the ARM processor controls all of the functions of the TPS devices. If possible, use a dedicated I2C bus between the processor and TPS device. If you must share the bus with other peripherals, group the TPS devices (meant for voltage control) with peripherals which require only infrequent I2C activity.
</p>
<h1><span class="mw-headline" id="AVS_Driver"><span style="color:green"><b>AVS Driver </b></span></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_AVS_FAQ&amp;action=edit&amp;section=10" title="Edit section: AVS Driver">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h2><span id="What's_the_role_of_AVS/SR_Driver?"></span><span class="mw-headline" id="What.27s_the_role_of_AVS.2FSR_Driver.3F"><span style="color:green">What's the role of AVS/SR Driver?</span></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_AVS_FAQ&amp;action=edit&amp;section=11" title="Edit section: What&#039;s the role of AVS/SR Driver?">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>AVS/SR Driver configures the SmartReflex hardware. It initializes software structures related to IRQs, Regulator Device handle and also exports debugfs entries to see/debug current SR status. It acts as a mediator between SmartReflex IP and Voltage controller/Regulator.
</p>
<h2><span id="Is_AVS_Driver_support_available_for_all_TI81XX_devices?"></span><span class="mw-headline" id="Is_AVS_Driver_support_available_for_all_TI81XX_devices.3F"><span style="color:green">Is AVS Driver support available for all TI81XX devices? </span></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_AVS_FAQ&amp;action=edit&amp;section=12" title="Edit section: Is AVS Driver support available for all TI81XX devices?">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The following table lists the current software support for TI81XX devices.
</p>
<table border="1" cellspacing="0" cellpadding="5" width="40%">
<caption><b>AVS Software Support</b><br />
</caption>
<tbody><tr>
<td style="background-color: green;" width="50%"><span style="color: White"> Device </span>
</td>
<td style="background-color: green;" width="50%"><span style="color: White">Supported(YES/NO) </span>
</td></tr>
<tr>
<td>TI816X/TI816X/AM389X
</td>
<td>YES
</td></tr>
<tr>
<td>TI814X/DM814X/AM387X
</td>
<td>NO
</td></tr></tbody></table>
<p><br />
<span style="color:green"> For details on all Power Management Features available/status as part of TI81XX PSP LINUX package please refer to <a href="TI81XX_PSP_PM_FAQ.html" title="TI81XX PSP PM FAQ"> TI81XX PSP PM FAQ</a>
</span></p>
<h1><span class="mw-headline" id="Voltage_Regulator_Driver"><span style="color:green"><b>Voltage Regulator Driver</b></span></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_AVS_FAQ&amp;action=edit&amp;section=13" title="Edit section: Voltage Regulator Driver">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h2><span id="What_is_the_role_of_PMIC_in_AVS_operation?"></span><span class="mw-headline" id="What_is_the_role_of_PMIC_in_AVS_operation.3F"><span style="color:green">What is the role of PMIC in AVS operation?  </span></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_AVS_FAQ&amp;action=edit&amp;section=14" title="Edit section: What is the role of PMIC in AVS operation?">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Power Management Integrated Circuit (PMIC), controls the voltage/current of various components of a device through regulators. PMIC and regulator are interchangeably used in Software context. The same PMIC can be used to provide the voltage for Audio codec, Integrated battery charger, USB, etc.
</p><p>TI816X EVM comes with TPS40041 PMIC which feeds voltage to 1V AVS voltage domain. If you want to know what all system components fall under 1V AVS Domain please refer TI816X DataSheet available on <a rel="nofollow" class="external text" href="http://www.ti.com/">TI Website</a>.
</p><p>AVS Driver requests the Regulator driver to modify the voltage of 1V AVS domain as and when required which in turn forwards the requests to the PMIC. PMIC then outputs the requested voltage to the 1V AVS domain.
</p>
<h2><span id="What_is_Regulator_Driver?_How_is_implemented?"></span><span class="mw-headline" id="What_is_Regulator_Driver.3F_How_is_implemented.3F"><span style="color:green">What is Regulator Driver? How is implemented?  </span></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_AVS_FAQ&amp;action=edit&amp;section=15" title="Edit section: What is Regulator Driver? How is implemented?">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Regulator driver is the software component that interacts with the PMIC. When a voltage change is requested using Regulator driver APIs, Regulator driver check for the constraints on the voltage of the component/domain being changed and if all the checks are passed then configures the PMIC registers to reflect the voltage change.
</p><p>Typical supply voltage level control communication is performed via an interface like I2C, GPIO, or SPI. Decision entirely depends upon how the SoC interfaces with the PMIC.
</p><p>On TI816X EVM, Regulator driver uses GPIO lines to interact with the PMIC.
</p>
<h2><span id="What_is_PMIC/Regulator_step_size?_How_does_this_impact_AVS?"></span><span class="mw-headline" id="What_is_PMIC.2FRegulator_step_size.3F_How_does_this_impact_AVS.3F"><span style="color: green">What is PMIC/Regulator step size? How does this impact AVS?</span></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_AVS_FAQ&amp;action=edit&amp;section=16" title="Edit section: What is PMIC/Regulator step size? How does this impact AVS?">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Step size of a PMIC is the least possible voltage change that the PMIC can achieve. Any voltage change that the PMIC does will be an integer multiple of the step size.
</p><p>The following parameters of SmartReflex IP depend on the step size of PMIC:
</p>
<ol><li>Error Limits</li>
<li>Error to Voltage Gain</li></ol>
<p>These parameters are passed to the AVS/SR driver as part of platform data and are used for configuring the SmartReflex IP during initialization.<br /> If the step size of a PMIC being used changes then the parameters need to be updated.
For detailed information on these parameters refer to <a href="#What_are_the_parameters_that_need_to_be_changed_when_voltage_step_size_changes.3F"> changing voltage step size</a>
</p>
<h3><span id="Is_step_size_constant_or_variable?"></span><span class="mw-headline" id="Is_step_size_constant_or_variable.3F"><span style="color:green">Is step size constant or variable?</span></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_AVS_FAQ&amp;action=edit&amp;section=17" title="Edit section: Is step size constant or variable?">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Voltage Step Size <span style="color:red"><b>should be</b></span> constant for a PMIC as the SmartReflex configuration depends on the step size of the PMIC.
</p>
<h1><span class="mw-headline" id="TI816X_Specific"><span style="color:green">TI816X Specific</span></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_AVS_FAQ&amp;action=edit&amp;section=18" title="Edit section: TI816X Specific">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h2><span class="mw-headline" id="Device_Verification"><span style="color:green">Device Verification </span></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_AVS_FAQ&amp;action=edit&amp;section=19" title="Edit section: Device Verification">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h3><span id="How_can_I_verify_that_my_device_is_meant_for_AVS_operation?"></span><span class="mw-headline" id="How_can_I_verify_that_my_device_is_meant_for_AVS_operation.3F"><span style="color:green">How can I verify that my device is meant for AVS operation?</span></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_AVS_FAQ&amp;action=edit&amp;section=20" title="Edit section: How can I verify that my device is meant for AVS operation?">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ul><li>If you see any of the below messages during kernel boot, then the silicon/device does not have nTarget values. It means that the device is not meant for AVS operation.</li></ul>
<pre>SmartReflex Driver: Un-Characterized silicon found
SmartReflex Driver is notinitialized
</pre>
<p>or
</p>
<pre>smartreflex: Driver is not initialized, nTarget values are not found
</pre>
<ul><li>If you think the device what you have is AVS enabled then check these register values from <b>U-Boot prompt</b>, these registers should have <b>Non-Zero values</b></li></ul>
<ul><li>SmartReflex HVT nTarget value, address - 0x481406AC</li></ul>
<pre>TI8168_EVM#md 0x481406AC
</pre>
<ul><li>SmartReflex SVT nTarget value, address - 0x481406A8</li></ul>
<pre>TI8168_EVM#md 0x481406A8
</pre>
<h3><span id="What_are_the_GPIO_lines_used_for_voltage_control?"></span><span class="mw-headline" id="What_are_the_GPIO_lines_used_for_voltage_control.3F"><span style="color:green">What are the GPIO lines used for voltage control?</span></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_AVS_FAQ&amp;action=edit&amp;section=21" title="Edit section: What are the GPIO lines used for voltage control?">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>In TI816X EVM GP0_IO0, GP0_IO1, GP0_IO2 and GP0_IO3 (GPIO bank 0) are the GPIO lines used for controlling the voltage. In total we have 16 (2^4) linear voltage steps from 800 to 1025mV.
</p>
<h3><span id="What_is_the_default_voltage_step_size_on_TI816X_with_TPS40041?"></span><span class="mw-headline" id="What_is_the_default_voltage_step_size_on_TI816X_with_TPS40041.3F"><span style="color:green">What is the default voltage step size on TI816X with TPS40041? </span></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_AVS_FAQ&amp;action=edit&amp;section=22" title="Edit section: What is the default voltage step size on TI816X with TPS40041?">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Default voltage step size of TPS40041 is 15mV.
</p>
<h2><span id="Software/driver_related_Questions"></span><span class="mw-headline" id="Software.2Fdriver_related_Questions"><span style="color:green">Software/driver related Questions </span></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_AVS_FAQ&amp;action=edit&amp;section=23" title="Edit section: Software/driver related Questions">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h3><span id="What_is_the_default_voltage_regulator_driver_provided_in_Kernel?"></span><span class="mw-headline" id="What_is_the_default_voltage_regulator_driver_provided_in_Kernel.3F"><span style="color:green">What is the default voltage regulator driver provided in Kernel?</span></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_AVS_FAQ&amp;action=edit&amp;section=24" title="Edit section: What is the default voltage regulator driver provided in Kernel?">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>TI816X EVM supports GPIO based voltage controller (TPS40041), so GPIO based voltage regulator driver is added for supporting the same.
</p>
<h3><span id="What_are_the_parameters_that_need_to_be_changed_when_voltage_step_size_changes?"></span><span class="mw-headline" id="What_are_the_parameters_that_need_to_be_changed_when_voltage_step_size_changes.3F"><span style="color:green">What are the parameters that need to be changed when voltage step size changes?</span></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_AVS_FAQ&amp;action=edit&amp;section=25" title="Edit section: What are the parameters that need to be changed when voltage step size changes?">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p><span style="color: red">Changes below are applicable from PSP-04.00.00.12 release onwards </span>
</p><p>These are the parameters that need to change according to the voltage step size. Voltage step size is entirely based upon the hardware. If your hardware is modified for different voltage step size then these parameters need to change in software.<br />
</p>
<ul><li>Voltage table change in VR platform data in arch/arm/mach-omap2/board-ti8168evm.c file</li></ul>
<blockquote><p>Replace older values with new values </p></blockquote><blockquote>
<p> static struct gpio_vr_data ti816x_vsel_table[] = {
         &lt;new_values&gt;
 };
</p>
</blockquote>
<ul><li>Voltage step size of the PMIC needs to modify in arch/arm/mach-omap2/devices.c file<br /></li></ul>
<blockquote><p>.vstep_size_uv = &lt;new_value&gt; </p></blockquote>
<p><span style="color: Green">Based on voltage step size, modify err_minlimit &amp; e2v_gain fields in <b>sr_sensor_data</b> structure. Below table lists the values of the parameters that change when a new voltage step_size is chosen </span>
<br />
<br />
<span style="color: green"><b>NOTE:</b> Smaller voltage step size makes SmartReflex more sensitive to performance changes. On TI816X devices it is recommended to choose the step size such that the operating voltage window 800mV to 1050 mV is spanned in 8 to 32 steps.
So the recommended step size should lie between the min and max, where<b>min = (1050-800)/32 = 7.8125 mV</b> and  <b>max = (1050 - 800)/8 = 31.25 mV</b> </span>
<br />
</p>
<table border="1" cellspacing="0" cellpadding="5" width="50%">
<caption><b>HVT Sensor Parameters: SR0</b>
</caption>
<tbody><tr>
<th style="background-color: green;" width="33%"><span style="color: White">Step Size (uV)</span>
</th>
<td>7812
</td>
<td>10000
</td>
<td>12500
</td>
<td>15000
</td>
<td>16667
</td>
<td>31250
</td></tr>
<tr>
<th style="background-color: green;" width="34%"><span style="color: White">e2v_gain</span>
</th>
<td>0x18
</td>
<td>0x13
</td>
<td>0xF
</td>
<td>0xD
</td>
<td>0xB
</td>
<td>0x6
</td></tr>
<tr>
<th style="background-color: green;" width="33%"><span style="color: White">err_minlimit</span>
</th>
<td>0xFA
</td>
<td>0xF9
</td>
<td>0xF7
</td>
<td>0xF6
</td>
<td>0xF4
</td>
<td>0xEA
</td></tr></tbody></table>
<p><br />
<br />
</p>
<table border="1" cellspacing="0" cellpadding="5" width="50%">
<caption><b>SVT Sensor Parameters: SR1</b>
</caption>
<tbody><tr>
<th style="background-color: green;" width="33%"><span style="color: White"> Step Size (uV)</span>
</th>
<td>7812
</td>
<td>10000
</td>
<td>12500
</td>
<td>15000
</td>
<td>16667
</td>
<td>31250
</td></tr>
<tr>
<th style="background-color: green;" width="34%"><span style="color: White">e2v_gain</span>
</th>
<td>0x23
</td>
<td>0x1B
</td>
<td>0x16
</td>
<td>0x12
</td>
<td>0x10
</td>
<td>0x8
</td></tr>
<tr>
<th style="background-color: green;" width="33%"><span style="color: White">err_minlimit</span>
</th>
<td>0xFC
</td>
<td>0xFA
</td>
<td>0xFA
</td>
<td>0xF8
</td>
<td>0xF7
</td>
<td>0xF0
</td></tr></tbody></table>
<p><br />
<br />
</p>
<ul><li>Change minimum and maximum voltage values under gpio_pmic_init_data in arch/arm/mach-omap2/board-ti8168evm.c file</li></ul>
<pre>.min_uV = &lt;new_min_value&gt;,
.max_uV = &lt;new_max_value&gt;,
</pre>
<ul><li>Change the gpio instances (if modified in hardware) accordingly under vcore_gpios in arch/arm/mach-omap2/board-ti8168evm.c file</li></ul>
<h3><span id="How_to_implement_a_driver_for_TPS65911x_PMIC?"></span><span class="mw-headline" id="How_to_implement_a_driver_for_TPS65911x_PMIC.3F"><span style="color:green">How to implement a driver for TPS65911x PMIC?</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_AVS_FAQ&amp;action=edit&amp;section=26" title="Edit section: How to implement a driver for TPS65911x PMIC?">edit</a><span class="mw-editsection-bracket">]</span></span></span></h3>
<p>Here is a top level information for implementing the voltage regulator driver (S/W) for <a href="Tps65911x_pmic_usage.html" title="Tps65911x pmic usage">TPS65911X PMIC</a>
This is only for a reference actual implementation may demand a different design or implementation based on system requirements.
</p>
<h2><span class="mw-headline" id="Modifications_required_for_AVS_operation_on_older_revisions_of_the_TI816X_EVM"><span style="color:green">Modifications required for AVS operation on older revisions of the TI816X EVM</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_AVS_FAQ&amp;action=edit&amp;section=27" title="Edit section: Modifications required for AVS operation on older revisions of the TI816X EVM">edit</a><span class="mw-editsection-bracket">]</span></span></span></h2>
<h3><span class="mw-headline" id="Reason_for_TI816X_EVM_modification"><span style="color:green">Reason for TI816X EVM modification  </span></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_AVS_FAQ&amp;action=edit&amp;section=28" title="Edit section: Reason for TI816X EVM modification">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Board modifications needed for AVS operation, these changes are applicable for REV-A/B/C versions of TI816X EVM. It is recommended to change the board according to latest schematics (REV-D/E versions of TI816X EVM). Schematics can be found at <a rel="nofollow" class="external text" href="http://support.spectrumdigital.com/boards/evm816x/reve/files/evm816x_Schematics_RevE.pdf">spectrum digital website</a>, refer page #54
</p>
<ul><li><i>Reason1:</i> smooth AVS operation</li></ul>
<blockquote><p>Step size need to be constant across all the voltages for AVS operation </p></blockquote><blockquote>
<p><i>Details:</i> If the voltage step size is not constant across the voltages, then AVS interrupts rate is huge and some times we can see higher power consumption than what we expected from AVS.
</p>
</blockquote><blockquote>
<p><i>Advantage:</i> We can get better power reduction because of constant voltage step size and better voltage levels as compared to old schematics. With the new changes we can observe better AVS operation by reduce the number of AVS interrupts results in further power reduction. System load also better because of reduction in AVS interrupts
</p>
</blockquote>
<ul><li><i>Reason 2:</i> TCLKIN Issue</li></ul>
<blockquote><p>If you look into the schematics we can find that GP0_IO3 is tied with TCLKIN. Issue below should be taken care while modifying the board </p></blockquote>
<blockquote><p><i>Details:</i> Timers may sometimes lock up if the TCLKIN pin is tied high, even when the GPIO module is selected. If the TCLKIN pin is tied high (is not toggling/does not come to 0), TIMERs may lock up and may not be usable. This happens even if the TCLKIN pin is not selected by the pin control registers. The locks may be seen randomly on power up; i.e., it may be observed that some timers lock up and some do not. </p></blockquote>
<blockquote><p><i>Workaround:</i> The TCLKIN pin must be driven to 0 on the board while boot-up </p></blockquote>
<blockquote><p><i>Occurrence:</i> Sometimes it works, sometimes it does not </p></blockquote>
<blockquote><p>According to the <a rel="nofollow" class="external text" href="http://support.spectrumdigital.com/boards/evm816xdimm/revc/files/evm816xdimm_Schematics_revc.pdf">old schematics</a>, if we are changing the GP0_IO3 value from 0 -&gt; 1 or 1 -&gt; 0 leads to high voltage transition that leads to some un-stability.</p></blockquote>
<table border="1" cellspacing="0" cellpadding="5" width="40%">
<caption><b>Summary of EVM Resistor Changes</b><br />
</caption>
<tbody><tr>
<td style="background-color: green;" width="50%"><span style="color: White"> DDR2 DIMM EVM </span>
</td>
<td style="background-color: green;" width="50%"><span style="color: White">DDR3 Solder EVM  </span>
</td>
<td style="background-color: green;" width="50%"><span style="color: White">New R Value  </span>
</td></tr>
<tr>
<td valign="middle" align="center">R133
</td>
<td valign="middle" align="center">R133
</td>
<td valign="middle" align="center">30K
</td></tr>
<tr>
<td valign="middle" align="center">R89
</td>
<td valign="middle" align="center">R89
</td>
<td valign="middle" align="center">400K
</td></tr>
<tr>
<td valign="middle" align="center">R93
</td>
<td valign="middle" align="center">R93
</td>
<td valign="middle" align="center">200K
</td></tr>
<tr>
<td valign="middle" align="center">R105
</td>
<td valign="middle" align="center">R105
</td>
<td valign="middle" align="center">100K
</td></tr>
<tr>
<td valign="middle" align="center">R126
</td>
<td valign="middle" align="center">R126
</td>
<td valign="middle" align="center">50K
</td></tr>
<tr>
<td valign="middle" align="center">R13
</td>
<td valign="middle" align="center">R488
</td>
<td valign="middle" align="center">NOPOP
</td></tr>
<tr>
<td valign="middle" align="center">R15
</td>
<td valign="middle" align="center">R487
</td>
<td valign="middle" align="center">10K
</td></tr>
<tr>
<td valign="middle" align="center">R27
</td>
<td valign="middle" align="center">R486
</td>
<td valign="middle" align="center">10K
</td></tr>
<tr>
<td valign="middle" align="center">R63
</td>
<td valign="middle" align="center">R485
</td>
<td valign="middle" align="center">10K
</td></tr>
<tr>
<td valign="middle" align="center">R88
</td>
<td valign="middle" align="center">R88
</td>
<td valign="middle" align="center">10K
</td></tr>
<tr>
<td valign="middle" align="center">R91
</td>
<td valign="middle" align="center">R91
</td>
<td valign="middle" align="center">NOPOP
</td></tr>
<tr>
<td valign="middle" align="center">R106
</td>
<td valign="middle" align="center">R106
</td>
<td valign="middle" align="center">NOPOP
</td></tr>
<tr>
<td valign="middle" align="center">R127
</td>
<td valign="middle" align="center">R127
</td>
<td valign="middle" align="center">NOPOP
</td></tr></tbody></table>
<p><br />
</p>
<h4><span id="What_is_the_impact_in_software_(driver)_after_board_modifications?"></span><span class="mw-headline" id="What_is_the_impact_in_software_.28driver.29_after_board_modifications.3F"><span style="color:green">What is the impact in software (driver) after board modifications?</span></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_AVS_FAQ&amp;action=edit&amp;section=29" title="Edit section: What is the impact in software (driver) after board modifications?">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p><span style="color:green"><b>NOTE:</b> If you are using PSP version <b>04.00.00.12 or later</b> then following chnages are not required.</span>
</p><p><br />
</p>
<ul><li>If you are using the PSP04.00.00.11 or older version then these are the software changes needed after board modifications.</li></ul>
<ul><li>Voltage table change in arch/arm/mach-omap2/smartreflex-class2.c file</li></ul>
<blockquote><p>Replace older values with new values </p></blockquote> <blockquote>
<p> static struct tps40041_volt_data tps_volt_data[NUM_VOLT_LEVELS] = {
      {0x0, 800}, {0x8, 815}, {0x4, 830}, {0xC, 845},
      {0x2, 860}, {0xA, 875}, {0x6, 890}, {0xE, 905},
      {0x1, 920}, {0x9, 935}, {0x5, 950}, {0xD, 965},
      {0x3, 980}, {0xB, 995}, {0x7, 1010}, {0xF, 1025},
 };
</p>
</blockquote>
<ul><li>e2v_gain</li></ul>
<blockquote><p>Change hvt error2gain value to new value in arch/arm/mach-omap2/smartreflex-class2.c file </p></blockquote> <blockquote>
<p> .e2v_gain       = 0xD,
</p>
</blockquote>
<ul><li>e2v_gain</li></ul>
<blockquote><p>Change svt error2gain value to new value in arch/arm/mach-omap2/smartreflex-class2.c file </p></blockquote> <blockquote>
<p> .e2v_gain       = 0x12,
</p>
</blockquote>
<ul><li>ERRCONFIG_HVT_ERRMINLIMIT</li></ul>
<blockquote><p>Change ERRCONFIG_HVT_ERRMINLIMIT macro to new one in arch/arm/plat-omap/include/plat/smartreflex.h file </p></blockquote> <blockquote>
<p> #define ERRCONFIG_HVT_ERRMINLIMIT      (0xF6 &lt;&lt; 0)
</p>
</blockquote>
<ul><li>ERRCONFIG_SVT_ERRMINLIMIT</li></ul>
<blockquote><p>Change ERRCONFIG_SVT_ERRMINLIMIT macro to new one in arch/arm/plat-omap/include/plat/smartreflex.h file </p></blockquote> <blockquote>
<p> #define ERRCONFIG_SVT_ERRMINLIMIT      (0xF8 &lt;&lt; 0)
</p>
</blockquote>
<ul><li>STEP_SIZE</li></ul>
<blockquote><p>Change STEP_SIZE in arch/arm/mach-omap2/smartreflex-class2.c file </p></blockquote> <blockquote>
<p> #define STEP_SIZE               67
</p>
</blockquote>
<h4><span id="What_happens_if_I_do_not_modify_the_board,_but_using_latest_code&lt;?/span&gt;"></span><span class="mw-headline" id="What_happens_if_I_do_not_modify_the_board.2C_but_using_latest_code.3C.3F.2Fspan.3E"><span style="color:green">What happens if I do not modify the board, but using latest code&lt;?/span&gt;</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_AVS_FAQ&amp;action=edit&amp;section=30" title="Edit section: What happens if I do not modify the board, but using latest code&lt;?/span&gt;">edit</a><span class="mw-editsection-bracket">]</span></span></span></h4>
<p>Latest software driver points to new voltage table. If the user enabled the AVS driver then it will set GPIO value according to software voltage table, which leads to a different voltage in hardware. Sometimes it will fall into a stage where device stop functioning because the software set value is lower than device Vmin.
</p>
<h4><span id="What_will_happen_if_I_use_the_new_board_with_old_driver?"></span><span class="mw-headline" id="What_will_happen_if_I_use_the_new_board_with_old_driver.3F"><span style="color:green">What will happen if I use the new board with old driver?</span></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_AVS_FAQ&amp;action=edit&amp;section=31" title="Edit section: What will happen if I use the new board with old driver?">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Older software driver points to old voltage table. If the user enabled the AVS driver then it will set GPIO value according to older software voltage table, which leads to a different voltage in hardware (new modifications). Sometimes it will fall into a stage where device stop functioning because the software set value is lower then device Vmin.
</p>
<h2><span class="mw-headline" id="Software_changes_if_default_GPIO_pin_configuration_changes"><span style="color:green">Software changes if default GPIO pin configuration changes</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_AVS_FAQ&amp;action=edit&amp;section=32" title="Edit section: Software changes if default GPIO pin configuration changes">edit</a><span class="mw-editsection-bracket">]</span></span></span></h2>
<p>In TI816X EVM GP0_IO0, GP0_IO1, GP0_IO2 and GP0_IO3 (GPIO bank 0) are the GPIO lines used for controlling the voltage. If the hardware is configured for different GPIO lines then these modifications needs to be taken care in the driver.
</p><p>Modify below fields in arch/arm/mach-omap2/board-ti8168evm.c file
</p><p>1. Update the GPIO bank information, change VR_GPIO_INSTANCE to corresponding value
</p>
<pre>Eg: If the GPIO bank used for AVS voltage control is one then change INSTANCE macro to
#define VR_GPIO_INSTANCE 1
</pre>
<p>2. Change below 0, 1, 2 and 3 to corresponding GPIO lines.
</p><p>3. Rename "vgpio 0..3" to corresponding name's
</p>
<pre>Eg: If the GPIO lines used for AVS voltage control is 4, 5, 6 and 7 then change vcore_gpios array to
static struct gpio vcore_gpios[] = {
        { (VR_GPIO_INSTANCE * 32) + 4, GPIOF_IN, "vgpio 4"},
        { (VR_GPIO_INSTANCE * 32) + 5, GPIOF_IN, "vgpio 5"},
        { (VR_GPIO_INSTANCE * 32) + 6, GPIOF_IN, "vgpio 6"},
        { (VR_GPIO_INSTANCE * 32) + 7, GPIOF_IN, "vgpio 7"},
};
</pre>
<p>4. If the GPIO lines are not belonging to single bank then
</p>
<pre>Eg: flag gpio_single_bank is true otherwise false
</pre>
<p>5. gpio_arr_mask is applicable only if GPIO lines are belonging to single bank
</p>
<pre>Eg: If the GPIO lines used for AVS voltage control is 4, 5, 6 and 7 and in a single bank then
             .gpio_arr_mask = 0xF0,
</pre>
<p><br />
</p>
<h1><span class="mw-headline" id="Useful_Links"><span style="color:green">Useful Links</span></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_AVS_FAQ&amp;action=edit&amp;section=33" title="Edit section: Useful Links">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<ul><li><a rel="nofollow" class="external text" href="TI81XX_PSP_PM_AVS_Driver_User_Guide.html">TI816X AVS User Guide</a></li>
<li><a rel="nofollow" class="external text" href="http://processors.wiki.ti.com/index.php?title=Tps65911x_pmic_usage">TPS65911X PMIC Usage</a></li></ul>
<p><br />
</p></div>
<!-- 
NewPP limit report
Cached time: 20201201040114
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.090 seconds
Real time usage: 0.092 seconds
Preprocessor visited node count: 211/1000000
Preprocessor generated node count: 338/1000000
Post‐expand include size: 681/2097152 bytes
Template argument size: 97/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 0/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    4.301      1 -total
 34.69%    1.492      1 Template:SpArticleStart
 29.78%    1.281      1 Template:SpImportant
 29.46%    1.267      1 Template:SpLicenseCC-SA
-->
</div>
<!-- Saved in parser cache with key procwiki:pcache:idhash:10816-0!canonical and timestamp 20201201040114 and revision id 184692
 -->
<div class='hf-nsfooter' id='hf-nsfooter-'><table style="text-align:center; background:white; width:100%; text-align:left; height: 65px border-top: 1px solid; border-bottom: 1px solid; border-left: 1px solid; border-right: 1px solid; border-width: 1px; border-style: solid;">
<tr>
<td width="305px"><a href="File_E2e.html" class="image"><img alt="E2e.jpg" src="https://processors.wiki.ti.com/images/8/82/E2e.jpg" width="305" height="63" /></a>
</td>
<td>{{
<ol><li>switchcategory:MultiCore=</li></ol>
<ul><li>For technical support on MultiCore devices, please post your questions in the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/c6000_multi-core_dsps/default.aspx">C6000 MultiCore Forum</a></li>
<li>For questions related to the BIOS MultiCore SDK (MCSDK), please use the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/embedded/f/355.aspx">BIOS Forum</a></li></ul>
<p>Please post only comments related to the article <b>DM816x C6A816x AM389x AVS FAQ</b> here.<i></i>
</p>
</td>
<td>Keystone=
<ul><li>For technical support on MultiCore devices, please post your questions in the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/c6000_multi-core_dsps/default.aspx">C6000 MultiCore Forum</a></li>
<li>For questions related to the BIOS MultiCore SDK (MCSDK), please use the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/embedded/f/355.aspx">BIOS Forum</a></li></ul>
<p>Please post only comments related to the article <b>DM816x C6A816x AM389x AVS FAQ</b> here.<i></i>
</p>
</td>
<td>C2000=<i>For technical support on the C2000 please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/microcontrollers/tms320c2000_32-bit_real-time_mcus/f/171.aspx">The C2000 Forum</a>. Please post only comments about the article <b>DM816x C6A816x AM389x AVS FAQ</b> here.</i>
</td>
<td>DaVinci=<i>For technical support on DaVincoplease post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/davinci_digital_media_processors/default.aspx">The DaVinci Forum</a>. Please post only comments about the article <b>DM816x C6A816x AM389x AVS FAQ</b> here.</i>
</td>
<td>MSP430=<i>For technical support on MSP430 please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/microcontrollers/msp43016-bit_ultra-low_power_mcus/default.aspx">The MSP430 Forum</a>. Please post only comments about the article <b>DM816x C6A816x AM389x AVS FAQ</b> here.</i>
</td>
<td>OMAP35x=<i>For technical support on OMAP please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/omap_applications_processors/default.aspx">The OMAP Forum</a>. Please post only comments about the article <b>DM816x C6A816x AM389x AVS FAQ</b> here.</i>
</td>
<td>OMAPL1=<i>For technical support on OMAP please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/omap_applications_processors/default.aspx">The OMAP Forum</a>. Please post only comments about the article <b>DM816x C6A816x AM389x AVS FAQ</b> here.</i>
</td>
<td>MAVRK=<i>For technical support on MAVRK please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/development_tools/mavrk/default.aspx">The MAVRK Toolbox Forum</a>. Please post only comments about the article <b>DM816x C6A816x AM389x AVS FAQ</b> here.</i>
</td>
<td><i>For technical support please post your questions at <a rel="nofollow" class="external text" href="http://e2e.ti.com/">http://e2e.ti.com</a>. Please post only comments about the article <b>DM816x C6A816x AM389x AVS FAQ</b> here.</i>
<p>}}
</p>
</td></tr></table>
<table style="border-style:solid; border-width:1px; text-align:center; width:100%;">

<tr style="font-size:150%;">
<td rowspan="2"><a href="File_Hyperlink_blue.html" class="image"><img alt="Hyperlink blue.png" src="https://processors.wiki.ti.com/images/9/9f/Hyperlink_blue.png" width="96" height="96" /></a>
</td>
<td><b>Links</b>
</td></tr>
<tr>
<td>
<table style="text-align: left;">
<tr>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/amplifier_and_linear.page">Amplifiers &amp; Linear</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/audio/audio_overview.page">Audio</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/rfif.page">Broadband RF/IF &amp; Digital Radio</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/clocksandtimers/clocks_and_timers.page">Clocks &amp; Timers</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/dataconverters/data_converter.page">Data Converters</a>
</p>
</td>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/mems/mems.page">DLP &amp; MEMS</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/high_reliability.page">High-Reliability</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/interface/interface.page">Interface</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/logic/home_overview.page">Logic</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/powermanagement/power_portal.page">Power Management</a>
</p>
</td>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/dsp/embedded_processor.page">Processors</a>
</p>
<ul><li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/dsp/arm.page">ARM Processors</a></li>
<li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/dsp/home.page">Digital Signal Processors (DSP)</a></li>
<li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/microcontroller/home.page">Microcontrollers (MCU)</a></li>
<li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/omap-applications-processors/the-omap-experience.page">OMAP Applications Processors</a></li></ul>
</td>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/switches_and_multiplexers.page">Switches &amp; Multiplexers</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/temperature_sensor.page">Temperature Sensors &amp; Control ICs</a><br/>
<a rel="nofollow" class="external text" href="http://focus.ti.com/wireless/docs/wirelessoverview.tsp?familyId=2003&amp;sectionId=646&amp;tabId=2735">Wireless Connectivity</a>
</p>
</td></tr></table>
</td></tr></table>
<div id="tiPrivacy"></div>
</div></div>					<div class="printfooter">
						Retrieved from "<a dir="ltr" href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_AVS_FAQ&amp;oldid=184692">https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_AVS_FAQ&amp;oldid=184692</a>"					</div>
				<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="Special_Categories.html" title="Special:Categories">Categories</a>: <ul><li><a href="Category_TI816x.html" title="Category:TI816x">TI816x</a></li><li><a href="Category_Linux.html" title="Category:Linux">Linux</a></li><li><a href="Category_PSP.html" title="Category:PSP">PSP</a></li></ul></div></div>				<div class="visualClear"></div>
							</div>
		</div>
		<div id="mw-navigation">
			<h2>Navigation menu</h2>
			<div id="mw-head">
									<div id="p-personal" role="navigation" class="" aria-labelledby="p-personal-label">
						<h3 id="p-personal-label">Personal tools</h3>
						<ul>
							<li id="pt-login"><a href="https://processors.wiki.ti.com/index.php?title=Special:UserLogin&amp;returnto=TI81XX+PSP+AVS+FAQ" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li><li id="pt-createaccount"><a href="Special_RequestAccount.html" title="You are encouraged to create an account and log in; however, it is not mandatory">Request account</a></li>						</ul>
					</div>
									<div id="left-navigation">
										<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
						<h3 id="p-namespaces-label">Namespaces</h3>
						<ul>
							<li id="ca-nstab-main" class="selected"><span><a href="TI81XX_PSP_AVS_FAQ.html" title="View the content page [c]" accesskey="c">Page</a></span></li><li id="ca-talk" class="new"><span><a href="https://processors.wiki.ti.com/index.php?title=Talk:TI81XX_PSP_AVS_FAQ&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page (page does not exist) [t]" accesskey="t">Discussion</a></span></li>						</ul>
					</div>
										<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
												<input type="checkbox" class="vectorMenuCheckbox" aria-labelledby="p-variants-label" />
						<h3 id="p-variants-label">
							<span>Variants</span>
						</h3>
						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
									</div>
				<div id="right-navigation">
										<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
						<h3 id="p-views-label">Views</h3>
						<ul>
							<li id="ca-view" class="collapsible selected"><span><a href="TI81XX_PSP_AVS_FAQ.html">Read</a></span></li><li id="ca-viewsource" class="collapsible"><span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_AVS_FAQ&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></span></li><li id="ca-history" class="collapsible"><span><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_AVS_FAQ&amp;action=history" title="Past revisions of this page [h]" accesskey="h">View history</a></span></li>						</ul>
					</div>
										<div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label">
						<input type="checkbox" class="vectorMenuCheckbox" aria-labelledby="p-cactions-label" />
						<h3 id="p-cactions-label"><span>More</span></h3>
						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
										<div id="p-search" role="search">
						<h3>
							<label for="searchInput">Search</label>
						</h3>
						<form action="https://processors.wiki.ti.com/index.php" id="searchform">
							<div id="simpleSearch">
								<input type="search" name="search" placeholder="Search Texas Instruments Wiki" title="Search Texas Instruments Wiki [f]" accesskey="f" id="searchInput"/><input type="hidden" value="Special:Search" name="title"/><input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton mw-fallbackSearchButton"/><input type="submit" name="go" value="Go" title="Go to a page with this exact name if it exists" id="searchButton" class="searchButton"/>							</div>
						</form>
					</div>
									</div>
			</div>
			<div id="mw-panel">
				<div id="p-logo" role="banner"><a class="mw-wiki-logo" href="Main_Page.html"  title="Visit the main page"></a></div>
						<div class="portal" role="navigation" id="p-navigation" aria-labelledby="p-navigation-label">
			<h3 id="p-navigation-label">Navigation</h3>
			<div class="body">
								<ul>
					<li id="n-mainpage"><a href="Main_Page.html" title="Visit the main page [z]" accesskey="z">Main Page</a></li><li id="n-All-pages"><a href="Special_AllPages.html">All pages</a></li><li id="n-All-categories"><a href="Special_Categories.html">All categories</a></li><li id="n-recentchanges"><a href="Special_RecentChanges.html" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li><li id="n-randompage"><a href="Package_Reflow_Profiles.html" title="Load a random page [x]" accesskey="x">Random page</a></li><li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" title="The place to find out">Help</a></li>				</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id="p-tb" aria-labelledby="p-tb-label">
			<h3 id="p-tb-label">Toolbox</h3>
			<div class="body">
								<ul>
					<li id="t-whatlinkshere"><a href="Special_WhatLinksHere/TI81XX_PSP_AVS_FAQ.html" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li><li id="t-recentchangeslinked"><a href="Special_RecentChangesLinked/TI81XX_PSP_AVS_FAQ.html" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li><li id="t-specialpages"><a href="Special_SpecialPages.html" title="A list of all special pages [q]" accesskey="q">Special pages</a></li><li id="t-print"><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_AVS_FAQ&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li><li id="t-permalink"><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_AVS_FAQ&amp;oldid=184692" title="Permanent link to this revision of the page">Permanent link</a></li><li id="t-info"><a href="https://processors.wiki.ti.com/index.php?title=TI81XX_PSP_AVS_FAQ&amp;action=info" title="More information about this page">Page information</a></li>				</ul>
							</div>
		</div>
				</div>
		</div>
				<div id="footer" role="contentinfo">
						<ul id="footer-info">
								<li id="footer-info-lastmod"> This page was last edited on 5 September 2014, at 04:30.</li>
								<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-ShareAlike</a> unless otherwise noted.</li>
							</ul>
						<ul id="footer-places">
								<li id="footer-places-privacy"><a href="Project_Privacy_policy.html" title="Project:Privacy policy">Privacy policy</a></li>
								<li id="footer-places-about"><a href="Project_About.html" title="Project:About">About Texas Instruments Wiki</a></li>
								<li id="footer-places-disclaimer"><a href="Project_General_disclaimer.html" title="Project:General disclaimer">Disclaimers</a></li>
								<li id="footer-places-termsofservice"><a href="Project_Terms_of_Service.html" title="Project:Terms of Service">Terms of Use</a></li>
							</ul>
										<ul id="footer-icons" class="noprint">
										<li id="footer-copyrightico">
						<a href="http://creativecommons.org/licenses/by-sa/3.0/"><img src="https://processors.wiki.ti.com/resources/assets/licenses/cc-by-sa.png" alt="Creative Commons Attribution-ShareAlike" width="88" height="31"/></a>					</li>
										<li id="footer-poweredbyico">
						<a href="http://www.mediawiki.org/"><img src="https://processors.wiki.ti.com/resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31"/></a>					</li>
									</ul>
						<div style="clear: both;"></div>
		</div>
		<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgPageParseReport":{"limitreport":{"cputime":"0.090","walltime":"0.092","ppvisitednodes":{"value":211,"limit":1000000},"ppgeneratednodes":{"value":338,"limit":1000000},"postexpandincludesize":{"value":681,"limit":2097152},"templateargumentsize":{"value":97,"limit":2097152},"expansiondepth":{"value":2,"limit":40},"expensivefunctioncount":{"value":0,"limit":100},"unstrip-depth":{"value":0,"limit":20},"unstrip-size":{"value":0,"limit":5000000},"timingprofile":["100.00%    4.301      1 -total"," 34.69%    1.492      1 Template:SpArticleStart"," 29.78%    1.281      1 Template:SpImportant"," 29.46%    1.267      1 Template:SpLicenseCC-SA"]},"cachereport":{"timestamp":"20201201040114","ttl":86400,"transientcontent":false}}});});</script><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":235});});</script>
	</body>

<!-- Mirrored from processors.wiki.ti.com/index.php/DM816x_C6A816x_AM389x_AVS_FAQ by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 01 Dec 2020 11:01:21 GMT -->
</html>
