<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">

<!-- Mirrored from processors.wiki.ti.com/index.php/TI-Android-ICS-PortingGuide by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 01 Dec 2020 04:16:30 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8"/>
<title>TI-Android-ICS-PortingGuide - Texas Instruments Wiki</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"TI-Android-ICS-PortingGuide","wgTitle":"TI-Android-ICS-PortingGuide","wgCurRevisionId":148387,"wgRevisionId":148387,"wgArticleId":16351,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["AM335x","Android","Sitara Android","AM37x"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"TI-Android-ICS-PortingGuide","wgRelevantArticleId":16351,"wgRequestId":"4a058cd1b4d65a2509fc0c2c","wgIsProbablyEditable":false,"wgRelevantPageIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[]});mw.loader.state({"site.styles":"ready","noscript":"ready","user.styles":"ready","user":"ready","user.options":"ready","user.tokens":"loading","mediawiki.legacy.shared":"ready","mediawiki.legacy.commonPrint":"ready","mediawiki.sectionAnchor":"ready","mediawiki.skinning.interface":"ready","skins.vector.styles":"ready"});mw.loader.implement("user.tokens@19o3a1s",function($,jQuery,require,module){/*@nomin*/mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});
});mw.loader.load(["site","mediawiki.page.startup","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.toc","mediawiki.searchSuggest","skins.vector.js"]);});</script>
<link rel="stylesheet" href="https://processors.wiki.ti.com/load.php?debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.interface%7Cskins.vector.styles&amp;only=styles&amp;skin=vector"/>
<script async="" src="https://processors.wiki.ti.com/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=vector"></script>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="https://processors.wiki.ti.com/load.php?debug=false&amp;lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=vector"/>
<meta name="generator" content="MediaWiki 1.31.6"/>
<link rel="shortcut icon" href="https://processors.wiki.ti.com/favicon.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="https://processors.wiki.ti.com/opensearch_desc.php" title="Texas Instruments Wiki (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="https://processors.wiki.ti.com/api.php?action=rsd"/>
<link rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/"/>
<link rel="alternate" type="application/atom+xml" title="Texas Instruments Wiki Atom feed" href="https://processors.wiki.ti.com/index.php?title=Special:RecentChanges&amp;feed=atom"/>
<!--[if lt IE 9]><script src="/load.php?debug=false&amp;lang=en&amp;modules=html5shiv&amp;only=scripts&amp;skin=Vector&amp;sync=1"></script><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-TI-Android-ICS-PortingGuide rootpage-TI-Android-ICS-PortingGuide skin-vector action-view">		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<div id="content" class="mw-body" role="main">
			<a id="top"></a>
			<div id="siteNotice" class="mw-body-content"><div id="localNotice" lang="en" dir="ltr"><div class="mw-parser-output"><p><br />
<span style="color:#ff0000"><b>NOTICE: The Processors Wiki will End-of-Life on January 15, 2021. It is recommended to download any files or other content you may need that are hosted on processors.wiki.ti.com. The site is now set to read only.</b></span>
</p></div></div></div><div class="mw-indicators mw-body-content">
</div>
<h1 id="firstHeading" class="firstHeading" lang="en">TI-Android-ICS-PortingGuide</h1>			<div id="bodyContent" class="mw-body-content">
				<div id="siteSub" class="noprint">From Texas Instruments Wiki</div>				<div id="contentSub"></div>
								<div id="jump-to-nav" class="mw-jump">
					Jump to:					<a href="#mw-head">navigation</a>, 					<a href="#p-search">search</a>
				</div>
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output"><table border="1">

<tbody><tr>
<td><a href="File_Construction_Icon_small.html" class="image"><img alt="Construction Icon small.png" src="https://processors.wiki.ti.com/images/8/89/Construction_Icon_small.png" width="50" height="44" /></a></td>
<td><b>This page is currently under construction.  The content of this page is due to change quite frequently and thus the quality and accuracy are not guaranteed until this message has been removed.  Please feel free to contribute to this page while construction is in progress.</b>
</td></tr>

</tbody></table>
<p><a href="File_TIBanner.html" class="image"><img alt="TIBanner.png" src="https://processors.wiki.ti.com/images/c/cd/TIBanner.png" width="667" height="87" /></a> 
<br />
</p><p><br />
</p>
<div id="toc" class="toc"><div class="toctitle" lang="en" dir="ltr"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#About_this_manual"><span class="tocnumber">1</span> <span class="toctext">About this manual</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#WLAN"><span class="tocnumber">2</span> <span class="toctext">WLAN</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Introduction"><span class="tocnumber">2.1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Features_Overview"><span class="tocnumber">2.2</span> <span class="toctext">Features Overview</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Android_WLAN_Sub-System_Overview"><span class="tocnumber">2.3</span> <span class="toctext">Android WLAN Sub-System Overview</span></a>
<ul>
<li class="toclevel-3 tocsection-6"><a href="#Application"><span class="tocnumber">2.3.1</span> <span class="toctext">Application</span></a></li>
<li class="toclevel-3 tocsection-7"><a href="#Application_Framework"><span class="tocnumber">2.3.2</span> <span class="toctext">Application Framework</span></a></li>
<li class="toclevel-3 tocsection-8"><a href="#Libraries"><span class="tocnumber">2.3.3</span> <span class="toctext">Libraries</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-9"><a href="#Driver_Configuration"><span class="tocnumber">2.4</span> <span class="toctext">Driver Configuration</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Android_WiFi_HAL_Configuration"><span class="tocnumber">2.5</span> <span class="toctext">Android WiFi HAL Configuration</span></a>
<ul>
<li class="toclevel-3 tocsection-11"><a href="#Overlay_changes"><span class="tocnumber">2.5.1</span> <span class="toctext">Overlay changes</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-12"><a href="#Verify_WLAN_from_console"><span class="tocnumber">2.6</span> <span class="toctext">Verify WLAN from console</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#WLAN_calibration"><span class="tocnumber">2.7</span> <span class="toctext">WLAN calibration</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-14"><a href="#Bluetooth"><span class="tocnumber">3</span> <span class="toctext">Bluetooth</span></a>
<ul>
<li class="toclevel-2 tocsection-15"><a href="#Introduction_2"><span class="tocnumber">3.1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-2 tocsection-16"><a href="#Features_Overview_2"><span class="tocnumber">3.2</span> <span class="toctext">Features Overview</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="#Android_BT_Sub-System_Overview"><span class="tocnumber">3.3</span> <span class="toctext">Android BT Sub-System Overview</span></a></li>
<li class="toclevel-2 tocsection-18"><a href="#Driver_Configuration_2"><span class="tocnumber">3.4</span> <span class="toctext">Driver Configuration</span></a></li>
<li class="toclevel-2 tocsection-19"><a href="#Android_BT_HAL_Configuration"><span class="tocnumber">3.5</span> <span class="toctext">Android BT HAL Configuration</span></a>
<ul>
<li class="toclevel-3 tocsection-20"><a href="#Overlay_changes_2"><span class="tocnumber">3.5.1</span> <span class="toctext">Overlay changes</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-21"><a href="#Audio"><span class="tocnumber">4</span> <span class="toctext">Audio</span></a>
<ul>
<li class="toclevel-2 tocsection-22"><a href="#Introduction_3"><span class="tocnumber">4.1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-2 tocsection-23"><a href="#Features_Overview_3"><span class="tocnumber">4.2</span> <span class="toctext">Features Overview</span></a></li>
<li class="toclevel-2 tocsection-24"><a href="#Android_Audio_Sub-System_Overview"><span class="tocnumber">4.3</span> <span class="toctext">Android Audio Sub-System Overview</span></a></li>
<li class="toclevel-2 tocsection-25"><a href="#Driver_Configuration_3"><span class="tocnumber">4.4</span> <span class="toctext">Driver Configuration</span></a></li>
<li class="toclevel-2 tocsection-26"><a href="#Android_Audio_HAL_Configuration"><span class="tocnumber">4.5</span> <span class="toctext">Android Audio HAL Configuration</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-27"><a href="#Display"><span class="tocnumber">5</span> <span class="toctext">Display</span></a>
<ul>
<li class="toclevel-2 tocsection-28"><a href="#Introduction_4"><span class="tocnumber">5.1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-2 tocsection-29"><a href="#Features_Overview_4"><span class="tocnumber">5.2</span> <span class="toctext">Features Overview</span></a></li>
<li class="toclevel-2 tocsection-30"><a href="#Android_Display_Subsystem_Overview"><span class="tocnumber">5.3</span> <span class="toctext">Android Display Subsystem Overview</span></a></li>
<li class="toclevel-2 tocsection-31"><a href="#Driver_Configuration_4"><span class="tocnumber">5.4</span> <span class="toctext">Driver Configuration</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-32"><a href="#Display_backlight"><span class="tocnumber">6</span> <span class="toctext">Display backlight</span></a>
<ul>
<li class="toclevel-2 tocsection-33"><a href="#Introduction_5"><span class="tocnumber">6.1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-2 tocsection-34"><a href="#Driver_Configuration_5"><span class="tocnumber">6.2</span> <span class="toctext">Driver Configuration</span></a></li>
<li class="toclevel-2 tocsection-35"><a href="#Android_Configuration"><span class="tocnumber">6.3</span> <span class="toctext">Android Configuration</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-36"><a href="#MMC"><span class="tocnumber">7</span> <span class="toctext">MMC</span></a>
<ul>
<li class="toclevel-2 tocsection-37"><a href="#Introduction_6"><span class="tocnumber">7.1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-2 tocsection-38"><a href="#Features_Overview_5"><span class="tocnumber">7.2</span> <span class="toctext">Features Overview</span></a></li>
<li class="toclevel-2 tocsection-39"><a href="#Driver_Configuration_6"><span class="tocnumber">7.3</span> <span class="toctext">Driver Configuration</span></a></li>
<li class="toclevel-2 tocsection-40"><a href="#Android_MMC_HAL_or_Vold_Configuration"><span class="tocnumber">7.4</span> <span class="toctext">Android MMC HAL or Vold Configuration</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-41"><a href="#Touchscreen"><span class="tocnumber">8</span> <span class="toctext">Touchscreen</span></a>
<ul>
<li class="toclevel-2 tocsection-42"><a href="#Introduction_7"><span class="tocnumber">8.1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-2 tocsection-43"><a href="#Features_Overview_6"><span class="tocnumber">8.2</span> <span class="toctext">Features Overview</span></a></li>
<li class="toclevel-2 tocsection-44"><a href="#Driver_Configuration_7"><span class="tocnumber">8.3</span> <span class="toctext">Driver Configuration</span></a>
<ul>
<li class="toclevel-3 tocsection-45"><a href="#Add_touchscreen_driver_support"><span class="tocnumber">8.3.1</span> <span class="toctext">Add touchscreen driver support</span></a></li>
<li class="toclevel-3 tocsection-46"><a href="#Test_touch_driver_using_getevent"><span class="tocnumber">8.3.2</span> <span class="toctext">Test touch driver using getevent</span></a></li>
<li class="toclevel-3 tocsection-47"><a href="#Touch_Calibration"><span class="tocnumber">8.3.3</span> <span class="toctext">Touch Calibration</span></a></li>
<li class="toclevel-3 tocsection-48"><a href="#Test_Touch_Calibration_in_Android"><span class="tocnumber">8.3.4</span> <span class="toctext">Test Touch Calibration in Android</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-49"><a href="#Android_Touchscreen_configuration"><span class="tocnumber">8.4</span> <span class="toctext">Android Touchscreen configuration</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-50"><a href="#Keypad"><span class="tocnumber">9</span> <span class="toctext">Keypad</span></a>
<ul>
<li class="toclevel-2 tocsection-51"><a href="#Introduction_8"><span class="tocnumber">9.1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-2 tocsection-52"><a href="#Features_Overview_7"><span class="tocnumber">9.2</span> <span class="toctext">Features Overview</span></a></li>
<li class="toclevel-2 tocsection-53"><a href="#Driver_Configuration_8"><span class="tocnumber">9.3</span> <span class="toctext">Driver Configuration</span></a></li>
<li class="toclevel-2 tocsection-54"><a href="#Android_Keypad_Configuration"><span class="tocnumber">9.4</span> <span class="toctext">Android Keypad Configuration</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-55"><a href="#NAND"><span class="tocnumber">10</span> <span class="toctext">NAND</span></a>
<ul>
<li class="toclevel-2 tocsection-56"><a href="#Introduction_9"><span class="tocnumber">10.1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-2 tocsection-57"><a href="#Features_Overview_8"><span class="tocnumber">10.2</span> <span class="toctext">Features Overview</span></a></li>
<li class="toclevel-2 tocsection-58"><a href="#Driver_Configuration_9"><span class="tocnumber">10.3</span> <span class="toctext">Driver Configuration</span></a></li>
<li class="toclevel-2 tocsection-59"><a href="#Fastboot"><span class="tocnumber">10.4</span> <span class="toctext">Fastboot</span></a>
<ul>
<li class="toclevel-3 tocsection-60"><a href="#Establishing_Fastboot_connectivity"><span class="tocnumber">10.4.1</span> <span class="toctext">Establishing Fastboot connectivity</span></a></li>
<li class="toclevel-3 tocsection-61"><a href="#Supported_Fastboot_commands"><span class="tocnumber">10.4.2</span> <span class="toctext">Supported Fastboot commands</span></a></li>
<li class="toclevel-3 tocsection-62"><a href="#Fastboot_Porting_guide"><span class="tocnumber">10.4.3</span> <span class="toctext">Fastboot Porting guide</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-63"><a href="#USB_Host_and_Gadget"><span class="tocnumber">11</span> <span class="toctext">USB Host and Gadget</span></a>
<ul>
<li class="toclevel-2 tocsection-64"><a href="#Introduction_10"><span class="tocnumber">11.1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-2 tocsection-65"><a href="#Driver_Configuration_10"><span class="tocnumber">11.2</span> <span class="toctext">Driver Configuration</span></a></li>
<li class="toclevel-2 tocsection-66"><a href="#Android_USB_Configuration"><span class="tocnumber">11.3</span> <span class="toctext">Android USB Configuration</span></a>
<ul>
<li class="toclevel-3 tocsection-67"><a href="#Android_USB_Gadget_Configuration"><span class="tocnumber">11.3.1</span> <span class="toctext">Android USB Gadget Configuration</span></a>
<ul>
<li class="toclevel-4 tocsection-68"><a href="#USB_Gadget_configuration_for_AM37x"><span class="tocnumber">11.3.1.1</span> <span class="toctext">USB Gadget configuration for AM37x</span></a></li>
<li class="toclevel-4 tocsection-69"><a href="#USB_Gadget_configuration_for_AM335x"><span class="tocnumber">11.3.1.2</span> <span class="toctext">USB Gadget configuration for AM335x</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-70"><a href="#USB_Mass_storage"><span class="tocnumber">12</span> <span class="toctext">USB Mass storage</span></a>
<ul>
<li class="toclevel-2 tocsection-71"><a href="#Introduction_11"><span class="tocnumber">12.1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-2 tocsection-72"><a href="#Android_Configuration_for_USB_mass_storage"><span class="tocnumber">12.2</span> <span class="toctext">Android Configuration for USB mass storage</span></a></li>
<li class="toclevel-2 tocsection-73"><a href="#Test_mass_storage_in_Android"><span class="tocnumber">12.3</span> <span class="toctext">Test mass storage in Android</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-74"><a href="#USB_Camera"><span class="tocnumber">13</span> <span class="toctext">USB Camera</span></a>
<ul>
<li class="toclevel-2 tocsection-75"><a href="#Kernel_configuration"><span class="tocnumber">13.1</span> <span class="toctext">Kernel configuration</span></a></li>
<li class="toclevel-2 tocsection-76"><a href="#Android_Configuration_2"><span class="tocnumber">13.2</span> <span class="toctext">Android Configuration</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-77"><a href="#USB_3G_Modem"><span class="tocnumber">14</span> <span class="toctext">USB 3G Modem</span></a>
<ul>
<li class="toclevel-2 tocsection-78"><a href="#Introduction_12"><span class="tocnumber">14.1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-2 tocsection-79"><a href="#Kernel_Configuration_for_USB_Modem"><span class="tocnumber">14.2</span> <span class="toctext">Kernel Configuration for USB Modem</span></a></li>
<li class="toclevel-2 tocsection-80"><a href="#File_System_Changes"><span class="tocnumber">14.3</span> <span class="toctext">File System Changes</span></a></li>
<li class="toclevel-2 tocsection-81"><a href="#Usage"><span class="tocnumber">14.4</span> <span class="toctext">Usage</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-82"><a href="#Sensors"><span class="tocnumber">15</span> <span class="toctext">Sensors</span></a>
<ul>
<li class="toclevel-2 tocsection-83"><a href="#Accelerometer"><span class="tocnumber">15.1</span> <span class="toctext">Accelerometer</span></a></li>
<li class="toclevel-2 tocsection-84"><a href="#Light_sensor"><span class="tocnumber">15.2</span> <span class="toctext">Light sensor</span></a></li>
<li class="toclevel-2 tocsection-85"><a href="#Temperature_sensor"><span class="tocnumber">15.3</span> <span class="toctext">Temperature sensor</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-86"><a href="#Disclaimer"><span class="tocnumber">16</span> <span class="toctext">Disclaimer</span></a></li>
<li class="toclevel-1 tocsection-87"><a href="#Technical_Support_and_Product_Updates"><span class="tocnumber">17</span> <span class="toctext">Technical Support and Product Updates</span></a></li>
</ul>
</div>

<h1><span class="mw-headline" id="About_this_manual">About this manual</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=1" title="Edit section: About this manual">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>The goal of Porting Guide is to provide valuable information and instructions to people who want to run Android OS on their (new) HW. Information covered here will mainly be useful to port Android ICS DevKit Sitara-based devices.
</p><p>The information here is currently relevant to <a href="TI-Android-ICS-4.0.3-DevKit-3.0-3.html" title="TI-Android-ICS-4.0.3-DevKit-3.0.0 ReleaseNotes">TI Android ICS 4.0.3 DevKit 3.0.0</a> for AM37x and <a href="TI-Android-ICS-4.0.3-DevKit-3.0-7.html" title="TI-Android-ICS-4.0.3-DevKit-3.0.1 ReleaseNotes">TI Android ICS 4.0.3 DevKit 3.0.1</a> for AM335x.
</p><p><img alt="Note" src="https://processors.wiki.ti.com/images/b/b0/Light_bulb_icon.png" title="Note" width="18" height="25" /><b>Note:</b> Detailed porting information in the different technical areas is dependent on the respective h/w architecture.
</p>
<h1><span class="mw-headline" id="WLAN">WLAN</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=2" title="Edit section: WLAN">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h2><span class="mw-headline" id="Introduction">Introduction</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=3" title="Edit section: Introduction">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>This section of guide provides a step by step explanation of what's involved in adding a new WiFi driver and making WiFi work in a custom Android build like Rowboat.
<br />
</p>
<h2><span class="mw-headline" id="Features_Overview">Features Overview</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=4" title="Edit section: Features Overview">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li>WLAN (802.11 b/g/n)</li>
<li>Core IP pre-tested against WiFi specifications.</li>
<li>Station mode is fully supported.</li>
<li>Initial support for SoftAP/WiFi hotspot and WiFi Direct is available</li></ul>
<p><br />
</p>
<h2><span class="mw-headline" id="Android_WLAN_Sub-System_Overview">Android WLAN Sub-System Overview</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=5" title="Edit section: Android WLAN Sub-System Overview">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p><a href="File_WLAN_Stack.html" class="image"><img alt="WLAN Stack.jpg" src="https://processors.wiki.ti.com/images/4/4a/WLAN_Stack.jpg" width="960" height="720" /></a>
<br />
<br />
Diagram explains WLAN event flow from application to h/w with respect to rowboat android source tree.
</p>
<h4><span class="mw-headline" id="Application">Application</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=6" title="Edit section: Application">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<ul><li>Settings/Connection Manager:<b>&lt;android-src&gt;/packages/apps/Settings/src/com/android/settings/WirelessSettings.java</b></li></ul>
<h4><span class="mw-headline" id="Application_Framework">Application Framework</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=7" title="Edit section: Application Framework">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<ul><li>WiFi manager:<b>&lt;android-src&gt;/frameworks/base/wifi/java/android/net/wifi</b></li>
<li>JNI Implementation:<b>&lt;android-src&gt;/frameworks/base/core/jni/android_net_wifi_Wifi.cpp</b></li></ul>
<h4><span class="mw-headline" id="Libraries">Libraries</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=8" title="Edit section: Libraries">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<ul><li>libhardware_legacy:<b>&lt;android-src&gt;/hardware/libhardware_legacy/wifi/wifi.c</b></li>
<li>wpa_supplicant (Daemon):<b>&lt;android-src&gt;/external/hostap/wpa_supplicant</b></li>
<li>Higher level network management is done in <b>&lt;android-src&gt;/frameworks/base/core/java/android/net</b>.</li></ul>
<h2><span class="mw-headline" id="Driver_Configuration">Driver Configuration</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=9" title="Edit section: Driver Configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>In this Devkit release we are using WL12XX Compat wireless SDK. The drivers and firmwares of WL12XX Compat release are at <b>hardware/ti/wlan</b>
</p><p>To enable WLAN support in kernel the following settings need to be enabled:
</p>
<ul><li>First enable Wireless LAN device driver as shown below:</li></ul>
<pre>   Device Drivers  ---&gt;
       [*] Network device support  ---&gt;
           [*]   Wireless LAN ---&gt;
</pre>
<ul><li>Enable WLAN Networking support as shown below:</li></ul>
<pre>   [*] Networking support  ---&gt;
       -*-   Wireless  ---&gt;
           [*]   Wireless extensions sysfs files
</pre>
<p>This enables the following CONFIG options in kernel and allows WL12xx compat wlan drivers to be built:
</p>
<pre>   CONFIG_WLAN=y
   CONFIG_WIRELESS_EXT=y
   CONFIG_WEXT_CORE=y
   CONFIG_WEXT_PROC=y
   CONFIG_WEXT_PRIV=y
</pre>
<ul><li>The following additional options need to be enabled in kernel for WLAN to operate</li></ul>
<pre>  CONFIG_KEYS=y
  CONFIG_SECURITY=y
  CONFIG_CRYPTO=y
  CONFIG_CRYPTO_ARC4=y
  CONFIG_CRYPTO_ECB=y
  CONFIG_CRYPTO_AES=y
  CONFIG_CRYPTO_MICHAEL_MIC=y
  CONFIG_CRC7=y
</pre>
<ul><li>The relevant initialization and pin-muxing for MMC bus is done in the relevant board file e.g for AM335xevm <b><a rel="nofollow" class="external text" href="http://gitorious.org/rowboat/kernel/blobs/rowboat-am335x-kernel-3.2/arch/arm/mach-omap2/board-am335xevm.c">arch/arm/mach-omap2/board-am335xevm.c</a></b>. Do take care of this initialization and pin-muxing if using any other MMC bus e.g. MMC3.</li></ul>
<p>The following code snippet shows the board-specific WLAN configuration done on AM335xevm. The code below is provided for information only and is not complete. Please refer to the source for more details.
</p>
<table width="100%" cellpadding="0" cellspacing="0" style="background-color: #fff2f2; border: solid 1px #ffbfbf;">
<tbody><tr>
<td style="background-color: #ffafaf; border-bottom: 1px solid #888;"><font size="-1"><b>File:</b> arch/arm/mach-omap2/board-am335xevm.c arch/arm/mach-omap2/board-am335xevm.c</font>
</td></tr>
<tr>
<td>
<div class="scroll"><pre>struct wl12xx_platform_data am335xevm_wlan_data = {
        .irq = OMAP_GPIO_IRQ(AM335XEVM_WLAN_IRQ_GPIO),
        .board_ref_clock = WL12XX_REFCLOCK_38_XTAL, /* 38.4Mhz */
        .bt_enable_gpio = GPIO_TO_PIN(3, 21),
        .wlan_enable_gpio = GPIO_TO_PIN(1, 16),
};

/* Module pin mux for wlan and bluetooth */
static struct pinmux_config mmc2_wl12xx_pin_mux[] = {
        {"gpmc_a1.mmc2_dat0", OMAP_MUX_MODE3 | AM33XX_PIN_INPUT_PULLUP},
        {"gpmc_a2.mmc2_dat1", OMAP_MUX_MODE3 | AM33XX_PIN_INPUT_PULLUP},
        {"gpmc_a3.mmc2_dat2", OMAP_MUX_MODE3 | AM33XX_PIN_INPUT_PULLUP},
        {"gpmc_ben1.mmc2_dat3", OMAP_MUX_MODE3 | AM33XX_PIN_INPUT_PULLUP},
        {"gpmc_csn3.mmc2_cmd", OMAP_MUX_MODE3 | AM33XX_PIN_INPUT_PULLUP},
        {"gpmc_clk.mmc2_clk", OMAP_MUX_MODE3 | AM33XX_PIN_INPUT_PULLUP},
        {NULL, 0},
};
...
static int wl12xx_set_power(struct device *dev, int slot, int on, int vdd)
{
        if (on) {
                gpio_direction_output(am335xevm_wlan_data.wlan_enable_gpio, 1);
                mdelay(70);
        } else {
                gpio_direction_output(am335xevm_wlan_data.wlan_enable_gpio, 0);
        }

        return 0;
}

static void wl12xx_init(int evm_id, int profile)
{
...
        if (wl12xx_set_platform_data(&amp;am335xevm_wlan_data))
                pr_err("error setting wl12xx data\n");

        dev = am335x_mmc[1].dev;
        if (!dev) {
                pr_err("wl12xx mmc device initialization failed\n");
                goto out;
        }
...
        ret = gpio_request_one(am335xevm_wlan_data.wlan_enable_gpio,
                GPIOF_OUT_INIT_LOW, "wlan_en");
...
        setup_pin_mux(wl12xx_pin_mux);

        pdata-&gt;slots[0].set_power = wl12xx_set_power;
out:
        return;
}
</pre>
</div>
</td></tr></tbody></table>
<p><br />
</p><p><i>See also: <a href="WL127x.html" title="WL127x"> Wl127x WiLink6 Portal</a></i>
</p>
<h2><span class="mw-headline" id="Android_WiFi_HAL_Configuration">Android WiFi HAL Configuration</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=10" title="Edit section: Android WiFi HAL Configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li>Enable building of wpa_supplicant 0.8.x in your BoardConfig.mk (e.g. <b>device/ti/am335xevm/BoardConfig.mk</b> for AM335xevm and <b>device/ti/omap3evm/BoardConfig.mk</b> for AM37xevm)</li></ul>
<p>This is by simply adding following options in BoardConfig.mk:
</p>
<pre>   BOARD_WPA_SUPPLICANT_DRIVER     &#160;:= NL80211
   WPA_SUPPLICANT_VERSION          &#160;:= VER_0_8_X
   BOARD_WLAN_DEVICE               &#160;:= wl12xx_mac80211
   BOARD_SOFTAP_DEVICE             &#160;:= wl12xx_mac80211
   BOARD_WPA_SUPPLICANT_PRIVATE_LIB&#160;:= lib_driver_cmd_wl12xx
   WIFI_DRIVER_MODULE_PATH         &#160;:= "/system/lib/modules/wl12xx_sdio.ko"
   WIFI_DRIVER_MODULE_NAME         &#160;:= "wl12xx_sdio"
</pre>
<p>This will set  WPA_BUILD_SUPPLICANT to true in <b>external/wpa_supplicant_8/Android.mk</b> enabling building of wpa_supplicant 0.8.x with NL80211. At run time <b>wl12xx_sdio</b> will get loaded from <i>WIFI_DRIVER_MODULE_PATH</i>.
</p><p><b>BOARD_SOFTAP_DEVICE&#160;:= wl12xx_mac80211</b> needs to be set only if SoftAP/hotspot feature is required.
</p>
<ul><li>Next we need to provide a proper wpa_supplicant.conf for our device. That we will keep in <b>/data/misc/wifi</b>.</li></ul>
<ul><li>Set the correct permissions and paths created from <i>init.rc</i></li></ul>
<pre>   # give system access to wpa_supplicant.conf for backup and restore
   mkdir /system/etc/wifi 0770 system wifi
   chmod 0770 /system/etc/wifi
   chmod 0660 /system/etc/wifi/wpa_supplicant.conf
   chown system wifi /system/etc/wifi/wpa_supplicant.conf
   mkdir /data/misc/wifi 0770 system wifi
   mkdir /data/misc/wifi/sockets 0770 system wifi
   chmod 0770 /data/misc/wifi
   chmod 0660 /data/misc/wifi/wpa_supplicant.conf
   chown wifi wifi /data/misc/wifi
   chown wifi wifi /data/misc/wifi/wpa_supplicant.conf
</pre>
<p><b>Important</b>
We use System user(uid: 1000) to initiate wpa_supplicant service that way are able to enable WiFi over Android NFS rootfs. Here is the detailed discussion on that <a rel="nofollow" class="external text" href="http://groups.google.com/group/rowboat/browse_thread/thread/698e2b6e049e53e8/7e273dfb2afe87d1?pli=1">WiFi does not work when booting from an NFS file system</a>
</p>
<ul><li>Set the wifi interface name in <i>device.mk</i></li></ul>
<pre>  PRODUCT_PROPERTY_OVERRIDES&#160;:= \
       wifi.interface=wlan0
</pre>
<ul><li>Start <b>wpa_supplicant</b> and <b>dhcpcd</b> from <i>init.rc</i>.</li></ul>
<pre>   # wpa_supplicant and dhcp daemon
   service wpa_supplicant /system/bin/wpa_supplicant -Dnl80211 -iwlan0
       class main
       socket wpa_wlan0 dgram 660 wifi wifi
       disabled
       oneshot
</pre>
<pre>   service dhcpcd_wlan0 /system/bin/dhcpcd -ABKL
       class main
       disabled
       oneshot
</pre>
<pre>   service iprenew_wlan0 /system/bin/dhcpcd -n
       class main
       disabled
       oneshot
</pre>
<p>The following entries are required to configure SoftAP/hotspot and WiFi Direct functions:
</p>
<ul><li>Register <b>hostap</b> service for SoftAP/hotspot:</li></ul>
<pre>   service hostapd_bin /system/bin/hostapd -d /data/misc/wifi/hostapd.conf
       socket wpa_wlan1 dgram 660 wifi wifi
       disabled
       oneshot
</pre>
<ul><li>Register dhcp hooks for WiFi Direct:</li></ul>
<pre>   service dhcpcd_p2p /system/bin/dhcpcd -aABKL
       disabled
       oneshot
</pre>
<pre>   service iprenew_p2p /system/bin/dhcpcd -n
       disabled
       oneshot
</pre>
<h3><span class="mw-headline" id="Overlay_changes">Overlay changes</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=11" title="Edit section: Overlay changes">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The following entries enable Wi-Fi for use by android network manager.
</p><p>Add the following entries in device/ti/&lt;boardname&gt;/overlay/frameworks/base/core/res/res/values/config.xml
</p>
<pre>&lt;string-array translatable="false" name="networkAttributes"&gt;
...
        &lt;item&gt;"wifi,1,1,1,-1,true"&lt;/item&gt;
        &lt;item&gt;"wifi_p2p,13,1,0,-1,true"&lt;/item&gt;
...
    &lt;/string-array&gt;

&lt;string-array translatable="false" name="radioAttributes"&gt;
        &lt;item&gt;"1,1"&lt;/item&gt;
...
    &lt;/string-array&gt;
</pre>
<p>Add the required permissions file into the android filesystem by updating device.mk. This also enables the Wi-Fi and Wi-Fi Direct options in the Settings App.
</p>
<pre>PRODUCT_COPY_FILES&#160;:= \
...
    frameworks/base/data/etc/android.hardware.wifi.xml:system/etc/permissions/android.hardware.wifi.xml \
    frameworks/base/data/etc/android.hardware.wifi.direct.xml:system/etc/permissions/android.hardware.wifi.direct.xml
</pre>
<p><br />
The following commits in device/ti/omap3evm enable WiFi, SoftAP and WiFi Direct support on AM37xevm. Ensure that similar additions are done to support WiFi on your platform.
</p>
<ul><li>Enable WiFi <a rel="nofollow" class="external text" href="http://gitorious.org/rowboat/vendor-ti-omap3evm/commit/1529904cf72388874a079f7082b211fc754b7577">commit</a></li>
<li>Enable SoftAP <a rel="nofollow" class="external text" href="http://gitorious.org/rowboat/vendor-ti-omap3evm/commit/ed6e95ac6c838c079a1d416dbf586b873241b682">commit</a></li>
<li>Enable WiFi Direct <a rel="nofollow" class="external text" href="http://gitorious.org/rowboat/vendor-ti-omap3evm/commit/c4d4ca54c8992d393c02f250032512cb34d940b8">commit</a></li></ul>
<h2><span class="mw-headline" id="Verify_WLAN_from_console">Verify WLAN from console</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=12" title="Edit section: Verify WLAN from console">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The following steps perform basic checks to see if WiFi driver is operational:
</p>
<pre># lsmod
wl12xx 142062 0 - Live 0xbf08d000 (O)
mac80211 248275 1 wl12xx, Live 0xbf03c000 (O)
cfg80211 161123 2 wl12xx,mac80211, Live 0xbf004000 (O)
compat 1706 0 - Live 0xbf000000 (O)


# insmod /system/lib/modules/wl12xx_sdio.ko
[  154.549804] wl1271: loaded
</pre>
<p>If you do not see the message <b>wl1271: loaded</b> after inserting <i>wl12xx_sdio.ko</i> kernel module, the wifi driver initialization may not be correct. Please ensure that all the relevant pinmuxing and gpio configuration is correct and not over-written.
</p><p>Next, check that the driver is not unloaded after initialization:
</p>
<pre># netcfg
lo       UP                                   127.0.0.1/8   0x00000049 00:00:00:00:00:00
sit0     DOWN                                   0.0.0.0/0   0x00000080 00:00:00:00:00:00
eth0     UP                               172.24.190.76/22  0x00001043 40:5f:c2:76:4c:99
wlan0    DOWN                                   0.0.0.0/0   0x00001002 00:12:34:56:78:90
</pre>
<p>If wlan0 is not available in netcfg output, the driver might have been unloaded due to some error.
</p><p>Now, we try to up the wlan0 interface:
</p>
<pre># netcfg wlan0 up
[ 8255.485626] wl1271: firmware booted (Rev 6.3.6.0.79_2)
[ 8255.491027] wl1271: Driver version: R4_SP2_03_00
[ 8255.515350] ADDRCONF(NETDEV_UP): wlan0: link is not ready
</pre>
<p>The above messages show that the interface is up and the firmware is downloaded to wlan module and booted.
</p><p>Ensure that wlan drivers are unloaded before trying the Android UI for wireless settings
</p>
<pre># netcfg wlan0 down
# rmmod wl12xx_sdio
</pre>
<p>If wlan0 is not available in netcfg output, the driver might have been unloaded due to some error.
</p><p>TBD
</p>
<h2><span class="mw-headline" id="WLAN_calibration">WLAN calibration</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=13" title="Edit section: WLAN calibration">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li>Copy the ini files used for calibration to the sdcard</li></ul>
<pre>  sudo cp -rv rowboat/hardware/ti/wlan/mac80211/ti-utils/ini_files /media/rootfs/system/etc/wifi
</pre>
<ul><li>Boot the board. Make sure WLAN is disabled. wl12xx_sdio.ko should NOT be loaded</li></ul>
<pre>root@android:/ # lsmod
omaplfb 10662 0 - Live 0xbf0ed000 (O)
pvrsrvkm 159205 49 omaplfb, Live 0xbf0bc000 (O)
wl12xx 142062 0 - Live 0xbf08e000 (O)
mac80211 251034 1 wl12xx, Live 0xbf03c000 (O)
cfg80211 161115 2 wl12xx,mac80211, Live 0xbf004000 (O)
compat 1706 0 - Live 0xbf000000 (O)
</pre>
<ul><li>Remove existing calibration file</li></ul>
<pre>  rm /system/etc/firmware/ti-connectivity/wl1271-nvs.bin
</pre>
<ul><li>Run the calibrator tool</li></ul>
<pre>  calibrator plt autocalibrate wlan0 /system/lib/modules/wl12xx_sdio.ko /system/etc/wifi/ini_files/127x/TQS_S_2.6.ini /system/etc/firmware/ti-connectivity/wl1271-nvs.bin
</pre>
<p>NOTE: Running the calibration results in a random MAC address being set. To set the desired MAC address, run the following step:
</p>
<pre>  calibrator set nvs_mac /system/etc/firmware/ti-connectivity/wl1271-nvs.bin &lt;MAC Address&gt;
</pre>
<p>You can verify the MAC address using the following command:
</p>
<pre>  calibrator get nvs_mac /system/etc/firmware/ti-connectivity/wl1271-nvs.bin
</pre>
<h1><span class="mw-headline" id="Bluetooth">Bluetooth</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=14" title="Edit section: Bluetooth">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h2><span class="mw-headline" id="Introduction_2">Introduction</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=15" title="Edit section: Introduction">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>This section describes how to enable Bluetooth support on Android for wl1271 chipset.
<br />
</p>
<h2><span class="mw-headline" id="Features_Overview_2">Features Overview</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=16" title="Edit section: Features Overview">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li>Bluetooth 2.1</li>
<li>OPP, A2DP, AVRCP, HID profiles are supported.</li>
<li>HSP, HFP profiles are <b>NOT</b> supported</li></ul>
<p><br />
</p>
<h2><span class="mw-headline" id="Android_BT_Sub-System_Overview">Android BT Sub-System Overview</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=17" title="Edit section: Android BT Sub-System Overview">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p><a href="File_BT_Stack.html" class="image"><img alt="BT Stack.jpg" src="https://processors.wiki.ti.com/images/e/e0/BT_Stack.jpg" width="960" height="720" /></a>
</p><p><br />
</p><p>Enable Bluetooth with the following setting in BoardConfig.mk (e.g. <b>device/ti/am335xevm/BoardConfig.mk</b>) 
</p>
<pre>   # Bluetooth
   BOARD_HAVE_BLUETOOTH&#160;:= true
</pre>
<p>This enables bluez <b>external/bluez</b> HAL layer, which is used to connect with Android Frameworks (<b>frameworks/base/core/jni/android_bluetooth_*.cpp</b>, <b>frameworks/base/core/java/android/bluetooth/*.java</b> and <b>SystemServer</b> via DBUS .
</p>
<h2><span class="mw-headline" id="Driver_Configuration_2">Driver Configuration</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=18" title="Edit section: Driver Configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>TI Android DevKit uses the TI Wilink7 Bluetooth driver along with the TI Shared-Transport driver (TI-ST) for managing the BT-UART.
</p>
<ul><li>WL12xx BT is interfaced to UART1 on AM37xevm and AM335xevm. UART1 initialization and BT module registration with TI-ST is implemented at <b>arch/arm/mach-omap2/board-am335xevm.c</b> for AM37xevm and <b>arch/arm/mach-omap2/board-am335xevm.c</b> for AM335xevm.</li></ul>
<ul><li>Bluetooth support is enabled in the kernel as shown below:</li></ul>
<pre>   [*] Networking support  ---&gt; 
       &lt;*&gt;   Bluetooth subsystem support  ---&gt;
           [*]   L2CAP protocol support
           &lt;*&gt;   RFCOMM protocol support
           &lt;*&gt;   RFCOMM protocol support
           &lt;*&gt;   BNEP protocol support
           [*]     Multicast filter support
           [*]     Protocol filter support 
           &lt;*&gt;   HIDP protocol support 
                 Bluetooth device drivers  ---&gt;
                   &lt;*&gt; HCI UART driver
                   [*]   UART (H4) protocol support 
                   [*]   HCILL protocol support
       &lt;*&gt;   RF switch subsystem support
</pre>
<p>This enables the following CONFIG options:
</p>
<pre>CONFIG_BT=y
CONFIG_BT_L2CAP=y
CONFIG_BT_RFCOMM=y
CONFIG_BT_RFCOMM_TTY=y
CONFIG_BT_BNEP=y
CONFIG_BT_BNEP_MC_FILTER=y
CONFIG_BT_BNEP_PROTO_FILTER=y
CONFIG_BT_HIDP=y
CONFIG_BT_HCIUART=y
CONFIG_BT_HCIUART_H4=y
CONFIG_BT_HCIUART_LL=y
CONFIG_RFKILL=y
</pre>
<ul><li>The following CONFIG options enable TI-ST and WiLink Bluetooth driver support:</li></ul>
<pre>CONFIG_BT_WILINK=y
CONFIG_TI_ST=y
</pre>
<ul><li>The following kernel configs are required for Bluetooth AVRCP support:</li></ul>
<pre>CONFIG_INPUT_MISC=y
CONFIG_INPUT_UINPUT=y
</pre>
<p>You can check this as follows:
</p>
<pre>   Device Drivers  ---&gt;
       Input device support  ---&gt;
           [*]   Miscellaneous devices  ---&gt;
                   &lt;*&gt;   User level driver support
</pre>
<p><br />
The following code-snippet shows board-level configuration for TI-ST on AM335xevm:
</p>
<table width="100%" cellpadding="0" cellspacing="0" style="background-color: #fff2f2; border: solid 1px #ffbfbf;">
<tbody><tr>
<td style="background-color: #ffafaf; border-bottom: 1px solid #888;"><font size="-1"><b>File:</b> arch/arm/mach-omap2/board-am335xevm.c</font>
</td></tr>
<tr>
<td>
<div class="scroll"><pre>struct ti_st_plat_data wilink_pdata = {
	.nshutdown_gpio = GPIO_TO_PIN(3, 21),
	.dev_name = "/dev/ttyO1",
	.flow_cntrl = 1,
	.baud_rate = 3000000,
	.suspend = plat_kim_suspend,
	.resume = plat_kim_resume,
	.chip_enable = plat_kim_chip_enable,
	.chip_disable = plat_kim_chip_disable,
};

static struct platform_device wl12xx_device = {
	.name		= "kim",
	.id		= -1,
	.dev.platform_data = &amp;wilink_pdata,
};

static struct platform_device btwilink_device = {
	.name = "btwilink",
	.id = -1,
};

static inline void __init am335xevm_init_btwilink(void)
{
	pr_info("am335xevm: bt init\n");

	platform_device_register(&amp;wl12xx_device);
	platform_device_register(&amp;btwilink_device);
}
</pre>
</div>
</td></tr></tbody></table>
<p><br />
</p>
<h2><span class="mw-headline" id="Android_BT_HAL_Configuration">Android BT HAL Configuration</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=19" title="Edit section: Android BT HAL Configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li>Set the correct permissions and paths created from <i>init.rc</i></li></ul>
<pre>   #Owners, Modes for Bluetooth
   chmod 0660 /dev/ttyO1
   chown bluetooth bluetooth /dev/ttyO1
   chmod 0660 /sys/class/rfkill/rfkill0/state
   chown bluetooth bluetooth /sys/class/rfkill/rfkill0/state
</pre>
<ul><li>The following services are registered in <i>init.rc</i> for Bluetooth operation:</li></ul>
<ul><li>dbus-daemon: (deal connections between hcid and system server)</li></ul>
<pre>   service dbus /system/bin/dbus-daemon --system --nofork
   class main
   socket dbus stream 660 bluetooth bluetooth
   user bluetooth
   group bluetooth net_bt_admin
</pre>
<ul><li>bluetoothd: create hcid (Bluetooth Host Controller Interface Daemon) service, but disabled at first</li></ul>
<pre>   service bluetoothd /system/bin/bluetoothd -n
   class main
   socket bluetooth stream 660 bluetooth bluetooth
   socket dbus_bluetooth stream 660 bluetooth bluetooth
   # init.rc does not yet support applying capabilities, so run as root and
   # let bluetoothd drop uid to bluetooth with the right linux capabilities
   group bluetooth net_bt_admin misc
   disabled
</pre>
<ul><li>uim-sysfs: userspace module for TI-ST kernel driver. This service attaches the BT UART HCI interface to the bluetooth stack at 3000000 baud rate. It is also responsible for loading the BT firmware on WL1271. The sources for uim-sysfs is found in <b>hadware/ti/wpan</b></li></ul>
<pre>   #shared transport user space mgr service for Bluetooth, FM and GPS
   service uim /system/bin/uim-sysfs
   class core
   user bluetooth
   group bluetooth net_bt_admin
</pre>
<h3><span class="mw-headline" id="Overlay_changes_2">Overlay changes</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=20" title="Edit section: Overlay changes">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Add bluetooth entry in the overlay to indicate bluetooth availability to network manager
</p>
<pre>&lt;string-array translatable="false" name="networkAttributes"&gt;
...
    &lt;item&gt;"bluetooth,7,7,0,-1,true"&lt;/item&gt;
...
&lt;/string-array&gt;

&lt;string-array translatable="false" name="radioAttributes"&gt;
...
    &lt;item&gt;"7,1"&lt;/item&gt;
...
</pre>
<p>Copy the Bluetooth permissions file and the relevant bluez conf file. The permissions file also enables Bluetooth menu in Settings
</p>
<pre>PRODUCT_COPY_FILES += \
    device/ti/omap3evm/android.hardware.bluetooth.xml:system/etc/permissions/android.hardware.bluetooth.xml \
    system/bluetooth/data/main.nonsmartphone.conf:system/etc/bluetooth/main.conf
</pre>
<h1><span class="mw-headline" id="Audio">Audio</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=21" title="Edit section: Audio">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h2><span class="mw-headline" id="Introduction_3">Introduction</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=22" title="Edit section: Introduction">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>AM37xevm uses the audio module of TPS65950 while AM335xevm uses AIC31 audio codec module for analog audio input and output.
</p><p>The audio module is interfaced to the main processor through the TDM / I2S interface and used to transmit and receive audio data. The  audio codec is connected via Multi-Channel Buffered Serial Port (McBSP) interface on AM37xevm and Multi-Channel Audio Serial Port (McASP) interface on AM335x, to the main processor. 
</p><p>The Audio module is controlled by internal registers that can be accessed by the high speed I2C control interface.
</p><p>This user manual section defines and describes the user level and platform level interfaces of the ALSA SoC Audio driver.
</p>
<h2><span class="mw-headline" id="Features_Overview_3">Features Overview</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=23" title="Edit section: Features Overview">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The features supported by ALSA SoC Audio driver are: 
</p>
<ul><li>Supports audio codec in ALSA SoC framework.</li>
<li>Multiple sample rates support (8 KHz, 16 KHz, 22.05 KHz, 32 KHz, 44.1 KHz, 48 KHz etc) for both capture and playback.</li>
<li>Supports audio in stereo mode.</li>
<li>Supports simultaneous playback and record (full-duplex mode).</li>
<li>Start, stop, pause and resume feature.</li>
<li>Supports mixer interface for audio codecs.</li></ul>
<p><br />
<b>Important</b>
</p><p>Please note that enabling any line-in inputs necessitates connecting an audio playback source's output; connecting a (non-preamplified) microphone input (like the one from a head-set jack) might not work.
</p>
<h2><span class="mw-headline" id="Android_Audio_Sub-System_Overview">Android Audio Sub-System Overview</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=24" title="Edit section: Android Audio Sub-System Overview">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>TBD
</p>
<h2><span class="mw-headline" id="Driver_Configuration_3">Driver Configuration</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=25" title="Edit section: Driver Configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li>Please refer to <a href="UserGuideAudioDriver_PSP_04.02.00.html" title="UserGuideAudioDriver PSP 04.02.00.07">PSP 04.02.00.07 Audio Driver Guide</a> for details on audio driver features and kernel configuration for AM37x</li>
<li>Please refer to <a href="AM335x_Audio_Driver%27s_Guide.html" title="AM335x Audio Driver&#39;s Guide">AM335x Audio Driver's Guide</a> for more information on AM335x audio driver and kernel configuration.</li></ul>
<h2><span class="mw-headline" id="Android_Audio_HAL_Configuration">Android Audio HAL Configuration</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=26" title="Edit section: Android Audio HAL Configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Android uses the kernel ALSA framework for audio input/output.
</p><p>The <b>tinyalsa</b> utilities present at <i><a rel="nofollow" class="external text" href="http://gitorious.org/rowboat/external-tinyalsa/trees/rowboat-ics">external/tinyalsa</a></i> are used for audio playback, capture and configuration. These can be used to test the audio functionality and configuration at kernel-level.
</p><p>The ALSA HAL is present at <b><a rel="nofollow" class="external text" href="http://gitorious.org/rowboat/hardware-ti-omap3/blobs/rowboat-ics/audio/audio_hw.c">hardware/ti/omap3/audio/audio_hw.c</a></b>. The compiled HAL is named <b>audio.primary.&lt;boardname&gt;.so</b>
</p>
<div class="block-note"><span class="block-contents"><img alt="Note" src="https://processors.wiki.ti.com/images/b/b0/Light_bulb_icon.png" title="Note" width="18" height="25" /><b>Note:</b> Android handles volume control in software. We recommend to keep the default volume levels close to maximum in the ALSA HAL.</span></div>
<p>The following commits enable audio support for AM37xevm and AM335xevm:
</p>
<ul><li>AM37xevm: Enable audio support <a rel="nofollow" class="external text" href="http://gitorious.org/rowboat/vendor-ti-omap3evm/commit/6ad9ce83566ae110053c87a20fc302af24feda0c">commit</a></li>
<li>AM335xevm: Enable audio support <a rel="nofollow" class="external text" href="http://gitorious.org/rowboat/vendor-ti-am335xevm/commit/c90eb2b2f1f63d5294e9e52b553cdf7dba84cba2">commit</a></li></ul>
<p><br /> 
<b>Important</b><br /> 
Please note that enabling any line-in inputs necessitates connecting an audio playback source's output&#160;; connecting a (non-preamplified) microphone input (like the one from a head-set jack) might not work.
</p><p><br />
</p>
<h1><span class="mw-headline" id="Display">Display</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=27" title="Edit section: Display">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h2><span class="mw-headline" id="Introduction_4">Introduction</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=28" title="Edit section: Introduction">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>This section of the porting guide describes the display system with respect to TI Android ICS DevKit. AM37xevm, flashboard and AM335xevm use LCD interface for display while BeagleBoard uses DVI output.
</p><p>Depending on the display size, android uses either the phone layout (e.g. AM37xevm, AM335xevm) or tablet layout (Beagleboard).
</p>
<h2><span class="mw-headline" id="Features_Overview_4">Features Overview</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=29" title="Edit section: Features Overview">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li>Supports LCD display interface on AM37xevm, Flashboard, AM335xevm and BeagleBone with LCD cape</li>
<li>Supports DVI output on Beagleboard, AM37xevm, Flashboard and BeagleBone with DVI-D cape</li></ul>
<h2><span class="mw-headline" id="Android_Display_Subsystem_Overview">Android Display Subsystem Overview</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=30" title="Edit section: Android Display Subsystem Overview">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>TBD
</p>
<h2><span class="mw-headline" id="Driver_Configuration_4">Driver Configuration</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=31" title="Edit section: Driver Configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li>Refer <a href="UserGuideDisplayDrivers_PSP_04.02.00.html" title="UserGuideDisplayDrivers PSP 04.02.00.07">PSP 04.02.00.07 Display Driver Guide</a> for AM37x</li>
<li>Refer <a href="http://software-dl.ti.com/processor-sdk-linux/esd/docs/latest/linux/Foundational_Components/Kernel/Kernel_Drivers/Display/LCDC.html" title="AM335x LCD Controller Driver&#39;s Guide">AM335x LCD Controller Driver's Guide</a> for AM335x</li></ul>
<h1><span class="mw-headline" id="Display_backlight">Display backlight</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=32" title="Edit section: Display backlight">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h2><span class="mw-headline" id="Introduction_5">Introduction</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=33" title="Edit section: Introduction">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>This section explains how the LCD backlight control is implemented in the DevKit. For variable backlight intensity, PWM-controlled backlight is generally used.
</p>
<h2><span class="mw-headline" id="Driver_Configuration_5">Driver Configuration</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=34" title="Edit section: Driver Configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>TBD
</p>
<h2><span class="mw-headline" id="Android_Configuration">Android Configuration</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=35" title="Edit section: Android Configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>For integration with the Android Backlight settings configuration, the liblights HAL needs to be implemented for the board. The output HAL library should have the name <b>lights.&lt;TARGET_PRODUCT&gt;.so</b>. E.g. for AM335x EVM, the liblights HAL is called <i>lights.am335xevm.so</i>.
</p><p>The liblights backlight HAL for AM335x EVM is implemented at <a rel="nofollow" class="external text" href="http://gitorious.org/rowboat/vendor-ti-am335xevm/trees/rowboat-ics/liblights">device/ti/am335xevm/liblights</a>.
</p>
<h1><span class="mw-headline" id="MMC">MMC</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=36" title="Edit section: MMC">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h2><span class="mw-headline" id="Introduction_6">Introduction</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=37" title="Edit section: Introduction">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The MMC/SD card is used as the primary boot device and storage device on TI Android DevKit. This section gives details on configuring the MMC interface and supporting MMC/SD storage card.
</p><p><br />
</p>
<h2><span class="mw-headline" id="Features_Overview_5">Features Overview</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=38" title="Edit section: Features Overview">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The MMC/SD/SDIO driver supports following features
<br /> 
</p>
<ul><li>The driver is built in-kernel (part of vmlinux).</li>
<li>MMC cards including High Speed cards.</li>
<li>SD cards including SD High Speed and SDHC cards</li>
<li>Uses block bounce buffer to aggregate scattered blocks</li></ul>
<p><br />
</p>
<h2><span class="mw-headline" id="Driver_Configuration_6">Driver Configuration</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=39" title="Edit section: Driver Configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li>Refer <a href="UserGuideMmcDriver_PSP_04.02.00.html" title="UserGuideMmcDriver PSP 04.02.00.07">PSP 04.02.00.07 MMC Driver Guide</a> for AM37x</li>
<li>Refer <a href="AM335x_MMC/SD_Driver%27s_Guide.html" title="AM335x MMC/SD Driver&#39;s Guide">AM335x MMC/SD Driver's Guide</a> for AM335x</li></ul>
<h2><span class="mw-headline" id="Android_MMC_HAL_or_Vold_Configuration">Android MMC HAL or Vold Configuration</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=40" title="Edit section: Android MMC HAL or Vold Configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Android system uses vold as the mount daemon, which detects, mounts and monitors the status of sdcard. The mount daemon needs a configuration file to tell it what the sdcard device is. Since Android 2.2 (froyo), it ships with a new implementation of vold (aka vold2). The configuration is changed to /etc/vold.fstab and its format is also changed. See <b><a rel="nofollow" class="external text" href="http://gitorious.org/rowboat/system-core/blobs/rowboat-ics/rootdir/etc/vold.fstab">system/core/rootdir/etc/vold.fstab</a></b> in the Android source tree for the detailed explanations of the format.
</p><p>However, a fixed vold.fstab can only support block device with fixed name. 
</p>
<pre># cat /etc/vold.fstab
<b>dev_mount sdcard /mnt/sdcard 3 /devices/platform/omap/omap_hsmmc.0/mmc_host/mmc0</b>
dev_mount usb /mnt/usb2 auto /devices/platform/omap/ti81xx-usbss/musb-hdrc.1/usb2
</pre>
<p>Depending on the interface used these values can change. Best way is to probe sysfs directories to find the fixed name. For MMC the entry will be of the form:
</p>
<pre> /sys/devices/platform/omap/omap_hsmmc.X/mmc_host/mmcY
</pre>
<p><br />
Update the android storage list overlay at overlay/frameworks/base/core/res/res/xml/storage_list.xml
</p>
<pre>&lt;StorageList xmlns:android="http://schemas.android.com/apk/res/android"&gt;
    &lt;storage android:mountPoint="/mnt/sdcard"
             android:storageDescription="@string/storage_internal"
             android:primary="true"
             android:emulated="true"
             android:mtpReserve="100"
             android:allowMassStorage="true" /&gt;
&lt;/StorageList&gt;
</pre>
<h1><span class="mw-headline" id="Touchscreen">Touchscreen</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=41" title="Edit section: Touchscreen">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h2><span class="mw-headline" id="Introduction_7">Introduction</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=42" title="Edit section: Introduction">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The touchscreen is the primary input device for TI Android DevKit on AM37xevm, Flashboard and AM335xevm.
</p>
<h2><span class="mw-headline" id="Features_Overview_6">Features Overview</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=43" title="Edit section: Features Overview">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The features supported by Touchscreen in Android are:
</p>
<ul><li>Single touch input</li>
<li>Single click</li>
<li>Single long click</li>
<li>Uni-direction motion touch</li></ul>
<h2><span class="mw-headline" id="Driver_Configuration_7">Driver Configuration</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=44" title="Edit section: Driver Configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h3><span class="mw-headline" id="Add_touchscreen_driver_support">Add touchscreen driver support</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=45" title="Edit section: Add touchscreen driver support">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ul><li>AM37x&#160;: TBD</li>
<li>AM335x evm: Refer <a href="AM335x_Touchscreen_Driver%27s_Guide.html" title="AM335x Touchscreen Driver&#39;s Guide">AM335x Touchscreen Driver's Guide</a> for details</li></ul>
<h3><span class="mw-headline" id="Test_touch_driver_using_getevent">Test touch driver using getevent</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=46" title="Edit section: Test touch driver using getevent">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ul><li>Once ADC Touchscreen driver is up through board file (e.g. board-am335xevm.c) configuration.</li>
<li>Test with AndroidFS as events are coming while touching the LCD display. Run on command prompt:</li></ul>
<pre>    # getevent
    add device 1: /dev/input/event1
      name:     "ti-tsc-adcc"

    /dev/input/event1: 0003 0000 00000659
    /dev/input/event1: 0003 0001 00000a31
    /dev/input/event1: 0001 014a 00000001
    /dev/input/event1: 0000 0000 00000000
    /dev/input/event1: 0003 0000 00000654
    /dev/input/event1: 0000 0000 00000000
    </pre>
<ul><li>It confirms that touch inputs and irq based event generation is working fine.</li></ul>
<h3><span class="mw-headline" id="Touch_Calibration">Touch Calibration</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=47" title="Edit section: Touch Calibration">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ul><li>Touch inputs (x, y, pressure) need to calibrate based on touch controller used.</li>
<li>To define the touch input boundaries, the following macros are used in driver (e.g. drivers/input/touchscreen/ti_tscadc.c)
<ul><li><b>AM335X_XMIN</b> -- Minimum raw x input possible</li>
<li><b>AM335X_XMAX</b> -- Maximum raw x input possible</li>
<li><b>AM335X_YMIN</b> -- Minimux raw y input possible</li>
<li><b>AM335X_YMAX</b> -- Maximum raw y input possible</li></ul></li>
<li>add the log to get print of x, y and pressure values as raw and absolute both in function <b>tscadc_interrupt()</b>:</li></ul>
<pre>    /* Calibrate absolute value of x and y co-ordinate */
    val_x = ts_dev-&gt;x_max -
                ((ts_dev-&gt;x_max * (val_x - AM335X_TS_XMIN)) /
                    (AM335X_TS_XMAX - AM335X_TS_XMIN));
    val_y = ts_dev-&gt;y_max -
                ((ts_dev-&gt;y_max * (val_y - AM335X_TS_YMIN)) /
                    (AM335X_TS_YMAX - AM335X_TS_YMIN));
</pre>
<ul><li>Get the debug log for x, y and pressure at following points on the touchscreen
<ul><li>Left Top Most Point</li>
<li>Right Top Most Point</li>
<li>Left Bottom Down Point</li>
<li>Right Bottom Down Point</li></ul></li>
<li>Update the macros based on observation of above input points
<ul><li>set AM335X_XMIN value as "minimum x input possible value from the reading of left top most touch"</li>
<li>set AM335X_XMAX value as "maximum x input possible value from the reading of right top most touch"</li>
<li>set AM335X_YMIN value as "minimux y input possible value from the reading of left top most touch"</li>
<li>set AM335X_YMAX value as "maximum y input possible value from the reading of left bottom down touch"</li></ul></li></ul>
<p><i>Note:</i> Above four macros need to be fine tune to get the correct absolute value of x and y.
</p>
<ul><li>For example in ads7846.c:</li></ul>
<pre>#ifdef CONFIG_MACH_AM335XEVM
#define AM335X_XMIN           0x0A5
#define AM335X_XMAX           0xFB0
#define AM335X_YMIN           0x0DC
#define AM335X_YMAX           0xF43
#endif
</pre>
<p><span style="color: BLUE;"><b>Note:</b> sometimes calculation method return negative values. Then method needs some modification to get positive calculated touch inputs.</span>
<br />
</p>
<h3><span class="mw-headline" id="Test_Touch_Calibration_in_Android">Test Touch Calibration in Android</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=48" title="Edit section: Test Touch Calibration in Android">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ul><li>Run android on the board.</li>
<li>select "Menu" -&gt; "Dev Tools" -&gt; "Pointer Location" utility</li>
<li>Touch and draw on the screen and observe that the expected points are getting marked on the LCD screen.</li>
<li>if drawing on LCD is not proper then driver needs to be fine tune the above mentioned macros.</li></ul>
<h2><span class="mw-headline" id="Android_Touchscreen_configuration">Android Touchscreen configuration</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=49" title="Edit section: Android Touchscreen configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>TBD
</p><p><i>See also&#160;:<a rel="nofollow" class="external free" href="http://source.android.com/tech/input/touch-devices.html">http://source.android.com/tech/input/touch-devices.html</a></i>
</p>
<h1><span class="mw-headline" id="Keypad">Keypad</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=50" title="Edit section: Keypad">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h2><span class="mw-headline" id="Introduction_8">Introduction</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=51" title="Edit section: Introduction">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The matrix gpio keypad and Volume gpio keys are in AM335x EVM. Here porting explanation for matrix gpio keypad controller.
</p>
<h2><span class="mw-headline" id="Features_Overview_7">Features Overview</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=52" title="Edit section: Features Overview">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li>3x2 matrix key layout supported</li>
<li>single click input</li></ul>
<h2><span class="mw-headline" id="Driver_Configuration_8">Driver Configuration</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=53" title="Edit section: Driver Configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p><b> Add keypad driver support </b>
</p>
<ul><li>start the <i>Linux Kernel Configuration</i> tool:</li></ul>
<pre>    $ make ARCH=arm menuconfig
</pre> 
<ul><li>Select <span style="color: BLUE;"><i>Device Drivers</i></span> from the main menu.</li></ul>
<pre>    ...
    Power management options ---&gt;
    [*] Networking support ---&gt;
    '''Device Drivers ---&gt;'''
    File systems ---&gt;
    Kernel hacking ---&gt;
    ...</pre>
<ul><li>Select <span style="color: BLUE;"><i>Input device support</i></span> form the next menu:</li></ul>
<pre>    ...
    [ ] ISDN support  ---&gt;
    &lt; &gt; Telephony support  ---&gt;
    '''Input device support  ---&gt;'''
    Character devices  ---&gt;
    -*- I2C support  ---&gt;
    ...</pre>
<ul><li>Select <span style="color: BLUE;"> <i>Keyboards</i> </span> from the next menu:</li></ul>
<pre>    ...
    &lt; &gt;   Reset key
          *** Input Device Drivers ***
    '''[*]   Keyboards  ---&gt;'''
    [ ]   Mice  ---&gt;
    [ ]   Joysticks/Gamepads  ---&gt;
....</pre>
<ul><li>Select <span style="color: BLUE;"> <i>GPIO driven matrix keypad support</i> and <i>GPIO Buttons</i></span> from the next menu:</li></ul>
<pre>    ....
 &lt; &gt;   DECstation/VAXstation LK201/LK401 keyboard
 &lt;*&gt;   GPIO Buttons
 &lt; &gt;   Polled GPIO buttons
 &lt; &gt;   TCA6416/TCA6408A Keypad Support
 &lt;*&gt;   GPIO driven matrix keypad support
 &lt; &gt;   Maxim MAX7359 Key Switch Controller
....</pre>
<p><b>Board-specific Configuration</b>
The board-specific configuration includes, specifying the GPIOs, no. of rows and columns, debounce, scan settings etc. The following code snippet shows the configuration for AM335x EVM (arch/arm/mach-omap2/board-am335xevm.c).
</p>
<pre>static const uint32_t am335x_evm_matrix_keys[] = {
        KEY(0, 0, KEY_MENU),
        KEY(1, 0, KEY_BACK),
        KEY(2, 0, KEY_LEFT),

        KEY(0, 1, KEY_RIGHT),
        KEY(1, 1, KEY_ENTER),
        KEY(2, 1, KEY_DOWN),
};

const struct matrix_keymap_data am335x_evm_keymap_data = {
        .keymap      = am335x_evm_matrix_keys,
        .keymap_size = ARRAY_SIZE(am335x_evm_matrix_keys),
};

static const unsigned int am335x_evm_keypad_row_gpios[] = {
        GPIO_TO_PIN(1, 25), GPIO_TO_PIN(1, 26), GPIO_TO_PIN(1, 27)
};

static const unsigned int am335x_evm_keypad_col_gpios[] = {
        GPIO_TO_PIN(1, 21), GPIO_TO_PIN(1, 22)
};

static struct matrix_keypad_platform_data am335x_evm_keypad_platform_data = {
        .keymap_data       = &amp;am335x_evm_keymap_data,
        .row_gpios         = am335x_evm_keypad_row_gpios,
        .num_row_gpios     = ARRAY_SIZE(am335x_evm_keypad_row_gpios),
        .col_gpios         = am335x_evm_keypad_col_gpios,
        .num_col_gpios     = ARRAY_SIZE(am335x_evm_keypad_col_gpios),
        .active_low        = false,
        .debounce_ms       = 5,
        .col_scan_delay_us = 2,
};

...

static struct gpio_keys_button am335x_evm_volume_gpio_buttons[] = {
        {
                .code                   = KEY_VOLUMEUP,
                .gpio                   = GPIO_TO_PIN(0, 2),
                .active_low             = true,
                .desc                   = "volume-up",
                .type                   = EV_KEY,
                .wakeup                 = 1,
        },
        {
                .code                   = KEY_VOLUMEDOWN,
                .gpio                   = GPIO_TO_PIN(0, 3),
                .active_low             = true,
                .desc                   = "volume-down",
                .type                   = EV_KEY,
                .wakeup                 = 1,
        },
};

static struct gpio_keys_platform_data am335x_evm_volume_gpio_key_info = {
        .buttons        = am335x_evm_volume_gpio_buttons,
        .nbuttons       = ARRAY_SIZE(am335x_evm_volume_gpio_buttons),
};
</pre>
<p><b> Test keypad driver using getevent </b>
</p>
<ul><li>Once matrix gpio keypad and volume gpio keys driver is up through board file (e.g. board-am335xevm.c) configuration.</li>
<li>Test with AndroidFS as events are coming while pressing the keys. Run on command prompt:</li></ul>
<pre>    # getevent
    add device 1: /dev/input/event2
            name: "gpio-keys"
    add device 2: /dev/input/event0
            name: "matrix-keypad"

    /dev/input/event0: 0004 0004 00000002
    /dev/input/event0: 0001 009e 00000001
    /dev/input/event0: 0000 0000 00000000
    /dev/input/event0: 0004 0004 00000002
    /dev/input/event0: 0001 009e 00000000
    /dev/input/event0: 0000 0000 00000000
    </pre>
<ul><li>It confirms that keypad inputs and irq based event generation is working fine.</li></ul>
<h2><span class="mw-headline" id="Android_Keypad_Configuration">Android Keypad Configuration</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=54" title="Edit section: Android Keypad Configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li>Android requires Key layout files (.kl files) for mapping Linux key codes and axis codes to Android key codes and axis codes and specifying associated policy flags.</li>
<li>The &lt;matrix keypad driver name&gt;.kl (e.g. QWERTY_Keypad.kl) or &lt;gpio keypad driver name&gt;.kl (e.g. gpio-keys.kl) should be present in root directory of AndroidFS.</li>
<li>Syntax of a Key layout File (Refer to the link: <a rel="nofollow" class="external free" href="http://source.android.com/tech/input/key-layout-files.html">http://source.android.com/tech/input/key-layout-files.html</a>):</li></ul>
<dl><dd><ul><li>Key declarations each consist of the keyword "key" followed by a Linux key code number(In Decimal), an Android key code name, and optional set of whitespace delimited policy flags.</li>
<li>For example:</li></ul></dd></dl>
<pre>  The gpio-keys.kl for Beaglebone looks like:
  # Beaglebone LCD Cape  GPIO KEYPAD keylayout
  key 105   BACK               WAKE
  key 106   HOME               WAKE
  key 103   MENU               WAKE
  key 108   SEARCH             WAKE
  key 28    POWER              WAKE
</pre>
<dl><dd><ul><li>For finding a suitable Android key code name for your requirement, follow the link: <a rel="nofollow" class="external free" href="http://source.android.com/tech/input/keyboard-devices.html">http://source.android.com/tech/input/keyboard-devices.html</a></li>
<li>The Policy Flags specify extra information such as: whether this key should wake the device, also while waking the device should this key press be considered etc. Complete information is available under the "Key Declarations" in the link: <a rel="nofollow" class="external free" href="http://source.android.com/tech/input/key-layout-files.html">http://source.android.com/tech/input/key-layout-files.html</a></li></ul></dd></dl>
<p><br />
</p>
<h1><span class="mw-headline" id="NAND">NAND</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=55" title="Edit section: NAND">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h2><span class="mw-headline" id="Introduction_9">Introduction</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=56" title="Edit section: Introduction">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>This section of porting guide will describe the NAND layout present on AM335x EVM and how to integrate Fastboot functionality in u-boot. Micron MT29F2G08ABA Nand part (AM335x EVM) is supported.
</p><p><b>NAND Layout</b>
</p><p>The NAND on the EVM has been configured in the following manner.
</p>
<pre> +------------+--&gt;0x00000000-&gt; SPL start
 |            |
 |            |--&gt;0x0001FFFF-&gt; SPL end  
 |            |--&gt;0x00020000-&gt; SPL.backup1 start
 |            |
 |            |--&gt;0x0003FFFF-&gt; SPL.backup1 end  
 |            |--&gt;0x00040000-&gt; SPL.backup2 start
 |            |
 |            |--&gt;0x0005FFFF-&gt; SPL.backup2 end  
 |            |--&gt;0x00060000-&gt; SPL.backup3 start
 |            |
 |            |--&gt;0x0007FFFF-&gt; SPL.backup3 end  
 |            |--&gt;0x00080000-&gt; U-Boot start
 |            |
 |            |--&gt;0x0025FFFF-&gt; U-Boot end  
 |            |--&gt;0x00260000-&gt; U-Boot ENV start
 |            |
 |            |
 |            |--&gt;0x0027FFFF-&gt; ENV end
 |            |--&gt;0x00280000-&gt; Linux Kernel start
 |            |
 |            |
 |            |
 |            |
 |            |--&gt;0x0077FFFF-&gt; Linux Kernel end
 |            |--&gt;0x00780000-&gt; Filesystem start
 |            |
 |            |
 |            |
 |            |
 |            |
 |            |
 |            |
 |            |
 +------------+--&gt;0x10000000-&gt; Filesystem end
</pre>
<p><br />
</p>
<h2><span class="mw-headline" id="Features_Overview_8">Features Overview</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=57" title="Edit section: Features Overview">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p><br />
</p>
<h2><span class="mw-headline" id="Driver_Configuration_9">Driver Configuration</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=58" title="Edit section: Driver Configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li>Start the Kernel configuration tool to enable/disable NAND and UBIFS support:</li></ul>
<pre>$ make ARCH=arm menuconfig
</pre>
<ul><li>Enable NAND support from the main menu. Select Device Drivers -&gt; MTD support -&gt; NAND support.</li></ul>
<pre>-&gt; Device Drivers
   -&gt; Memory Technology Device (MTD) support (MTD [=y])
      -&gt; NAND Device Support (MTD_NAND [=y])     
</pre>
<ul><li>Enable UBI support. Select Device Drivers -&gt; MTD support -&gt; Enable UBI.</li></ul>
<pre>-&gt; Device Drivers
   -&gt; Memory Technology Device (MTD) support (MTD [=y])
      -&gt; Enable UBI - Unsorted block images (MTD_UBI [=y])
</pre>
<ul><li>Enable UBIFS support. Select Filesystems -&gt; Misc filesystems -&gt; UBIFS support.</li></ul>
<pre>-&gt; File systems
   -&gt; Miscellaneous filesystems (MISC_FILESYSTEMS [=y])
      -&gt; UBIFS file system support (UBIFS_FS [=y])
</pre>
<p><br />
</p>
<h2><span class="mw-headline" id="Fastboot">Fastboot</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=59" title="Edit section: Fastboot">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Fastboot flashing utility is for updating the different software components of Android. Here is a guide to re-flash the spl, u-boot, kernel and root-filesystem (UBIFS image). This guide assume that Rowboat has been compiled before trying out these instructions.
</p>
<h3><span class="mw-headline" id="Establishing_Fastboot_connectivity">Establishing Fastboot connectivity</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=60" title="Edit section: Establishing Fastboot connectivity">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ul><li>Connect serial port to host PC via null modem cable.</li>
<li>Serial port settings: 115200 8N1, No flow control.</li>
<li>Apply power to the board.</li>
<li>Press any key in serial port utility during boot and get U-boot command prompt.</li>
<li>Run "fastboot" on u-boot command prompt (u-boot will echo "fastboot initialized").</li>
<li>Connect USB cable between USB OTG port of the board and host PC.</li></ul>
<p><b> Setup on Linux host </b>
</p>
<ul><li>On command prompt, run</li></ul>
<pre>   $ export ANDROID_ROOT=&lt;rowboat top level directory&gt;
</pre>
<pre>   $ cd $ANDROID_ROOT/out/host/linux-x86/bin
</pre>
<pre>   $ sudo ./fastboot devices
</pre>
<p>if a device number is echoed, fastboot is working.
</p><p><b> Setup on Windows host </b>
</p>
<ul><li>Refer <a rel="nofollow" class="external text" href="TI-Android-FroYo-DevKit-V2_UserGuide.html#adb_over_USB_on_Windows_Machine">ADB over USB on Windows Machine</a></li>
<li>Edit android_winusb.inf - under section [Google.NTx86], add line as below:</li></ul>
<pre>  &#160;%SingleBootLoaderInterface% = USB_Install, USB\VID_0451
</pre>
<ul><li>Proceed installing, with the difference that device to be selected is "Android Bootloader Interface" instead of "Android ADB Interface".</li></ul>
<h3><span class="mw-headline" id="Supported_Fastboot_commands">Supported Fastboot commands</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=61" title="Edit section: Supported Fastboot commands">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<pre>   $ export ANDROID_ROOT=&lt;rowboat_top_level_build_directory&gt;
</pre>
<pre>   $ cd $ANDROID_ROOT/out/host/linux-x86/bin
</pre>
<ul><li>List connected devices</li></ul>
<pre>   $ sudo ./fastboot devices
</pre>
<ul><li>Boot with new kernel image</li></ul>
<pre>   $ sudo ./fastboot boot &lt;image_path&gt;
</pre>
<ul><li>Update <i>images</i></li></ul>
<pre>   $ sudo ./fastboot flash &lt;image_name&gt; &lt;image_path&gt;
</pre>
<p><b>Note:</b> Where "image_name" can be spl, uboot, kernel or filesystem.
</p>
<ul><li>Erasing <i>images</i> or partition.</li></ul>
<pre>   $ sudo ./fastboot erase &lt;partition_name&gt; (eg. spl)
</pre>
<div class="block-note"><span class="block-contents"><img alt="Note" src="https://processors.wiki.ti.com/images/b/b0/Light_bulb_icon.png" title="Note" width="18" height="25" /><b>Note:</b> 
<dl><dd><ul><li>"partition_name" can be <i>spl</i>, <i>uboot</i>, <i>environment</i>, <i>kernel</i> or <i>filesystem</i> in case of AM335x.</li>
<li>"partition_name" can be <i>xloader</i>, <i>uboot</i>, <i>environment</i>, <i>kernel</i> or <i>filesystem</i> in case of AM37x.</li></ul></dd></dl>
</span></div>
<ul><li>Display fastboot variable</li></ul>
<pre>   $ sudo ./fastboot getvar &lt;variable&gt;
</pre>
<ul><li>Exit fastboot mode in uboot</li></ul>
<pre>   $ sudo ./fastboot continue
</pre>
<h3><span class="mw-headline" id="Fastboot_Porting_guide">Fastboot Porting guide</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=62" title="Edit section: Fastboot Porting guide">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Fastboot implementation have a generic board independent function driver (cmd_fastboot.c), which will communicate with USB gadget driver, in the present case USB gadget stack is handled by MUSB driver. In the board dependent files, configurations like the available partition name, offset, size, method of <i>nand write</i> etc are defined.
</p><p>In the <i>Config file</i>:
</p>
<ul><li>Enable CONFIG_FASTBOOT</li>
<li>Enable CONFIG_MUSB_UDC, disable CONFIG_MUSB_HCD (assumption: gadget driver used is MUSB)</li>
<li>Enable CONFIG_CMD_FASTBOOT</li>
<li>Define CONFIG_FASTBOOT_TRANSFER_BUFFER (location to which fastboot data has to be downloaded)</li>
<li>Define CONFIG_FASTBOOT_TRANSFER_BUFFER_SIZE (maximum fastboot data that can be downloaded, make sure it does not overlap bootloader memory)</li>
<li>Define FASTBOOT_NAND_BLOCK_SIZE</li>
<li>Define FASTBOOT_NAND_OOB_SIZE</li>
<li>Define FASTBOOT_PRODUCT_NAME, make sure that string is same as value of TARGET_PRODUCT used for compiling Android</li>
<li>Define USB_BCD_VERSION to 0x0200, if HS USB support is required</li></ul>
<p>In the <i>Board file</i>:
</p>
<ul><li>Add header file - fastboot.h</li>
<li>Define "struct fastboot_ptentry" array with entries equal to the number of partitions required</li>
<li>Each entry to have name - this is the variable used for flashing, erasing.</li>
<li>Each entry to provide NAND start address &amp; length</li>
<li>Each entry to specify flags, options as follows,</li>
<li>FASTBOOT_PTENTRY_FLAGS_WRITE_HW_ECC - flash the partition using HW ECC</li>
<li>FASTBOOT_PTENTRY_FLAGS_HW_ECC_LAYOUT_1 - Sets the NANDECC to use Kernel/FS layout for writing</li>
<li>FASTBOOT_PTENTRY_FLAGS_HW_ECC_LAYOUT_2 - Sets the NANDECC to use X-loader/U-boot layout for writing</li>
<li>FASTBOOT_PTENTRY_FLAGS_WRITE_SW_ECC - flash the partition using SW ECC</li>
<li>FASTBOOT_PTENTRY_FLAGS_WRITE_I - Use write.i for NAND write</li>
<li>FASTBOOT_PTENTRY_FLAGS_WRITE_JFFS2 - Use write.jffs2 for NAND write</li>
<li>FASTBOOT_PTENTRY_FLAGS_WRITE_ENV - Add this flag to indicate to fastboot driver the partition for storing environmental variable</li>
<li>FASTBOOT_PTENTRY_FLAGS_REPEAT_4 - Use this to indicate that partition will be written 4 times</li>
<li>Additional flags can be defined to write till 15 times, last 4 bits are reserved for repeat value, Define required value &amp; OR the value in flag</li>
<li>Invoke fastboot API, ' fastboot_flash_add_ptn' for each partition so as to inform about the partition details to fastboot driver.</li></ul>
<p><i>Notes</i>
</p>
<ul><li>Existing USB gadget supported only FS, this was modified so that HS USB can be handled. Changes were done in USB header files, MUSB files.</li>
<li>AM335X was having problems due to the wrapper over MUSB IP. Fix in MUSB UDC; read TI EP interrupt register instead of MUSB register.</li>
<li>A fix with respect to the index for EP array has also been done.</li>
<li>MUSB EP setup has been modified to be more in line with the USB TRM.</li>
<li>Portions of the code that has been ported from OmapZoom is included within the macro FASTBOOT_PORT_OMAPZOOM_NAND_FLASHING.</li></ul>
<p><br />
</p>
<h1><span class="mw-headline" id="USB_Host_and_Gadget">USB Host and Gadget</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=63" title="Edit section: USB Host and Gadget">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h2><span class="mw-headline" id="Introduction_10">Introduction</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=64" title="Edit section: Introduction">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Android ICS supports both USB host and USB device ports. USB host can be used to connect Keyboard/Mouse, Mass storage device, modem dongles etc, while the USB device port is mainly used for adb.
</p>
<h2><span class="mw-headline" id="Driver_Configuration_10">Driver Configuration</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=65" title="Edit section: Driver Configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li>See <a href="UserGuideUsbDriver_PSP_04_02_00_07.html" title="UserGuideUsbDriver PSP 04 02 00 07">PSP 04.02.00.07 USB Driver Guide </a> for AM37x
<ul><li>The USB Android Gadget driver on AM37x is enabled as shown below:</li></ul></li></ul>
<pre>TBD</pre>
<ul><li>See <a href="AM335x_USB_Driver%27s_Guide.html" title="AM335x USB Driver&#39;s Guide">AM335x USB Driver's Guide</a><i> for AM335xevm</i>
<ul><li>The USB Android Gadget driver on AM335x is enabled as shown below:</li></ul></li></ul>
<pre>-&gt; Device Drivers
   -&gt; USB support
      -&gt; USB Gadget Support
         -&gt; USB Gadget Drivers
            (X) Android Gadget
</pre>
<h2><span class="mw-headline" id="Android_USB_Configuration">Android USB Configuration</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=66" title="Edit section: Android USB Configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h3><span class="mw-headline" id="Android_USB_Gadget_Configuration">Android USB Gadget Configuration</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=67" title="Edit section: Android USB Gadget Configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<h4><span class="mw-headline" id="USB_Gadget_configuration_for_AM37x">USB Gadget configuration for AM37x</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=68" title="Edit section: USB Gadget configuration for AM37x">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>The AM37x TI Android DevKit uses 2.6.37 kernel. Here the USB android gadget mode is configured as part of board initialization.
</p>
<table width="100%" cellpadding="0" cellspacing="0" style="background-color: #fff2f2; border: solid 1px #ffbfbf;">
<tbody><tr>
<td style="background-color: #ffafaf; border-bottom: 1px solid #888;"><font size="-1"><b>File:</b>  kernel/arch/arm/mach-omap2/board-omap3evm.c</font>
</td></tr>
<tr>
<td>
<div class="scroll"><pre>#ifdef CONFIG_USB_ANDROID

#define GOOGLE_VENDOR_ID		0x18d1
#define GOOGLE_PRODUCT_ID		0x9018
#define GOOGLE_ADB_PRODUCT_ID		0x9015

static char *usb_functions_adb[] = {
	"adb",
};

static char *usb_functions_mass_storage[] = {
	"usb_mass_storage",
};
static char *usb_functions_ums_adb[] = {
	"usb_mass_storage",
	"adb",
};

static char *usb_functions_all[] = {
	"adb", "usb_mass_storage",
};

static struct android_usb_product usb_products[] = {
	{
		.product_id	= GOOGLE_PRODUCT_ID,
		.num_functions	= ARRAY_SIZE(usb_functions_adb),
		.functions	= usb_functions_adb,
	},
	{
		.product_id	= GOOGLE_PRODUCT_ID,
		.num_functions	= ARRAY_SIZE(usb_functions_mass_storage),
		.functions	= usb_functions_mass_storage,
	},
	{
		.product_id	= GOOGLE_PRODUCT_ID,
		.num_functions	= ARRAY_SIZE(usb_functions_ums_adb),
		.functions	= usb_functions_ums_adb,
	},
};

static struct usb_mass_storage_platform_data mass_storage_pdata = {
	.nluns		= 1,
	.vendor		= "rowboat",
	.product	= "rowboat gadget",
	.release	= 0x100,
};

static struct platform_device usb_mass_storage_device = {
	.name	= "usb_mass_storage",
	.id	= -1,
	.dev	= {
		.platform_data = &amp;mass_storage_pdata,
	},
};

static struct android_usb_platform_data android_usb_pdata = {
	.vendor_id	= GOOGLE_VENDOR_ID,
	.product_id	= GOOGLE_PRODUCT_ID,
	.functions	= usb_functions_all,
	.num_products	= ARRAY_SIZE(usb_products),
	.products	= usb_products,
	.version	= 0x0100,
	.product_name	= "rowboat gadget",
	.manufacturer_name	= "rowboat",
	.serial_number	= "20100720",
	.num_functions	= ARRAY_SIZE(usb_functions_all),
};

static struct platform_device androidusb_device = {
	.name	= "android_usb",
	.id	= -1,
	.dev	= {
		.platform_data = &amp;android_usb_pdata,
	},
};

static void omap3evm_android_gadget_init(void)
{
	platform_device_register(&amp;androidusb_device);
}

#endif
</pre>
</div>
</td></tr></tbody></table>
<p><br />
</p>
<h4><span class="mw-headline" id="USB_Gadget_configuration_for_AM335x">USB Gadget configuration for AM335x</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=69" title="Edit section: USB Gadget configuration for AM335x">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>The Android gadget driver is configured via the sysfs entries. These are done from init.rc
</p>
<pre># Used to disable USB when switching states
on property:sys.usb.config=none
    stop adbd
    write /sys/class/android_usb/android0/enable 0
    write /sys/class/android_usb/android0/bDeviceClass 0
    setprop sys.usb.state $sys.usb.config

# adb only USB configuration
# This should only be used during device bringup
# and as a fallback if the USB manager fails to set a standard configuration
on property:sys.usb.config=adb
    write /sys/class/android_usb/android0/enable 0
    write /sys/class/android_usb/android0/idVendor 18d1
    write /sys/class/android_usb/android0/idProduct D002
    write /sys/class/android_usb/android0/functions $sys.usb.config
    write /sys/class/android_usb/android0/enable 1
    start adbd
    setprop sys.usb.state $sys.usb.config

# USB accessory configuration
on property:sys.usb.config=accessory
    write /sys/class/android_usb/android0/enable 0
    write /sys/class/android_usb/android0/idVendor 18d1
    write /sys/class/android_usb/android0/idProduct 2d00
    write /sys/class/android_usb/android0/functions $sys.usb.config
    write /sys/class/android_usb/android0/enable 1
    setprop sys.usb.state $sys.usb.config

# USB accessory configuration, with adb
on property:sys.usb.config=accessory,adb
    write /sys/class/android_usb/android0/enable 0
    write /sys/class/android_usb/android0/idVendor 18d1
    write /sys/class/android_usb/android0/idProduct 2d01
    write /sys/class/android_usb/android0/functions $sys.usb.config
    write /sys/class/android_usb/android0/enable 1
    start adbd
    setprop sys.usb.state $sys.usb.config

# Used to set USB configuration at boot and to switch the configuration
# when changing the default configuration
on property:persist.sys.usb.config=*
    setprop sys.usb.config $persist.sys.usb.config
</pre>
<p>The sysfs settings need to be done depending on the features required to be enabled. By default only the adb mode is configured.
</p>
<h1><span class="mw-headline" id="USB_Mass_storage">USB Mass storage</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=70" title="Edit section: USB Mass storage">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>The USB mass storage device class, otherwise known as USB MSC or UMS, is a protocol that allows file transfers between device and host to which it is connected. Mass storage is very good source of carrying media as well as other data files.
</p>
<h2><span class="mw-headline" id="Introduction_11">Introduction</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=71" title="Edit section: Introduction">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The Android system uses vold as the mount daemon which detects, mounts and monitors the status of external storage.This mount daemon needs a configuration file(vold.fstab) to determine the mount device and location where it should be mounted.<br />
Vold reads /etc/vold.fstab configuration file and mounts the device specified in the file.
The basic format of the vold.fstab is
</p>
<pre>  dev_mount &lt;label&gt; &lt;mount_point&gt; &lt;part&gt; &lt;sysfs_path1...&gt; 
  
  where
  label - Label for the volume
  mount_point - Where the volume will be mounted
  part - Partition # (1 based), or 'auto' for first usable partition.
  &lt;sysfs_path&gt; - List of sysfs paths to source devices
</pre>
<p>sysfs_path is the full or partial path where kernel exports the udev information about the device currently pluged into system.<br />
See system/core/rootdir/etc/vold.fstab in the Android source tree for the detailed explanations of the format.
</p>
<h2><span class="mw-headline" id="Android_Configuration_for_USB_mass_storage">Android Configuration for USB mass storage</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=72" title="Edit section: Android Configuration for USB mass storage">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>In case of AM335xevm, Kernel populates udev entries for the following path for USB.
</p>
<pre>  /sys/devices/platform/omap/ti81xx-usbss/musb-hdrc.1/usb2
</pre>
<p>The following changes are done to detect connected usb mass storage device and mount/unmount it automatically when plugged/unplugged.
</p>
<ul><li>An entry is added in vold.fstab for USB storage</li></ul>
<pre>  dev_mount sdcard /mnt/sdcard 3 /devices/platform/omap/omap_hsmmc.0/mmc_host/mmc0
  <b>dev_mount usb /mnt/usb2 auto /devices/platform/omap/ti81xx-usbss/musb-hdrc.1/usb2</b>
</pre>
<ul><li>init.rc is updated as follows</li></ul>
<pre># create mountpoints
    mkdir /mnt 0775 root system
    mkdir /mnt/sdcard 0000 system system
    <b>mkdir /mnt/usb2 0000 system system</b>

... 
# Backwards Compat - XXX: Going away in G*
    symlink /mnt/sdcard /sdcard
    <b>symlink /mnt/usb2 /usb2</b>

    mkdir /system
    mkdir /data 0771 system system
</pre>
<ul><li>Entry is added to the storage list: overlay/frameworks/base/core/res/res/xml/storage_list.xml</li></ul>
<pre>    &lt;storage android:mountPoint="/mnt/usb2"
             android:storageDescription="@string/storage_usb"
             android:removable="true" /&gt;
</pre>
<h2><span class="mw-headline" id="Test_mass_storage_in_Android">Test mass storage in Android</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=73" title="Edit section: Test mass storage in Android">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Connect USB mass storage device to board and check whether it is mounted properly.
</p>
<ul><li>Use mount command to see the list of mount points. Here is the sample output of mount command.</li></ul>
<pre>  # mount
  rootfs / rootfs rw 0 0
  /dev/root / ext3 rw,relatime,errors=continue,barrier=1,data=writeback 0 0
  tmpfs /dev tmpfs rw,relatime,mode=755 0 0
  devpts /dev/pts devpts rw,relatime,mode=600 0 0
  proc /proc proc rw,relatime 0 0
  sysfs /sys sysfs rw,relatime 0 0
  tmpfs /mnt/asec tmpfs rw,relatime,mode=755,gid=1000 0 0
  /dev/block/mmcblk0p3 /part-3 vfat rw,relatime,fmask=0000,dmask=0000,allow_utime=0022,codepage=cp437,iocharset=iso8859-1,shortname=mixed,errors=remount-ro 0 0
  /dev/block/vold/179:3 /mnt/sdcard vfat rw,nosuid,nodev,noexec,relatime,fmask=0000,dmask=0000,allow_utime=0022,codepage=cp437,iocharset=iso8859-1,shortname=mixed,errors=remount-ro 0 0
  /dev/block/vold/179:3 /mnt/secure/asec vfat rw,nosuid,nodev,noexec,relatime,fmask=0000,dmask=0000,allow_utime=0022,codepage=cp437,iocharset=iso8859-1,shortname=mixed,errors=remount-ro 0 0
  tmpfs /mnt/sdcard/.android_secure tmpfs ro,relatime,size=0k,mode=000 0 0
  <b>/dev/block/vold/8:1 /mnt/usb2 vfat rw,dirsync,nosuid,nodev,noexec,relatime,uid=1000,gid=1015,fmask=0702,dmask=0702,allow_utime=0020,codepage=cp437,iocharset=iso8859-1,shortname=mixed,utf8,errors=remount-ro 0 0</b>
  /dev/block/vold/8:1 /mnt/secure/asec vfat rw,dirsync,nosuid,nodev,noexec,relatime,uid=1000,gid=1015,fmask=0702,dmask=0702,allow_utime=0020,codepage=cp437,iocharset=iso8859-1,shortname=mixed,utf8,errors=remount-ro 0 0
  tmpfs /mnt/usb2/.android_secure tmpfs ro,relatime,size=0k,mode=000 0 0
</pre>
<ul><li>Run OI File Manager application and see whether usb2 directory is populated with the contents of the USB mass storage device.</li></ul>
<p><a href="File_Am335x-filemanager-usb2.html" class="image" title="Browsing to usb2 directory using OI File Manager"><img alt="Browsing to usb2 directory using OI File Manager" src="https://processors.wiki.ti.com/images/d/d9/Am335x-filemanager-usb2.png" width="800" height="480" /></a>
</p>
<h1><span class="mw-headline" id="USB_Camera">USB Camera</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=74" title="Edit section: USB Camera">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>This section discusses interfacing USB camera with android
</p>
<h2><span class="mw-headline" id="Kernel_configuration">Kernel configuration</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=75" title="Edit section: Kernel configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Enable the following CONFIGs to add support for USB camera in kernel:
</p>
<pre>  CONFIG_USB_VIDEO_CLASS=y
  CONFIG_USB_VIDEO_CLASS_INPUT_EVDEV=y
</pre>
<p>This <a rel="nofollow" class="external text" href="http://gitorious.org/rowboat/kernel/commit/6319f19840a2fa3afc5453465dec4ed0d19220b1">commit</a> enables USB camera support in BeagleBoard
</p>
<h2><span class="mw-headline" id="Android_Configuration_2">Android Configuration</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=76" title="Edit section: Android Configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Enable USB Camera support in BoardConfig.mk. Also disable stub camera
</p>
<pre>   BOARD_USB_CAMERA&#160;:= true
   #USE_CAMERA_STUB&#160;:= true
</pre>
<p>Add the following entries in device.mk
</p>
<pre>#Camera
PRODUCT_PACKAGES += \
        camera.omap3 \
        Camera
</pre>
<p>The Camera HAL is at <a rel="nofollow" class="external text" href="http://gitorious.org/rowboat/hardware-ti-omap3/trees/rowboat-ics/camera">hardware/ti/omap3/camera</a>.
</p><p><b>NOTE</b>: By default it is assumed that the USB camera is registered as /dev/video0 ( <a rel="nofollow" class="external text" href="http://gitorious.org/rowboat/hardware-ti-omap3/blobs/rowboat-ics/camera/CameraHardware.cpp#line81">source</a> ). You may need to change this for your device.
</p><p>E.g on BeagleBoard, the USB video device node is /dev/video9
</p>
<h1><span class="mw-headline" id="USB_3G_Modem">USB 3G Modem</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=77" title="Edit section: USB 3G Modem">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>The USB 3G Modem section describes how to connect USB Modem to the android.
</p>
<h2><span class="mw-headline" id="Introduction_12">Introduction</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=78" title="Edit section: Introduction">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>PPP is the protocol used for establishing internet links over dial-up modems, DSL connections, and many other types of point-to-point links. The pppd daemon works together with the kernel PPP driver to establish and maintain a PPP link with another system (called the peer) and to negotiate Internet Protocol (IP) addresses for each end of the link.
</p>
<h2><span class="mw-headline" id="Kernel_Configuration_for_USB_Modem">Kernel Configuration for USB Modem</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=79" title="Edit section: Kernel Configuration for USB Modem">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<pre>Device Drivers  ---&gt;
 [*] Network device support  ---&gt;
   &lt;*&gt;   PPP (point-to-point protocol) support
     &lt;*&gt;     PPP BSD-Compress compression
     &lt;*&gt;     PPP Deflate compression
     &lt;*&gt;     PPP support for async serial ports
     &lt;*&gt;     PPP support for sync tty ports
 [*] USB support  ---&gt;
   &lt;*&gt;   USB Modem (CDC ACM) support
   &lt;*&gt;   USB Serial Converter support  ---&gt;
     [*]   USB Generic Serial Driver
     &lt;*&gt;   USB driver for GSM and CDMA modems
</pre>
<h2><span class="mw-headline" id="File_System_Changes">File System Changes</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=80" title="Edit section: File System Changes">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>To get the Modem Working, we need usb_modeswitch, usb_modeswicth.conf(configuration file) for the specific modem or Hardware vendor and the airtel.chat(dialer script) for the specific network. 
</p>
<ul><li>Copy the usb_modeswitch (ARM Compiled binary) and usb_modeswitch.conf to the /system/xbin folder. The ARM compiled binary and the sources can be obtained from <a rel="nofollow" class="external text" href="http://www.draisberghof.de/usb_modeswitch/#download">HERE</a></li>
<li>Copy the airtel.chat(dialer script) to the /system/etc/ppp folder</li></ul>
<p>Below is the description of an example usb_modeswitch.conf file for the Huawei E1731 Modem (Airtel in India) 
</p>
<pre>  Huawei E1731

  EnableLogging=1

  DefaultVendor= 0x12d1
  DefaultProduct=0x1446

  TargetVendor=  0x12d1
  TargetProductList="1001,1406,140b,140c,1412,141b,1436,14ac,1506"

  CheckSuccess=20

  MessageEndpoint= 0x01
  MessageContent="55534243123456780000000000000011062000000100000000000000000000"
</pre>
<p><br /> The DefaultVendor and DefaultProduct is the ID displayed for CDROM or mass storage, the TargetVendor and TargetProduct is for Modem. Plug the device into linux system and do "dmesg" or "lsusb" to know the IDs. 
</p><p>Example: HUAWEI E1731 Modem Below is the log when plugged to PC 
</p>
<pre>   [6663132.917033] usb 1-4: new high speed USB device number 10 using ehci_hcd
   [6663133.033394] usb 1-4: New USB device found, <b>idVendor=12d1, idProduct=1446</b>
[6663133.033400] usb 1-4: New USB device strings: Mfr=3, Product=2, SerialNumber=0
[6663133.033404] usb 1-4: Product: HUAWEI Mobile
[6663133.033407] usb 1-4: Manufacturer: HUAWEI Technology
[6663133.036040] scsi16&#160;: usb-storage 1-4:1.0
[6663133.036652] scsi17&#160;: usb-storage 1-4:1.1
[6663133.685546] usb 1-4: USB disconnect, device number 10
[6663137.665047] usb 1-4: new high speed USB device number 11 using ehci_hcd
[6663137.781645] usb 1-4: New USB device found, <b>idVendor=12d1, idProduct=1436</b>
[6663137.781651] usb 1-4: New USB device strings: Mfr=4, Product=3, SerialNumber=0
[6663137.781654] usb 1-4: Product: HUAWEI Mobile
[6663137.781657] usb 1-4: Manufacturer: HUAWEI Technology
[6663137.784476] option 1-4:1.0: GSM modem (1-port) converter detected
[6663137.784663] usb 1-4: GSM modem (1-port) converter now attached to ttyUSB0
[6663137.786425] cdc_ether 1-4:1.1: wwan0: register 'cdc_ether' at usb-0000:00:1d.7-4, Mobile Broadband Network Device, 02:50:f3:00:00:00
[6663137.788066] option 1-4:1.3: GSM modem (1-port) converter detected
[6663137.788268] usb 1-4: GSM modem (1-port) converter now attached to ttyUSB1
[6663137.788509] option 1-4:1.4: GSM modem (1-port) converter detected
[6663137.788646] usb 1-4: GSM modem (1-port) converter now attached to ttyUSB2
[6663137.789203] scsi22&#160;: usb-storage 1-4:1.5
[6663137.789812] scsi23&#160;: usb-storage 1-4:1.6
[6663138.790809] scsi 22:0:0:0: CD-ROM            HUAWEI   Mass Storage     2.31 PQ: 0 ANSI: 2
[6663138.791303] scsi 23:0:0:0: Direct-Access     HUAWEI   SD Storage       2.31 PQ: 0 ANSI: 2
[6663138.807169] sr1: scsi-1 drive
[6663138.808426] sr 22:0:0:0: Attached scsi CD-ROM sr1
[6663138.808593] sr 22:0:0:0: Attached scsi generic sg5 type 5
[6663138.809394] sd 23:0:0:0: Attached scsi generic sg6 type 0
[6663138.812181] sd 23:0:0:0: [sde] Attached SCSI removable disk
</pre>
<p>Below is the description of an example airtel.chat(dialer script) file for AirTel (INDIA) 
</p>
<pre>TIMEOUT 10
ABORT 'BUSY'
ABORT 'NO ANSWER'
ABORT 'ERROR'
SAY 'Starting GPRS connect script\n'
""'ATZ'
SAY 'Setting APN\n'
OK 'AT+CGDCONT=1,"IP","airtelgprs.com"'
ABORT 'NO CARRIER'
SAY 'Dialing...\n'
OK 'ATD*99***1#'
CONNECT
</pre>
<p><b>NOTE</b>: the single quotes in the above chat file must be together. ie no space allowed.
</p><p>This file is network service provider dependent, so modify the <b>airtelgprs.com</b> according to your service provider.
</p>
<h2><span class="mw-headline" id="Usage">Usage</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=81" title="Edit section: Usage">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Below are the steps to perform once android boots up with the above necessary modifications
</p>
<ul><li>Disable wireless and ethernet settings</li>
<li>Plug the USB Modem</li>
<li>Run the following commands</li></ul>
<pre>   mount -t usbfs usbfs /proc/bus/usb
</pre>
<pre>   /system/xbin/usb_modeswitch -I -W -c /system/xbin/usb_modeswitch.conf
</pre>
<p>Mount the usbfs file system to /proc/bus/usb. This is necessary to 	avoid the Couldnt opendir() error you get otherwise on running 	usb_modeswitch.<br /> Once Mode Switch Succeeds, modem will be enumerated as /dev/ttyUSB* (* can be 0,1,2).<br /> If you place the usb_modeswitch and usb_modeswitch.conf at other place, change the above command accordingly.
</p>
<ul><li>Once Modem succeeds in enumeration, run the follwoing command</li></ul>
<pre>   /system/bin/pppd /dev/ttyUSB0 115200 persist defaultroute usepeerdns updetach crtscts noauth debug connect "/system/xbin/chat -v -s -f /system/etc/ppp/airtel.chat"
</pre>
<ul><li>From the logcat check what primary and secondary dns server IPs you got, you can kill the logcat after getting the IPs. Set those primary and secondary DNS server IPs for your device with the following commands replacing IP1 and IP2  with whatever IPs you got.</li></ul>
<pre>   setprop net.dns1 &lt;IP1&gt;
   setprop net.dns2 &lt;IP2&gt;
</pre>
<p>You are ready to browse that net after this if everything went well in the previous steps.<br /> Enjoy the 3G fast speed surfing on your device.
</p>
<h1><span class="mw-headline" id="Sensors">Sensors</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=82" title="Edit section: Sensors">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h2><span class="mw-headline" id="Accelerometer">Accelerometer</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=83" title="Edit section: Accelerometer">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The STMicro LIS33 Accelerometer is supported on Am37x Flashboard and AM335x evm.
</p><p>Kernel driver for accelerometer on AM335x&#160;: <a rel="nofollow" class="external free" href="http://gitorious.org/rowboat/kernel/trees/rowboat-am335x-kernel-3.2/drivers/misc/lis3lv02d">http://gitorious.org/rowboat/kernel/trees/rowboat-am335x-kernel-3.2/drivers/misc/lis3lv02d</a>
</p><p>Android HAL on AM335xevm: <a rel="nofollow" class="external free" href="http://gitorious.org/rowboat/vendor-ti-am335xevm/trees/rowboat-ics/libsensors">http://gitorious.org/rowboat/vendor-ti-am335xevm/trees/rowboat-ics/libsensors</a>
</p><p>To indicate accelerometer support to android add the following line in device.mk
</p>
<pre>PRODUCT_COPY_FILES += \
    frameworks/base/data/etc/android.hardware.sensor.accelerometer.xml:system/etc/permissions/android.hardware.sensor.accelerometer.xml
</pre>
<h2><span class="mw-headline" id="Light_sensor">Light sensor</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=84" title="Edit section: Light sensor">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>AM335x evm supports light sensor TSL2550.
</p><p>Light sensor kernel driver&#160;: <a rel="nofollow" class="external free" href="http://gitorious.org/rowboat/kernel/blobs/rowboat-am335x-kernel-3.2/drivers/misc/tsl2550.c">http://gitorious.org/rowboat/kernel/blobs/rowboat-am335x-kernel-3.2/drivers/misc/tsl2550.c</a>
</p><p>Please note that the standard linux driver is modified to report light sensor values to the input sub-system. See <a rel="nofollow" class="external text" href="http://gitorious.org/rowboat/kernel/commit/bd34846b8f650d1238935ceaf8ce6f496f06e60b">commit</a>.
</p><p>Android HAL on AM335xevm: <a rel="nofollow" class="external free" href="http://gitorious.org/rowboat/vendor-ti-am335xevm/trees/rowboat-ics/libsensors">http://gitorious.org/rowboat/vendor-ti-am335xevm/trees/rowboat-ics/libsensors</a>
</p><p>To indicate light sensor support to android add the following line in device.mk
</p>
<pre>PRODUCT_COPY_FILES += \
    frameworks/base/data/etc/android.hardware.sensor.light.xml:system/etc/permissions/android.hardware.sensor.light.xml
</pre>
<p>You can use the light sensor input to modify the LCD backlight intensity. You need to add the following entry in the overlay:
</p>
<pre>  &lt;bool name="config_automatic_brightness_available"&gt;true&lt;/bool&gt;
</pre>
<p>Also you need to implement a lookup table to map the light intensity to the LCD backlight values. Please refer to the <a rel="nofollow" class="external text" href="http://gitorious.org/rowboat/vendor-ti-am335xevm/blobs/rowboat-ics/overlay/frameworks/base/core/res/res/values/config.xml#line38">overlay</a> file for more details.
</p>
<h2><span class="mw-headline" id="Temperature_sensor">Temperature sensor</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=85" title="Edit section: Temperature sensor">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>AM335xevm supports temperature sensor LM75.
</p><p>Kernel driver path&#160;: TBD
</p><p>Android HAL is at TBD
</p>
<h1><span class="mw-headline" id="Disclaimer">Disclaimer</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=86" title="Edit section: Disclaimer">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<ul><li>All components explained in this porting guide are validated against TI Android DevKit release 3.0.0 and 3.0.1 only.</li>
<li>However guide can be taken as reference to port mentioned components on similar architecture.</li></ul>
<h1><span class="mw-headline" id="Technical_Support_and_Product_Updates">Technical Support and Product Updates</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit&amp;section=87" title="Edit section: Technical Support and Product Updates">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>For further information or to report any problems, contact <a rel="nofollow" class="external free" href="http://e2e.ti.com/android">http://e2e.ti.com/android</a> or <a rel="nofollow" class="external free" href="http://support.ti.com/">http://support.ti.com</a>. <br /> For community support join <a rel="nofollow" class="external free" href="http://groups.google.com/group/rowboat">http://groups.google.com/group/rowboat</a> <br /> For IRC #rowboat on irc.freenode.net <br />
</p>
<!-- 
NewPP limit report
Cached time: 20201130052806
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.157 seconds
Real time usage: 0.164 seconds
Preprocessor visited node count: 731/1000000
Preprocessor generated node count: 1290/1000000
Postexpand include size: 2489/2097152 bytes
Template argument size: 1311/2097152 bytes
Highest expansion depth: 3/40
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip postexpand size: 14472/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    9.421      1 -total
 28.69%    2.703      3 Template:Box_File
 20.77%    1.957      3 Template:Note
 16.70%    1.573      1 Template:Under_Construction
-->
</div>
<!-- Saved in parser cache with key procwiki:pcache:idhash:16351-0!canonical and timestamp 20201130052806 and revision id 148387
 -->
<div class='hf-nsfooter' id='hf-nsfooter-'><table style="text-align:center; background:white; width:100%; text-align:left; height: 65px border-top: 1px solid; border-bottom: 1px solid; border-left: 1px solid; border-right: 1px solid; border-width: 1px; border-style: solid;">
<tr>
<td width="305px"><a href="File_E2e.html" class="image"><img alt="E2e.jpg" src="https://processors.wiki.ti.com/images/8/82/E2e.jpg" width="305" height="63" /></a>
</td>
<td>{{
<ol><li>switchcategory:MultiCore=</li></ol>
<ul><li>For technical support on MultiCore devices, please post your questions in the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/c6000_multi-core_dsps/default.aspx">C6000 MultiCore Forum</a></li>
<li>For questions related to the BIOS MultiCore SDK (MCSDK), please use the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/embedded/f/355.aspx">BIOS Forum</a></li></ul>
<p>Please post only comments related to the article <b>TI-Android-ICS-PortingGuide</b> here.<i></i>
</p>
</td>
<td>Keystone=
<ul><li>For technical support on MultiCore devices, please post your questions in the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/c6000_multi-core_dsps/default.aspx">C6000 MultiCore Forum</a></li>
<li>For questions related to the BIOS MultiCore SDK (MCSDK), please use the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/embedded/f/355.aspx">BIOS Forum</a></li></ul>
<p>Please post only comments related to the article <b>TI-Android-ICS-PortingGuide</b> here.<i></i>
</p>
</td>
<td>C2000=<i>For technical support on the C2000 please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/microcontrollers/tms320c2000_32-bit_real-time_mcus/f/171.aspx">The C2000 Forum</a>. Please post only comments about the article <b>TI-Android-ICS-PortingGuide</b> here.</i>
</td>
<td>DaVinci=<i>For technical support on DaVincoplease post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/davinci_digital_media_processors/default.aspx">The DaVinci Forum</a>. Please post only comments about the article <b>TI-Android-ICS-PortingGuide</b> here.</i>
</td>
<td>MSP430=<i>For technical support on MSP430 please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/microcontrollers/msp43016-bit_ultra-low_power_mcus/default.aspx">The MSP430 Forum</a>. Please post only comments about the article <b>TI-Android-ICS-PortingGuide</b> here.</i>
</td>
<td>OMAP35x=<i>For technical support on OMAP please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/omap_applications_processors/default.aspx">The OMAP Forum</a>. Please post only comments about the article <b>TI-Android-ICS-PortingGuide</b> here.</i>
</td>
<td>OMAPL1=<i>For technical support on OMAP please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/omap_applications_processors/default.aspx">The OMAP Forum</a>. Please post only comments about the article <b>TI-Android-ICS-PortingGuide</b> here.</i>
</td>
<td>MAVRK=<i>For technical support on MAVRK please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/development_tools/mavrk/default.aspx">The MAVRK Toolbox Forum</a>. Please post only comments about the article <b>TI-Android-ICS-PortingGuide</b> here.</i>
</td>
<td><i>For technical support please post your questions at <a rel="nofollow" class="external text" href="http://e2e.ti.com/">http://e2e.ti.com</a>. Please post only comments about the article <b>TI-Android-ICS-PortingGuide</b> here.</i>
<p>}}
</p>
</td></tr></table>
<table style="border-style:solid; border-width:1px; text-align:center; width:100%;">

<tr style="font-size:150%;">
<td rowspan="2"><a href="File_Hyperlink_blue.html" class="image"><img alt="Hyperlink blue.png" src="https://processors.wiki.ti.com/images/9/9f/Hyperlink_blue.png" width="96" height="96" /></a>
</td>
<td><b>Links</b>
</td></tr>
<tr>
<td>
<table style="text-align: left;">
<tr>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/amplifier_and_linear.page">Amplifiers &amp; Linear</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/audio/audio_overview.page">Audio</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/rfif.page">Broadband RF/IF &amp; Digital Radio</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/clocksandtimers/clocks_and_timers.page">Clocks &amp; Timers</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/dataconverters/data_converter.page">Data Converters</a>
</p>
</td>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/mems/mems.page">DLP &amp; MEMS</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/high_reliability.page">High-Reliability</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/interface/interface.page">Interface</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/logic/home_overview.page">Logic</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/powermanagement/power_portal.page">Power Management</a>
</p>
</td>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/dsp/embedded_processor.page">Processors</a>
</p>
<ul><li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/dsp/arm.page">ARM Processors</a></li>
<li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/dsp/home.page">Digital Signal Processors (DSP)</a></li>
<li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/microcontroller/home.page">Microcontrollers (MCU)</a></li>
<li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/omap-applications-processors/the-omap-experience.page">OMAP Applications Processors</a></li></ul>
</td>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/switches_and_multiplexers.page">Switches &amp; Multiplexers</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/temperature_sensor.page">Temperature Sensors &amp; Control ICs</a><br/>
<a rel="nofollow" class="external text" href="http://focus.ti.com/wireless/docs/wirelessoverview.tsp?familyId=2003&amp;sectionId=646&amp;tabId=2735">Wireless Connectivity</a>
</p>
</td></tr></table>
</td></tr></table>
<div id="tiPrivacy"></div>
</div></div>					<div class="printfooter">
						Retrieved from "<a dir="ltr" href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;oldid=148387">https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;oldid=148387</a>"					</div>
				<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="Special_Categories.html" title="Special:Categories">Categories</a>: <ul><li><a href="Category_AM335x.html" title="Category:AM335x">AM335x</a></li><li><a href="Category_Android.html" title="Category:Android">Android</a></li><li><a href="Category_Sitara_Android.html" title="Category:Sitara Android">Sitara Android</a></li><li><a href="Category_AM37x.html" title="Category:AM37x">AM37x</a></li></ul></div></div>				<div class="visualClear"></div>
							</div>
		</div>
		<div id="mw-navigation">
			<h2>Navigation menu</h2>
			<div id="mw-head">
									<div id="p-personal" role="navigation" class="" aria-labelledby="p-personal-label">
						<h3 id="p-personal-label">Personal tools</h3>
						<ul>
							<li id="pt-login"><a href="https://processors.wiki.ti.com/index.php?title=Special:UserLogin&amp;returnto=TI-Android-ICS-PortingGuide" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li><li id="pt-createaccount"><a href="Special_RequestAccount.html" title="You are encouraged to create an account and log in; however, it is not mandatory">Request account</a></li>						</ul>
					</div>
									<div id="left-navigation">
										<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
						<h3 id="p-namespaces-label">Namespaces</h3>
						<ul>
							<li id="ca-nstab-main" class="selected"><span><a href="TI-Android-ICS-PortingGuide.html" title="View the content page [c]" accesskey="c">Page</a></span></li><li id="ca-talk" class="new"><span><a href="https://processors.wiki.ti.com/index.php?title=Talk:TI-Android-ICS-PortingGuide&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page (page does not exist) [t]" accesskey="t">Discussion</a></span></li>						</ul>
					</div>
										<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
												<input type="checkbox" class="vectorMenuCheckbox" aria-labelledby="p-variants-label" />
						<h3 id="p-variants-label">
							<span>Variants</span>
						</h3>
						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
									</div>
				<div id="right-navigation">
										<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
						<h3 id="p-views-label">Views</h3>
						<ul>
							<li id="ca-view" class="collapsible selected"><span><a href="TI-Android-ICS-PortingGuide.html">Read</a></span></li><li id="ca-viewsource" class="collapsible"><span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></span></li><li id="ca-history" class="collapsible"><span><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=history" title="Past revisions of this page [h]" accesskey="h">View history</a></span></li>						</ul>
					</div>
										<div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label">
						<input type="checkbox" class="vectorMenuCheckbox" aria-labelledby="p-cactions-label" />
						<h3 id="p-cactions-label"><span>More</span></h3>
						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
										<div id="p-search" role="search">
						<h3>
							<label for="searchInput">Search</label>
						</h3>
						<form action="https://processors.wiki.ti.com/index.php" id="searchform">
							<div id="simpleSearch">
								<input type="search" name="search" placeholder="Search Texas Instruments Wiki" title="Search Texas Instruments Wiki [f]" accesskey="f" id="searchInput"/><input type="hidden" value="Special:Search" name="title"/><input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton mw-fallbackSearchButton"/><input type="submit" name="go" value="Go" title="Go to a page with this exact name if it exists" id="searchButton" class="searchButton"/>							</div>
						</form>
					</div>
									</div>
			</div>
			<div id="mw-panel">
				<div id="p-logo" role="banner"><a class="mw-wiki-logo" href="Main_Page.html"  title="Visit the main page"></a></div>
						<div class="portal" role="navigation" id="p-navigation" aria-labelledby="p-navigation-label">
			<h3 id="p-navigation-label">Navigation</h3>
			<div class="body">
								<ul>
					<li id="n-mainpage"><a href="Main_Page.html" title="Visit the main page [z]" accesskey="z">Main Page</a></li><li id="n-All-pages"><a href="Special_AllPages.html">All pages</a></li><li id="n-All-categories"><a href="Special_Categories.html">All categories</a></li><li id="n-recentchanges"><a href="Special_RecentChanges.html" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li><li id="n-randompage"><a href="Package_Reflow_Profiles.html" title="Load a random page [x]" accesskey="x">Random page</a></li><li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" title="The place to find out">Help</a></li>				</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id="p-tb" aria-labelledby="p-tb-label">
			<h3 id="p-tb-label">Toolbox</h3>
			<div class="body">
								<ul>
					<li id="t-whatlinkshere"><a href="Special_WhatLinksHere/TI-Android-ICS-PortingGuide.html" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li><li id="t-recentchangeslinked"><a href="Special_RecentChangesLinked/TI-Android-ICS-PortingGuide.html" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li><li id="t-specialpages"><a href="Special_SpecialPages.html" title="A list of all special pages [q]" accesskey="q">Special pages</a></li><li id="t-print"><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li><li id="t-permalink"><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;oldid=148387" title="Permanent link to this revision of the page">Permanent link</a></li><li id="t-info"><a href="https://processors.wiki.ti.com/index.php?title=TI-Android-ICS-PortingGuide&amp;action=info" title="More information about this page">Page information</a></li>				</ul>
							</div>
		</div>
				</div>
		</div>
				<div id="footer" role="contentinfo">
						<ul id="footer-info">
								<li id="footer-info-lastmod"> This page was last edited on 23 April 2013, at 10:08.</li>
								<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-ShareAlike</a> unless otherwise noted.</li>
							</ul>
						<ul id="footer-places">
								<li id="footer-places-privacy"><a href="Project_Privacy_policy.html" title="Project:Privacy policy">Privacy policy</a></li>
								<li id="footer-places-about"><a href="Project_About.html" title="Project:About">About Texas Instruments Wiki</a></li>
								<li id="footer-places-disclaimer"><a href="Project_General_disclaimer.html" title="Project:General disclaimer">Disclaimers</a></li>
								<li id="footer-places-termsofservice"><a href="Project_Terms_of_Service.html" title="Project:Terms of Service">Terms of Use</a></li>
							</ul>
										<ul id="footer-icons" class="noprint">
										<li id="footer-copyrightico">
						<a href="http://creativecommons.org/licenses/by-sa/3.0/"><img src="https://processors.wiki.ti.com/resources/assets/licenses/cc-by-sa.png" alt="Creative Commons Attribution-ShareAlike" width="88" height="31"/></a>					</li>
										<li id="footer-poweredbyico">
						<a href="http://www.mediawiki.org/"><img src="https://processors.wiki.ti.com/resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31"/></a>					</li>
									</ul>
						<div style="clear: both;"></div>
		</div>
		<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgPageParseReport":{"limitreport":{"cputime":"0.157","walltime":"0.164","ppvisitednodes":{"value":731,"limit":1000000},"ppgeneratednodes":{"value":1290,"limit":1000000},"postexpandincludesize":{"value":2489,"limit":2097152},"templateargumentsize":{"value":1311,"limit":2097152},"expansiondepth":{"value":3,"limit":40},"expensivefunctioncount":{"value":0,"limit":100},"unstrip-depth":{"value":0,"limit":20},"unstrip-size":{"value":14472,"limit":5000000},"timingprofile":["100.00%    9.421      1 -total"," 28.69%    2.703      3 Template:Box_File"," 20.77%    1.957      3 Template:Note"," 16.70%    1.573      1 Template:Under_Construction"]},"cachereport":{"timestamp":"20201130052806","ttl":86400,"transientcontent":false}}});});</script><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":229});});</script>
	</body>

<!-- Mirrored from processors.wiki.ti.com/index.php/TI-Android-ICS-PortingGuide by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 01 Dec 2020 04:16:34 GMT -->
</html>
