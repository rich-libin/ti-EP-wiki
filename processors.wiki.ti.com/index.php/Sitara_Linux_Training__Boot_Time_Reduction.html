<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">

<!-- Mirrored from processors.wiki.ti.com/index.php/Sitara_Linux_Training:_Boot_Time_Reduction by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 01 Dec 2020 10:12:19 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8"/>
<title>Sitara Linux Training: Boot Time Reduction - Texas Instruments Wiki</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Sitara_Linux_Training:_Boot_Time_Reduction","wgTitle":"Sitara Linux Training: Boot Time Reduction","wgCurRevisionId":157984,"wgRevisionId":157984,"wgArticleId":17882,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["AM437x","AM335x","AM35x","AM37x","AM1x","AM18x"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Sitara_Linux_Training:_Boot_Time_Reduction","wgRelevantArticleId":17882,"wgRequestId":"f52935abbf1c621bba8ba220","wgIsProbablyEditable":false,"wgRelevantPageIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[]});mw.loader.state({"site.styles":"ready","noscript":"ready","user.styles":"ready","user":"ready","user.options":"ready","user.tokens":"loading","mediawiki.legacy.shared":"ready","mediawiki.legacy.commonPrint":"ready","mediawiki.sectionAnchor":"ready","mediawiki.skinning.interface":"ready","skins.vector.styles":"ready"});mw.loader.implement("user.tokens@19o3a1s",function($,jQuery,require,module){/*@nomin*/mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});
});mw.loader.load(["site","mediawiki.page.startup","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.toc","mediawiki.searchSuggest","skins.vector.js"]);});</script>
<link rel="stylesheet" href="https://processors.wiki.ti.com/load.php?debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.interface%7Cskins.vector.styles&amp;only=styles&amp;skin=vector"/>
<script async="" src="https://processors.wiki.ti.com/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=vector"></script>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="https://processors.wiki.ti.com/load.php?debug=false&amp;lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=vector"/>
<meta name="generator" content="MediaWiki 1.31.6"/>
<link rel="shortcut icon" href="https://processors.wiki.ti.com/favicon.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="https://processors.wiki.ti.com/opensearch_desc.php" title="Texas Instruments Wiki (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="https://processors.wiki.ti.com/api.php?action=rsd"/>
<link rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/"/>
<link rel="alternate" type="application/atom+xml" title="Texas Instruments Wiki Atom feed" href="https://processors.wiki.ti.com/index.php?title=Special:RecentChanges&amp;feed=atom"/>
<!--[if lt IE 9]><script src="/load.php?debug=false&amp;lang=en&amp;modules=html5shiv&amp;only=scripts&amp;skin=Vector&amp;sync=1"></script><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Sitara_Linux_Training_Boot_Time_Reduction rootpage-Sitara_Linux_Training_Boot_Time_Reduction skin-vector action-view">		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<div id="content" class="mw-body" role="main">
			<a id="top"></a>
			<div id="siteNotice" class="mw-body-content"><div id="localNotice" lang="en" dir="ltr"><div class="mw-parser-output"><p><br />
<span style="color:#ff0000"><b>NOTICE: The Processors Wiki will End-of-Life on January 15, 2021. It is recommended to download any files or other content you may need that are hosted on processors.wiki.ti.com. The site is now set to read only.</b></span>
</p></div></div></div><div class="mw-indicators mw-body-content">
</div>
<h1 id="firstHeading" class="firstHeading" lang="en">Sitara Linux Training: Boot Time Reduction</h1>			<div id="bodyContent" class="mw-body-content">
				<div id="siteSub" class="noprint">From Texas Instruments Wiki</div>				<div id="contentSub"></div>
								<div id="jump-to-nav" class="mw-jump">
					Jump to:					<a href="#mw-head">navigation</a>, 					<a href="#p-search">search</a>
				</div>
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output"><p><br />
</p>
<p><a href="File_TIBanner.html" class="image"><img alt="TIBanner.png" src="https://processors.wiki.ti.com/images/c/cd/TIBanner.png" width="667" height="87" /></a> </p><div id="toc" class="toc"><div class="toctitle" lang="en" dir="ltr"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Lab_Configuration"><span class="tocnumber">1</span> <span class="toctext">Lab Configuration</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Hardware"><span class="tocnumber">1.1</span> <span class="toctext">Hardware</span></a>
<ul>
<li class="toclevel-3 tocsection-3"><a href="#Optional"><span class="tocnumber">1.1.1</span> <span class="toctext">Optional</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-4"><a href="#Software"><span class="tocnumber">1.2</span> <span class="toctext">Software</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5"><a href="#Setting_up_a_Minimal_System"><span class="tocnumber">2</span> <span class="toctext">Setting up a Minimal System</span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#Description"><span class="tocnumber">2.1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Key_Points"><span class="tocnumber">2.2</span> <span class="toctext">Key Points</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Lab_Steps"><span class="tocnumber">2.3</span> <span class="toctext">Lab Steps</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-9"><a href="#Measuring_Boot_Time"><span class="tocnumber">3</span> <span class="toctext">Measuring Boot Time</span></a>
<ul>
<li class="toclevel-2 tocsection-10"><a href="#Description_2"><span class="tocnumber">3.1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Key_Points_2"><span class="tocnumber">3.2</span> <span class="toctext">Key Points</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Lab_Steps_2"><span class="tocnumber">3.3</span> <span class="toctext">Lab Steps</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-13"><a href="#Finding_SPL.2FU-Boot_Optimizations"><span class="tocnumber">4</span> <span class="toctext">Finding SPL/U-Boot Optimizations</span></a>
<ul>
<li class="toclevel-2 tocsection-14"><a href="#Description_3"><span class="tocnumber">4.1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-2 tocsection-15"><a href="#Key_Points_3"><span class="tocnumber">4.2</span> <span class="toctext">Key Points</span></a></li>
<li class="toclevel-2 tocsection-16"><a href="#Lab_Steps_3"><span class="tocnumber">4.3</span> <span class="toctext">Lab Steps</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-17"><a href="#Finding_Linux_Kernel_Optimizations"><span class="tocnumber">5</span> <span class="toctext">Finding Linux Kernel Optimizations</span></a>
<ul>
<li class="toclevel-2 tocsection-18"><a href="#Description_4"><span class="tocnumber">5.1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-2 tocsection-19"><a href="#Key_Points_4"><span class="tocnumber">5.2</span> <span class="toctext">Key Points</span></a></li>
<li class="toclevel-2 tocsection-20"><a href="#Lab_Steps_4"><span class="tocnumber">5.3</span> <span class="toctext">Lab Steps</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-21"><a href="#Finding_File_System_Optimizations"><span class="tocnumber">6</span> <span class="toctext">Finding File System Optimizations</span></a>
<ul>
<li class="toclevel-2 tocsection-22"><a href="#Description_5"><span class="tocnumber">6.1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-2 tocsection-23"><a href="#Key_Points_5"><span class="tocnumber">6.2</span> <span class="toctext">Key Points</span></a></li>
<li class="toclevel-2 tocsection-24"><a href="#Lab_Steps_5"><span class="tocnumber">6.3</span> <span class="toctext">Lab Steps</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-25"><a href="#Optimizing_the_Root_File_System"><span class="tocnumber">7</span> <span class="toctext">Optimizing the Root File System</span></a>
<ul>
<li class="toclevel-2 tocsection-26"><a href="#Description_6"><span class="tocnumber">7.1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-2 tocsection-27"><a href="#Key_Points_6"><span class="tocnumber">7.2</span> <span class="toctext">Key Points</span></a></li>
<li class="toclevel-2 tocsection-28"><a href="#Lab_Steps_6"><span class="tocnumber">7.3</span> <span class="toctext">Lab Steps</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-29"><a href="#Writing_the_File_System_to_SD"><span class="tocnumber">8</span> <span class="toctext">Writing the File System to SD</span></a>
<ul>
<li class="toclevel-2 tocsection-30"><a href="#Description_7"><span class="tocnumber">8.1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-2 tocsection-31"><a href="#Key_Points_7"><span class="tocnumber">8.2</span> <span class="toctext">Key Points</span></a></li>
<li class="toclevel-2 tocsection-32"><a href="#Lab_Steps_7"><span class="tocnumber">8.3</span> <span class="toctext">Lab Steps</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-33"><a href="#Optimizing_the_Linux_Kernel"><span class="tocnumber">9</span> <span class="toctext">Optimizing the Linux Kernel</span></a>
<ul>
<li class="toclevel-2 tocsection-34"><a href="#Description_8"><span class="tocnumber">9.1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-2 tocsection-35"><a href="#Key_Points_8"><span class="tocnumber">9.2</span> <span class="toctext">Key Points</span></a></li>
<li class="toclevel-2 tocsection-36"><a href="#Lab_Steps_8"><span class="tocnumber">9.3</span> <span class="toctext">Lab Steps</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-37"><a href="#Writing_the_Linux_Kernel_to_SD"><span class="tocnumber">10</span> <span class="toctext">Writing the Linux Kernel to SD</span></a>
<ul>
<li class="toclevel-2 tocsection-38"><a href="#Description_9"><span class="tocnumber">10.1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-2 tocsection-39"><a href="#Key_Points_9"><span class="tocnumber">10.2</span> <span class="toctext">Key Points</span></a></li>
<li class="toclevel-2 tocsection-40"><a href="#Lab_Steps_9"><span class="tocnumber">10.3</span> <span class="toctext">Lab Steps</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-41"><a href="#Optimizing_the_U-Boot.2FSPL"><span class="tocnumber">11</span> <span class="toctext">Optimizing the U-Boot/SPL</span></a>
<ul>
<li class="toclevel-2 tocsection-42"><a href="#Description_10"><span class="tocnumber">11.1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-2 tocsection-43"><a href="#Key_Points_10"><span class="tocnumber">11.2</span> <span class="toctext">Key Points</span></a></li>
<li class="toclevel-2 tocsection-44"><a href="#Lab_Steps_10"><span class="tocnumber">11.3</span> <span class="toctext">Lab Steps</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-45"><a href="#Writing_the_U-Boot.2FSPL_to_SD"><span class="tocnumber">12</span> <span class="toctext">Writing the U-Boot/SPL to SD</span></a>
<ul>
<li class="toclevel-2 tocsection-46"><a href="#Description_11"><span class="tocnumber">12.1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-2 tocsection-47"><a href="#Key_Points_11"><span class="tocnumber">12.2</span> <span class="toctext">Key Points</span></a></li>
<li class="toclevel-2 tocsection-48"><a href="#Lab_Steps_11"><span class="tocnumber">12.3</span> <span class="toctext">Lab Steps</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-49"><a href="#Measuring_the_Final_Boot_Time"><span class="tocnumber">13</span> <span class="toctext">Measuring the Final Boot Time</span></a>
<ul>
<li class="toclevel-2 tocsection-50"><a href="#Description_12"><span class="tocnumber">13.1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-2 tocsection-51"><a href="#Key_Points_12"><span class="tocnumber">13.2</span> <span class="toctext">Key Points</span></a></li>
<li class="toclevel-2 tocsection-52"><a href="#Lab_Steps_12"><span class="tocnumber">13.3</span> <span class="toctext">Lab Steps</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-53"><a href="#Further_Notes"><span class="tocnumber">14</span> <span class="toctext">Further Notes</span></a></li>
<li class="toclevel-1 tocsection-54"><a href="#Additional_Methods"><span class="tocnumber">15</span> <span class="toctext">Additional Methods</span></a>
<ul>
<li class="toclevel-2 tocsection-55"><a href="#Flashing_the_File_System_to_NAND_with_UBIFS"><span class="tocnumber">15.1</span> <span class="toctext">Flashing the File System to NAND with UBIFS</span></a>
<ul>
<li class="toclevel-3 tocsection-56"><a href="#Description_13"><span class="tocnumber">15.1.1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-3 tocsection-57"><a href="#Key_Points_13"><span class="tocnumber">15.1.2</span> <span class="toctext">Key Points</span></a></li>
<li class="toclevel-3 tocsection-58"><a href="#Lab_Steps_13"><span class="tocnumber">15.1.3</span> <span class="toctext">Lab Steps</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-59"><a href="#Flashing_the_Linux_Kernel_to_NAND"><span class="tocnumber">15.2</span> <span class="toctext">Flashing the Linux Kernel to NAND</span></a>
<ul>
<li class="toclevel-3 tocsection-60"><a href="#Description_14"><span class="tocnumber">15.2.1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-3 tocsection-61"><a href="#Key_Points_14"><span class="tocnumber">15.2.2</span> <span class="toctext">Key Points</span></a></li>
<li class="toclevel-3 tocsection-62"><a href="#Lab_Steps_14"><span class="tocnumber">15.2.3</span> <span class="toctext">Lab Steps</span></a>
<ul>
<li class="toclevel-4 tocsection-63"><a href="#From_Linux"><span class="tocnumber">15.2.3.1</span> <span class="toctext">From Linux</span></a></li>
<li class="toclevel-4 tocsection-64"><a href="#From_U-Boot"><span class="tocnumber">15.2.3.2</span> <span class="toctext">From U-Boot</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-2 tocsection-65"><a href="#Flashing_the_U-Boot.2FSPL_to_NAND"><span class="tocnumber">15.3</span> <span class="toctext">Flashing the U-Boot/SPL to NAND</span></a>
<ul>
<li class="toclevel-3 tocsection-66"><a href="#Description_15"><span class="tocnumber">15.3.1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-3 tocsection-67"><a href="#Key_Points_15"><span class="tocnumber">15.3.2</span> <span class="toctext">Key Points</span></a></li>
<li class="toclevel-3 tocsection-68"><a href="#Lab_Steps_15"><span class="tocnumber">15.3.3</span> <span class="toctext">Lab Steps</span></a>
<ul>
<li class="toclevel-4 tocsection-69"><a href="#From_Linux_2"><span class="tocnumber">15.3.3.1</span> <span class="toctext">From Linux</span></a></li>
<li class="toclevel-4 tocsection-70"><a href="#From_U-Boot_2"><span class="tocnumber">15.3.3.2</span> <span class="toctext">From U-Boot</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
 
<p><big><big><big>Introduction</big></big></big> 
</p>
<hr />
<p><br />This lab is going to give you a hands on tutorial of how to reduce the boot time of a Linux system. There are many techniques to reduce Linux boot time and not all of them will be covered in this lab so please refer to the presentation for more ideas. <br /><br /> 
</p><p><big><b>GOALS:</b></big> 
</p>
<ul><li>Provide the user with a simple display on the LCD and await touchscreen input</li>
<li>Provide the above in <big><b>3</b></big> seconds</li></ul>
<p><br /><br /> <big><b>FEEDBACK:</b></big><br /> If you have questions or feedback please e-mail the <b><a rel="nofollow" class="external text" href="mailto:sdk_feedback@list.ti.com">sdk_feedback@list.ti.com</a></b> mailing list. 
</p><p><br /> <br /> 
</p><p><br />
<br /><big><big><span style="color: red"><b>NOTE:</b> In this guide commands to be executed for each step will be marked in <b>BOLD</b></span></big></big> 
</p><p><br /> 
</p>
<h1><span class="mw-headline" id="Lab_Configuration">Lab Configuration</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=1" title="Edit section: Lab Configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>The following are the hardware and software configurations for this lab. The steps in this lab are written against this configuration. The concepts of the lab will apply to other configurations but will need to be adapted accordingly. 
</p>
<h3><span class="mw-headline" id="Hardware">Hardware</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=2" title="Edit section: Hardware">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ol><li>beaglebone (<a rel="nofollow" class="external text" href="http://beagleboard.org/buy">http://beagleboard.org/buy</a>)</li>
<li>7" LCD cape (<a rel="nofollow" class="external text" href="http://circuitco.com/support/index.php?title=BeagleBone_Capes">http://circuitco.com/support/index.php?title=BeagleBone_Capes</a>)</li>
<li>5V power supply</li></ol>
<h4><span class="mw-headline" id="Optional">Optional</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=3" title="Edit section: Optional">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<ol><li>16-bit NAND cape (<a rel="nofollow" class="external text" href="http://circuitco.com/support/index.php?title=BeagleBone_Capes">http://circuitco.com/support/index.php?title=BeagleBone_Capes</a>)
<ul><li>This hardware is required if you wish to do the steps for flashing the kernel or file system into NAND</li></ul>
<dl><dd><div style="margin: 5px; padding: 5px 10px; background-color: #ffffec; border-left: 5px solid #ff6600;"><b>IMPORTANT</b><br /><br />In this use case the boards should be stacked as beaglebone -&gt; NAND cape -&gt; LCD Cape.  The NAND cape cannot be placed on the cape expander of the LCD cape because it cannot pull the SYSBOOT pins to the right settings from there.</div></dd></dl></li></ol>
<h3><span class="mw-headline" id="Software">Software</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=4" title="Edit section: Software">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ol><li>A Linux host system configured as per the <a href="Sitara_Linux_Training__Linux_Host_Configuration.html" title="Sitara Linux Training: Linux Host Configuration">Linux Host Configuration</a> page</li>
<li>Sitara Linux SDK installed. This lab assumes the SDK is installed in <b>/home/sitara</b>. If you use a different location please modify the below steps accordingly.</li>
<li>setup.sh script in the SDK run to configure the target device for NFS and TFTP.
<ul><li>For help configuring the NFS and TFTP setup see <a href="Sitara_Linux_Training__Hands_on_with_the_SDK.html" class="mw-redirect" title="Sitara Linux Training: Hands on with the SDK">Sitara Linux Training: Hands on with the SDK</a></li></ul></li>
<li>SD card with Sitara Linux SDK installed.
<ul><li>For help creating a 2 partition SD card with the SDK conent see the <a href="http://software-dl.ti.com/processor-sdk-linux/esd/docs/latest/linux/Overview_Getting_Started_Guide.html#linux-sd-card-creation-guide" class="mw-redirect" title="Sitara Linux SDK create SD card script">create_sdcard.sh script page</a></li></ul></li>
<li>The <a href="Sitara_Linux_Training__Linux_Board_Port.html" title="Sitara Linux Training: Linux Board Port">Sitara Linux Training: Linux Board Port</a> and <a href="Sitara_Linux_Training__UBoot_Board_Port.html" title="Sitara Linux Training: UBoot Board Port">Sitara Linux Training: U-Boot Board Port</a> lab trees built with support for the 16-bit NAND cape (tag 05.05.00.00-nand16). These files should be save in the <b>/tftpboot</b> directory as:
<ul><li>uImage-board-port</li>
<li>MLO-board-port</li>
<li>u-boot-board-port</li></ul>
<dl><dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />If using a TI laptop during the labs these images are already created and saved in the /tftpboot directory</div></dd></dl></li></ol>
<h1><span class="mw-headline" id="Setting_up_a_Minimal_System">Setting up a Minimal System</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=5" title="Edit section: Setting up a Minimal System">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h3><span class="mw-headline" id="Description">Description</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=6" title="Edit section: Description">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>This section will cover how to setup the Sitara Linux SDK and the target board to boot the minimal <i>base-rootfs-&lt;machine&gt;.tar.gz</i> file system found in the Sitara Linux SDK. During this lab you will also be using the Linux kernel and U-boot from the <a href="Sitara_Linux_Training__Linux_Board_Port.html" title="Sitara Linux Training: Linux Board Port">Linux board port</a> and <a href="Sitara_Linux_Training__UBoot_Board_Port.html" title="Sitara Linux Training: UBoot Board Port">U-Boot board port</a> labs. These serve as a good starting point for optimization since many of the extra features enabled for development by the <i>tisdk-rootfs-&lt;machine&gt;.tar.gz</i> file system and the default kernel and u-boot configurations are not necessary in a boot time optimized system. 
</p>
<h3><span class="mw-headline" id="Key_Points">Key Points</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=7" title="Edit section: Key Points">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ul><li>Configuring the system for a typical development environment. This includes:
<ul><li>Loading the u-boot boot loader from MMC</li>
<li>Transferring the kernel over TFTP</li>
<li>Booting the target root file system via NFS</li></ul></li></ul>
<h3><span class="mw-headline" id="Lab_Steps">Lab Steps</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=8" title="Edit section: Lab Steps">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ol><li>Close any open minicom sessions you may have by pressing <b>CTRL+A</b> then <b>Z</b> and then <b>X</b>. When prompted select <b>Yes</b> to exit minicom</li>
<li>Insert the Sitara Linux SDK SD card into the beaglebone and boot the board.
<dl><dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />You will not see output on the LCD because the SDK does not currently support capes.  This is why we will be using the board port kernel during this lab</div></dd></dl></li>
<li>Once the board boots you should see the "boot" partition mounted to your Linux host. You can use the <b>mount</b> command to verify that the boot partition is mounted and you should see output like:
<dl><dd><pre>/dev/sdb on /media/boot type vfat (rw,nosuid,nodev,uid=1000,gid=1000,shortname=mixed,dmask=0077,utf8=1,showexec,flush,uhelper=udisks)</pre></dd>
<dd><div style="margin: 5px; padding: 5px 10px; background-color: #ffffec; border-left: 5px solid #ff6600;"><b>IMPORTANT</b><br /><br />If the SD card you are using already has a uEnv.txt file on it for NFS boot (possibly from a previous lab) and the board fails to boot (Perhaps because the NFS server is no longer available) you will need to connect to the serial console using minicom and can run the following commands to boot the board one time from the SD card.<br /><br /><b>env default -f</b>    (This sets the default environment)<br /> <b>mmc rescan</b>    (This enables the mmc device)<br /> <b>run mmc_boot</b>    (This will boot from mmc)<br /><br />You can now continue with the steps below which will reconfigure the NFS settings</div></dd></dl></li>
<li>Copy the board port u-boot and MLO files (listed as prerequisites)to the SD card boot partition. This is so that the default images on the MMC/SD card will have support for the 16-bit NAND cape.
<dl><dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />If you are using a TI laptop these files are already available at <b>/tftpboot/MLO-board-port</b> and <b>/tftpboot/u-boot-board-port</b></div></dd></dl>
<ul><li><b>cp /tftpboot/MLO-board-port /media/boot/MLO</b></li>
<li><b>cp /tftpboot/u-boot-board-port /media/boot/u-boot.img</b></li></ul></li>
<li>Change directory into the Sitara Linux SDK installation directory
<dl><dd><b>cd /home/sitara/&lt;SDK install&gt;</b></dd></dl></li>
<li>Run the setup.sh script
<dl><dd><b>./setup.sh</b></dd>
<dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />These steps assume that you have already run the setup.sh script once before on your host system and therefore already have an NFS share and kernel uImage exported</div></dd></dl></li>
<li>When prompted provide the following responses
<ul><li>If prompted enter your sudo password. If using a TI laptop the password is <b>sitara</b></li>
<li>When prompted to select a directory to install the target filesystem press <b>ENTER</b> to take the default</li>
<li>When asked whether you want to rename, overwrite, or skip the file system extraction enter <b>s</b> to skip the extraction</li>
<li>Press <b>ENTER</b> until prompted for the TFTP directory</li>
<li>When prompted for the tftp root directory press <b>ENTER</b> to accept the default <i>/tftpboot</i> location</li>
<li>When asked whether to rename, overwrite, or skip the copy of the uImage enter <b>s</b> to skip the copy</li>
<li>When prompted for the serial port to use press <b>ENTER</b> because the serial port will be detected automatically
<dl><dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />The automatic detection only works on boards like the beaglebone and EVM-SK.  For the full EVM you should enter your serial port here</div></dd></dl></li>
<li>When prompted to enter your host IP address press <b>ENTER</b> to take the default</li>
<li>When prompted to select the Linux kernel location press <b>ENTER</b> to take the default of TFTP</li>
<li>When prompted to select the root file system location press <b>ENTER</b> to take the default of NFS</li>
<li>When prompted for the kernel image to use press <b>ENTER</b> to take the default value</li>
<li>When asked if you are using a Beaglebone or EVM-SK enter <b>y</b> to configure for a beaglebone (unless you are using a full EVM)</li>
<li>When asked if you would like to restart the device now press <b>ENTER</b> to restart the device.</li></ul></li>
<li>You should now see a minicom terminal open and the device begin to boot. You should see that the kernel is loaded over TFTP and the file system is booted from NFS
<ul><li>Your system is now configured for a TFTP kernel boot and and NFS root file system</li></ul></li>
<li>At the login prompt login as <b>root</b> with a blank password</li>
<li>Shutdown the board using the following command. This is done so that you can swap the file system being used with the base image from the SDK.
<dl><dd><b>init 0</b></dd>
<dd><div style="margin: 5px; padding: 5px 10px; background-color: #ffffec; border-left: 5px solid #ff6600;"><b>IMPORTANT</b><br /><br />Wait until you see the <b>System halted</b> message before going on</div></dd></dl></li>
<li>On your host go to the SDK directory and perform the following commands. These commands will move the default NFS file system out of the way and extract a new NFS file system using the base image.
<ol><li><b>cd /home/sitara/&lt;sdk install dir&gt;</b></li>
<li><b>sudo mv targetNFS targetNFS.orig</b></li>
<li><b>mkdir targetNFS</b></li>
<li><b>cd targetNFS</b></li>
<li><b>sudo tar xzf ../filesystem/base-rootfs-&lt;machine&gt;.tar.gz</b></li></ol>
<dl><dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br /><b>sudo</b> is used when extracting the target file system because special files such as device nodes require root permission to be created</div></dd>
<dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />The steps above are done to preserve your original file system and so that you can re-use the export created for the targetNFS file system with you new file system</div></dd></dl></li>
<li>Now on the host you will change the TFTP kernel image to the image from the <a href="Sitara_Linux_Training__Linux_Board_Port.html" title="Sitara Linux Training: Linux Board Port">Sitara Linux board port</a> lab. If you have not already done this lab please refer to the <a href="Sitara_Linux_Training__Linux_Board_Port.html" title="Sitara Linux Training: Linux Board Port">Sitara Linux board port</a> lab for instructions on building the kernel.
<dl><dd><div style="margin: 5px; padding: 5px 10px; background-color: #ffffec; border-left: 5px solid #ff6600;"><b>IMPORTANT</b><br /><br />If you are using a training laptop provided by TI these images have already been compiled and stored in the /tftpboot directory for you.  The following instructions will tell you how to copy these images.  If you are not using a TI laptop then you will need to build the kernel image yourself and overwrite the existing image in the /tftpboot directory</div></dd></dl>
<ol><li><b>cd /tftpboot</b></li>
<li><b>sudo cp uImage-am335x-evm.bin uImage-am335x-evm.bin.orig</b></li>
<li><b>sudo cp uImage-board-port uImage-am335x-evm.bin</b></li></ol></li>
<li>Reboot the board. You should see the system come up to a login prompt. You have now finished configuring your system to boot a minimal file system and simple kernel which was ported to your hardware over NFS and TFTP.</li>
<li>Once the board is booted shut the board down with <b>init 0</b>
<dl><dd><b>init 0</b></dd>
<dd><div style="margin: 5px; padding: 5px 10px; background-color: #ffffec; border-left: 5px solid #ff6600;"><b>IMPORTANT</b><br /><br />Wait until you see the <b>System halted</b> message before going on</div></dd></dl></li>
<li>Exit minicom by pressing <b>CTRL+A</b> then <b>Z</b> and then <b>X</b>. When prompted select <b>Yes</b> to exit minicom</li></ol>
<h1><span class="mw-headline" id="Measuring_Boot_Time">Measuring Boot Time</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=9" title="Edit section: Measuring Boot Time">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h3><span class="mw-headline" id="Description_2">Description</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=10" title="Edit section: Description">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>This section will cover how to measure the boot time and the time used by different components of the system during boot. This measurement will be used in the following sections to help identify the areas that can be optimized. 
</p>
<h3><span class="mw-headline" id="Key_Points_2">Key Points</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=11" title="Edit section: Key Points">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ol><li>Use the tstamp.c program to measure boot time on Linux systems
<ul><li>This program can be found in the sitara-training-helper-files git repository available at <a rel="nofollow" class="external text" href="https://gitorious.org/sitara-training">https://gitorious.org/sitara-training</a> and can be cloned by doing <b>git clone <a rel="nofollow" class="external free" href="git://gitorious.org/sitara-training/sitara-training-helper-files.git">git://gitorious.org/sitara-training/sitara-training-helper-files.git</a></b></li></ul></li>
<li>After capturing the boot time output you can use that output to find areas to optimize</li></ol>
<h3><span class="mw-headline" id="Lab_Steps_2">Lab Steps</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=12" title="Edit section: Lab Steps">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ol><li>Checkout the sitara-training-helper-files repository.
<dl><dd><div style="margin: 5px; padding: 5px 10px; background-color: #ffffec; border-left: 5px solid #ff6600;"><b>IMPORTANT</b><br /><br />If you are using a TI training laptop this has already been done for you and you can find the files in <b>/home/sitara/sitara-training-helper-files</b></div></dd>
<dd><b>cd /home/sitara</b></dd>
<dd><b>git clone <a rel="nofollow" class="external free" href="git://gitorious.org/sitara-training/sitara-training-helper-files.git">git://gitorious.org/sitara-training/sitara-training-helper-files.git</a></b></dd></dl></li>
<li>Compile the tstamp.c program
<dl><dd><b>cd /home/sitara/sitara-training-helper-files</b></dd>
<dd><b>gcc tstamp.c -o tstamp</b></dd></dl></li>
<li>Copy the tstamp executable to the /usr/bin directory so it will be available in your default PATH
<dl><dd><b>sudo cp tstamp /usr/bin/</b></dd></dl></li>
<li>Set your serial port to the proper baud rate. For these instructions we will assume /dev/ttyUSB1 but you may have a different port based on your setup.
<dl><dd><div style="margin: 5px; padding: 5px 10px; background-color: #ffffec; border-left: 5px solid #ff6600;"><b>IMPORTANT</b><br /><br />If you are using a device like the beaglebone with a built in USB-to-Serial adapter you can find the serial port by doing <b>dmesg </b></div><b> </b></dd>
<dd><b>stty -F /dev/ttyUSB1 115200</b></dd></dl></li>
<li>You can now use the tstamp program to measure boot times. To do this use the command
<dl><dd><b>cat /dev/ttyUSB1 | tstamp</b></dd></dl></li>
<li>Now <b>press the Reset button</b> on the beaglebone (located on at the top right corner when using and LCD 7" cape) and let the system boot. You should see output on the screen with timestamps for each line like
<dl><dd><i>37.920 0.080: Starting thttpd.</i></dd>
<dd><div style="margin: 5px; padding: 5px 10px; background-color: #ffffec; border-left: 5px solid #ff6600;"><b>IMPORTANT</b><br /><br />The tstamp program works by capturing time elapsed between new lines on the screen, which is why you do no see the login prompt.  It also keeps the counter from the first line which means that if you want to restart the base time counter (the first field) you will need to use <b>ctrl+c</b> to exit the application and then restart it running</div></dd></dl></li>
<li>The total boot time in this setup was around <b>39.252</b> seconds. We can do much better than that and the rest of this lab will be focused on doing just that to hit our 3 second goal.</li></ol>
<h1><span id="Finding_SPL/U-Boot_Optimizations"></span><span class="mw-headline" id="Finding_SPL.2FU-Boot_Optimizations">Finding SPL/U-Boot Optimizations</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=13" title="Edit section: Finding SPL/U-Boot Optimizations">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h3><span class="mw-headline" id="Description_3">Description</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=14" title="Edit section: Description">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Now that you have an output from the boot process we can go through that output by scrolling back in history and reviewing the pieces of the boot that took the most time. This section will highlight areas in the boot loaders that can be optimized as well as a estimate of the difficulty in reducing that time. 
</p><p>The following difficulty classifications will be used during this lab: 
</p>
<ul><li>Easy: These changes can be as simple as modifying bootargs and environment settings.</li>
<li>Medium: These changes usually involve modifying/rebuilding a component but do not require changing the system configuration</li>
<li>Hard: These changes usually involve modifying/rebuilding a components and changing the system configuration</li></ul>
<h3><span class="mw-headline" id="Key_Points_3">Key Points</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=15" title="Edit section: Key Points">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ol><li>Identify steps in the boot loader that consume a large amount of time</li>
<li>Identify the begin and end of the boot loader steps</li>
<li>Build a list of the optimizations to make in later steps</li></ol>
<h3><span class="mw-headline" id="Lab_Steps_3">Lab Steps</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=16" title="Edit section: Lab Steps">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ol><li>Identify the beginning of the boot loader in your output. This should be one of the first lines and should look like the following
<dl><dd><a href="File_Sitara-linux-training-spl-start.html" class="image"><img alt="Sitara-linux-training-spl-start.png" src="https://processors.wiki.ti.com/images/0/01/Sitara-linux-training-spl-start.png" width="643" height="390" /></a></dd></dl></li>
<li>Scroll down in the output until you find the beginning of the U-Boot boot. This should look like the following
<dl><dd><a href="File_Sitara-linux-training-spl-end.html" class="image"><img alt="Sitara-linux-training-spl-end.png" src="https://processors.wiki.ti.com/images/8/8c/Sitara-linux-training-spl-end.png" width="643" height="390" /></a></dd></dl></li>
<li>The lines located between this start line and end line represent the steps of the SPL boot loader. We will now focus on those lines to identify optimizations.</li>
<li>We see that the <i>OMAP SD/MMC</i> device is being initialized
<dl><dd><a href="File_Sitara-linux-training-spl-mmcinit.html" class="image"><img alt="Sitara-linux-training-spl-mmcinit.png" src="https://processors.wiki.ti.com/images/e/e5/Sitara-linux-training-spl-mmcinit.png" width="643" height="390" /></a></dd></dl>
<ul><li>Impact: This step is taking about 0.436 seconds</li>
<li>Removable?: We are currently booting from SD card and would need to find a different boot source to remove this initialization</li>
<li>Difficulty: Hard. Making this change will require modifying the boot loader and changing the system configuration to boot from a different interface than SD/MMC.</li></ul></li>
<li>We have now reached the end of the SPL boot loader and need to identify the start of the U-Boot boot loader. This should look like the following
<dl><dd><a href="File_Sitara-linux-training-spl-end.html" class="image"><img alt="Sitara-linux-training-spl-end.png" src="https://processors.wiki.ti.com/images/8/8c/Sitara-linux-training-spl-end.png" width="643" height="390" /></a></dd></dl></li>
<li>Scroll down in the output until you find the beginning of the Linux kernel boot. This should look like the following
<dl><dd><a href="File_Sitara-linux-training-uboot-end.html" class="image"><img alt="Sitara-linux-training-uboot-end.png" src="https://processors.wiki.ti.com/images/5/5d/Sitara-linux-training-uboot-end.png" width="644" height="390" /></a></dd></dl></li>
<li>As with the SPL the lines between these sections represent the U-Boot output and where we will focus our optimizations</li>
<li>The first optimization point concerns reading the u-boot environment from NAND. Because the NAND is blank this generates an ECC error.
<dl><dd><a href="File_Sitara-linux-training-uboot-env-ecc.html" class="image"><img alt="Sitara-linux-training-uboot-env-ecc.png" src="https://processors.wiki.ti.com/images/5/5b/Sitara-linux-training-uboot-env-ecc.png" width="643" height="392" /></a></dd></dl>
<ul><li>Impact: This step is taking about 0.764 seconds</li>
<li>Removable?: When creating your own product you will may store your environment in a persistent storage like NAND, but you can also modify u-boot to code your default environment directly into the executable.</li>
<li>Difficulty: Medium. To remove this you would need to modify u-boot to set your default boot environment.</li></ul></li>
<li>The next step taking a large amount of time is the boot delay
<dl><dd><a href="File_Sitara-linux-training-boot-delay.html" class="image"><img alt="Sitara-linux-training-boot-delay.png" src="https://processors.wiki.ti.com/images/a/a5/Sitara-linux-training-boot-delay.png" width="643" height="392" /></a></dd></dl>
<ul><li>Impact: This step takes about 3.004 seconds</li>
<li>Removable?: Yes. Although if/when we set this to zero you will be unable to stop the autoboot from the serial console</li>
<li>Difficulty: Easy/Medium. This is given a rating of easy to medium because you cannot change this value using the uEnv.txt file support on the MMC card. You can change this value if you are using a NAND environment. So for NAND this is easy because the value can be set and saved. For MMC you will need to change the U-Boot configuration and rebuild U-Boot.</li></ul></li>
<li>The next large section is where the network interface is defined and the kernel is transferred
<dl><dd><a href="File_Sitara-linux-training-uboot-network.html" class="image"><img alt="Sitara-linux-training-uboot-network.png" src="https://processors.wiki.ti.com/images/8/83/Sitara-linux-training-uboot-network.png" width="645" height="510" /></a></dd></dl>
<ul><li>Impact: All told this step is taking about 21.7 seconds</li>
<li>Removable?: Yes, although this will require transferring the kernel from elsewhere</li>
<li>Difficulty: Medium/Hard. This will require changing the boot configuration which is why it has received a hard rating. However, since changing where the kernel is loaded from is usually a trivial task and in fact supported by many of the default environment commands such as <b>nand_boot</b> and <b>mmc_boot</b> this is also listed as medium.</li></ul></li>
<li>The next big time consumer is verifying the image checksum
<dl><dd><a href="File_Sitara-linux-training-image-checksum.html" class="image"><img alt="Sitara-linux-training-image-checksum.png" src="https://processors.wiki.ti.com/images/2/2a/Sitara-linux-training-image-checksum.png" width="644" height="390" /></a></dd></dl>
<ul><li>Impact: About 0.916 seconds</li>
<li>Removable?: Maybe. Since we do nothing when an image checksum fails to match then we can remove this. If however you had a fallback mechanism for a bad kernel you would want to keep this in place.</li>
<li>Difficulty: Easy. This verification can be controlled with a simple environment flag so it is an easy one to make.</li></ul></li>
<li>Next you will see that we are spending time loading the kernel image to the proper location in DDR
<dl><dd><a href="File_Sitara-linux-training-load-kernel.html" class="image"><img alt="Sitara-linux-training-load-kernel.png" src="https://processors.wiki.ti.com/images/f/fd/Sitara-linux-training-load-kernel.png" width="644" height="390" /></a></dd></dl>
<ul><li>Impact: About 1.428 seconds</li>
<li>Removable?: Yes. This step is being done because the default boot command is configured to load the kernel at a different address then where the kernel is configured to run from. Therefore u-boot must relocate the kernel in memory before booting.</li>
<li>Difficulty: Easy. This can be fixed by changing the environment variables to use <b>kloadaddr</b> for the load address and bootm addresses rather than <b>loadaddr</b></li></ul></li>
<li>All told we have identified about 27.812 seconds of time that we can optimize. We will not get all of this time back because we will be trading some things like the long network load time for booting from NAND which will still have a copy time associated. But as a rough target this is a good estimate. If our total boot time is about 39.2 seconds and we can remove almost 27.8 seconds we will already have our boot time down to 11.4 seconds with just boot loader optimizations.</li></ol>
<p><b>Additional Notes</b> 
</p>
<ul><li>If you are using the default SDK u-boot you will see that u-boot scans for any daughter cards on the I2C bus
<ul><li>Impact: These step is taking about 0.352 seconds</li>
<li>Removable?: When creating your own product you likely will not bother with I2C EEPROMs to scan to identify daughter cards. So this should be removable.</li>
<li>Difficulty: Medium. We will need to remove the code that does the scan from the bootloader and recompile.
<dl><dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />In this lab we use the U-Boot from the <a href="Sitara_Linux_Training__UBoot_Board_Port.html" title="Sitara Linux Training: UBoot Board Port"> U-Boot Board Port lab</a> which already has this I2C scan removed.</div></dd></dl></li></ul></li></ul>
<h1><span class="mw-headline" id="Finding_Linux_Kernel_Optimizations">Finding Linux Kernel Optimizations</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=17" title="Edit section: Finding Linux Kernel Optimizations">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h3><span class="mw-headline" id="Description_4">Description</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=18" title="Edit section: Description">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Now that you have an output from the boot process we can go through that output by scrolling back in history and reviewing the pieces of the boot that took the most time. This section will highlight areas in the Linux kernel that can be optimized as well as a estimate of the difficulty in reducing that time. 
</p>
<h3><span class="mw-headline" id="Key_Points_4">Key Points</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=19" title="Edit section: Key Points">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ol><li>Identify steps in the Linux kernel that consume a large amount of time</li>
<li>Identify the begin and end of the Linux kernel steps</li>
<li>Build a list of the optimizations to make in later steps</li>
<li>initcall_debug is not used in this lab but can be used to help you better refine your kernel boot time optimization search</li>
<li>This is not a comprehensive list of all the optimizations that are possible. We are starting from a rather minimal kernel and it would be possible to cut this kernel down even further if needed but for the sake of this lab we will leave most of the kernel options alone and target the large ticket items and easy items.</li></ol>
<p><br /> 
</p>
<h3><span class="mw-headline" id="Lab_Steps_4">Lab Steps</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=20" title="Edit section: Lab Steps">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ol><li>Scroll up in your output to identify the beginning of the kernel boot process. This should look like the following
<dl><dd><a href="File_Sitara-linux-training-uboot-end.html" class="image"><img alt="Sitara-linux-training-uboot-end.png" src="https://processors.wiki.ti.com/images/5/5d/Sitara-linux-training-uboot-end.png" width="644" height="390" /></a></dd></dl></li>
<li>Scroll down in the output until you find the beginning of the end of the Linux kernel boot. This should look like the following
<dl><dd><a href="File_Sitara-linux-training-linux-end.html" class="image"><img alt="Sitara-linux-training-linux-end.png" src="https://processors.wiki.ti.com/images/0/0a/Sitara-linux-training-linux-end.png" width="643" height="391" /></a></dd></dl></li>
<li>You have now identified the kernel boot step and can begin to look for areas of optimization.
<dl><dd><div style="margin: 5px; padding: 5px 10px; background-color: #ffffec; border-left: 5px solid #ff6600;"><b>IMPORTANT</b><br /><br />Since the kernel uses some buffers during output sometimes the tstamp tool is not optimal for finding the time taken by a kernel step since the tool tracks the time between new lines being printed.  Luckily the kernel also has time stamping on its messages and you can use those time stamps to help you find the amount of time taken by a step.  However, if you see a large delay in tstamp that is still a good area to focus you attention</div></dd></dl></li>
<li>The first optimization is the time taken to calibrate the delay loop
<dl><dd><a href="File_Sitara-linux-training-lpj.html" class="image"><img alt="Sitara-linux-training-lpj.png" src="https://processors.wiki.ti.com/images/2/21/Sitara-linux-training-lpj.png" width="643" height="393" /></a></dd></dl>
<ul><li>Impact: About 0.000152 seconds</li>
<li>Removable?: Yes</li>
<li>Difficulty: Easy. This does not save much time as it did is some previous devices, but this is a value that only needs to be calculated once in most cases. So adding lpj=xxxxxxx to the kernel bootargs is an easy way to save this time.</li></ul></li>
<li>The next area of improvement is further down in the output and revolves around the networking required for NFS
<dl><dd><a href="File_Sitara-linux-training-kernel-ip.html" class="image"><img alt="Sitara-linux-training-kernel-ip.png" src="https://processors.wiki.ti.com/images/a/a9/Sitara-linux-training-kernel-ip.png" width="643" height="393" /></a></dd></dl>
<ul><li>Impact: About 4.2 seconds</li>
<li>Removable?: Yes. By not bringing up the network interface in the kernel this time can be saved. A static IP would at least save about 1.252 seconds of time.</li>
<li>Difficulty: Medium/Hard. This change is listed as hard because it requires changing the system configuration to boot from something other than NFS. It is given a medium rating as well because this is not too difficult of a task depending on the location being used for the root file system. For example using a MMC root file system is easier and takes very little configuration vs. a NAND based root file system.</li></ul></li>
<li>The final optimization is to observe how long the kernel took to print each line of output.
<ul><li>Impact: About 1.5 seconds</li>
<li>Removable?: Yes. Using the quiet parameter</li>
<li>Difficulty: Easy. Simple adding the <b>quiet</b> parameter to the kernel bootargs will reduce the amount of kernel print messages.
<dl><dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />This is usually something you would do towards the end of your optimizations since you will also lose a lot of useful messages once this option is enabled.  You can still see these messages using <b>dmesg</b> once the system is booted.</div></dd></dl></li></ul></li>
<li>Overall we can save about 5.7 seconds on the boot time with the optimizations above. We will obviously not get back all of the time since it will take some amount of time to initialize other types of file systems as well.</li></ol>
<h1><span class="mw-headline" id="Finding_File_System_Optimizations">Finding File System Optimizations</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=21" title="Edit section: Finding File System Optimizations">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h3><span class="mw-headline" id="Description_5">Description</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=22" title="Edit section: Description">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Now that you have an output from the boot process we can go through that output by scrolling back in history and reviewing the pieces of the boot that took the most time. This section will highlight areas in the root file system that can be optimized as well as a estimate of the difficulty in reducing that time. We will also identify where we can inject our own steps to perform a simple splash screen display and touchscreen read in the boot process. 
</p>
<h3><span class="mw-headline" id="Key_Points_5">Key Points</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=23" title="Edit section: Key Points">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ol><li>Identify steps in the root file system that consume a large amount of time</li>
<li>Build a list of the optimizations to make in later steps</li>
<li>Identify where to place our init script to start our application early in the boot process
<ul><li>If you have not already done the <a href="Sitara_Linux_Training__Init_Scripts.html" title="Sitara Linux Training: Init Scripts">Init Scripts Lab</a> you should do this to familiarize yourself with how init scripts work.</li></ul></li>
<li>The root file system is the point at which we will add our splash screen application and be ready to receive touchscreen event.
<ul><li>The sooner we can add this in the boot process the sooner the system will be "booted"</li></ul></li>
<li>You will see that we can make the system "boot" (become "available") quickly while continuing to load the rest of the system services in the background.</li></ol>
<h3><span class="mw-headline" id="Lab_Steps_5">Lab Steps</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=24" title="Edit section: Lab Steps">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ol><li>Scroll up in your output to identify the beginning of the root file system boot process. This should look like the following
<dl><dd><a href="File_Sitara-linux-training-linux-end.html" class="image"><img alt="Sitara-linux-training-linux-end.png" src="https://processors.wiki.ti.com/images/0/0a/Sitara-linux-training-linux-end.png" width="643" height="391" /></a></dd></dl></li>
<li>Scroll down in the output until you find the beginning of the end of the root file sysetm boot. This should look like the following
<dl><dd><a href="File_Sitara-linux-training-rootfs-end.html" class="image"><img alt="Sitara-linux-training-rootfs-end.png" src="https://processors.wiki.ti.com/images/0/00/Sitara-linux-training-rootfs-end.png" width="644" height="393" /></a></dd></dl></li>
<li>You have now identified the file system boot step and can begin to look for areas of optimization.</li>
<li>The first are taking a large amount of time is the init process
<dl><dd><a href="File_Sitara-linux-training-init.html" class="image"><img alt="Sitara-linux-training-init.png" src="https://processors.wiki.ti.com/images/2/21/Sitara-linux-training-init.png" width="643" height="392" /></a></dd></dl>
<ul><li>Impact: About 0.256 seconds</li>
<li>Removable?: No. It is possible to modify the init process but usually not required or recommended. This would require a rebuild of the entire init process.</li>
<li>Difficulty: Hard. Requires modifying the base process for the entire Linux system.</li></ul></li>
<li>The first process being run is S01psplash which is responsible for showing the TI logo and progress bar on the screen. Instead we can replace this with our own custom image and script to read touchscreen events. So we can <b>mark this as the location to add our application start script</b> and remove the psplash script.</li>
<li>The following items are listed to give you an idea of other areas you can impact boot time but not necessarily items we are going to optimize
<dl><dd><div style="margin: 5px; padding: 5px 10px; background-color: #ffffec; border-left: 5px solid #ff6600;"><b>IMPORTANT</b><br /><br />The reason we are not optimizing these items is because it is OK for those items to run in the background since the system is already "booted".  If you wanted to remove those items you would usually just remove the init script that calls the process</div></dd></dl></li>
<li>The next step taking time is the initialization of the udev process.
<dl><dd><a href="File_Sitara-linux-training-udev.html" class="image"><img alt="Sitara-linux-training-udev.png" src="https://processors.wiki.ti.com/images/9/98/Sitara-linux-training-udev.png" width="643" height="392" /></a></dd></dl>
<ul><li>Impact: About 1.172 seconds</li>
<li>Removable?: Maybe. You can remove udev or use a different manager like mdev if you are working with a static system. However, if you are wanting to be able to attach new devices to the system udev is recommended.</li>
<li>Difficulty: Medium. It is easy to not start udev but modifying your system to handle all the attached devices can be difficult.</li></ul></li>
<li>Next we see that caching the udev nodes is taking a good chunk of time.
<dl><dd><a href="File_Sitara-linux-training-udev-cache.html" class="image"><img alt="Sitara-linux-training-udev-cache.png" src="https://processors.wiki.ti.com/images/0/0a/Sitara-linux-training-udev-cache.png" width="643" height="392" /></a></dd></dl>
<ul><li>Impact: About 0.520 seconds</li>
<li>Removable?: Maybe. If we are not using udev you can remove the caching of the udev nodes</li>
<li>Difficulty: Easy. Just remove the init script</li></ul></li>
<li>One of the last big consumers of time is the creation of the shell.
<dl><dd><a href="File_Sitara-linux-training-init-shell.html" class="image"><img alt="Sitara-linux-training-init-shell.png" src="https://processors.wiki.ti.com/images/b/b3/Sitara-linux-training-init-shell.png" width="643" height="392" /></a></dd></dl>
<ul><li>Impact: About 1.288 seconds</li>
<li>Removable?: Maybe. This too would require a modification to the init program itself. Removing this would prevent the initial shell from being launched and therefore prevent user login including debug login.</li>
<li>Difficulty: Hard. Requires modifying the base process for the entire Linux system.</li></ul></li></ol>
<h1><span class="mw-headline" id="Optimizing_the_Root_File_System">Optimizing the Root File System</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=25" title="Edit section: Optimizing the Root File System">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>This section will cover the simple modifications that can be made to reduce the large boot time adders identified in the previous section. 
</p>
<h3><span class="mw-headline" id="Description_6">Description</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=26" title="Edit section: Description">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>We will start with the root file system because it is the easiest to modify. The overall goal is to have a splash screen up and awaiting touchscreen input in less than 3 seconds. For this we will make a simple modification to the root file system to implement the splash screen functionality early in the boot process, and then allow the rest of the system to initialize in the background. 
</p><p><br /> 
</p>
<h3><span class="mw-headline" id="Key_Points_6">Key Points</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=27" title="Edit section: Key Points">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ol><li>Placement of the splash screen early in the boot process allows the system to be "booted" quickly.</li>
<li>The rest of the system can continue to boot in the background while waiting for the user to touch the screen.</li></ol>
<p><br /> 
</p>
<h3><span class="mw-headline" id="Lab_Steps_6">Lab Steps</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=28" title="Edit section: Lab Steps">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ol><li>Start minicom using the following command
<dl><dd><b>minicom -w</b></dd>
<dd><div style="margin: 5px; padding: 5px 10px; background-color: #ffffec; border-left: 5px solid #ff6600;"><b>IMPORTANT</b><br /><br />The above command launches minicom using the defaults and with line wrap enabled.  If you do not see output during the following steps you will likely need to use <b>minicom -s -w</b> to allow reconfiguring the serial port to use</div></dd></dl></li>
<li>Press <b>Enter</b> to bring up the login prompt and login using:
<dl><dd>Username: <b>root</b></dd></dl></li>
<li>First we need to remove the existing <i>psplash</i> init script which is displaying the progress bar during boot. This can be done by simply removing the symlink <b>S01psplash</b> from <b>/etc/rcS.d</b>
<ul><li><b>rm /etc/rcS.d/S01psplash</b></li></ul></li>
<li>We now need to create our own script for doing the splash operation and waiting for a touchscreen event
<ul><li><b>vi /etc/init.d/mysplash.sh</b> and type</li></ul>
<dl><dd><big><code>#!/bin/sh</code></big></dd><big><code>
<dd>cat /home/root/startup.rawr16 &gt; /dev/fb0</dd>
<dd>head -c 1 /dev/input/event0 &gt; /dev/null</dd>
<dd>cat /dev/zero &gt; /dev/fb0</dd>
</code></big><dd><big><code></code></big></dd>
<dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />The above script does a raw write of a 16 bit per pixel to the frame buffer.  It then waits to read 1 byte of input from the input device node to determine when the touchscreen is pressed.  At that point it blanks the display.</div></dd>
<dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br /> The startup.rawr16 image will be copied later</div></dd></dl></li>
<li>Because we want to run the above script and allow the rest of the system to continue booting we will create a wrapper script that just calls this script and has it run in the background.
<ul><li><b>vi /etc/init.d/run-mysplash.sh</b> and type</li></ul>
<dl><dd><big><code>#!/bin/sh</code></big></dd><big><code>
<dd>echo "Starting splash screen and waiting for touchscreen"</dd>
<dd>/etc/init.d/mysplash.sh &amp;</dd>
</code></big><dd><big><code></code></big></dd>
<dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />In the above script the echo line is used so that we can get a timestamp of when our splash operation started.  The <b>&amp;</b> is required to background the mysplash.sh process</div></dd></dl></li>
<li>Make the scripts executable
<ul><li><b>chmod +x /etc/init.d/mysplash.sh</b></li>
<li><b>chmod +x /etc/init.d/run-mysplash.sh</b></li></ul></li>
<li><b>On your Linux Host</b>: Open a terminal window and copy the <b>startup.rawr16</b> file to the /home/root directory of the NFS share
<ul><li><b>sudo cp /home/sitara/sitara-training-helper-files/boot_time_optimization/startup.rawr16 /home/sitara/&lt;SDK install dir&gt;/targetNFS/home/root</b></li></ul></li>
<li>Now back in your <b>target console</b> link this script into the init process flow at the location where <i>psplash</i> used to be.
<dl><dd><b>cd /etc/rcS.d/</b></dd>
<dd><b>ln -s ../init.d/run-mysplash.sh S01run-mysplash.sh</b></dd></dl></li>
<li>This should now make this one of the first processes to run on system boot. Reboot the board using the following command and observe where the splash screen is started
<ul><li><b>init 6</b></li></ul></li>
<li>After the reboot you should see the splash screen up waiting for a touchscreen press and on the serial console you should see that they system has continued to boot in the background.</li></ol>
<h1><span class="mw-headline" id="Writing_the_File_System_to_SD">Writing the File System to SD</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=29" title="Edit section: Writing the File System to SD">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h3><span class="mw-headline" id="Description_7">Description</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=30" title="Edit section: Description">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Now that we have finished optimizing the root file system for this lab we can go ahead and write the file system to the SD card partition reserved for the file system (<i>/dev/mmcblk0p2</i>). In this case the beaglebone acts as our SD card reader rather than having to use our Linux host system. 
</p>
<h3><span class="mw-headline" id="Key_Points_7">Key Points</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=31" title="Edit section: Key Points">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ul><li>How to make a tarball of an existing NFS file system</li>
<li>How to mount an SD card partition on the target board</li>
<li>Extracting a file system to the SD card</li>
<li>Modifying the bootargs to boot using the root file system on the SD card</li></ul>
<h3><span class="mw-headline" id="Lab_Steps_7">Lab Steps</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=32" title="Edit section: Lab Steps">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ol><li>The first step is to make a tarball of our existing NFS image. Shutdown the board using <b>init 0</b> and use the following commands on the <b>Linux Host</b> to make a file system tarball
<ul><li><b>cd /home/sitara/&lt;SDK install dir&gt;/targetNFS</b></li>
<li><b>sudo tar czf ../base-file-system.tar.gz *</b></li></ul>
<dl><dd><div style="margin: 5px; padding: 5px 10px; background-color: #ffffec; border-left: 5px solid #ff6600;"><b>IMPORTANT</b><br /><br />The above command will make a file system tarball that extracts into the current directory.  The ../ is used so that the tarball being created is NOT picked up as part of the tar process</div></dd></dl></li>
<li>Now copy the <b>base-file-system.tar.gz</b> tarball back into the NFS file system so it will be available on the target
<ul><li><b>sudo cp ../base-file-system.tar.gz .</b></li></ul></li>
<li>Reset the target board. Once the board has booted, on the target console login using <b>root</b></li>
<li>Re-Format the SD card root file system partition. This will erase the SDK file system and make room for our file minimal file system instead.
<ul><li><b>mkfs.ext3 -L rootfs /dev/mmcblk0p2</b></li></ul>
<dl><dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />The "-L rootfs" option was used to give the file system volume a human readable name</div></dd></dl></li>
<li>Mount the second partition of the SD card, which was reserved for the file system to the <b>/media/mmc1</b> mount point
<ul><li><b>mount /dev/mmcblk0p2 /media/mmc1</b></li></ul></li>
<li>Now cd to the mounted file system and extract the root file system tarball into the blank file system.
<ul><li><b>cd /media/mmc1</b></li>
<li><b>tar xzf /base-file-system.tar.gz</b></li></ul></li>
<li>Now you can unmount the file system and perform a sync operation to make sure everything is flushed to the SD card
<ul><li><b>cd ..</b></li>
<li><b>umount mmc1</b></li>
<li><b>sync</b></li></ul></li>
<li>Now we will mount the SD card boot partition and modify the uEnv.txt so that we can boot this new SD file system instead of the NFS.
<ul><li><b>mount /dev/mmc0blk0p1 /media/mmc1</b></li>
<li><b>vi /media/mmc1/uEnv.txt</b> and make the following changes
<ul><li>Delete the following line: (You can scroll to the line and press <b>d + d</b> to delete the line)
<dl><dd><b>tftp_nfs_boot=......</b></dd></dl></li>
<li>Add the following line:
<dl><dd><b>tftp_mmc_boot=dhcp ${loadaddr} ${bootfile}; run mmc_args; bootm ${loadaddr}</b></dd></dl></li>
<li>Change the uenvcmd to
<dl><dd><b>uenvcmd=tftp_mmc_boot</b></dd></dl></li></ul></li></ul></li>
<li>The resulting file should look like:
<dl><dd><i>serverip=xxx.xxx.xxx.xxx</i></dd>
<dd><i>rootpath=/xxx/xxx/xxx/</i></dd>
<dd><i>bootfile=uImage-am335x-evm.bin</i></dd>
<dd><i>ip_method=dhcp</i></dd>
<dd><i>uenvcmd=run tftp_mmc_boot</i></dd>
<dd><i>tftp_mmc_boot=dhcp ${loadaddr} ${bootfile}; run mmc_args; bootm ${loadaddr}</i></dd></dl></li>
<li>Unmount the MMC device and reboot the board
<ul><li><b>umount mmc1</b></li>
<li><b>init 6</b></li></ul></li>
<li>You should now see the board boot using the file system on the SD card.</li></ol>
<h1><span class="mw-headline" id="Optimizing_the_Linux_Kernel">Optimizing the Linux Kernel</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=33" title="Edit section: Optimizing the Linux Kernel">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h3><span class="mw-headline" id="Description_8">Description</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=34" title="Edit section: Description">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>This section will cover making optimizations to the Linux kernel that will save on boot time. This kernel is in some ways already reduced since many interfaces are not defined in the board port kernel we are using but configuration options could be optimized further depending on your target system. The optimizations done in this lab will mostly involve changing the settings passed to the kernel during boot. 
</p>
<h3><span class="mw-headline" id="Key_Points_8">Key Points</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=35" title="Edit section: Key Points">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ul><li>Many optimizations can be as simple as changing the kernel boot settings</li>
<li>Setting lpj value</li>
<li>Changing IP method</li>
<li>Avoiding kernel message prints</li></ul>
<h3><span class="mw-headline" id="Lab_Steps_8">Lab Steps</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=36" title="Edit section: Lab Steps">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ol><li>You should at this point have your board booted to the SD file system flashed in the previous lab. Go ahead and login as <b>root</b>.</li>
<li>Mount the SD card boot partition so that we can modify the uEnv.txt file to affect the parameters passed to the Linux kernel
<ul><li><b>cd /media</b></li>
<li><b>mount /dev/mmcblk0p1 mmc1</b></li></ul></li>
<li>Make a copy of your uEnv.txt file for backup purposes
<ul><li><b>cp mmc1/uEnv.txt mmc1/uEnv.txt.orig</b></li></ul></li>
<li>Edit the <b>mmc1/uEnv.txt</b> file and make the following changes
<ul><li><b>vi /media/mmc1/uEnv.txt</b>
<ul><li>Add the line
<dl><dd><b>optargs=quiet lpj=3590144</b></dd></dl></li>
<li>Delete following lines
<dl><dd><b>ip_method=dhcp</b></dd>
<dd><b>rootpath=xxxxxx</b></dd></dl></li>
<li>The resulting file should look like:
<dl><dd><i>serverip=xxx.xxx.xxx.xxx</i></dd>
<dd><i>bootfile=uImage-am335x-evm.bin</i></dd>
<dd><i>uenvcmd=run tftp_mmc_boot</i></dd>
<dd><i>tftp_mmc_boot=dhcp ${loadaddr} ${bootfile}; run mmc_args; bootm ${loadaddr}</i></dd>
<dd><i>optargs=quiet lpj=3590144</i></dd></dl></li></ul></li></ul>
<dl><dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />The above modifications set the quiet option to reduce kernel printing, pre-set the loops per jiffie value to avoid needing to calculate this again, and most importantly removed the NFS settings including the ip_method setting.  This means that the kernel will not request an IP while booting, but the file system can request the IP during start up AFTER our splash screen has started</div></dd></dl></li>
<li>Un-mount the SD card and reboot the board
<ul><li><b>umount mmc1</b></li>
<li><b>init 6</b></li></ul></li>
<li>This time you should notice that there was very little output once the kernel was booting. You also did not have the delay associated with obtaining and IP address in the kernel.</li></ol>
<h1><span class="mw-headline" id="Writing_the_Linux_Kernel_to_SD">Writing the Linux Kernel to SD</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=37" title="Edit section: Writing the Linux Kernel to SD">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h3><span class="mw-headline" id="Description_9">Description</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=38" title="Edit section: Description">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>This section will cover how to place the Linux kernel on the SD card and configure u-boot to read the kernel from the FAT partition on the SD card. This will allow us to stop downloading the kernel over the ethernet connection, which is a time consuming operation and instead load the kernel from the SD device which should be faster. 
</p>
<div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />The current u-boot implementation for NAND is not optimized and yields a slow kernel read (about 1MB/s).  This is not what you would want for a fast boot so instead an SD card is used which has a high speed driver available.  There are instructions for flashing the kernel to NAND at the end of this lab as an information item</div> 
<h3><span class="mw-headline" id="Key_Points_9">Key Points</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=39" title="Edit section: Key Points">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ul><li>How to write the kernel to SD</li>
<li>Changing u-boot settings to boot the kernel from SD</li></ul>
<h3><span class="mw-headline" id="Lab_Steps_9">Lab Steps</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=40" title="Edit section: Lab Steps">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ol><li>Assuming the system is booted login using <b>root</b></li>
<li>Download the kernel image to your local file system. You can find the serverip to use by running the <b>ifconfig</b> command on your host.
<ul><li><b>tftp -g -r uImage-am335x-evm.bin &lt;serverip&gt;</b></li></ul>
<dl><dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />The serverip used is the same as the one used in your uEnv.txt file</div></dd></dl></li>
<li>Mount the SD card
<ul><li><b>mount /dev/mmcblk0p1 /media/mmc1</b></li></ul></li>
<li>Copy the downloaded <b>uImage-am335x-evm.bin</b> to the SD card as <b>uImage</b>
<ul><li><b>cp uImage-am335x-evm.bin /media/mmc1/uImage</b></li></ul>
<dl><dd><div style="margin: 5px; padding: 5px 10px; background-color: #ffffec; border-left: 5px solid #ff6600;"><b>IMPORTANT</b><br /><br />The kernel image should be named uImage because this is the default name that u-boot will look to load from the SD card boot partition</div></dd></dl>
<ul><li><b>vi /media/mmc1/uEnv.txt</b> and make the following changes
<ul><li>Remove these lines
<dl><dd><b>serverip=xxxx</b> This is not needed because we will not be booting from tftp</dd>
<dd><b>bootfile=xxxx</b> Again, we will not be booting from tftp so this is not required</dd>
<dd><b>tftp_mmc_boot</b> Since we are now going to boot the kernel from the SD card and use the file system from SD card we can now use the built in u-boot defaults</dd></dl></li>
<li>Modify the uenvcmd line to look like
<dl><dd><b>uenvcmd=run mmc_boot</b></dd></dl></li>
<li>The resulting file should look like:
<dl><dd><i>uenvcmd=run mmc_boot</i></dd>
<dd><i>optargs=quiet lpj=3590144</i></dd></dl></li></ul></li></ul>
<dl><dd><div style="margin: 5px; padding: 5px 10px; background-color: #ffffec; border-left: 5px solid #ff6600;"><b>IMPORTANT</b><br /><br />There is a subtle optimization here that will save you over a second.  Using the built in defaults for <b>mmc_boot</b> the board is now set to read the uImage from the SD card to the address <b>kloadaddr</b>.  This address is configured such that the image is written into DDR at the proper kernel start location.  This means that the kernel does not need to be relocated from one place in DDR to another which saves about 1.4 seconds as we identified in the labs above</div></dd></dl></li>
<li>Un-mount the SD card and reboot your board using the following commands
<ul><li><b>umount /media/mmc1</b></li>
<li><b>init 6</b></li></ul></li>
<li>You should now see the device boot reading the kernel from the SD card
<dl><dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />You should no longer see the #'s that marked the tftp of the kernel which is a good sign it is being read from elsewhere</div></dd></dl></li></ol>
<h1><span id="Optimizing_the_U-Boot/SPL"></span><span class="mw-headline" id="Optimizing_the_U-Boot.2FSPL">Optimizing the U-Boot/SPL</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=41" title="Edit section: Optimizing the U-Boot/SPL">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h3><span class="mw-headline" id="Description_10">Description</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=42" title="Edit section: Description">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>This section is going to cover making some of the optimizations that were identified previously. Some of these optimizations were already done by modifying where the kernel is loaded from and how it is booted. The rest of these optimization will be done my modifying the actual u-boot sources and configuration for the desired result. 
</p><p><br /> 
</p>
<h3><span class="mw-headline" id="Key_Points_10">Key Points</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=43" title="Edit section: Key Points">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ul><li>Disabling the NAND environment check</li>
<li>Removing image verification</li>
<li>Programming default U-boot environment</li>
<li>Changing default boot command</li>
<li>Reducing the boot delay</li>
<li>Disabling ethernet intialization</li></ul>
<h3><span class="mw-headline" id="Lab_Steps_10">Lab Steps</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=44" title="Edit section: Lab Steps">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ol><li>The following steps will walk through modifying the u-boot sources to optimize your boot time. On you <i>Linux Host</i> go to the u-boot board-port tree
<ul><li><b>cd /home/sitara/board-port/sitara-board-port-uboot</b></li></ul></li>
<li>This step will modify the <b>include/configs/am335x_evm.h</b> to Disable the NAND environment check. This step was identified as taking about 0.764 seconds of boot time. Since we are going to modify the default boot arguments anyway there is no need for the NAND environment to be saved.
<ul><li><b>gedit include/configs/am335x_evm.h</b>
<ul><li>Search for the following lines (You can use <b>ctrl+F</b> to do a search in gedit):
<dl><dd><i>/* NAND support */</i></dd>
<dd><i>#ifdef CONFIG_NAND</i></dd>
<dd><i>#define CONFIG_CMD_NAND</i></dd></dl></li>
<li>Just above these lines add the following lines:
<dl><dd><i>#undef CONFIG_NAND_ENV</i></dd>
<dd><i>#define CONFIG_ENV_IS_NOWHERE</i></dd></dl></li>
<li>Your file should now look like:
<dl><dd><i>#undef CONFIG_NAND_ENV</i></dd>
<dd><i>#define CONFIG_ENV_IS_NOWHERE</i></dd>
<dd><br /></dd>
<dd><i>/* NAND support */</i></dd>
<dd><i>#ifdef CONFIG_NAND</i></dd>
<dd><i>#define CONFIG_CMD_NAND</i></dd></dl></li></ul></li></ul>
<dl><dd><div style="margin: 5px; padding: 5px 10px; background-color: #ffffec; border-left: 5px solid #ff6600;"><b>IMPORTANT</b><br /><br />Adding this optimization will currently break reading Linux kernel images from NAND in u-boot.  The system needs to do the configuration of the NAND for the environment to be ready to read the images such as the Linux kernel.  This will be addresses in the future.</div></dd>
<dd><div style="margin: 5px; padding: 5px 10px; background-color: #ffffec; border-left: 5px solid #ff6600;"><b>IMPORTANT</b><br /><br />The lines added were placed in the file near the NAND support structure for convenience.  The effect is to unset the U-boot environment being saved in NAND.  It is also important to tell u-boot that since the environment is not in NAND that it is located NOWHERE</div></dd></dl></li>
<li>This next modification will disable the network driver initialization in u-boot. Since we are no transferring the kernel over tftp this is the remainder of the networking boot impact left to be removed.
<dl><dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />This does not prevent the kernel or file system from starting the network later</div></dd></dl>
<ul><li>Search for the following line
<dl><dd><i># define CONFIG_DRIVER_TI_CPSW</i></dd></dl></li>
<li>Remove that line from the configuration file</li></ul></li>
<li>Next we are going to turn off the image verification. As mentioned in the steps identifying the optimizations, the image verify takes about a second and since we don't do anything with a failed image we will not bother to verify it.
<ul><li>Search for the following lines:
<dl><dd><i>#define CONFIG_EXTRA_ENV_SETTINGS \</i>
<dl><dd><i>"bootfile=uImage\0" \</i></dd>
<dd><i>"loadaddr=0x82000000\0" \</i></dd></dl></dd></dl></li>
<li>Add the following line after bootfile=uImage
<dl><dd><dl><dd><i>"verify=n\0" \</i></dd></dl></dd>
<dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />This line can be added anywhere in the CONFIG_EXTRA_ENV_SETTINGS variable, the location picked here was arbitrary.</div></dd></dl></li></ul></li>
<li>The next modification to the default U-boot environment will allow us to no longer depend on the uEnv.txt file for setting parameters. This means we will be able to stop doing the read of that file from the SD card.
<ul><li>Search for the following line:
<dl><dd><dl><dd><i>"optargs=\0" \</i></dd></dl></dd></dl></li>
<li>Modify this line to instead set:
<dl><dd><dl><dd><i>"optargs=quiet lpj=3590144\0" \</i></dd></dl></dd></dl></li></ul></li>
<li>Now we will configure BOOTDELAY to remove the 3 seconds we are seeing during boot
<ul><li>Search for the following lines:
<dl><dd><i>#ifndef CONFIG_RESTORE_FLASH</i></dd>
<dd><i>/* set to negative value for no autoboot */</i></dd>
<dd><i>#define CONFIG_BOOTDELAY 3</i></dd></dl></li>
<li>Change the CONFIG_BOOTDELAY line to:
<dl><dd><i>#define CONFIG_BOOTDELAY 1</i></dd></dl></li></ul>
<dl><dd><div style="margin: 5px; padding: 5px 10px; background-color: #ffffec; border-left: 5px solid #ff6600;"><b>IMPORTANT</b><br /><br />There are two definitions of CONFIG_BOOTDELAY in the default configuration file.  This is because for flashing/restore operations we want no boot delay and to use a different boot command.  This is why the <b>#ifndef CONFIG_RESTORE_FLASH</b> flag is used to wrap the CONFIG_BOOTDELAY and CONFIG_BOOTCOMMAND variables</div></dd>
<dd><div style="margin: 5px; padding: 5px 10px; background-color: #ffffec; border-left: 5px solid #ff6600;"><b>IMPORTANT</b><br /><br />You may be asking why we set the CONFIG_BOOTDELAY to 1 instead of 0.  This is because if we make any mistakes we still have a change to interrupt u-boot and interact with the system.  So for this lab we will end up taking the boot time and subtracting 1 second.  In your production environment once you are happy with the system you would likely change this to a 0 to remove that one second boot time impact</div></dd></dl></li>
<li>Lastly we will define the custom boot command so that we do not need to use the uEnv.txt file anymore
<ul><li>Search for the following lines
<dl><dd><i>#define CONFIG_BOOTCOMMAND \</i>
<dl><dd><i>"if mmc rescan; then " \</i>
<dl><dd><i>"echo SD/MMC found on device ${mmc_dev};" \</i></dd></dl></dd></dl></dd></dl></li>
<li>This whole indented block of code is one long string for the CONFIG_BOOTCOMMAND variable. Delete this entire string and replace it with the following lines:
<dl><dd><i>#define CONFIG_BOOTCOMMAND \</i>
<dl><dd><i>"mmc rescan; run mmc_boot"</i></dd></dl></dd>
<dd><div style="margin: 5px; padding: 5px 10px; background-color: #ffffec; border-left: 5px solid #ff6600;"><b>IMPORTANT</b><br /><br />We had to add the <b>mmc rescan</b> to the boot command here because the rescan had not happened before.  In the uEnv.txt file the rescan had already happened because of the default boot command and we did not need to perform the rescan a second time</div></dd></dl></li>
<li>You final code should look like:
<dl><dd><i>/* set to negative value for no autoboot */</i></dd>
<dd><i>#define CONFIG_BOOTDELAY 1</i></dd>
<dd><br /></dd>
<dd><i>#define CONFIG_BOOTCOMMAND \</i>
<dl><dd><i>"mmc rescan; run mmc_boot"</i></dd></dl></dd></dl></li></ul></li>
<li>You can now <b>save</b> your file and exit gedit</li>
<li>Use the following commands to configure and compile a new <b>u-boot.img</b> and <b>MLO</b> image
<ul><li><b>make ARCH=arm CROSS_COMPILE=/home/sitara/ti-sdk-am335x-evm-&lt;sdk version&gt;/linux-devkit/bin/arm-arago-linux-gnueabi- am335x_evm_config</b>
<dl><dd><div style="margin: 5px; padding: 5px 10px; background-color: #ffffec; border-left: 5px solid #ff6600;"><b>IMPORTANT</b><br /><br />There is a space between arm-arago-linux-gnueabi- and am335x_evm_config</div></dd></dl></li>
<li><b>make ARCH=arm CROSS_COMPILE=/home/sitara/ti-sdk-am335x-evm-&lt;sdk version&gt;/linux-devkit/bin/arm-arago-linux-gnueabi-</b></li></ul></li>
<li>When the build finishes you should now have a new <b>MLO</b> and <b>u-boot.img</b> file in the <b>/home/sitara/board-port/sitara-board-port-uboot/</b> directory.</li>
<li>For the next steps you should go ahead and copy these files to the <b>/tftpboot</b> directory so they can be downloaded to the target device.
<ul><li><b>cp MLO /tftpboot/MLO-optimized</b></li>
<li><b>cp u-boot.img /tftpboot/u-boot-optimized</b></li></ul></li></ol>
<h1><span id="Writing_the_U-Boot/SPL_to_SD"></span><span class="mw-headline" id="Writing_the_U-Boot.2FSPL_to_SD">Writing the U-Boot/SPL to SD</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=45" title="Edit section: Writing the U-Boot/SPL to SD">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h3><span class="mw-headline" id="Description_11">Description</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=46" title="Edit section: Description">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>This section will cover transferring the new MLO and u-boot.img that you created to the SD card 
</p><p><br /> 
</p>
<h3><span class="mw-headline" id="Key_Points_11">Key Points</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=47" title="Edit section: Key Points">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ul><li>How to tftp the images to the target file system</li>
<li>Using the target file system to access the SD card</li></ul>
<p><br /> 
</p>
<h3><span class="mw-headline" id="Lab_Steps_11">Lab Steps</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=48" title="Edit section: Lab Steps">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ol><li>Your target board should be booted and you should login as <b>root</b></li>
<li>TFTP you optimized boot loader files. Remember that you can get the TFTP server address by using the <b>ifconfig</b> command on your Linux host.
<ul><li><b>tftp -g -r MLO-optimized &lt;server ip&gt;</b></li>
<li><b>tftp -g -r u-boot-optimized &lt;server ip&gt;</b></li></ul></li>
<li>Mount the boot partition of the SD card
<ul><li><b>mount /dev/mmcblk0p1 /media/mmc1</b></li></ul></li>
<li>Copy the new boot loader files to the boot partition of the SD card.
<ul><li><b>cp MLO-optimized /media/mmc1/MLO</b></li>
<li><b>cp u-boot-optimized /media/mmc1/u-boot.img</b></li></ul></li>
<li>Unmount the boot partition
<ul><li><b>umount /media/mmc1</b></li></ul></li>
<li>Reboot the board
<ul><li><b>init 6</b></li></ul></li>
<li>On this boot you should have noticed that the boot delay went down to only 1 second, that the network was not initialized, that the uEnv.txt file was not being read from the SD card, and that the kernel image verify was disabled.</li></ol>
<h1><span class="mw-headline" id="Measuring_the_Final_Boot_Time">Measuring the Final Boot Time</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=49" title="Edit section: Measuring the Final Boot Time">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h3><span class="mw-headline" id="Description_12">Description</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=50" title="Edit section: Description">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>In this lab we will re-run the tstamp program and observe the change in boot time to get to an initial splash screen 
</p>
<h3><span class="mw-headline" id="Key_Points_12">Key Points</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=51" title="Edit section: Key Points">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ul><li>Measuring the changed boot time</li>
<li>Observing the touch event being processed</li></ul>
<h3><span class="mw-headline" id="Lab_Steps_12">Lab Steps</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=52" title="Edit section: Lab Steps">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ol><li>Assuming the target board is booted login as <b>root</b></li>
<li>Shutdown the target board so that the root file system is cleanly un-mounted and the target is ready for a reset
<ul><li><b>init 0</b></li></ul></li>
<li>Once you see the following message your board is shutdown
<ul><li><b>[ xxx.xxxxxx] System halted.'</b></li></ul></li>
<li>Exit your minicom terminal using the following key commands
<ul><li><b>Ctlr+A</b></li>
<li><b>z</b></li>
<li><b>x</b></li>
<li><b>Select Yes to exit minicom</b></li></ul></li>
<li>Make sure your serial port is properly configured using the stty command
<ul><li><b>stty -F /dev/ttyUSB1 115200 </b></li></ul></li>
<li>You can now use the tstamp program to measure boot times. To do this use the command
<ul><li><b>cat /dev/ttyUSB1 | tstamp </b></li></ul></li>
<li>Press the <b>Reset</b> button on the top-right corner of the LCD cape and let the system boot</li>
<li>Look for the message we printed when we started the splash screen. You should see output like:
<dl><dd><a href="File_Sitara-linux-training-final-boot.html" class="image"><img alt="Sitara-linux-training-final-boot.png" src="https://processors.wiki.ti.com/images/c/cd/Sitara-linux-training-final-boot.png" width="643" height="408" /></a></dd>
<dd><div style="margin: 5px; padding: 5px 10px; background-color: #ffffec; border-left: 5px solid #ff6600;"><b>IMPORTANT</b><br /><br />Why is the boot time 3.736 seconds?  Weren't we trying to get under 3 seconds?  Remember that we left a second delay in u-boot to allow us to get to a u-boot prompt in case something went wrong.  if you scroll back in the boot history you will see that second delay is still there.  So if you delete 1 second from the boot time the total time is <big><b>2.736 Seconds</b></big>, so we actually beat our goal.</div></dd></dl></li>
<li>Go ahead and touch the touchscreen. You should see the panel go blank.</li>
<li>Congratulations, you have managed to create a system that can boot in under 3 seconds.</li>
<li>In su</li></ol>
<h1><span class="mw-headline" id="Further_Notes">Further Notes</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=53" title="Edit section: Further Notes">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<ul><li>In this lab we still left the OneNAND driver in the Linux kernel to enable NAND support. If you are booting completely from SD card you could also remove this driver from the Linux kernel configuration.
<dl><dd><a href="File_Sitara-linux-training-one-nand.html" class="image"><img alt="Sitara-linux-training-one-nand.png" src="https://processors.wiki.ti.com/images/2/23/Sitara-linux-training-one-nand.png" width="644" height="390" /></a></dd></dl>
<ul><li>Impact: About 0.212 seconds</li>
<li>Removable?: Yes, if you do not plan on using NAND in Linux both as a root file system or for additional persistent storage.</li>
<li>Difficulty: Medium. You would need to re-configure to disable the <b>Device Drivers -&gt; Memory Technology Device (MTD) support -&gt; OneNAND Device Support</b> option and re-compile the kernel.</li></ul></li>
<li>There is currently work going on in the U-Boot community to allow the SPL image to directly boot the Linux kernel without loading U-Boot first. This support is not available today but in the future may enable saving another ~1.2 seconds during boot.</li></ul>
<h1><span class="mw-headline" id="Additional_Methods">Additional Methods</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=54" title="Edit section: Additional Methods">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>These methods can be used in place of the SD card methods above to flash the components to the NAND rather than to the SD card. In this lab the SD card was chosen because it has good throughput, particularly in u-boot in the which the NAND performance is not currently optimized. It is also worth noting that it takes about .5 seconds to scan and mount a 32MB UBI/UBIFS NAND volume. UBI is faster than JFFS2 but it scales linearly (see <a rel="nofollow" class="external text" href="http://www.linux-mtd.infradead.org/doc/ubi.html#L_scalability">http://www.linux-mtd.infradead.org/doc/ubi.html#L_scalability</a>). This is in part because unlike in an MMC/SD card we are the controller and are responsible for scanning the NAND, etc rather than relying on another controller to do this in parallel like what you see with a MMC/SD card which is a Flash Translation Layer device. 
</p><p>Still, for completeness these steps were added here to provide a reference for how to perform this lab with different media. 
</p>
<div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />The performance of SD cards can vary depending on the card.  You should test multiple cards and find the one with the best performance.  This lab used the card that shipped with the EVM</div> 
<p><br /> 
</p>
<h2><span class="mw-headline" id="Flashing_the_File_System_to_NAND_with_UBIFS">Flashing the File System to NAND with UBIFS</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=55" title="Edit section: Flashing the File System to NAND with UBIFS">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h3><span class="mw-headline" id="Description_13">Description</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=56" title="Edit section: Description">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Now that we have finished optimizing the root file system for this lab we can go ahead and write the file system to the NAND partition reserved for the file system. 
</p>
<h3><span class="mw-headline" id="Key_Points_13">Key Points</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=57" title="Edit section: Key Points">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ul><li>How to make a tarball of an existing NFS file system</li>
<li>How to mount a NAND partition as a UBIFS file system</li>
<li>Copying file to UBIFS</li>
<li>Modifying the bootargs to boot using the root file system in UBIFS</li>
<li>Additional information for creating UBIFS images and other methods for doing so can be found at:
<ul><li><a rel="nofollow" class="external text" href="UBIFS_Support.html">http://processors.wiki.ti.com/index.php/UBIFS_Support</a></li>
<li><a rel="nofollow" class="external text" href="http://www.sakoman.com/OMAP/how-to-write-an-ubifs-rootfs-image-to-nand.html">http://www.sakoman.com/OMAP/how-to-write-an-ubifs-rootfs-image-to-nand.html</a></li></ul></li></ul>
<h3><span class="mw-headline" id="Lab_Steps_13">Lab Steps</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=58" title="Edit section: Lab Steps">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ol><li>The first step is to make a tarball of our existing NFS image. Shutdown the board using <b>init 0</b> and use the following commands on the <b>Linux Host</b> to make a file system tarball
<ul><li><b>cd /home/sitara/&lt;SDK install dir&gt;/targetNFS</b></li>
<li><b>sudo tar czf ../base-file-system.tar.gz *</b></li></ul>
<dl><dd><div style="margin: 5px; padding: 5px 10px; background-color: #ffffec; border-left: 5px solid #ff6600;"><b>IMPORTANT</b><br /><br />The above command will make a file system tarball that extracts into the current directory.  The ../ is used so that the tarball being created is NOT picked up as part of the tar process</div></dd></dl></li>
<li>Now copy the <b>base-file-system.tar.gz</b> tarball back into the NFS file system so it will be available on the target
<ul><li><b>sudo cp ../base-file-system.tar.gz .</b></li></ul></li>
<li>Reset the target board. Once the board has booted, on the target console login using <b>root</b></li>
<li>If you scroll back in the kernel boot messages you will see the partition definitions the kernel is using for the NAND. In this case the output should look like the output below which shows that the File System partition is the last partition. Since the numbering is zero based this would make this partition <b>7</b>. Remember this for the next steps.
<dl><dd>[ x.xxxxxx] 0x000000000000-0x000000020000&#160;: "SPL"</dd>
<dd>[ x.xxxxxx] 0x000000020000-0x000000040000&#160;: "SPL.backup1"</dd>
<dd>[ x.xxxxxx] 0x000000040000-0x000000060000&#160;: "SPL.backup2"</dd>
<dd>[ x.xxxxxx] 0x000000060000-0x000000080000&#160;: "SPL.backup3"</dd>
<dd>[ x.xxxxxx] 0x000000080000-0x000000260000&#160;: "U-Boot"</dd>
<dd>[ x.xxxxxx] 0x000000260000-0x000000280000&#160;: "U-Boot Env"</dd>
<dd>[ x.xxxxxx] 0x000000280000-0x000000780000&#160;: "Kernel"</dd>
<dd>[ x.xxxxxx] 0x000000780000-0x000002780000&#160;: "File System"</dd>
<dd>[ x.xxxxxx] 0x000002780000-0x000002960000&#160;: "U-Boot.backup"</dd>
<dd>[ x.xxxxxx] 0x000002960000-0x000002e60000&#160;: "Kernel.backup"</dd>
<dd>[ x.xxxxxx] 0x000002e60000-0x000020000000&#160;: "Extended File System"</dd></dl></li>
<li>First we will erase the flash partition
<ul><li><b>flash_erase /dev/mtd7 0 0</b></li></ul>
<dl><dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />You may see some bad block messages or messages saying some blocks could not be erased.  This is OK</div></dd></dl></li>
<li>Next we will format the UBI mtd device for UBIFS with a sub page size of 512
<ul><li><b>ubiformat /dev/mtd7 -s 512 -O 2048</b></li></ul>
<dl><dd><div style="margin: 5px; padding: 5px 10px; background-color: #ffffec; border-left: 5px solid #ff6600;"><b>IMPORTANT</b><br /><br />Since we specify an sub page size of 512 which is used for writing erase blocks we need to specify the VID header offset (using the -O option) as 2048 to make sure it is in the next erase block and now in the first erase block</div></dd></dl></li>
<li>Next we tell UBI that we are going to be working with mtd device 7 using <b>ubiattach</b>
<ul><li><b>ubiattach /dev/ubi_ctrl -m 7 -O 2048</b></li></ul>
<dl><dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />Specifying /dev/ubi_ctrl is not strictly necessary as this is the default but is used here for safety sake.</div></dd>
<dd><div style="margin: 5px; padding: 5px 10px; background-color: #ffffec; border-left: 5px solid #ff6600;"><b>IMPORTANT</b><br /><br />The UBI device number is assigned automatically and will be used in the next step.  This is assigned starting from 0 and incrementing by 1.  So for the first UBI device this will be /dev/ubi0 and the second will be /dev/ubi1, and so forth.  You can find which ubi device this has been attached to in the first line of output from the <b>ubiattach</b> command</div></dd>
<dd><div style="margin: 5px; padding: 5px 10px; background-color: #ffffec; border-left: 5px solid #ff6600;"><b>IMPORTANT</b><br /><br />We use the -O 2048 option to match the location of the VID header given when we formatted the UBIFS</div></dd></dl></li>
<li>You may need to press <b>Enter</b> to return to a command prompt</li>
<li>Now we will create a UBIFS volume using <b>ubimkvol</b>
<ul><li><b>ubimkvol /dev/ubi0 -N rootfs -m'</b></li></ul>
<dl><dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />The above command makes a UBI volume on UBI device ubi0 with a label of <b>rootfs</b> and taking up the full size of the device</div></dd>
<dd><div style="margin: 5px; padding: 5px 10px; background-color: #ffffec; border-left: 5px solid #ff6600;"><b>IMPORTANT</b><br /><br />If you use a different label than <b>rootfs</b> you will also need to change the default u-boot environment to use this new label since it uses rootfs by default.</div></dd></dl></li>
<li>Now you will create a mount point for the UBIFS NAND file system and mount the file system
<ul><li><b>mkdir /mnt/nand</b></li>
<li><b>mount -t ubifs ubi0:rootfs /mnt/nand</b></li></ul>
<dl><dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />You may see some read errors during the mount operation.  These can be ignored</div></dd></dl></li>
<li>You may need to press <b>Enter</b> to return to a command prompt</li>
<li>Now cd to the mounted file system and extract the rootfs tarball into the UBIFS mount.
<ul><li><b>cd /mnt/nand</b></li>
<li><b>tar xzf /base-file-system.tar.gz</b></li></ul></li>
<li>Now you can unmount the file system and perform a sync operation to make sure everything is flushed to NAND
<ul><li><b>cd ..</b></li>
<li><b>umount nand</b></li>
<li><b>sync</b></li></ul></li>
<li>Now we will mount the SD card and modify the uEnv.txt so that we can boot this new NAND file system.
<ul><li><b>mkdir /mnt/mmc</b></li>
<li><b>mount /dev/mmc0blk0p1 /mnt/mmc</b></li>
<li><b>vi /mnt/mmc</b> and make the following changes
<ul><li>Add the following line:
<dl><dd>tftp_nand_boot=dhcp ${loadaddr} ${bootfile}; run nand_args; bootm ${loadaddr}</dd></dl></li>
<li>Change the uenvcmd to
<dl><dd>uenvcmd=tftp_nand_boot</dd></dl></li></ul></li></ul></li>
<li>Unmount the MMC device and reboot the board
<ul><li><b>umount mmc</b></li>
<li><b>init 6</b></li></ul></li>
<li>You should now see the board boot using the file system in the NAND flash. You can verify this using the <b>mount</b> command and looking for a line like:
<dl><dd><i>ubi0:rootfs on / type ubifs (rw,relatime)</i></dd></dl></li></ol>
<p><br /> 
</p>
<h2><span class="mw-headline" id="Flashing_the_Linux_Kernel_to_NAND">Flashing the Linux Kernel to NAND</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=59" title="Edit section: Flashing the Linux Kernel to NAND">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h3><span class="mw-headline" id="Description_14">Description</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=60" title="Edit section: Description">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>This section will cover how to place the Linux kernel into the NAND flash. This will allow us to stop downloading the kernel over the ethernet connection, which is a time consuming operation and instead load the kernel from the NAND device which should be faster. 
</p>
<h3><span class="mw-headline" id="Key_Points_14">Key Points</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=61" title="Edit section: Key Points">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ul><li>How to flash the kernel to NAND</li>
<li>Changing u-boot settings to reflect the actual image size</li>
<li>Copying and booting the kernel from NAND</li></ul>
<p><br /> 
</p>
<h3><span class="mw-headline" id="Lab_Steps_14">Lab Steps</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=62" title="Edit section: Lab Steps">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<h4><span class="mw-headline" id="From_Linux">From Linux</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=63" title="Edit section: From Linux">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<ol><li>Assuming the system is booted login using <b>root</b></li>
<li>Determine the <b>Kernel</b> flash partition.
<ul><li><b>cat /proc/mtd</b></li></ul>
<dl><dd>You should expect output like:
<dl><dd>mtd6: 00500000 00020000 "Kernel"</dd></dl></dd>
<dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />You will see the full list of the mtd partition when using doing <b>cat /proc/mtd</b> and can use the output to find the /dev/mtd device node corresponding to each partition</div></dd></dl></li>
<li>Erase the <b>Kernel</b> flash partition.
<ul><li><b>flash_erase /dev/mtd6 0 0</b></li></ul>
<dl><dd><div style="margin: 5px; padding: 5px 10px; background-color: #ffffec; border-left: 5px solid #ff6600;"><b>IMPORTANT</b><br /><br />The device node to erase was based on the mtd device found for the "Kernel" partition in the /proc/mtd output</div></dd></dl></li>
<li>Download the kernel image to your local file system. You can find the serverip to use by running the <b>ifconfig</b> command on your host.
<ul><li><b>tftp -g -r uImage-am335x-evm.bin &lt;serverip&gt;</b></li></ul>
<dl><dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />The serverip used is the same as the one used in your uEnv.txt file</div></dd></dl></li>
<li>Write the kernel image using the following command
<ul><li><b>nandwrite -p /dev/mtd6 uImage-am335x-evm.bin</b></li></ul>
<dl><dd><div style="margin: 5px; padding: 5px 10px; background-color: #ffffec; border-left: 5px solid #ff6600;"><b>IMPORTANT</b><br /><br />You need to use the -p option to pad the kernel image to a full page size or else you will see write errors</div></dd></dl></li>
<li>The result of the write operation is that the last line will tell you the offset of the last page written. i.e.:
<dl><dd><i>Writing data to block 24 at offset 0x300000</i></dd></dl></li>
<li>If you take this last offset and add one page size (0x20000) you will have the size of the kernel image that needs to be copied from NAND. In this case <b>0x320000</b>. Remember this number for the following steps.</li>
<li>In u-boot the default size of the kernel to load is 0x500000. We do not need to actually copy this much data from the NAND to the DDR so any extra data copy is actually a waste of time. So now you will update the uEnv.txt file to overwrite the default value with the <b>0x320000</b> value we found above.
<ul><li><b>mount /dev/mmcblk0p1 /media/mmc1</b></li>
<li><b>vi /media/mmc1/uEnv.txt</b> and make the following changes
<ul><li>Remove these lines
<dl><dd><b>serverip=xxxx</b> This is not needed because we will not be booting from tftp</dd>
<dd><b>bootfile=xxxx</b> Again, we will not be booting from tftp so this is not required</dd>
<dd><b>tftp_nand_boot</b> Since we are now going to boot the kernel from NAND and use the file system from NAND we can now use the built in u-boot defaults</dd></dl></li>
<li>Modify the uenvcmd line to look like
<dl><dd><b>uenvcmd=run nand_boot</b></dd></dl></li>
<li>Add the following line to change the size of the kernel loaded
<dl><dd><b>nand_img_siz=0x320000</b></dd></dl></li></ul></li></ul></li>
<li>Un-mount the SD card and reboot your board using the following commands
<ul><li><b>umount /media/mmc1</b></li>
<li><b>init 6</b></li></ul></li>
<li>You should now see the device boot reading the kernel from NAND
<dl><dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />You should no longer see the #'s that marked the tftp of the kernel which is a good sign it is being read from elsewhere</div></dd></dl></li></ol>
<h4><span class="mw-headline" id="From_U-Boot">From U-Boot</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=64" title="Edit section: From U-Boot">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<ol><li>Assuming the system is booted login using <b>root</b></li>
<li>Determine the <b>Kernel</b> flash partition.
<ul><li><b>cat /proc/mtd</b></li></ul>
<dl><dd>You should expect output like:
<dl><dd><i>mtd5: 00020000 00020000 "U-Boot Env"</i></dd>
<dd><b>mtd6: 00500000 00020000 "Kernel"</b></dd>
<dd><i>mtd7: 02000000 00020000 "File System"</i></dd></dl></dd>
<dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />You will see the full list of the mtd partition when using doing <b>cat /proc/mtd</b> and can use the output to find the /dev/mtd device node corresponding to each partition</div></dd></dl></li>
<li>Make note of the offset and size for the kernel partition. In this case that is:
<ul><li><b>OFFSET: 0x280000</b></li>
<li><b>SIZE: 0x500000</b></li></ul>
<dl><dd><div style="margin: 5px; padding: 5px 10px; background-color: #ffffec; border-left: 5px solid #ff6600;"><b>IMPORTANT</b><br /><br />The OFFSET can be found by either adding up the size of all the mtd devices before the kernel, or if you scroll back in your kernel boot history (You can use the <b>dmesg</b> command to see the kernel boot log even with the <b>quiet</b> option set) you will see a line like<br /><br /><b>0x000000280000-0x000000780000&#160;: "Kernel"</b><br /><br />This line is in the format &lt;start of partition (offset)&gt; - &lt;end of partition&gt; which means you could use this to get both the partition, and with some simple math the size as well.</div></dd></dl></li>
<li>Reboot the board and stop the auto boot by pressing any key when prompted
<ul><li><b>init 6</b></li></ul></li>
<li>Set the NAND ECC mode to match the Linux kernel which is BCH8
<ul><li><b>nandecc hw 2</b></li></ul></li>
<li>Erase the <b>Kernel</b> flash partition.
<ul><li><b>nand erase 0x280000 0x500000</b></li></ul></li>
<li>Download the kernel image to DDR. You can find the serverip to use by running the <b>ifconfig</b> command on your host.
<ul><li><b>mw.b ${loadaddr} 0xFF 0x500000</b></li></ul>
<dl><dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />This command will write all 1's to the memory address where we are going to transfer the kernel image.  This is a nice to do not a strict requirement</div></dd></dl>
<ul><li><b>setenv serverip &lt;your server ip&gt;</b></li>
<li><b>setenv autoload n</b></li>
<li><b>dhcp</b></li>
<li><b>tftp ${loadaddr} uImage-am335x-evm.bin</b></li></ul>
<dl><dd><div style="margin: 5px; padding: 5px 10px; background-color: #ffffec; border-left: 5px solid #ff6600;"><b>IMPORTANT</b><br /><br />The kernel image is downloaded to the address stored in <b>loadaddr</b>.  In this case that is 0x82000000 but you can always look for the <b>Load address</b> in the tftp output</div></dd>
<dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />The serverip used is the same as the one used in your uEnv.txt file</div></dd></dl></li>
<li>Make a note of the actual kernel image size shown as the last line out output. i.e.
<dl><dd><b>Bytes transferred = 3154760 (302348 hex)</b></dd></dl></li>
<li>Write the kernel image using the following command
<ul><li><b>nand write ${loadaddr} 0x280000 0x500000</b></li></ul>
<dl><dd><div style="margin: 5px; padding: 5px 10px; background-color: #ffffec; border-left: 5px solid #ff6600;"><b>IMPORTANT</b><br /><br />For help with the various nand command you can just type <b>nand</b> on the u-boot prompt and you will be given the help output for the nand system</div></dd></dl></li>
<li>Using the tftp transfer size from above you can find the size of the kernel image that needs to be copied from NAND by rounding it to the next erase size (0x20000). In this case <b>0x320000</b>. Remember this number for the following steps.
<dl><dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />You can find the erase size using the <b>nand info</b> command and looking for the <b>sector size</b></div></dd></dl></li>
<li>In u-boot the default size of the kernel to load is 0x500000. We do not need to actually copy this much data from the NAND to the DDR so any extra data copy is actually a waste of time. So now you will update the uEnv.txt file to overwrite the default value with the <b>0x320000</b> value we found above. To do this boot your board using the following commands and modify the uEnv.txt (remember that we are using the target board as our SD card reader as well for this lab)
<ul><li><b>boot</b></li>
<li>Once the target boots login as <b>root</b></li>
<li><b>mount /dev/mmcblk0p1 /media/mmc1</b></li>
<li><b>vi /media/mmc1/uEnv.txt</b> and make the following changes
<ul><li>Remove these lines
<dl><dd><b>serverip=xxxx</b> This is not needed because we will not be booting from tftp</dd>
<dd><b>bootfile=xxxx</b> Again, we will not be booting from tftp so this is not required</dd>
<dd><b>tftp_nand_boot</b> Since we are now going to boot the kernel from NAND and use the file system from NAND we can now use the built in u-boot defaults</dd></dl></li>
<li>Modify the uenvcmd line to look like
<dl><dd><b>uenvcmd=run nand_boot</b></dd></dl></li>
<li>Add the following line to change the size of the kernel loaded
<dl><dd><b>nand_img_siz=0x320000</b> This is the value you found above</dd></dl></li></ul></li></ul></li>
<li>Un-mount the SD card and reboot your board using the following commands
<ul><li><b>umount /media/mmc1</b></li>
<li><b>init 6</b></li></ul></li>
<li>You should now see the device boot reading the kernel from NAND
<dl><dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />You should no longer see the #'s that marked the tftp of the kernel which is a good sign it is being read from elsewhere</div></dd></dl></li></ol>
<h2><span id="Flashing_the_U-Boot/SPL_to_NAND"></span><span class="mw-headline" id="Flashing_the_U-Boot.2FSPL_to_NAND">Flashing the U-Boot/SPL to NAND</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=65" title="Edit section: Flashing the U-Boot/SPL to NAND">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h3><span class="mw-headline" id="Description_15">Description</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=66" title="Edit section: Description">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>This section will cover how to place the boot loaders into the NAND flash. This will allow us get rid of the SD card altogether. 
</p>
<h3><span class="mw-headline" id="Key_Points_15">Key Points</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=67" title="Edit section: Key Points">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ul><li>How to flash the boot loaders to NAND</li></ul>
<h3><span class="mw-headline" id="Lab_Steps_15">Lab Steps</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=68" title="Edit section: Lab Steps">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<h4><span class="mw-headline" id="From_Linux_2">From Linux</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=69" title="Edit section: From Linux">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<ol><li>Assuming the system is booted login using <b>root</b></li>
<li>As with the Linux kernel you will need to determine the boot loader flash partition. In this case there are two, the <b>SPL</b> and <b>U-Boot</b> partitions
<ul><li><b>cat /proc/mtd</b></li></ul>
<dl><dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />You may wonder why there are multiple partitions for the SPL.  This is because the ROM boot loader will try looking into the first 4 sectors on the flash to find a valid SPL image in case the first sector is bad</div></dd>
<dd>You should expect output like:
<dl><dd><b>mtd0: 00020000 00020000 "SPL"</b></dd>
<dd>mtd0: 00020000 00020000 "SPL.backup1"</dd>
<dd>mtd0: 00020000 00020000 "SPL.backup2"</dd>
<dd>mtd0: 00020000 00020000 "SPL.backup3"</dd>
<dd><b>mtd0: 001e0000 00020000 "U-Boot"</b></dd></dl></dd>
<dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />You will see the full list of the mtd partition when using doing <b>cat /proc/mtd</b> and can use the output to find the /dev/mtd device node corresponding to each partition</div></dd></dl></li>
<li>Erase the <b>SPL</b> and <b>U-Boot</b> flash partitions.
<ul><li><b>flash_erase /dev/mtd0 0 0</b></li>
<li><b>flash_erase /dev/mtd4 0 0</b></li></ul>
<dl><dd><div style="margin: 5px; padding: 5px 10px; background-color: #ffffec; border-left: 5px solid #ff6600;"><b>IMPORTANT</b><br /><br />The device node to erase was based on the mtd device found for the "SPL" and "U-Boot" partitions in the /proc/mtd output</div></dd></dl></li>
<li>Download the SPL and U-Boot images to your local file system. You can find the serverip to use by running the <b>ifconfig</b> command on your host.
<ul><li><b>tftp -g -r MLO-optimized &lt;serverip&gt;</b></li>
<li><b>tftp -g -r u-boot-optimized &lt;serverip&gt;</b></li></ul>
<dl><dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />The serverip used is the same as the one used in your uEnv.txt file</div></dd></dl></li>
<li>Write the SPL and U-Boot images using the following commands
<ul><li><b>nandwrite -p /dev/mtd0 MLO-optimized</b></li>
<li><b>nandwrite -p /dev/mtd4 u-boot-optimized</b></li></ul>
<dl><dd><div style="margin: 5px; padding: 5px 10px; background-color: #ffffec; border-left: 5px solid #ff6600;"><b>IMPORTANT</b><br /><br />You need to use the -p option to pad the kernel image to a full page size or else you will see write errors</div></dd></dl></li>
<li>The beaglebone with the 16bit NAND cape is already configured to try to boot from NAND first. So all you need to do now is reboot your board using:
<ul><li><b>init 6</b></li></ul></li>
<li>You should now see the device boot reading the u-boot.img from NAND instead of SD. You should notice that the MMC initialization that was happening before the u-boot.img read is no longer being done because you are now booted from NAND.</li></ol>
<h4><span class="mw-headline" id="From_U-Boot_2">From U-Boot</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;section=70" title="Edit section: From U-Boot">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<ol><li>Assuming the system is booted login using <b>root</b></li>
<li>Determine the <b>SPL</b> and <b>U-Boot</b> flash partitions.
<ul><li><b>cat /proc/mtd</b></li></ul>
<dl><dd>You should expect output like:
<dl><dd><b>mtd0: 00020000 00020000 "SPL"</b></dd>
<dd>mtd0: 00020000 00020000 "SPL.backup1"</dd>
<dd>mtd0: 00020000 00020000 "SPL.backup2"</dd>
<dd>mtd0: 00020000 00020000 "SPL.backup3"</dd>
<dd><b>mtd0: 001e0000 00020000 "U-Boot"</b></dd></dl></dd>
<dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />You will see the full list of the mtd partition when using doing <b>cat /proc/mtd</b> and can use the output to find the /dev/mtd device node corresponding to each partition</div></dd></dl></li>
<li>Make note of the offset and size for the SPL and U-Boot partitions. In this case they are:
<ul><li>SPL:
<ul><li><b>OFFSET: 0x0</b></li>
<li><b>SIZE: 0x20000</b></li></ul></li>
<li>U-Boot:
<ul><li><b>OFFSET: 0x80000</b></li>
<li><b>SIZE: 0x1e0000</b></li></ul></li></ul>
<dl><dd><div style="margin: 5px; padding: 5px 10px; background-color: #ffffec; border-left: 5px solid #ff6600;"><b>IMPORTANT</b><br /><br />The OFFSET can be found by either adding up the size of all the mtd devices before the partition you are interested in, or if you scroll back in your kernel boot history (You can use the <b>dmesg</b> command to see the kernel boot log even with the <b>quiet</b> option set) you will see lines like<br /><br /><b>0x000000000000-0x000000020000&#160;: "SPL"</b><br /><b>0x000000080000-0x000000260000&#160;: "U-Boot"</b><br /><br />This line is in the format &lt;start of partition (offset)&gt; - &lt;end of partition&gt; which means you could use this to get both the partition, and with some simple math the size as well.</div></dd></dl></li>
<li>Reboot the board and stop the auto boot by pressing any key when prompted
<ul><li><b>init 6</b></li></ul></li>
<li>Set the NAND ECC mode to match the Linux kernel which is BCH8
<ul><li><b>nandecc hw 2</b></li></ul></li>
<li>Erase the <b>SPL</b> and <b>U-Boot</b> flash partitions.
<ul><li><b>nand erase 0x0 0x20000</b></li>
<li><b>nand erase 0x80000 0x1e0000</b></li></ul></li>
<li>Download the SPL image to DDR. You can find the serverip to use by running the <b>ifconfig</b> command on your host.
<ul><li><b>mw.b ${loadaddr} 0xFF 0x20000</b></li></ul>
<dl><dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />This command will write all 1's to the memory address where we are going to transfer the kernel image.  This is a nice to do not a strict requirement</div></dd></dl>
<ul><li><b>setenv serverip &lt;your server ip&gt;</b></li>
<li><b>setenv autoload n</b></li>
<li><b>dhcp</b></li>
<li><b>tftp ${loadaddr} MLO-optimized</b></li></ul>
<dl><dd><div style="margin: 5px; padding: 5px 10px; background-color: #ffffec; border-left: 5px solid #ff6600;"><b>IMPORTANT</b><br /><br />The SPL image is downloaded to the address stored in <b>loadaddr</b>.  In this case that is 0x82000000 but you can always look for the <b>Load address</b> in the tftp output</div></dd>
<dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />The serverip used is the same as the one used in your uEnv.txt file</div></dd></dl></li>
<li>Make a note of the actual image size shown as the last line out output. i.e.
<dl><dd><b>Bytes transferred = 79953 (13851)</b></dd></dl></li>
<li>Write the SPL image using the following command
<ul><li><b>nand write ${loadaddr} 0x0 0x20000</b></li></ul></li>
<li>Download the U-Boot image to DDR.
<ul><li><b>mw.b ${loadaddr} 0xFF 0x1e0000</b></li></ul>
<dl><dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />This command will write all 1's to the memory address where we are going to transfer the kernel image.  This is a nice to do not a strict requirement</div></dd></dl>
<ul><li><b>tftp ${loadaddr} u-boot-optimized</b></li></ul>
<dl><dd><div style="margin: 5px; padding: 5px 10px; background-color: #ffffec; border-left: 5px solid #ff6600;"><b>IMPORTANT</b><br /><br />The U-Boot image is downloaded to the address stored in <b>loadaddr</b>.  In this case that is 0x82000000 but you can always look for the <b>Load address</b> in the tftp output</div></dd></dl></li>
<li>Make a note of the actual kernel image size shown as the last line out output. i.e.
<dl><dd><b>Bytes transferred = 228144 (37b30 hex)</b></dd></dl></li>
<li>Write the kernel image using the following command
<ul><li><b>nand write ${loadaddr} 0x80000 0x1e0000</b></li></ul>
<dl><dd><div style="margin: 5px; padding: 5px 10px; background-color: #ffffec; border-left: 5px solid #ff6600;"><b>IMPORTANT</b><br /><br />For help with the various nand command you can just type <b>nand</b> on the u-boot prompt and you will be given the help output for the nand system</div></dd></dl></li>
<li>You can now type the following command at the u-boot prompt to see if you have flashed your images to NAND successfully.
<ul><li><b>reset</b></li></ul></li></ol>

<!-- 
NewPP limit report
Cached time: 20201130084730
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.232 seconds
Real time usage: 0.246 seconds
Preprocessor visited node count: 817/1000000
Preprocessor generated node count: 1878/1000000
Post‐expand include size: 24547/2097152 bytes
Template argument size: 14518/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 174/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%   17.129      1 -total
 21.91%    3.752     39 Template:SpNote
 21.84%    3.741     37 Template:SpImportant
  7.86%    1.347      1 Template:Sitara_Devices
-->
</div>
<!-- Saved in parser cache with key procwiki:pcache:idhash:17882-0!canonical and timestamp 20201130084729 and revision id 157984
 -->
<div class='hf-nsfooter' id='hf-nsfooter-'><table style="text-align:center; background:white; width:100%; text-align:left; height: 65px border-top: 1px solid; border-bottom: 1px solid; border-left: 1px solid; border-right: 1px solid; border-width: 1px; border-style: solid;">
<tr>
<td width="305px"><a href="File_E2e.html" class="image"><img alt="E2e.jpg" src="https://processors.wiki.ti.com/images/8/82/E2e.jpg" width="305" height="63" /></a>
</td>
<td>{{
<ol><li>switchcategory:MultiCore=</li></ol>
<ul><li>For technical support on MultiCore devices, please post your questions in the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/c6000_multi-core_dsps/default.aspx">C6000 MultiCore Forum</a></li>
<li>For questions related to the BIOS MultiCore SDK (MCSDK), please use the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/embedded/f/355.aspx">BIOS Forum</a></li></ul>
<p>Please post only comments related to the article <b>Sitara Linux Training: Boot Time Reduction</b> here.<i></i>
</p>
</td>
<td>Keystone=
<ul><li>For technical support on MultiCore devices, please post your questions in the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/c6000_multi-core_dsps/default.aspx">C6000 MultiCore Forum</a></li>
<li>For questions related to the BIOS MultiCore SDK (MCSDK), please use the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/embedded/f/355.aspx">BIOS Forum</a></li></ul>
<p>Please post only comments related to the article <b>Sitara Linux Training: Boot Time Reduction</b> here.<i></i>
</p>
</td>
<td>C2000=<i>For technical support on the C2000 please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/microcontrollers/tms320c2000_32-bit_real-time_mcus/f/171.aspx">The C2000 Forum</a>. Please post only comments about the article <b>Sitara Linux Training: Boot Time Reduction</b> here.</i>
</td>
<td>DaVinci=<i>For technical support on DaVincoplease post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/davinci_digital_media_processors/default.aspx">The DaVinci Forum</a>. Please post only comments about the article <b>Sitara Linux Training: Boot Time Reduction</b> here.</i>
</td>
<td>MSP430=<i>For technical support on MSP430 please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/microcontrollers/msp43016-bit_ultra-low_power_mcus/default.aspx">The MSP430 Forum</a>. Please post only comments about the article <b>Sitara Linux Training: Boot Time Reduction</b> here.</i>
</td>
<td>OMAP35x=<i>For technical support on OMAP please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/omap_applications_processors/default.aspx">The OMAP Forum</a>. Please post only comments about the article <b>Sitara Linux Training: Boot Time Reduction</b> here.</i>
</td>
<td>OMAPL1=<i>For technical support on OMAP please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/omap_applications_processors/default.aspx">The OMAP Forum</a>. Please post only comments about the article <b>Sitara Linux Training: Boot Time Reduction</b> here.</i>
</td>
<td>MAVRK=<i>For technical support on MAVRK please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/development_tools/mavrk/default.aspx">The MAVRK Toolbox Forum</a>. Please post only comments about the article <b>Sitara Linux Training: Boot Time Reduction</b> here.</i>
</td>
<td><i>For technical support please post your questions at <a rel="nofollow" class="external text" href="http://e2e.ti.com/">http://e2e.ti.com</a>. Please post only comments about the article <b>Sitara Linux Training: Boot Time Reduction</b> here.</i>
<p>}}
</p>
</td></tr></table>
<table style="border-style:solid; border-width:1px; text-align:center; width:100%;">

<tr style="font-size:150%;">
<td rowspan="2"><a href="File_Hyperlink_blue.html" class="image"><img alt="Hyperlink blue.png" src="https://processors.wiki.ti.com/images/9/9f/Hyperlink_blue.png" width="96" height="96" /></a>
</td>
<td><b>Links</b>
</td></tr>
<tr>
<td>
<table style="text-align: left;">
<tr>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/amplifier_and_linear.page">Amplifiers &amp; Linear</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/audio/audio_overview.page">Audio</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/rfif.page">Broadband RF/IF &amp; Digital Radio</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/clocksandtimers/clocks_and_timers.page">Clocks &amp; Timers</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/dataconverters/data_converter.page">Data Converters</a>
</p>
</td>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/mems/mems.page">DLP &amp; MEMS</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/high_reliability.page">High-Reliability</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/interface/interface.page">Interface</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/logic/home_overview.page">Logic</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/powermanagement/power_portal.page">Power Management</a>
</p>
</td>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/dsp/embedded_processor.page">Processors</a>
</p>
<ul><li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/dsp/arm.page">ARM Processors</a></li>
<li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/dsp/home.page">Digital Signal Processors (DSP)</a></li>
<li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/microcontroller/home.page">Microcontrollers (MCU)</a></li>
<li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/omap-applications-processors/the-omap-experience.page">OMAP Applications Processors</a></li></ul>
</td>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/switches_and_multiplexers.page">Switches &amp; Multiplexers</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/temperature_sensor.page">Temperature Sensors &amp; Control ICs</a><br/>
<a rel="nofollow" class="external text" href="http://focus.ti.com/wireless/docs/wirelessoverview.tsp?familyId=2003&amp;sectionId=646&amp;tabId=2735">Wireless Connectivity</a>
</p>
</td></tr></table>
</td></tr></table>
<div id="tiPrivacy"></div>
</div></div>					<div class="printfooter">
						Retrieved from "<a dir="ltr" href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;oldid=157984">https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;oldid=157984</a>"					</div>
				<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="Special_Categories.html" title="Special:Categories">Categories</a>: <ul><li><a href="Category_AM437x.html" title="Category:AM437x">AM437x</a></li><li><a href="Category_AM335x.html" title="Category:AM335x">AM335x</a></li><li><a href="Category_AM35x.html" title="Category:AM35x">AM35x</a></li><li><a href="Category_AM37x.html" title="Category:AM37x">AM37x</a></li><li><a href="Category_AM1x.html" title="Category:AM1x">AM1x</a></li><li><a href="Category_AM18x.html" title="Category:AM18x">AM18x</a></li></ul></div></div>				<div class="visualClear"></div>
							</div>
		</div>
		<div id="mw-navigation">
			<h2>Navigation menu</h2>
			<div id="mw-head">
									<div id="p-personal" role="navigation" class="" aria-labelledby="p-personal-label">
						<h3 id="p-personal-label">Personal tools</h3>
						<ul>
							<li id="pt-login"><a href="https://processors.wiki.ti.com/index.php?title=Special:UserLogin&amp;returnto=Sitara+Linux+Training%3A+Boot+Time+Reduction" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li><li id="pt-createaccount"><a href="Special_RequestAccount.html" title="You are encouraged to create an account and log in; however, it is not mandatory">Request account</a></li>						</ul>
					</div>
									<div id="left-navigation">
										<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
						<h3 id="p-namespaces-label">Namespaces</h3>
						<ul>
							<li id="ca-nstab-main" class="selected"><span><a href="Sitara_Linux_Training__Boot_Time_Reduction.html" title="View the content page [c]" accesskey="c">Page</a></span></li><li id="ca-talk" class="new"><span><a href="https://processors.wiki.ti.com/index.php?title=Talk:Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page (page does not exist) [t]" accesskey="t">Discussion</a></span></li>						</ul>
					</div>
										<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
												<input type="checkbox" class="vectorMenuCheckbox" aria-labelledby="p-variants-label" />
						<h3 id="p-variants-label">
							<span>Variants</span>
						</h3>
						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
									</div>
				<div id="right-navigation">
										<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
						<h3 id="p-views-label">Views</h3>
						<ul>
							<li id="ca-view" class="collapsible selected"><span><a href="Sitara_Linux_Training__Boot_Time_Reduction.html">Read</a></span></li><li id="ca-viewsource" class="collapsible"><span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></span></li><li id="ca-history" class="collapsible"><span><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=history" title="Past revisions of this page [h]" accesskey="h">View history</a></span></li>						</ul>
					</div>
										<div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label">
						<input type="checkbox" class="vectorMenuCheckbox" aria-labelledby="p-cactions-label" />
						<h3 id="p-cactions-label"><span>More</span></h3>
						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
										<div id="p-search" role="search">
						<h3>
							<label for="searchInput">Search</label>
						</h3>
						<form action="https://processors.wiki.ti.com/index.php" id="searchform">
							<div id="simpleSearch">
								<input type="search" name="search" placeholder="Search Texas Instruments Wiki" title="Search Texas Instruments Wiki [f]" accesskey="f" id="searchInput"/><input type="hidden" value="Special:Search" name="title"/><input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton mw-fallbackSearchButton"/><input type="submit" name="go" value="Go" title="Go to a page with this exact name if it exists" id="searchButton" class="searchButton"/>							</div>
						</form>
					</div>
									</div>
			</div>
			<div id="mw-panel">
				<div id="p-logo" role="banner"><a class="mw-wiki-logo" href="Main_Page.html"  title="Visit the main page"></a></div>
						<div class="portal" role="navigation" id="p-navigation" aria-labelledby="p-navigation-label">
			<h3 id="p-navigation-label">Navigation</h3>
			<div class="body">
								<ul>
					<li id="n-mainpage"><a href="Main_Page.html" title="Visit the main page [z]" accesskey="z">Main Page</a></li><li id="n-All-pages"><a href="Special_AllPages.html">All pages</a></li><li id="n-All-categories"><a href="Special_Categories.html">All categories</a></li><li id="n-recentchanges"><a href="Special_RecentChanges.html" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li><li id="n-randompage"><a href="Package_Reflow_Profiles.html" title="Load a random page [x]" accesskey="x">Random page</a></li><li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" title="The place to find out">Help</a></li>				</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id="p-tb" aria-labelledby="p-tb-label">
			<h3 id="p-tb-label">Toolbox</h3>
			<div class="body">
								<ul>
					<li id="t-whatlinkshere"><a href="Special_WhatLinksHere/Sitara_Linux_Training__Boot_Time_Reduction.html" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li><li id="t-recentchangeslinked"><a href="Special_RecentChangesLinked/Sitara_Linux_Training__Boot_Time_Reduction.html" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li><li id="t-specialpages"><a href="Special_SpecialPages.html" title="A list of all special pages [q]" accesskey="q">Special pages</a></li><li id="t-print"><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li><li id="t-permalink"><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;oldid=157984" title="Permanent link to this revision of the page">Permanent link</a></li><li id="t-info"><a href="https://processors.wiki.ti.com/index.php?title=Sitara_Linux_Training:_Boot_Time_Reduction&amp;action=info" title="More information about this page">Page information</a></li>				</ul>
							</div>
		</div>
				</div>
		</div>
				<div id="footer" role="contentinfo">
						<ul id="footer-info">
								<li id="footer-info-lastmod"> This page was last edited on 31 July 2013, at 15:57.</li>
								<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-ShareAlike</a> unless otherwise noted.</li>
							</ul>
						<ul id="footer-places">
								<li id="footer-places-privacy"><a href="Project_Privacy_policy.html" title="Project:Privacy policy">Privacy policy</a></li>
								<li id="footer-places-about"><a href="Project_About.html" title="Project:About">About Texas Instruments Wiki</a></li>
								<li id="footer-places-disclaimer"><a href="Project_General_disclaimer.html" title="Project:General disclaimer">Disclaimers</a></li>
								<li id="footer-places-termsofservice"><a href="Project_Terms_of_Service.html" title="Project:Terms of Service">Terms of Use</a></li>
							</ul>
										<ul id="footer-icons" class="noprint">
										<li id="footer-copyrightico">
						<a href="http://creativecommons.org/licenses/by-sa/3.0/"><img src="https://processors.wiki.ti.com/resources/assets/licenses/cc-by-sa.png" alt="Creative Commons Attribution-ShareAlike" width="88" height="31"/></a>					</li>
										<li id="footer-poweredbyico">
						<a href="http://www.mediawiki.org/"><img src="https://processors.wiki.ti.com/resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31"/></a>					</li>
									</ul>
						<div style="clear: both;"></div>
		</div>
		<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgPageParseReport":{"limitreport":{"cputime":"0.232","walltime":"0.246","ppvisitednodes":{"value":817,"limit":1000000},"ppgeneratednodes":{"value":1878,"limit":1000000},"postexpandincludesize":{"value":24547,"limit":2097152},"templateargumentsize":{"value":14518,"limit":2097152},"expansiondepth":{"value":2,"limit":40},"expensivefunctioncount":{"value":0,"limit":100},"unstrip-depth":{"value":0,"limit":20},"unstrip-size":{"value":174,"limit":5000000},"timingprofile":["100.00%   17.129      1 -total"," 21.91%    3.752     39 Template:SpNote"," 21.84%    3.741     37 Template:SpImportant","  7.86%    1.347      1 Template:Sitara_Devices"]},"cachereport":{"timestamp":"20201130084730","ttl":86400,"transientcontent":false}}});});</script><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":238});});</script>
	</body>

<!-- Mirrored from processors.wiki.ti.com/index.php/Sitara_Linux_Training:_Boot_Time_Reduction by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 01 Dec 2020 10:12:41 GMT -->
</html>
