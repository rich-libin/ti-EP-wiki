<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">

<!-- Mirrored from processors.wiki.ti.com/index.php/Usbgeneralpage by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 01 Dec 2020 06:33:57 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8"/>
<title>Usbgeneralpage - Texas Instruments Wiki</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Usbgeneralpage","wgTitle":"Usbgeneralpage","wgCurRevisionId":233692,"wgRevisionId":233692,"wgArticleId":9393,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Linux","PSP","USB"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Usbgeneralpage","wgRelevantArticleId":9393,"wgRequestId":"3c88ff268923b22f0ffeb8c0","wgIsProbablyEditable":false,"wgRelevantPageIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[]});mw.loader.state({"site.styles":"ready","noscript":"ready","user.styles":"ready","user":"ready","user.options":"ready","user.tokens":"loading","mediawiki.legacy.shared":"ready","mediawiki.legacy.commonPrint":"ready","mediawiki.sectionAnchor":"ready","mediawiki.skinning.interface":"ready","skins.vector.styles":"ready"});mw.loader.implement("user.tokens@19o3a1s",function($,jQuery,require,module){/*@nomin*/mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});
});mw.loader.load(["site","mediawiki.page.startup","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.toc","mediawiki.searchSuggest","skins.vector.js"]);});</script>
<link rel="stylesheet" href="https://processors.wiki.ti.com/load.php?debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.interface%7Cskins.vector.styles&amp;only=styles&amp;skin=vector"/>
<script async="" src="https://processors.wiki.ti.com/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=vector"></script>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="https://processors.wiki.ti.com/load.php?debug=false&amp;lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=vector"/>
<meta name="generator" content="MediaWiki 1.31.6"/>
<link rel="shortcut icon" href="https://processors.wiki.ti.com/favicon.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="https://processors.wiki.ti.com/opensearch_desc.php" title="Texas Instruments Wiki (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="https://processors.wiki.ti.com/api.php?action=rsd"/>
<link rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/"/>
<link rel="alternate" type="application/atom+xml" title="Texas Instruments Wiki Atom feed" href="https://processors.wiki.ti.com/index.php?title=Special:RecentChanges&amp;feed=atom"/>
<!--[if lt IE 9]><script src="/load.php?debug=false&amp;lang=en&amp;modules=html5shiv&amp;only=scripts&amp;skin=Vector&amp;sync=1"></script><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Usbgeneralpage rootpage-Usbgeneralpage skin-vector action-view">		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<div id="content" class="mw-body" role="main">
			<a id="top"></a>
			<div id="siteNotice" class="mw-body-content"><div id="localNotice" lang="en" dir="ltr"><div class="mw-parser-output"><p><br />
<span style="color:#ff0000"><b>NOTICE: The Processors Wiki will End-of-Life on January 15, 2021. It is recommended to download any files or other content you may need that are hosted on processors.wiki.ti.com. The site is now set to read only.</b></span>
</p></div></div></div><div class="mw-indicators mw-body-content">
</div>
<h1 id="firstHeading" class="firstHeading" lang="en">Usbgeneralpage</h1>			<div id="bodyContent" class="mw-body-content">
				<div id="siteSub" class="noprint">From Texas Instruments Wiki</div>				<div id="contentSub"></div>
								<div id="jump-to-nav" class="mw-jump">
					Jump to:					<a href="#mw-head">navigation</a>, 					<a href="#p-search">search</a>
				</div>
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output"><div style="width:800px; text-align:justify;"> 
<div style="display:block; clear: both; margin: 10px 0px; padding: 0px; background-color: #ee1d23; text-align:right;"><a href="File_TIBanner.html" class="image"><img alt="TIBanner.png" src="https://processors.wiki.ti.com/images/c/cd/TIBanner.png" width="667" height="87" /></a></div>
<div style="display:block; margin: 5px 0px; padding: 2px 5px; font-size:1.5em; font-weight:bold; text-align:left;">Linux USB Configuration</div>
<div style="display:block; margin: 5px 0px; padding: 2px; color: #666666; font-size:1.0em; font-weight:bold; text-align:right;">Linux PSP</div>   
<p><b>USB Driver</b>  
</p>
<div style="padding:5px; background: #eeeeee; color: #348017">
</div>
<p><b> </b>
</p>
<div id="toc" class="toc"><div class="toctitle" lang="en" dir="ltr"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Introduction"><span class="tocnumber">1</span> <span class="toctext"><b>Introduction</b></span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Linux_USB_Stack_Architecture"><span class="tocnumber">1.1</span> <span class="toctext"><b>Linux USB Stack Architecture </b></span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-3"><a href="#Driver_configuration"><span class="tocnumber">2</span> <span class="toctext"><b> Driver configuration </b></span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#To_configure_the_USB_Driver_Features_through_menuconfig"><span class="tocnumber">2.1</span> <span class="toctext"><b>To configure the USB Driver Features through menuconfig </b></span></a>
<ul>
<li class="toclevel-3 tocsection-5"><a href="#TI81XX.2FAM38XX.2FTI811X_EVM_default_configuration"><span class="tocnumber">2.1.1</span> <span class="toctext"><b>TI81XX/AM38XX/TI811X EVM default configuration</b></span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-6"><a href="#USB_phy_selection_for_MUSB_OTG_port"><span class="tocnumber">2.2</span> <span class="toctext"><b> USB phy selection for MUSB OTG port </b></span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#USB_controller_in_host_mode"><span class="tocnumber">2.3</span> <span class="toctext"><b> USB controller in host mode </b></span></a>
<ul>
<li class="toclevel-3 tocsection-8"><a href="#TI81XX.2FTI811X"><span class="tocnumber">2.3.1</span> <span class="toctext"><b> TI81XX/TI811X </b></span></a>
<ul>
<li class="toclevel-4 tocsection-9"><a href="#MUSB_OTG_Host_Configuration"><span class="tocnumber">2.3.1.1</span> <span class="toctext"><b> MUSB OTG Host Configuration </b></span></a></li>
<li class="toclevel-4 tocsection-10"><a href="#USB-ID_pin_configuration_selection_for_TI81XX"><span class="tocnumber">2.3.1.2</span> <span class="toctext"><b>USB-ID pin configuration selection for TI81XX</b></span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-11"><a href="#OMAP35x.2FAM35x.2FAM37x.2FAM45x"><span class="tocnumber">2.3.2</span> <span class="toctext"><b> OMAP35x/AM35x/AM37x/AM45x </b></span></a>
<ul>
<li class="toclevel-4 tocsection-12"><a href="#MUSB_OTG_Host_Configuration_2"><span class="tocnumber">2.3.2.1</span> <span class="toctext"><b> MUSB OTG Host Configuration </b></span></a></li>
<li class="toclevel-4 tocsection-13"><a href="#EHCI_Configuration_.28Not_supported_for_TI81XX.2FTI811X.29"><span class="tocnumber">2.3.2.2</span> <span class="toctext"><b> EHCI Configuration (Not supported for TI81XX/TI811X)</b></span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-2 tocsection-14"><a href="#MUSB_controller_in_gadget_mode"><span class="tocnumber">2.4</span> <span class="toctext"><b> MUSB controller in gadget mode </b></span></a>
<ul>
<li class="toclevel-3 tocsection-15"><a href="#TI81XX.2FTI811X_2"><span class="tocnumber">2.4.1</span> <span class="toctext"><b> TI81XX/TI811X </b></span></a>
<ul>
<li class="toclevel-4 tocsection-16"><a href="#Configuration"><span class="tocnumber">2.4.1.1</span> <span class="toctext"><b> Configuration </b></span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-17"><a href="#OMAP35x.2FAM35x.2FAM37x.2FAM45x_2"><span class="tocnumber">2.4.2</span> <span class="toctext"><b> OMAP35x/AM35x/AM37x/AM45x </b></span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-18"><a href="#MUSB_OTG_controller_in_OTG_mode"><span class="tocnumber">2.5</span> <span class="toctext"><b> MUSB OTG controller in OTG mode </b></span></a>
<ul>
<li class="toclevel-3 tocsection-19"><a href="#TI81XX.2FTI811X_3"><span class="tocnumber">2.5.1</span> <span class="toctext"><b> TI81XX/TI811X </b></span></a></li>
<li class="toclevel-3 tocsection-20"><a href="#OMAP35x.2FAM35x.2FAM37x.2FAM45x_3"><span class="tocnumber">2.5.2</span> <span class="toctext"><b> OMAP35x/AM35x/AM37x/AM45x </b></span></a>
<ul>
<li class="toclevel-4 tocsection-21"><a href="#OTG_Configuration"><span class="tocnumber">2.5.2.1</span> <span class="toctext"><b> OTG Configuration </b></span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-2 tocsection-22"><a href="#Host_mode_applications"><span class="tocnumber">2.6</span> <span class="toctext"><b> Host mode applications </b></span></a>
<ul>
<li class="toclevel-3 tocsection-23"><a href="#Mass_Storage_Driver"><span class="tocnumber">2.6.1</span> <span class="toctext"><b> Mass Storage Driver </b></span></a>
<ul>
<li class="toclevel-4 tocsection-24"><a href="#USB_Controller_and_USB_MSC_HOST"><span class="tocnumber">2.6.1.1</span> <span class="toctext"><b> USB Controller and USB MSC HOST </b></span></a></li>
<li class="toclevel-4 tocsection-25"><a href="#Configuration_2"><span class="tocnumber">2.6.1.2</span> <span class="toctext"><b> Configuration </b></span></a></li>
<li class="toclevel-4 tocsection-26"><a href="#Device_nodes"><span class="tocnumber">2.6.1.3</span> <span class="toctext"><b> Device nodes </b></span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-27"><a href="#USB_HID_Class"><span class="tocnumber">2.6.2</span> <span class="toctext"><b> USB HID Class </b></span></a>
<ul>
<li class="toclevel-4 tocsection-28"><a href="#USB_Controller_and_USB_HID"><span class="tocnumber">2.6.2.1</span> <span class="toctext"><b> USB Controller and USB HID </b></span></a></li>
<li class="toclevel-4 tocsection-29"><a href="#Configuration_3"><span class="tocnumber">2.6.2.2</span> <span class="toctext"><b> Configuration </b></span></a></li>
<li class="toclevel-4 tocsection-30"><a href="#Device_nodes_2"><span class="tocnumber">2.6.2.3</span> <span class="toctext"><b> Device nodes </b></span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-31"><a href="#USB_Audio"><span class="tocnumber">2.6.3</span> <span class="toctext"><b> USB Audio </b></span></a>
<ul>
<li class="toclevel-4 tocsection-32"><a href="#Configuration_4"><span class="tocnumber">2.6.3.1</span> <span class="toctext"><b> Configuration </b></span></a></li>
<li class="toclevel-4 tocsection-33"><a href="#Resources"><span class="tocnumber">2.6.3.2</span> <span class="toctext"><b> Resources </b></span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-34"><a href="#USB_Video"><span class="tocnumber">2.6.4</span> <span class="toctext"><b> USB Video </b></span></a>
<ul>
<li class="toclevel-4 tocsection-35"><a href="#Configuration_5"><span class="tocnumber">2.6.4.1</span> <span class="toctext"><b> Configuration </b></span></a></li>
<li class="toclevel-4 tocsection-36"><a href="#Resources_2"><span class="tocnumber">2.6.4.2</span> <span class="toctext"><b> Resources </b></span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-37"><a href="#USB_CDC-HOST"><span class="tocnumber">2.6.5</span> <span class="toctext"><b> USB CDC-HOST </b></span></a>
<ul>
<li class="toclevel-4 tocsection-38"><a href="#Configuration_6"><span class="tocnumber">2.6.5.1</span> <span class="toctext"><b> Configuration </b></span></a></li>
<li class="toclevel-4 tocsection-39"><a href="#Resources_3"><span class="tocnumber">2.6.5.2</span> <span class="toctext"><b> Resources </b></span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-2 tocsection-40"><a href="#Gadget_Mode_Applications"><span class="tocnumber">2.7</span> <span class="toctext"><b> Gadget Mode Applications </b></span></a>
<ul>
<li class="toclevel-3 tocsection-41"><a href="#Mass_Storage_Gadget"><span class="tocnumber">2.7.1</span> <span class="toctext"><b> Mass Storage Gadget </b></span></a>
<ul>
<li class="toclevel-4 tocsection-42"><a href="#Configuration_7"><span class="tocnumber">2.7.1.1</span> <span class="toctext"><b> Configuration </b></span></a></li>
<li class="toclevel-4 tocsection-43"><a href="#Installation_of_File_Storage_Gadget_Driver"><span class="tocnumber">2.7.1.2</span> <span class="toctext"><b> Installation of File Storage Gadget Driver </b></span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-44"><a href="#CDC.2FRNDIS_gadget"><span class="tocnumber">2.7.2</span> <span class="toctext"><b> CDC/RNDIS gadget </b></span></a>
<ul>
<li class="toclevel-4 tocsection-45"><a href="#Configuration_for_USB_controller_and_CDC.2FRNDIS_Gadget"><span class="tocnumber">2.7.2.1</span> <span class="toctext"><b> Configuration for USB controller and CDC/RNDIS Gadget </b></span></a></li>
<li class="toclevel-4 tocsection-46"><a href="#Installation_of_CDC.2FRNDIS_Gadget_Driver"><span class="tocnumber">2.7.2.2</span> <span class="toctext"><b> Installation of CDC/RNDIS Gadget Driver </b></span></a></li>
<li class="toclevel-4 tocsection-47"><a href="#Installing_driver_on_Windows_to_recognize_Linux_RNDIS_gadget"><span class="tocnumber">2.7.2.3</span> <span class="toctext">Installing driver on Windows to recognize Linux RNDIS gadget</span></a></li>
<li class="toclevel-4 tocsection-48"><a href="#Setting_up_USBNet"><span class="tocnumber">2.7.2.4</span> <span class="toctext"><b> Setting up USBNet </b></span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-49"><a href="#UVC_Webcam_Gadget"><span class="tocnumber">2.7.3</span> <span class="toctext"><b> UVC Webcam Gadget </b></span></a>
<ul>
<li class="toclevel-4 tocsection-50"><a href="#Kernel_Configuration"><span class="tocnumber">2.7.3.1</span> <span class="toctext"><b> Kernel Configuration </b></span></a></li>
<li class="toclevel-4 tocsection-51"><a href="#uvc-gadget_application"><span class="tocnumber">2.7.3.2</span> <span class="toctext"><b> uvc-gadget application </b></span></a></li>
<li class="toclevel-4 tocsection-52"><a href="#Running_UVC_Gadget"><span class="tocnumber">2.7.3.3</span> <span class="toctext"><b> Running UVC Gadget </b></span></a></li>
<li class="toclevel-4 tocsection-53"><a href="#Testing_different_bandwidth_settings"><span class="tocnumber">2.7.3.4</span> <span class="toctext"><b> Testing different bandwidth settings </b></span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-54"><a href="#Modular_testing_on_MUSB"><span class="tocnumber">3</span> <span class="toctext"><b> Modular testing on MUSB </b></span></a></li>
<li class="toclevel-1 tocsection-55"><a href="#One_port_as_host_and_other_port_as_Gadget_.28for_TI81XX.2FTI813X.29"><span class="tocnumber">4</span> <span class="toctext"><b>One port as host and other port as Gadget (for TI81XX/TI813X) </b></span></a></li>
<li class="toclevel-1 tocsection-56"><a href="#USB_EHCI_Electrical_testing_.28Not_applicable_for_TI81XX.2FTI811X.29"><span class="tocnumber">5</span> <span class="toctext"><b> USB EHCI Electrical testing (Not applicable for TI81XX/TI811X)</b></span></a></li>
<li class="toclevel-1 tocsection-57"><a href="#USB_OTG_.28HNP.2FSRP.29_testing_.28Not_applicable_for_TI81XX.2FTI811X.29"><span class="tocnumber">6</span> <span class="toctext"><b> USB OTG (HNP/SRP) testing (Not applicable for TI81XX/TI811X) </b></span></a></li>
<li class="toclevel-1 tocsection-58"><a href="#Software_Interface"><span class="tocnumber">7</span> <span class="toctext"><b> Software Interface </b></span></a>
<ul>
<li class="toclevel-2 tocsection-59"><a href="#sysfs"><span class="tocnumber">7.1</span> <span class="toctext"><b> sysfs </b></span></a></li>
<li class="toclevel-2 tocsection-60"><a href="#procfs"><span class="tocnumber">7.2</span> <span class="toctext"><b> procfs </b></span></a></li>
<li class="toclevel-2 tocsection-61"><a href="#musb_driver_debugfs"><span class="tocnumber">7.3</span> <span class="toctext"><b> musb driver debugfs </b></span></a>
<ul>
<li class="toclevel-3 tocsection-62"><a href="#mount_the_debug_file_system_.28debugfs.29"><span class="tocnumber">7.3.1</span> <span class="toctext"><b>mount the debug file system (debugfs) </b></span></a></li>
<li class="toclevel-3 tocsection-63"><a href="#musb_driver_TEST-MODE_debugfs_support"><span class="tocnumber">7.3.2</span> <span class="toctext"><b>musb driver TEST-MODE debugfs support</b></span></a>
<ul>
<li class="toclevel-4 tocsection-64"><a href="#To_force_musb_to_host_mode"><span class="tocnumber">7.3.2.1</span> <span class="toctext">To force musb to host mode</span></a></li>
<li class="toclevel-4 tocsection-65"><a href="#To_force_musb_to_full-speed"><span class="tocnumber">7.3.2.2</span> <span class="toctext">To force musb to full-speed</span></a></li>
<li class="toclevel-4 tocsection-66"><a href="#To_force_musb_to_high-speed"><span class="tocnumber">7.3.2.3</span> <span class="toctext">To force musb to high-speed</span></a></li>
<li class="toclevel-4 tocsection-67"><a href="#To_send_test_packet"><span class="tocnumber">7.3.2.4</span> <span class="toctext">To send test packet</span></a></li>
<li class="toclevel-4 tocsection-68"><a href="#To_generate_test_K_pattern"><span class="tocnumber">7.3.2.5</span> <span class="toctext">To generate test K pattern</span></a></li>
<li class="toclevel-4 tocsection-69"><a href="#To_generate_test_J_pattern"><span class="tocnumber">7.3.2.6</span> <span class="toctext">To generate test J pattern</span></a></li>
<li class="toclevel-4 tocsection-70"><a href="#To_generate_test_SE0_NAK_pattern"><span class="tocnumber">7.3.2.7</span> <span class="toctext">To generate test SE0 NAK pattern</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>

<h1><span class="mw-headline" id="Introduction"><b>Introduction</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=1" title="Edit section: Introduction">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h2><span class="mw-headline" id="Linux_USB_Stack_Architecture"><b>Linux USB Stack Architecture </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=2" title="Edit section: Linux USB Stack Architecture">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Linux usb stack is an layered architecture in which musb controller hardware is at the lowest layer. The musb controller driver abstract the musb controller hardware to linux usb stack.
</p><p><a href="File_Linuxusbarch3.html" class="image"><img alt="Linuxusbarch3.JPG" src="https://processors.wiki.ti.com/images/5/53/Linuxusbarch3.JPG" width="782" height="668" /></a>
</p><p>This page being common across all TI platforms describes the configuration of USB in linux menuconfig. Specific sections will be used for different platform to mention the differences with other platform.
</p>
<h1><span class="mw-headline" id="Driver_configuration"><b> Driver configuration </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=3" title="Edit section: Driver configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>The MUSB OTG controller can be used in Host only, Peripheral(Gadget) only or OTG (both host and device) modes. The following section shows the configuration options for USB and its associated class drivers.
</p>
<h3><span class="mw-headline" id="To_configure_the_USB_Driver_Features_through_menuconfig"><b>To configure the USB Driver Features through menuconfig </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=4" title="Edit section: To configure the USB Driver Features through menuconfig">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Use menuconfig to configure the USB driver features supported in kernel.
</p>
<pre>   make ARCH=arm CROSS_COMPILE=arm-none-linux-gnueabi- menuconfig
</pre>
<p>Goto Menuconfig-&gt;Device Drivers
</p>
<pre> Device Drivers ---&gt;
 ....
 [ ] HID Devices  ---&gt;  
 [*] USB support  ---&gt;  
 ....
</pre>
<h4><span id="TI81XX/AM38XX/TI811X_EVM_default_configuration"></span><span class="mw-headline" id="TI81XX.2FAM38XX.2FTI811X_EVM_default_configuration"><b>TI81XX/AM38XX/TI811X EVM default configuration</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=5" title="Edit section: TI81XX/AM38XX/TI811X EVM default configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>By default the usb host mode configuration is selected in default evm defconfig is available for DM816X and DM814X. The user can chose default evm defconfig by running
</p><p>for TI816X
</p>
<pre> # make ARCH=arm CROSS_COMPILE=arm-none-linux-gnueabi- ti8168_evm_defconfig 
</pre>
<p>for TI814X
</p>
<pre> # make ARCH=arm CROSS_COMPILE=arm-none-linux-gnueabi- ti8148_evm_defconfig
</pre>
<p>for TI811X
</p>
<pre> # make ARCH=arm CROSS_COMPILE=arm-none-linux-gnueabi- ti811x_evm_defconfig
</pre>
<h2><span class="mw-headline" id="USB_phy_selection_for_MUSB_OTG_port"><b> USB phy selection for MUSB OTG port </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=6" title="Edit section: USB phy selection for MUSB OTG port">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Please select NOP USB transceiver for MUSB support on all platform except Beagle or Beagle-XM which uses USB phy on TPS65950 (aka TWL4030).
</p>
<pre> Device Drivers ---&gt;
 USB support ---&gt;
 *** OTG and related infrastructure ***
 [ ] GPIO based peripheral-only VBUS sensing 'transceiver'
 [ ] Philips ISP1301 with OMAP OTG
 [ ] TWL4030 USB Transceiver Driver
 [*] NOP USB Transceiver Driver
</pre>
<h2><span class="mw-headline" id="USB_controller_in_host_mode"><b> USB controller in host mode </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=7" title="Edit section: USB controller in host mode">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h3><span id="TI81XX/TI811X"></span><span class="mw-headline" id="TI81XX.2FTI811X"><b> TI81XX/TI811X </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=8" title="Edit section: TI81XX/TI811X">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>In host only mode configuration, by default both ports usb0/usb1 are configured for host mode.
</p>
<h4><span class="mw-headline" id="MUSB_OTG_Host_Configuration"><b> MUSB OTG Host Configuration </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=9" title="Edit section: MUSB OTG Host Configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<pre> Device Drivers ---&gt;
 USB support ---&gt;
 &lt;*&gt; Support for Host-side USB
     *** Miscellaneous USB options ***
 [*] USB device filesystem
 [*] USB device class-devices (DEPRECATED)
     *** USB Host Controller Drivers ***
 &lt;*&gt;   Inventra Highspeed Dual Role Controller (TI, ADI, ...)  
   *** Platform Glue Layer ***                
    &lt; &gt;     TUSB6010                          
    &lt; &gt;     OMAP2430 and onwards              
    &lt; &gt;     AM35x                             
    &lt;*&gt;     TI81XX                            
            TI816X usb connector's ID pin control (from software setting)  ---&gt;   
            Driver Mode (USB Host)  ---&gt;                                        
    [ ]   Disable DMA (always use PIO)                                     
    [*]   Enable debugging messages   
</pre>
<ul><li>To enable musb driver in PIO mode, select</li></ul>
<pre> [*] Disable DMA (always use PIO)
</pre>
<ul><li>To enable musb driver in DMA mode, unselect</li></ul>
<pre> [ ] Disable DMA (always use PIO)
</pre>
<p>Note: for DM816X you need to select usb-id pin configuration as mentioned in <a rel="nofollow" class="external text" href="Usbgeneralpage.html#USB-ID_pin_configuration_selection_for_DM816X">usb-id configuration section</a>.
</p>
<h4><span class="mw-headline" id="USB-ID_pin_configuration_selection_for_TI81XX"><b>USB-ID pin configuration selection for TI81XX</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=10" title="Edit section: USB-ID pin configuration selection for TI81XX">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>The DM816X silicon includes the USB-ID configuration changes, where USB-ID can be controlled only through
</p>
<ol><li>software controlled</li></ol>
<p>To select software controlled USB-ID configuration (applicable for TI816X and TI814x PG1.x revision only)
</p>
<pre>   Menuconfig-&gt;Device Drviers-&gt;USB Support
           .....
          &lt;*&gt;   Inventra Highspeed Dual Role Controller (TI, ADI, ...)  
                       *** Platform Glue Layer *** 
          &lt; &gt;     TUSB6010                                                           
          &lt; &gt;     OMAP2430 and onwards                                               
          &lt; &gt;     AM35x                                                             
          &lt;*&gt;     TI81XX                                                            
                  TI816X usb connector's ID pin control (<b>from software setting</b>)  ---&gt; 
</pre>
<p>To select USB-ID configuration from external connector (<b>applicable for TI814X PG2.x/TI811X</b>)
</p>
<pre>   Menuconfig-&gt;Device Drviers-&gt;USB Support
           .....
          &lt;*&gt;   Inventra Highspeed Dual Role Controller (TI, ADI, ...)  
                       *** Platform Glue Layer *** 
          &lt; &gt;     TUSB6010                                                           
          &lt; &gt;     OMAP2430 and onwards                                               
          &lt; &gt;     AM35x                                                             
          &lt;*&gt;     TI81XX                                                            
                  TI816X usb connector's ID pin control (<b>from usb connector</b>)  ---&gt;
</pre>
<h3><span id="OMAP35x/AM35x/AM37x/AM45x"></span><span class="mw-headline" id="OMAP35x.2FAM35x.2FAM37x.2FAM45x"><b> OMAP35x/AM35x/AM37x/AM45x </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=11" title="Edit section: OMAP35x/AM35x/AM37x/AM45x">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<h4><span class="mw-headline" id="MUSB_OTG_Host_Configuration_2"><b> MUSB OTG Host Configuration </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=12" title="Edit section: MUSB OTG Host Configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<pre> Device Drivers ---&gt;
 USB support ---&gt;
 &lt;*&gt; Support for Host-side USB
     *** Miscellaneous USB options ***
 [*] USB device filesystem
 [*] USB device class-devices (DEPRECATED)
     *** USB Host Controller Drivers ***
 &lt;*&gt; Inventra Highspeed Dual Role Controller (TI, ADI, ...)
           *** Platform Glue Layer ***
 &lt;&gt;     TUSB6010
 &lt;*&gt;     OMAP2430 and onwards
 &lt;&gt;     AM35x  
           Driver Mode (USB Host) ---&gt;
 [ ] Disable DMA (always use PIO)
 [*] Use System DMA for Mentor DMA workaround 
 [*] Enable debugging messages
</pre>
<ul><li>Please enable "Use System DMA for Mentor DMA workaround" on OMAP35x/AM37x as a workaround to Mentor DMA issues.</li>
<li>Select AM35x for AM35x based platforms</li></ul>
<pre> [ ] TUSB6010
 [ ] OMAP2430 and onwards
 [*] AM35x
</pre>
<ul><li>To enable musb driver in PIO mode, select</li></ul>
<pre> [*] Disable DMA (always use PIO)
</pre>
<ul><li>To enable musb driver in DMA mode, unselect</li></ul>
<pre> [ ] Disable DMA (always use PIO)
</pre>
<h4><span id="EHCI_Configuration_(Not_supported_for_TI81XX/TI811X)"></span><span class="mw-headline" id="EHCI_Configuration_.28Not_supported_for_TI81XX.2FTI811X.29"><b> EHCI Configuration (Not supported for TI81XX/TI811X)</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=13" title="Edit section: EHCI Configuration (Not supported for TI81XX/TI811X)">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<pre> Device Drivers ---&gt;
 USB support ---&gt;
 &lt;*&gt; Support for Host-side USB
     *** Miscellaneous USB options ***
 [*] USB device filesystem
 [*] USB device class-devices (DEPRECATED)
 &lt;*&gt; EHCI HCD (USB2.0) Support
 [ ] Root hub transaction translators
 [*] Improved Transaction Translator scheduling
     *** USB Host Controller Drivers ***
</pre>
<h2><span class="mw-headline" id="MUSB_controller_in_gadget_mode"><b> MUSB controller in gadget mode </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=14" title="Edit section: MUSB controller in gadget mode">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h3><span id="TI81XX/TI811X_2"></span><span class="mw-headline" id="TI81XX.2FTI811X_2"><b> TI81XX/TI811X </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=15" title="Edit section: TI81XX/TI811X">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>In USB Gadget only configuration, only the usb0 port of TI816x/TI814x/TI813x/TI811x is configured for USB Gadget/Device Mode, usb1 port is unused. To enable each port as device/host mode, then you need to chose OTG configuration please refer <a rel="nofollow" class="external text" href="Usbgeneralpage.html#One_port_as_host_and_other_port_as_Gadget_.28for_DM81XX.29">here</a>.
</p><p>Note: For TI816X you need to select usb-id pin configuration as mentioned in <a rel="nofollow" class="external text" href="Usbgeneralpage.html#USB-ID_pin_configuration_selection_for_DM816X">usb-id configuration section</a>.
</p>
<h4><span class="mw-headline" id="Configuration"><b> Configuration </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=16" title="Edit section: Configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<pre> Device Drivers ---&gt;
 USB support ---&gt;
       &lt; &gt; Support for Host-side USB
       &lt;*&gt; Inventra Highspeed Dual Role Controller (TI, ADI, ...)
           *** Platform Glue Layer *** 
       &lt; &gt; TUSB6010
       &lt; &gt; OMAP2430 and onwards 
       &lt; &gt; AM35x 
       &lt;*&gt; TI81XX 
              Driver Mode (USB Peripheral (gadget stack))  ---&gt;
       [ ] Disable DMA (always use PIO)
       [*] Enable debugging messages
               *** NOTE: USB_STORAGE depends on SCSI but BLK_DEV_SD may ***
       &lt;*&gt; USB Gadget Support  ---&gt;
             *** OTG and related infrastructure ***
       &lt; &gt; GPIO based peripheral-only VBUS sensing 'transceiver'
       [ ] Generic ULPI Transceiver Driver
       -*- NOP USB Transceiver Driver 
</pre>
<p>Note: When Inventra HDRC is selected as USB peripheral controller, then must select the Inventra HDRC in "USB Gadget support page" as show below. 
</p>
<pre>--- USB Gadget Support          
      [ ]   Debugging messages (DEVELOPMENT) (NEW) 
      [ ]   Debugging information files (DEVELOPMENT) (NEW) 
      [ ]   Debugging information files in debugfs (DEVELOPMENT) (NEW) 
      (2)   Maximum VBUS Power usage (2-500 mA) (NEW)         
          USB Peripheral Controller (Inventra HDRC USB Peripheral (TI, ADI, ...))  ---&gt;
</pre>
<p>For Gadget RNDIS Mode configuration
</p>
<pre>       --- USB Gadget Support
            USB Peripheral Controller (Inventra HDRC USB Peripheral (TI, ADI, ...))  ---&gt;
       &lt;*&gt;   USB Gadget Drivers (Ethernet Gadget (with CDC Ethernet support))  ---&gt;
             Ethernet Gadget (with CDC Ethernet support) (NEW)
       [*]       RNDIS support (NEW)
</pre>
<p>For Gadget FileStorage configuration
</p>
<pre>       --- USB Gadget Support
            USB Peripheral Controller (Inventra HDRC USB Peripheral (TI, ADI, ...))  ---&gt;
       &lt;M&gt; USB Gadget Drivers
       &lt;M&gt; File-backed Storage Gadget
       [*] File-backed Storage Gadget testing version
</pre>
<p>Note: when the gadget driver built as modules, the usb gadget driver module are available at /drivers/usb/gadget directory and you need to insert the gadget driver after kernel is booted.
</p><p>Please make sure that Inventra HDRC is selected as USB peripheral controller which will appear only when "USB Peripheral (gadget stack)" is selected in driver mode as shown below so after selecting Gadget Support go back to driver mode option to select "USB Peripheral (gadget stack)" and then come back again to select Inventra HDRC as USB peripheral controller.
</p>
<pre> --- USB Gadget Support                                           
       [ ] Debugging messages (DEVELOPMENT)
       [ ] Debugging information files (DEVELOPMENT)
       [ ] Debugging information files in debugfs (DEVELOPMENT)
             (2)   Maximum VBUS Power usage (2-500 mA) 
             USB Peripheral Controller (Inventra HDRC USB Peripheral (TI, ADI, ...))  ---&gt;
       &lt;M&gt; USB Gadget Drivers
       &lt;M&gt; Gadget Zero (DEVELOPMENT)
       [*] HNP Test Device  
       &lt; &gt; Audio Gadget (EXPERIMENTAL)
       &lt;M&gt; Ethernet Gadget (with CDC Ethernet support)
       [*] RNDIS support
</pre>
<h3><span id="OMAP35x/AM35x/AM37x/AM45x_2"></span><span class="mw-headline" id="OMAP35x.2FAM35x.2FAM37x.2FAM45x_2"><b> OMAP35x/AM35x/AM37x/AM45x </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=17" title="Edit section: OMAP35x/AM35x/AM37x/AM45x">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Please do not disable support for host side usb as this will disable EHCI host interface also. Gadget option in driver mode will appear only when gadget support is also selected. Please enable gadget support as given below.
</p>
<pre> Device Drivers ---&gt;
 USB support ---&gt;
   &lt;*&gt; USB Gadget Support ---&gt;
       [ ] Debugging messages (DEVELOPMENT)
       [ ] Debugging information files (DEVELOPMENT)
       [ ]   Debugging information files in debugfs (DEVELOPMENT)
       (2) Maximum VBUS power usage (2-500mA) NEW
   USB Peripheral Controller (Inventra HDRC Peripheral(TI,ADI, ...)) ---&gt;
   &lt;M&gt; USB Gadget Drivers
   &lt;M&gt; File-backed Storage Gadget
</pre>
<p>Please make sure that Inventra HDRC is selected as USB peripheral controller which will appear only when "USB Peripheral (gadget stack)" is selected in driver mode as shown below so after selecting Gadget Support go back to driver mode option to select "USB Peripheral (gadget stack)" and then come back again to select Inventra HDRC as USB peripheral controller.
</p>
<pre> Device Drivers ---&gt;
 USB support ---&gt;
 &lt;*&gt; Support for Host-side USB
     *** Miscellaneous USB options ***
 [*] USB device filesystem
 [*] USB device class-devices (DEPRECATED)
     *** USB Host Controller Drivers ***
 &lt;*&gt; Inventra Highspeed Dual Role Controller (TI, ADI, ...)
           **** Platform Glue Layer ***
 &lt;&gt;     TUSB6010
 &lt;*&gt;     OMAP2430 and onwards
 &lt;&gt;     AM35x  
           Driver Mode (USB Peripheral (gadget stack)) ---&gt;
 [ ] Disable DMA (always use PIO)
 [*] Use System DMA for Mentor DMA workaround
 [*] Enable debugging messages
</pre>
<h2><span class="mw-headline" id="MUSB_OTG_controller_in_OTG_mode"><b> MUSB OTG controller in OTG mode </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=18" title="Edit section: MUSB OTG controller in OTG mode">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h3><span id="TI81XX/TI811X_3"></span><span class="mw-headline" id="TI81XX.2FTI811X_3"><b> TI81XX/TI811X </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=19" title="Edit section: TI81XX/TI811X">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>OTG not supported.
</p>
<h3><span id="OMAP35x/AM35x/AM37x/AM45x_3"></span><span class="mw-headline" id="OMAP35x.2FAM35x.2FAM37x.2FAM45x_3"><b> OMAP35x/AM35x/AM37x/AM45x </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=20" title="Edit section: OMAP35x/AM35x/AM37x/AM45x">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<h4><span class="mw-headline" id="OTG_Configuration"><b> OTG Configuration </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=21" title="Edit section: OTG Configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Both Host and Gadget driver should be selected for OTG support.If gadget driver is built as module then the host side module will be initialized only after gadget module is inserted after bootup.
</p><p>If "Rely on targeted peripheral list" is also selected then make sure to update <code>drivers/usb/core/otg_whitelist.h</code> with the desired
supported device class identification ids.
</p><p>OTG option in driver mode will appear only when gadget support is also selected.Please enable gadget support as given below.
</p>
<pre>  Device Drivers ---&gt;
  USB support ---&gt;
   &lt;*&gt; USB Gadget Support ---&gt;
       [ ] Debugging messages (DEVELOPMENT)
       [ ] Debugging information files (DEVELOPMENT)
       [ ]   Debugging information files in debugfs (DEVELOPMENT)
       (2) Maximum VBUS power usage (2-500mA) NEW
   USB Peripheral Controller (Inventra HDRC Peripheral(TI,ADI, ...)) ---&gt;
   &lt;M&gt; USB Gadget Drivers
   &lt;M&gt; File-backed Storage Gadget
</pre>
<p>Please make sure that Inventra HDRC is selected as USB peripheral controller which will appear only when OTG is selected as below.
</p>
<pre> Device Drivers ---&gt;
 USB support ---&gt;
 &lt;*&gt; Support for Host-side USB
     *** Miscellaneous USB options ***
 [*] USB device filesystem
 [*] USB device class-devices (DEPRECATED)
     *** USB Host Controller Drivers ***
 &lt;*&gt; Inventra Highspeed Dual Role Controller (TI, ADI, ...)
           **** Platform Glue Layer ***
 &lt;&gt;     TUSB6010
 &lt;*&gt;     OMAP2430 and onwards
 &lt;&gt;     AM35x  
           Driver Mode (Both Host and peripheral&#160;: USB OTG (On The Go) Device) ---&gt;
 [ ] Disable DMA (always use PIO)
 [*] Use System DMA for Mentor DMA workaround
 [*] Enable debugging messages
</pre>
<h2><span class="mw-headline" id="Host_mode_applications"><b> Host mode applications </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=22" title="Edit section: Host mode applications">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h3><span class="mw-headline" id="Mass_Storage_Driver"><b> Mass Storage Driver </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=23" title="Edit section: Mass Storage Driver">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>This figure illustrates the stack diagram of the system with USB Mass Storage class.
</p>
<div class="center"><div class="floatnone"><a href="File_Usb-msc.html" class="image" title="Illustration of Mass Storage Class"><img alt="Illustration of Mass Storage Class" src="https://processors.wiki.ti.com/images/5/51/Usb-msc.png" width="482" height="602" /></a></div></div>
<h4><span class="mw-headline" id="USB_Controller_and_USB_MSC_HOST"><b> USB Controller and USB MSC HOST </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=24" title="Edit section: USB Controller and USB MSC HOST">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<h4><span class="mw-headline" id="Configuration_2"><b> Configuration </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=25" title="Edit section: Configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<pre>    Device Drivers ---&gt;
    SCSI device support ---&gt;
     &lt;*&gt; SCSI device support
     [*] legacy /proc/scsi/support
     --- SCSI support type (disk, tape, CD-ROM)
     &lt;*&gt; SCSI disk support
    USB support ---&gt;
     &lt;*&gt; Support for Host-side USB
     [...] 
      --- USB Device Class drivers
      &lt;*&gt; USB Mass Storage support
</pre>
<h4><span class="mw-headline" id="Device_nodes"><b> Device nodes </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=26" title="Edit section: Device nodes">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>The SCSI sub system creates /dev/sd* devices with help of mdev. For example when USB stick or HDD is inserted /dev/sda1 will be created. Use fdisk utility to create a partition, mkfs.&lt;vfat/ext2&gt; to format the device with vfat/ext2 file system, use mount command for mounting the usb mass storage device.
</p>
<h3><span class="mw-headline" id="USB_HID_Class"><b> USB HID Class </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=27" title="Edit section: USB HID Class">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>USB Mouse and Keyboards that conform to the USB HID specifications are supported.
</p>
<div class="center"><div class="floatnone"><a href="File_Usb-hid.html" class="image" title="Illustration of of HID Class"><img alt="Illustration of of HID Class" src="https://processors.wiki.ti.com/images/1/12/Usb-hid.png" width="482" height="602" /></a></div></div>
<h4><span class="mw-headline" id="USB_Controller_and_USB_HID"><b> USB Controller and USB HID </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=28" title="Edit section: USB Controller and USB HID">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<h4><span class="mw-headline" id="Configuration_3"><b> Configuration </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=29" title="Edit section: Configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<pre>    Device Drivers ---&gt;
    HID Devices ---&gt;
     &lt;*&gt; Generic HID Support
               *** USB Input Devices ***
     &lt;*&gt; USB Human Interface Device(full HID) support
</pre>
<h4><span class="mw-headline" id="Device_nodes_2"><b> Device nodes </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=30" title="Edit section: Device nodes">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>The event sub system creates /dev/input/event* devices with the help of mdev. When mouse or keyboard is connected the device nodes with /dev/input/event[0/1/2..] will be created. The HID events can be captured with <a href="File_Evtest.html" title="File:Evtest.zip">File:Evtest.zip</a> application. Usage: ./evtest /dev/input/event*
</p>
<h3><span class="mw-headline" id="USB_Audio"><b> USB Audio </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=31" title="Edit section: USB Audio">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The image below shows the USB stack architecture with USB Audio/Video class.
</p>
<div class="center"><div class="floatnone"><a href="File_Usb-iso.html" class="image" title="Illustration of USB ISOC Class driver"><img alt="Illustration of USB ISOC Class driver" src="https://processors.wiki.ti.com/images/f/fa/Usb-iso.png" width="482" height="502" /></a></div></div>
<h4><span class="mw-headline" id="Configuration_4"><b> Configuration </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=32" title="Edit section: Configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<pre>   Device Drivers ---&gt;
   Sound card support---&gt;
    &lt;*&gt; Sound card support
      Advanced Linux Sound Architecture ---&gt;
      &lt;*&gt; Advanced Linux Sound Architecture
         [*] USB sound devices ---&gt;
         &lt;*&gt; USB Audio/MIDI driver
</pre>
<h4><span class="mw-headline" id="Resources"><b> Resources </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=33" title="Edit section: Resources">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>For testing USB Audio support we need any ALSA compliant audio player/capture application. Kindly read the Audio driver section to get more inputs on this.
</p><p>arecord and aplay tools can be used for record and playing audio stream to/from usb audio devices.
</p><p>To list the audio output (speaker) devices available use
</p>
<pre>  #aplay -l
</pre>
<p>For playing audio on usb audio speaker.
</p>
<pre>  #aplay -D "hw:0,0" -f S16_LE -r 11025 &lt;samplefile.wav&gt;
</pre>
<p>To list the audio input (mike) devices available use
</p>
<pre>  #arecord -l
</pre>
<p>For recording audio from usb audio input/mike device.
</p>
<pre>  #arecord -D "hw:0,0" -f S16_LE -r 16000 &lt;samplefile.wav&gt;
</pre>
<pre>  Note: use the appropriate device number "hw:0,0" or "hw:1,0" or "hw:2,0", use "aplay -l" or "arecord -l" to get list of available audio devices/
</pre>
<h3><span class="mw-headline" id="USB_Video"><b> USB Video </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=34" title="Edit section: USB Video">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<h4><span class="mw-headline" id="Configuration_5"><b> Configuration </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=35" title="Edit section: Configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<pre>  Device Drivers ---&gt;
    Multimedia support ---&gt;
          *** Multimedia core support ***
      &lt;*&gt; Video for Linux
      [*] Enable Video For Linux API 1 (DEPRECATED)
      [*] V4L2 sub-device userspace API (EXPERIMENTAL)
          *** Multimedia Drivers ***
      [*] Video capture adapters ---&gt;
          [*] V4L USB devices ---&gt;
              &lt;*&gt; USB Video Class (UVC)
               [*]     UVC input events device support
</pre>
<h4><span class="mw-headline" id="Resources_2"><b> Resources </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=36" title="Edit section: Resources">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>For testing USB Video support we need a user level application like "mplayer" to stream video from an USB camera.
If you are using mplayer as the capture application, then you must export the DISPLAY to a X server. Then, execute the following command:
</p>
<pre> $ mplayer tv:// -tv driver=v4l2:width=320:height=240
</pre>
<p>You can use the <a rel="nofollow" class="external text" href="http://git.ideasonboard.org/?p=yavta.git;a=summary">yavta</a> tool to capture frames from USB webcam. Please check if the tool is already available in the filesystem provided with your SDK before proceeding to building it yourself. For example:
</p>
<pre> $ yavta -n30 -c300 -s 640x480 -f mjpeg -F /dev/video2
</pre>
<p>To view the frames capture by yavta on the host, you can use gstreamer.
</p>
<pre> # gst-launch-1.0 multifilesrc location=frame-%06d.bin index=0 stop-index=300&#160;! jpegdec&#160;! videoconvert&#160;! autovideosink
</pre>
<h3><span class="mw-headline" id="USB_CDC-HOST"><b> USB CDC-HOST </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=37" title="Edit section: USB CDC-HOST">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The CDC-Host configuration will enable the CDC-ACM host class driver, which support network communication devices like USB modems.
</p>
<h4><span class="mw-headline" id="Configuration_6"><b> Configuration </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=38" title="Edit section: Configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Select usb host configuration through menuconfig as explained in <a rel="nofollow" class="external text" href="Usbgeneralpage.html#USB_controller_in_host_mode">host configuration section</a> and select CDC ACM support as mentioned below.
</p>
<pre>  Device Drivers ---&gt;
  USB support ---&gt;
       &lt;*&gt;   Support for Host-side USB 
       ....
       *** USB Device Class drivers ***                                     
         &lt;*&gt; USB Modem (CDC ACM) support               
         &lt; &gt; USB Printer support                       
         &lt; &gt; USB Wireless Device Management support    
         &lt; &gt; USB Test and Measurement Class support
</pre>
<pre>  Device Drivers ---&gt;
    Network device supports  ---&gt; 
      USB Network Adapters  ---&gt; 
        &lt;*&gt; Multi-purpose USB Networking Framework                                                     
        &lt; &gt;   ASIX AX88xxx Based USB 2.0 Ethernet Adapters                
        &lt;*&gt;   CDC Ethernet support (smart devices such as cable modems)   
        &lt; &gt;   CDC EEM support
</pre>
<h4><span class="mw-headline" id="Resources_3"><b> Resources </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=39" title="Edit section: Resources">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>The test setup includes connnecting the two EVMs, EVM-1 is configured in host mode (enabling CDC-host configuration as explained above) and EVM-2 is configured in CDC-device mode configuration (refer <a rel="nofollow" class="external text" href="Usbgeneralpage.html#CDC.2FRNDIS_gadget">cdc-configuration</a>). Connect EVM-2 (CDC-device act as CDC-modem) to EVM-1 (CDC-Host), the EVM-1 CDC-Host will rececognize the EVM-2 as usb-modem and creates the new <b>usbx</b> network interface. 
</p><p>on EVM-2 (CDC-Device)
</p>
<pre> #ifconfig usb0 192.168.0.3 up
</pre>
<p>on EVM-1 (CDC-Host): A new interface say usb0 or usb1 will be created.
</p>
<pre> #ifconfig usbx 192.168.0.5 up
</pre>
<p>perform the ping from EVM-1 to EVM-2 (vice-versa).
</p>
<h2><span class="mw-headline" id="Gadget_Mode_Applications"><b> Gadget Mode Applications </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=40" title="Edit section: Gadget Mode Applications">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h3><span class="mw-headline" id="Mass_Storage_Gadget"><b> Mass Storage Gadget </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=41" title="Edit section: Mass Storage Gadget">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<div class="center"><div class="floatnone"><a href="File_Usb-gadget.html" class="image" title="Illustration of Mass Storage Gadget driver"><img alt="Illustration of Mass Storage Gadget driver" src="https://processors.wiki.ti.com/images/c/c8/Usb-gadget.png" width="482" height="382" /></a></div></div>
<h4><span class="mw-headline" id="Configuration_7"><b> Configuration </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=42" title="Edit section: Configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>1. Select USB Gadget support<br />
</p>
<pre>  Device Drivers ---&gt;
  USB support ---&gt;
  &lt; &gt;   Support for Host-side USB 
    *** Enable Host or Gadget support to see Inventra options ***
    *** NOTE: USB_STORAGE depends on SCSI but BLK_DEV_SD may ***
  &lt;*&gt;   USB Gadget Support  ---&gt; 
   *** OTG and related infrastructure ***
    
</pre>
<p>2. Select device/gadget controller support<br />
</p>
<pre>&lt; &gt;   Support for Host-side USB
   &lt;*&gt;   Inventra Highspeed Dual Role Controller (TI, ADI, ...)
        *** Platform Glue Layer ***  
   &lt; &gt;     TUSB6010            
   &lt; &gt;     OMAP2430 and onwards
   &lt; &gt;     AM35x            
   &lt;*&gt;     TI81XX     
   TI81XX usb connector's ID pin control (from software setting)  ---&gt; 
       Driver Mode (USB Peripheral (gadget stack))  ---&gt; 
  [ ]   Disable DMA (always use PIO)  
  [*]   Enable debugging messages  
   *** NOTE: USB_STORAGE depends on SCSI but BLK_DEV_SD may *** 
  &lt;*&gt;   USB Gadget Support  ---&gt;   
       *** OTG and related infrastructure ***   
</pre>
<p>3. Select gadget driver, also select USB Peripheral controller  <br />
</p>
<pre>  Device Drivers ---&gt;
  USB support ---&gt;
  USB Gadget Support ---&gt;
  [ ]   Debugging messages (DEVELOPMENT) 
  [ ]   Debugging information files (DEVELOPMENT)
  [ ]   Debugging information files in debugfs (DEVELOPMENT)
      (2)   Maximum VBUS Power usage (2-500 mA
  <b>USB Peripheral Controller (Inventra HDRC USB Peripheral (TI, ADI, ...))  ---&gt;</b>
  &lt; &gt;   GPIO based peripheral-only VBUS sensing 'transceiver'
  [ ]   Generic ULPI Transceiver Driver  
     -*-   NOP USB Transceiver Driver
  &lt;M&gt;   USB Gadget Drivers       
  &lt; &gt; Gadget Zero (DEVELOPMENT)  
  &lt; &gt;     Audio Gadget (EXPERIMENTAL)
  &lt; &gt;     Ethernet Gadget (with CDC Ethernet support)
  &lt; &gt;     Gadget Filesystem (EXPERIMENTAL)       
  &lt; &gt;     Function Filesystem (EXPERIMENTAL) 
  &lt;M&gt;     File-backed Storage Gadget    
  [*]       File-backed Storage Gadget testing version
  &lt;M&gt;     Mass Storage Gadget
</pre>
<h4><span class="mw-headline" id="Installation_of_File_Storage_Gadget_Driver"><b> Installation of File Storage Gadget Driver </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=43" title="Edit section: Installation of File Storage Gadget Driver">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Let us assume that we are interested in exposing /dev/mmcblk0 block device to the file storage gadget device to host (windows/linux). To that effect we need to issue the following command to load the file storage gadget driver. The module parameter <b>buflen</b> can be used set buffersize of the gadget driver for better performance, please refer to /driver/usb/gadget/file_storage.c for more information on module parameters. 
</p>
<pre> example
 #insmod &lt;g_file_storage.ko&gt; file=/dev/sda1 buflen=65536 stall=0 removable=1
 #insmod &lt;g_file_storage.ko&gt; file=/dev/mmcblk0 stall=0 removable=1
</pre>
<h3><span id="CDC/RNDIS_gadget"></span><span class="mw-headline" id="CDC.2FRNDIS_gadget"><b> CDC/RNDIS gadget </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=44" title="Edit section: CDC/RNDIS gadget">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The CDC/RNDIS gadget driver that is used to send standard Ethernet frames using USB.<br /> 
<b>For OMAP35x</b>&#160;: Please enable "Use System DMA for Rx endpoints" to fix the flood ping hang issue with packet size of more than 16KB on OMAP35x due to Mentor DMA lockup issue.
</p><p>The image below shows the USB stack architecture with CDC/RNDIS gadget.
</p>
<div class="center"><div class="floatnone"><a href="File_Usb-cdc.html" class="image" title="Illustration of CDC/RNDIS gadget driver"><img alt="Illustration of CDC/RNDIS gadget driver" src="https://processors.wiki.ti.com/images/f/f2/Usb-cdc.png" width="482" height="382" /></a></div></div>
<h4><span id="Configuration_for_USB_controller_and_CDC/RNDIS_Gadget"></span><span class="mw-headline" id="Configuration_for_USB_controller_and_CDC.2FRNDIS_Gadget"><b> Configuration for USB controller and CDC/RNDIS Gadget </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=45" title="Edit section: Configuration for USB controller and CDC/RNDIS Gadget">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<pre>1. Select USB Gadget support<br />
  Device Drivers ---&gt;
  USB support ---&gt;
  &lt; &gt;   Support for Host-side USB 
    *** Enable Host or Gadget support to see Inventra options ***
    *** NOTE: USB_STORAGE depends on SCSI but BLK_DEV_SD may ***
  &lt;*&gt;   USB Gadget Support  ---&gt; 
   *** OTG and related infrastructure ***
    
</pre>
<p>2. Select device/gadget controller support<br />
</p>
<pre>&lt; &gt;   Support for Host-side USB
   &lt;*&gt;   Inventra Highspeed Dual Role Controller (TI, ADI, ...)
        *** Platform Glue Layer ***  
   &lt; &gt;     TUSB6010            
   &lt; &gt;     OMAP2430 and onwards
   &lt; &gt;     AM35x            
   &lt;*&gt;     TI81XX     
   TI81XX usb connector's ID pin control (from software setting)  ---&gt; 
       Driver Mode (USB Peripheral (gadget stack))  ---&gt; 
  [ ]   Disable DMA (always use PIO)  
  [*]   Enable debugging messages  
   *** NOTE: USB_STORAGE depends on SCSI but BLK_DEV_SD may *** 
  &lt;*&gt;   USB Gadget Support  ---&gt;   
       *** OTG and related infrastructure ***   
</pre>
<p>3. Select cdc/rndis gadget driver,select 'M' to build gadget as module and '*' for builtin. Also select USB Peripheral controller. <br />
</p>
<pre>  Device Drivers ---&gt;
  USB support ---&gt;
  USB Gadget Support ---&gt;
  [ ]   Debugging messages (DEVELOPMENT) 
  [ ]   Debugging information files (DEVELOPMENT)
  [ ]   Debugging information files in debugfs (DEVELOPMENT)
      (2)   Maximum VBUS Power usage (2-500 mA
  <b>USB Peripheral Controller (Inventra HDRC USB Peripheral (TI, ADI, ...))  ---&gt;</b>
 <b>&lt;M&gt;   USB Gadget Drivers (Ethernet Gadget (with CDC Ethernet support))  ---&gt;</b>
        Ethernet Gadget (with CDC Ethernet support)                           
  <b>[*]       RNDIS support</b>                                                     
  [ ]       Ethernet Emulation Model (EEM) support
</pre>
<p>Please do not select RNDIS support for testing ethernet gadget with Linux 2.4, IXIA and MACOS host machine.
</p>
<h4><span id="Installation_of_CDC/RNDIS_Gadget_Driver"></span><span class="mw-headline" id="Installation_of_CDC.2FRNDIS_Gadget_Driver"><b> Installation of CDC/RNDIS Gadget Driver </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=46" title="Edit section: Installation of CDC/RNDIS Gadget Driver">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Inserting the CDC/RNDIS gadget driver as module is as follows:
</p>
<pre> $ insmod  &lt;path to g_ether.ko&gt;
</pre>
<h4><span class="mw-headline" id="Installing_driver_on_Windows_to_recognize_Linux_RNDIS_gadget">Installing driver on Windows to recognize Linux RNDIS gadget</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=47" title="Edit section: Installing driver on Windows to recognize Linux RNDIS gadget">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<ul><li>Download and save linux.inf file to windows host. The file is available in Linux Kernel source under <tt>Documentation/usb/linux.inf</tt></li>
<li>Plug in the device to windows host.</li>
<li>Open Device Manager and look for the newly recognized USB serial COM port. Right click and choose Update Driver Software</li></ul>
<p><br />
<a href="File_Rndis1.html" class="image"><img alt="Rndis1.PNG" src="https://processors.wiki.ti.com/images/f/f2/Rndis1.PNG" width="300" height="105" /></a>
<br />
</p>
<ul><li>Follow the steps in below screen shots</li></ul>
<p><br />
<a href="File_Rndis2.html" class="image"><img alt="Rndis2.PNG" src="https://processors.wiki.ti.com/images/b/b7/Rndis2.PNG" width="300" height="217" /></a> &#160;&#160;&#160;<a href="File_Rndis3.html" class="image"><img alt="Rndis3.PNG" src="https://processors.wiki.ti.com/images/7/74/Rndis3.PNG" width="300" height="221" /></a> &#160;&#160;&#160;<a href="File_Rndis4.html" class="image"><img alt="Rndis4.PNG" src="https://processors.wiki.ti.com/images/a/ae/Rndis4.PNG" width="300" height="223" /></a>
<br />
</p>
<ul><li>Browse to the <tt>linux.inf</tt> file and click on OK.</li></ul>
<p><br />
<a href="File_Rndis5.html" class="image"><img alt="Rndis5.PNG" src="https://processors.wiki.ti.com/images/2/29/Rndis5.PNG" width="300" height="155" /></a>
<br />
</p>
<ul><li>You should see Linux RNDIS gadget recognized by Windows.</li></ul>
<p><br />
<a href="File_Rndis6.html" class="image"><img alt="Rndis6.PNG" src="https://processors.wiki.ti.com/images/d/d6/Rndis6.PNG" width="300" height="142" /></a>
<br />
<br />
</p>
<div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br /> On windows 10, installing unsigned driver is not permitted by default. Therefore, driver signature verification needs to be turned off. <a rel="nofollow" class="external text" href="https://answers.microsoft.com/en-us/insider/forum/insider_wintp-insider_devices/how-do-i-disable-driver-signature-enforcement-win/a53ec7ca-bdd3-4f39-a3af-3bd92336d248">See here.</a> </div>
<div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br /> On windows 10, a windows update might remove the untrusted drivers so you will have to re-install the driver in that case. </div>
<h4><span class="mw-headline" id="Setting_up_USBNet"><b> Setting up USBNet </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=48" title="Edit section: Setting up USBNet">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>The CDC/RNDIS Gadget driver will create a Ethernet device by the name usb0. You need to assign an IP address to the device and bring up the device. The typical command for that would be:
</p>
<pre> $ ifconfig usb0  &lt;IP_ADDR&gt; netmask 255.255.255.0 up
</pre>
<h3><span class="mw-headline" id="UVC_Webcam_Gadget"><b> UVC Webcam Gadget </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=49" title="Edit section: UVC Webcam Gadget">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<h4><span class="mw-headline" id="Kernel_Configuration"><b> Kernel Configuration </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=50" title="Edit section: Kernel Configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>1. Enable Multimedia and Camera/video grabbers support
</p>
<pre>  Device Drivers ---&gt;
  <b>&lt;M&gt; Multimedia support  ---&gt;</b>
     *** Multimedia core support ***
     <b>[*]   Cameras/video grabbers support</b>
</pre>
<p>2. Enable USB Gadget and Webcam Gadget support<br />
</p>
<pre>  Device Drivers ---&gt;
  USB support ---&gt;
  <b>&lt;M&gt;   USB Gadget Support  ---&gt;</b>
     <b>&lt;M&gt;     USB Webcam Gadget</b>
</pre>
<h4><span class="mw-headline" id="uvc-gadget_application"><b> uvc-gadget application </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=51" title="Edit section: uvc-gadget application">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>The g_webcam gadget provides a V4L2 /dev/videoX interface so that user space can pump camera captured data that needs to be sent over USB to the Host. For testing purposes we can use the uvc-gadget application. uvc-gadget should already be part of the filesystem distribution you received as part of the TI SDK release for your device. If not, to build this application from source, do the following on the target.
</p><p>1. git clone <a rel="nofollow" class="external free" href="git://git.ideasonboard.org/uvc-gadget.git">git://git.ideasonboard.org/uvc-gadget.git</a> <br />
2. Update uvc-gadget.c to point to the correct uvc.h location in your Kernel sources. E.g. #include "/usr/src/ti-linux-kernel/drivers/usb/gadget/function/uvc.h" <br />
3. make <br />
</p>
<h4><span class="mw-headline" id="Running_UVC_Gadget"><b> Running UVC Gadget </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=52" title="Edit section: Running UVC Gadget">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>On the Target
</p>
<pre>  &gt; modprobe g_webcam
  &gt;./uvc-gadget -d /dev/videoX
</pre>
<p>videoX might be video0 or video1 on your platform. It must match the video node that was created when g_webcam was loaded.
</p><p>On the Host
</p>
<pre>  luvcview -d /dev/videoY -f yuv
</pre>
<p>OR
</p>
<pre>  guvcview -d /dev/videoY -f yuv
</pre>
<p>videoY might be video0 or video1 on your host. It must match the video node that was created when the target's was connected to Host's USB port.
</p><p>On the host application you should see a scrolling test pattern like below <br />
</p><p><a href="File_Luvcview.html" class="image"><img alt="Luvcview.jpg" src="https://processors.wiki.ti.com/images/1/12/Luvcview.jpg" width="642" height="417" /></a>
</p>
<h4><span class="mw-headline" id="Testing_different_bandwidth_settings"><b> Testing different bandwidth settings </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=53" title="Edit section: Testing different bandwidth settings">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>g_webcam gadget uses an ISO endpoint to transfer the video stream to the host. This endpoint can have different settings to alter the bandwidth used by it.
The below module parameter options can be tweaked wile loading g_webcam.
</p>
<pre>  parm:           streaming_interval:1 - 16 (uint)
  parm:           streaming_maxpacket:1 - 1023 (FS), 1 - 3072 (hs/ss) (uint)
  parm:           streaming_maxburst:0 - 15 (ss only) (uint)
</pre>
<p><b>NOTE:</b> Not all combinations will work so be careful with these settings. Some known configurations are shown below.
</p>
<ul><li>High-Speed, high-bandwidth transfer test</li></ul>
<pre>  modprobe g_webcam streaming_maxpacket=3062 streaming_interval=1
</pre>
<ul><li>Super-Speed, burst transfer test</li></ul>
<pre>  modprobe g_webcam streaming_maxpacket=1024 streaming_maxburst=10
</pre>
<h1><span class="mw-headline" id="Modular_testing_on_MUSB"><b> Modular testing on MUSB </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=54" title="Edit section: Modular testing on MUSB">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>Mentor USB (MUSB) linux driver has been reorganized in v2.6.37 to support multi platform config. Modular structure has also changed due to this and thus now onward there will be below modules on MUSB
</p>
<pre>1. musb_hdrc.ko: The core controller module.
2. cppi30dma.ko, cppi41dma.ko or musbhsdma.ko: The dma controller module. 
3. ti81xx.ko, am35x.ko or omap2430.ko: The platform glue module.
4. g_file_storage.ko or g_ether.ko: The gadget controller module.
</pre>
<p>All the above four modules need to be inserted sequentially for an OTG (both host and device) configured or gadget only configured kernel. Fourth module (gadget controller) would not be needed in a host only config.
</p><p><br />
</p>
<h1><span id="One_port_as_host_and_other_port_as_Gadget_(for_TI81XX/TI813X)"></span><span class="mw-headline" id="One_port_as_host_and_other_port_as_Gadget_.28for_TI81XX.2FTI813X.29"><b>One port as host and other port as Gadget (for TI81XX/TI813X) </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=55" title="Edit section: One port as host and other port as Gadget (for TI81XX/TI813X)">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>The TI816X/TI814X/TI813X/TI811X has two mentor usb controller and hence each port usb0/usb1 can be configured in host or gadget mode. This feature will provide the user to configure the each port in host/gadget mode. 
</p><p>To configure the usb0/usb1 port to host/gadget mode, do the following steps 
</p><p><b>1) Select host and gadget support</b> 
</p>
<pre>   Menuconfig-&gt;Device Drviers-&gt;USB Support
          &lt;*&gt;   Support for Host-side USB  
          [ ]     USB verbose debug messages   
          [*]     USB announce new devices     
          *** Miscellaneous USB options ***   
          ......
          &lt;*&gt;   USB Gadget Support  ---&gt; 
</pre>
<p><b>2) Select USB OTG support (for TI814X/TI813X/TI811X)</b> 
</p>
<pre>   Menuconfig-&gt;Device Drviers-&gt;USB Support
          &lt;*&gt;   Inventra Highspeed Dual Role Controller (TI, ADI, ...)  
                       *** Platform Glue Layer *** 
          &lt; &gt;     TUSB6010                                                           
          &lt; &gt;     OMAP2430 and onwards                                               
          &lt; &gt;     AM35x                                                             
          &lt;*&gt;     TI81XX                                                            
                  TI816X usb connector's ID pin control (from usb connector)  ---&gt; 
                  <b><i>Driver Mode</i> (Both host and peripheral:  USB OTG (On The Go) Device)  ---&gt;</b>  
          [ ]   Disable DMA (always use PIO)                                          
          [*]   Enable debugging messages                                             
</pre>
<p><b>3) Select USB OTG support (for TI816X)</b> 
</p><p>For DM816X, you need to chose the USB-ID configuration through 1) software settings or 2)external connector. In case of software setting for each port usb0 or usb1 you need to configure the mode (Host or Device). You can chose 1) both port as host or 2)one port as host or other as device. 
</p>
<pre>   Menuconfig-&gt;Device Drviers-&gt;USB Support
          &lt;*&gt;   Inventra Highspeed Dual Role Controller (TI, ADI, ...)  
                       *** Platform Glue Layer *** 
          &lt; &gt;     TUSB6010                                                           
          &lt; &gt;     OMAP2430 and onwards                                               
          &lt; &gt;     AM35x                                                             
          &lt;*&gt;     TI81XX                                                            
                  <b>TI816X usb connector's ID pin control (from software setting)  ---&gt;</b> 
                            Force TI816X USB0 to  (Host mode)  ---&gt; 
                            Force TI816X USB1 to  (Host mode)  ---&gt;                 
                  <b><i>Driver Mode</i> (Both host and peripheral:  USB OTG (On The Go) Device)  ---&gt;</b>  
          [ ]   Disable DMA (always use PIO)                                          
          [*]   Enable debugging messages                                             
</pre>
<p><b>4) Select Gadget device controller and gadget driver as modules</b> 
</p>
<pre>   Menuconfig-&gt;Device Drviers-&gt;USB Support
          &lt;*&gt;   USB Gadget Support  ---&gt;
                --- USB Gadget Support                                
                [ ]   Debugging messages (DEVELOPMENT) (NEW)           
                [ ]   Debugging information files (DEVELOPMENT) (NEW)  
                [ ]   Debugging information files in debugfs (DEVELOPMENT) (NEW)
                (2)   Maximum VBUS Power usage (2-500 mA) (NEW)                 
                <b>USB Peripheral Controller (Inventra HDRC USB Peripheral (TI, ADI, ...))  ---&gt;</b>
               &lt;M&gt;   USB Gadget Drivers                                                          
               &lt;M&gt;     Gadget Zero (DEVELOPMENT)                                                 
               [ ]       HNP Test Device (NEW)                                                   
               &lt; &gt;     Audio Gadget (EXPERIMENTAL) (NEW)                                         
               &lt;M&gt;     Ethernet Gadget (with CDC Ethernet support)                               
               [*]       RNDIS support (NEW)                                                     
               [ ]       Ethernet Emulation Model (EEM) support (NEW)                            
               &lt; &gt;     Gadget Filesystem (EXPERIMENTAL) (NEW)                                    
               &lt; &gt;     Function Filesystem (EXPERIMENTAL) (NEW)                                  
               &lt;M&gt;     File-backed Storage Gadget                                                
               [*]       File-backed Storage Gadget testing version
</pre>
<p><b>5) Unselect the OTG Targeted Peripherals list</b> 
</p>
<pre>     Menuconfig-&gt;Device Drviers-&gt;USB Support
          &lt;*&gt;   Support for Host-side USB
                ....
               [*] USB runtime power management (autosuspend) and wakeup  
               -*- OTG support  
               <b>[ ]   Rely on OTG Targeted Peripherals List</b> 
               [ ]   Disable external hubs     
</pre>
<p><b>6) Build uImage and usb gadget modules </b> 
</p><p>Build the kernel image and the two usb gadget as modules (like g_ether.ko, g_file_storage.ko, g_mass_storage.ko or g_zero.ko ..etc). 
</p><p><b>7) Setup for TI81XX/TI814X</b> 
</p><p>If the board has mini-AB or micro-AB receptacle for usb0/usb1 port then 
</p>
<ul><li>To configure usb0/usb1 as host mode, connect mini/micro-A to A receptacle to usb0/usb1 port.</li>
<li>To configure usb0/usb1 as device mode, connect mini/micro-B to standard A cable.</li></ul>
<p>If the board has standard-A receptacle 
</p>
<ul><li>To configured usb0/usb1 as host mode , connect device directly or through HUB.</li>
<li>To configured usb0/usb1 as device mode , connect <b>Standard A to A USB cable</b>.</li></ul>
<p><b>8) Insert the two gadget modules</b> 
</p><p>Load the kernel image and Make sure above setup is done before insert the modules. Insert the gadget modules for usb0 port. 
</p>
<pre>   # insmod &lt;module&gt;.ko    (eg: #insert g_ether.ko)
</pre>
<p>Insert the gadget module for usb1 port. 
</p>
<pre>   # insmod &lt;module&gt;.ko    (eg: #insert g_file_storage.ko file=&lt;file path&gt; stall=0 buflen=65536)
</pre>
<p><b>Note: Please note that the usb port will be enabled only after inserting usb gadget module for port0/port1, depending on the cable type connected to each port, the first inserted gadget module will enable usb0 port for to host/device mode, the second inserted gadget module will enable the usb1 port to host/device mode.</b>
</p><p>In scenario where usb0 as mass-storage gadget mode and usb1 as host mode, and the use-case is to expose the usb flash drive or USB-HDD connected to usb1 port as mass-storage media through usb0 gadget port to windows/linux host. The workaround for this use-case could be
</p>
<ol><li>insmod g_ether.ko (usb0 port will be enabled as cdc/rndis gadget)</li>
<li>insmod g_zero.ko (usb1 port will enabled as host mode and all devices (eg.USB-HDD/flash drive etc) connected to this port will be enumerated</li>
<li>rmmod g_ether.ko (remove the gadget driver from usb0 port)</li>
<li>insmod g_file_storage.ko file=/dev/sda stall=0 buflen=65536 (or use g_mass_storage.ko)</li></ol>
<p>Now the usb0 port can be connected to window/linux host as mass storage gadget with USB-HDD (/dev/sda) as storage media.
</p>
<h1><span id="USB_EHCI_Electrical_testing_(Not_applicable_for_TI81XX/TI811X)"></span><span class="mw-headline" id="USB_EHCI_Electrical_testing_.28Not_applicable_for_TI81XX.2FTI811X.29"><b> USB EHCI Electrical testing (Not applicable for TI81XX/TI811X)</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=56" title="Edit section: USB EHCI Electrical testing (Not applicable for TI81XX/TI811X)">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>USB EHCI electrical test is supported in software. Please use below command to perform various electrical tests.
</p>
<pre> $ echo 'Options' &gt; sys/devices/platform/ehci-omap.0/portN
 Where 'options' can be,
 reset   --&gt; Reset Device
 t-j     --&gt; Send TEST_J on suspended port
 t-k     --&gt; Send TEST_K on suspended port
 t-pkt   --&gt; Send TEST_PACKET[53] on suspended port
 t-force --&gt; Send TEST_FORCE_ENABLE on suspended port
 t-se0   --&gt; Send TEST_SE0_NAK on suspended port
</pre>
<h1><span id="USB_OTG_(HNP/SRP)_testing_(Not_applicable_for_TI81XX/TI811X)"></span><span class="mw-headline" id="USB_OTG_.28HNP.2FSRP.29_testing_.28Not_applicable_for_TI81XX.2FTI811X.29"><b> USB OTG (HNP/SRP) testing (Not applicable for TI81XX/TI811X) </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=57" title="Edit section: USB OTG (HNP/SRP) testing (Not applicable for TI81XX/TI811X)">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>Please choose the configuration as described in driver configuration section for OTG and follow the steps below for testing.
</p>
<ul><li>1. Boot the OTG build image on two OMAP35x EVM.</li>
<li>2. If gadget driver is built as module then insert it to complete USB initialization.</li>
<li>3. Connect mini-A side of the OTG cable to one of the EVM (say EVM-1) and mini-B side on the other (say EVM-2).</li></ul>
<p>In this scenario EVM-1 will become initial host or A-device and EVM-2 will become initial device or B-device. A-device will provide bus power throughout the bus communication even if it becomes peripheral using HNP.
</p><p>There will not be any connect event at this point of time as Vbus power is not yet switched-on. Vbus power can be switched-on from A-device or from B-device using SRP.
</p>
<ul><li>4. Request to switch-on the Vbus power using below command on any EVM.</li></ul>
<pre> $ echo "F" &gt; /proc/driver/musb_hdrc
</pre>
<p>If this command is executed on B-device then SRP protocol will be used to request A-device to switch-on the Vbus power.
</p>
<ul><li>5. Now the connect event occurs, enumeration will complete and gadget driver on B-device will be ready to use if this driver is in "Targeted Peripheral List (TPL)" of A-device.</li></ul>
<p>If TPL is disabled on A-device then gadget driver will be ready to use soon after enumeration.
</p><p>If TPL is enabled and gadget driver of B-device is not in TPL list of A-device then there will be an automatic trial of HNP from usb core by suspending the bus. This will cause a role switch and B-device will enumerate A-device. Now the gadget driver of A-device will be configured if it is on the TPL list of B-device.
</p><p>Currently this is the only way possible for HNP testing but we have added a suspend proc entry to start HNP in other than this scenario.
</p>
<ul><li>6. Complete all the communication between A-device and B-device.</li>
<li>7. Start HNP by executing below command on host side.</li></ul>
<pre> $ echo "S" &gt; /proc/driver/musb_hdrc
</pre>
<p>It will suspend the bus and role-switch will follow after that.
</p>
<ul><li>8. Repeat step 4, 5, 6 and 7 for further testing.</li></ul>
<h1><span class="mw-headline" id="Software_Interface"><b> Software Interface </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=58" title="Edit section: Software Interface">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>The USB driver exposes its state/control through the sysfs and the procfs interfaces. The following sections talks about these.
</p>
<h2><span class="mw-headline" id="sysfs"><b> sysfs </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=59" title="Edit section: sysfs">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<table width="1200" border="1" cellpadding="1" cellspacing="1">

<tbody><tr>
<th align="left">sysfs attribute
</th>
<th align="left">Description
</th></tr>
<tr>
<td>mode
</td>
<td>The entry <code>/sys/devices/platform/musb_hdrc.0/mode</code> is a read-only entry. It will show the state of the OTG (though this feature is not supported) state machine. This will be true even if the driver has been compiled without OTG support. Only the states like A_HOST, B_PERIPHERAL,        that makes sense for non-OTG will show up.
</td></tr>
<tr>
<td>vbus
</td>
<td>The entry <code>/sys/devices/platform/musb_hdrc.0/vbus</code> is a write-only entry. It is used to set the VBUS timeout value during OTG. If the current OTG state is a_wait_bcon then urb submission is disabled.
</td></tr></tbody></table>
<h2><span class="mw-headline" id="procfs"><b> procfs </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=60" title="Edit section: procfs">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The procfs entry <code>/proc/driver/musb_hdrc</code> is used to control the driver behaviour as well as check the status of the driver.
</p>
<pre> In case of TI81XX/TI811X two nodes will be created for each controller /proc/driver/musb_hdrc.0 and /proc/driver/musb_hdrc.1 respectively.
</pre>
<ul><li>1. The following command will show the usage of this proc entry</li></ul>
<pre> # echo "?" &gt; /proc/driver/musb_hdrc.x 
</pre>
<ul><li>2. Specifically the most important usage of this entry would be to start an USB session(host mode) by issuing the following command:</li></ul>
<pre> # echo "F" &gt; /proc/driver/musb_hdrc.x
</pre>
<ul><li>3. To enable DEBUG message from musb driver, issue the following command:</li></ul>
<pre> # echo "D&lt;num&gt;" &gt; /proc/driver/musb_hdrc&#160;: &lt;num&gt; can be 1 to 8.
 Use dmesg to get dump of musb driver debug output
 # dmesg
</pre>
<pre> example (for two instances of musb controller)
 # echo D8 &gt; /proc/driver/musb_hdrc.0   //set debug_level 8 for musb contoller-0
 # echo D8 &gt; /proc/driver/musb_hdrc.1   //set debug_level 8 for musb contoller-1
 # dmesg                                //dump the debug prints on console
</pre>
<h2><span class="mw-headline" id="musb_driver_debugfs"><b> musb driver debugfs </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=61" title="Edit section: musb driver debugfs">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>To use the debugfs feature of kernel and musb, you need to enable the kernel debugfs option through menuconfig, as shown below
</p>
<pre>      Menuconfig-&gt;kernel hacking --&gt;
            [ ] Enable unused/obsolete exported symbols                                            
            [*] Debug Filesystem                                                                   
            [ ] Run 'make headers_check' when building vmlinux      
            [*] Kernel debugging               
</pre>
<h3><span id="mount_the_debug_file_system_(debugfs)"></span><span class="mw-headline" id="mount_the_debug_file_system_.28debugfs.29"><b>mount the debug file system (debugfs) </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=62" title="Edit section: mount the debug file system (debugfs)">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<pre>     #mount -t debugfs none /sys/kernel/debug/
</pre>
<h3><span class="mw-headline" id="musb_driver_TEST-MODE_debugfs_support"><b>musb driver TEST-MODE debugfs support</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=63" title="Edit section: musb driver TEST-MODE debugfs support">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Issue the following command 
</p>
<h4><span class="mw-headline" id="To_force_musb_to_host_mode">To force musb to host mode</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=64" title="Edit section: To force musb to host mode">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<pre>     #echo "force host" &gt; /sys/kernel/debug/testmode
</pre>
<h4><span class="mw-headline" id="To_force_musb_to_full-speed">To force musb to full-speed</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=65" title="Edit section: To force musb to full-speed">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<pre>     #echo "force full-speed" &gt; /sys/kernel/debug/testmode
</pre>
<h4><span class="mw-headline" id="To_force_musb_to_high-speed">To force musb to high-speed</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=66" title="Edit section: To force musb to high-speed">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<pre>     #echo "force high-speed" &gt; /sys/kernel/debug/testmode
</pre>
<h4><span class="mw-headline" id="To_send_test_packet">To send test packet</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=67" title="Edit section: To send test packet">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<pre>     #echo "test packet" &gt; /sys/kernel/debug/testmode
</pre>
<h4><span class="mw-headline" id="To_generate_test_K_pattern">To generate test K pattern</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=68" title="Edit section: To generate test K pattern">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<pre>     #echo "test K" &gt; /sys/kernel/debug/testmode
</pre>
<h4><span class="mw-headline" id="To_generate_test_J_pattern">To generate test J pattern</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=69" title="Edit section: To generate test J pattern">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<pre>     #echo "test J" &gt; /sys/kernel/debug/testmode
</pre>
<h4><span class="mw-headline" id="To_generate_test_SE0_NAK_pattern">To generate test SE0 NAK pattern</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit&amp;section=70" title="Edit section: To generate test SE0 NAK pattern">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<pre>     #echo "test SE0 NAK" &gt; /sys/kernel/debug/testmode
</pre></div>
<!-- 
NewPP limit report
Cached time: 20201130133128
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.138 seconds
Real time usage: 0.149 seconds
Preprocessor visited node count: 311/1000000
Preprocessor generated node count: 396/1000000
Postexpand include size: 1179/2097152 bytes
Template argument size: 472/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip postexpand size: 0/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    4.823      1 -total
 30.71%    1.481      1 Template:SpArticleStart
 27.95%    1.348      2 Template:SpNote
 25.09%    1.210      1 Template:SpLicenseCC-SA
-->
</div>
<!-- Saved in parser cache with key procwiki:pcache:idhash:9393-0!canonical and timestamp 20201130133128 and revision id 233692
 -->
<div class='hf-nsfooter' id='hf-nsfooter-'><table style="text-align:center; background:white; width:100%; text-align:left; height: 65px border-top: 1px solid; border-bottom: 1px solid; border-left: 1px solid; border-right: 1px solid; border-width: 1px; border-style: solid;">
<tr>
<td width="305px"><a href="File_E2e.html" class="image"><img alt="E2e.jpg" src="https://processors.wiki.ti.com/images/8/82/E2e.jpg" width="305" height="63" /></a>
</td>
<td>{{
<ol><li>switchcategory:MultiCore=</li></ol>
<ul><li>For technical support on MultiCore devices, please post your questions in the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/c6000_multi-core_dsps/default.aspx">C6000 MultiCore Forum</a></li>
<li>For questions related to the BIOS MultiCore SDK (MCSDK), please use the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/embedded/f/355.aspx">BIOS Forum</a></li></ul>
<p>Please post only comments related to the article <b>Usbgeneralpage</b> here.<i></i>
</p>
</td>
<td>Keystone=
<ul><li>For technical support on MultiCore devices, please post your questions in the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/c6000_multi-core_dsps/default.aspx">C6000 MultiCore Forum</a></li>
<li>For questions related to the BIOS MultiCore SDK (MCSDK), please use the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/embedded/f/355.aspx">BIOS Forum</a></li></ul>
<p>Please post only comments related to the article <b>Usbgeneralpage</b> here.<i></i>
</p>
</td>
<td>C2000=<i>For technical support on the C2000 please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/microcontrollers/tms320c2000_32-bit_real-time_mcus/f/171.aspx">The C2000 Forum</a>. Please post only comments about the article <b>Usbgeneralpage</b> here.</i>
</td>
<td>DaVinci=<i>For technical support on DaVincoplease post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/davinci_digital_media_processors/default.aspx">The DaVinci Forum</a>. Please post only comments about the article <b>Usbgeneralpage</b> here.</i>
</td>
<td>MSP430=<i>For technical support on MSP430 please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/microcontrollers/msp43016-bit_ultra-low_power_mcus/default.aspx">The MSP430 Forum</a>. Please post only comments about the article <b>Usbgeneralpage</b> here.</i>
</td>
<td>OMAP35x=<i>For technical support on OMAP please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/omap_applications_processors/default.aspx">The OMAP Forum</a>. Please post only comments about the article <b>Usbgeneralpage</b> here.</i>
</td>
<td>OMAPL1=<i>For technical support on OMAP please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/omap_applications_processors/default.aspx">The OMAP Forum</a>. Please post only comments about the article <b>Usbgeneralpage</b> here.</i>
</td>
<td>MAVRK=<i>For technical support on MAVRK please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/development_tools/mavrk/default.aspx">The MAVRK Toolbox Forum</a>. Please post only comments about the article <b>Usbgeneralpage</b> here.</i>
</td>
<td><i>For technical support please post your questions at <a rel="nofollow" class="external text" href="http://e2e.ti.com/">http://e2e.ti.com</a>. Please post only comments about the article <b>Usbgeneralpage</b> here.</i>
<p>}}
</p>
</td></tr></table>
<table style="border-style:solid; border-width:1px; text-align:center; width:100%;">

<tr style="font-size:150%;">
<td rowspan="2"><a href="File_Hyperlink_blue.html" class="image"><img alt="Hyperlink blue.png" src="https://processors.wiki.ti.com/images/9/9f/Hyperlink_blue.png" width="96" height="96" /></a>
</td>
<td><b>Links</b>
</td></tr>
<tr>
<td>
<table style="text-align: left;">
<tr>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/amplifier_and_linear.page">Amplifiers &amp; Linear</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/audio/audio_overview.page">Audio</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/rfif.page">Broadband RF/IF &amp; Digital Radio</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/clocksandtimers/clocks_and_timers.page">Clocks &amp; Timers</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/dataconverters/data_converter.page">Data Converters</a>
</p>
</td>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/mems/mems.page">DLP &amp; MEMS</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/high_reliability.page">High-Reliability</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/interface/interface.page">Interface</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/logic/home_overview.page">Logic</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/powermanagement/power_portal.page">Power Management</a>
</p>
</td>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/dsp/embedded_processor.page">Processors</a>
</p>
<ul><li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/dsp/arm.page">ARM Processors</a></li>
<li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/dsp/home.page">Digital Signal Processors (DSP)</a></li>
<li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/microcontroller/home.page">Microcontrollers (MCU)</a></li>
<li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/omap-applications-processors/the-omap-experience.page">OMAP Applications Processors</a></li></ul>
</td>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/switches_and_multiplexers.page">Switches &amp; Multiplexers</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/temperature_sensor.page">Temperature Sensors &amp; Control ICs</a><br/>
<a rel="nofollow" class="external text" href="http://focus.ti.com/wireless/docs/wirelessoverview.tsp?familyId=2003&amp;sectionId=646&amp;tabId=2735">Wireless Connectivity</a>
</p>
</td></tr></table>
</td></tr></table>
<div id="tiPrivacy"></div>
</div></div>					<div class="printfooter">
						Retrieved from "<a dir="ltr" href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;oldid=233692">https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;oldid=233692</a>"					</div>
				<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="Special_Categories.html" title="Special:Categories">Categories</a>: <ul><li><a href="Category_Linux.html" title="Category:Linux">Linux</a></li><li><a href="Category_PSP.html" title="Category:PSP">PSP</a></li><li><a href="Category_USB.html" title="Category:USB">USB</a></li></ul></div></div>				<div class="visualClear"></div>
							</div>
		</div>
		<div id="mw-navigation">
			<h2>Navigation menu</h2>
			<div id="mw-head">
									<div id="p-personal" role="navigation" class="" aria-labelledby="p-personal-label">
						<h3 id="p-personal-label">Personal tools</h3>
						<ul>
							<li id="pt-login"><a href="https://processors.wiki.ti.com/index.php?title=Special:UserLogin&amp;returnto=Usbgeneralpage" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li><li id="pt-createaccount"><a href="Special_RequestAccount.html" title="You are encouraged to create an account and log in; however, it is not mandatory">Request account</a></li>						</ul>
					</div>
									<div id="left-navigation">
										<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
						<h3 id="p-namespaces-label">Namespaces</h3>
						<ul>
							<li id="ca-nstab-main" class="selected"><span><a href="Usbgeneralpage.html" title="View the content page [c]" accesskey="c">Page</a></span></li><li id="ca-talk"><span><a href="Talk_Usbgeneralpage.html" rel="discussion" title="Discussion about the content page [t]" accesskey="t">Discussion</a></span></li>						</ul>
					</div>
										<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
												<input type="checkbox" class="vectorMenuCheckbox" aria-labelledby="p-variants-label" />
						<h3 id="p-variants-label">
							<span>Variants</span>
						</h3>
						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
									</div>
				<div id="right-navigation">
										<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
						<h3 id="p-views-label">Views</h3>
						<ul>
							<li id="ca-view" class="collapsible selected"><span><a href="Usbgeneralpage.html">Read</a></span></li><li id="ca-viewsource" class="collapsible"><span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></span></li><li id="ca-history" class="collapsible"><span><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=history" title="Past revisions of this page [h]" accesskey="h">View history</a></span></li>						</ul>
					</div>
										<div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label">
						<input type="checkbox" class="vectorMenuCheckbox" aria-labelledby="p-cactions-label" />
						<h3 id="p-cactions-label"><span>More</span></h3>
						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
										<div id="p-search" role="search">
						<h3>
							<label for="searchInput">Search</label>
						</h3>
						<form action="https://processors.wiki.ti.com/index.php" id="searchform">
							<div id="simpleSearch">
								<input type="search" name="search" placeholder="Search Texas Instruments Wiki" title="Search Texas Instruments Wiki [f]" accesskey="f" id="searchInput"/><input type="hidden" value="Special:Search" name="title"/><input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton mw-fallbackSearchButton"/><input type="submit" name="go" value="Go" title="Go to a page with this exact name if it exists" id="searchButton" class="searchButton"/>							</div>
						</form>
					</div>
									</div>
			</div>
			<div id="mw-panel">
				<div id="p-logo" role="banner"><a class="mw-wiki-logo" href="Main_Page.html"  title="Visit the main page"></a></div>
						<div class="portal" role="navigation" id="p-navigation" aria-labelledby="p-navigation-label">
			<h3 id="p-navigation-label">Navigation</h3>
			<div class="body">
								<ul>
					<li id="n-mainpage"><a href="Main_Page.html" title="Visit the main page [z]" accesskey="z">Main Page</a></li><li id="n-All-pages"><a href="Special_AllPages.html">All pages</a></li><li id="n-All-categories"><a href="Special_Categories.html">All categories</a></li><li id="n-recentchanges"><a href="Special_RecentChanges.html" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li><li id="n-randompage"><a href="Package_Reflow_Profiles.html" title="Load a random page [x]" accesskey="x">Random page</a></li><li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" title="The place to find out">Help</a></li>				</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id="p-tb" aria-labelledby="p-tb-label">
			<h3 id="p-tb-label">Toolbox</h3>
			<div class="body">
								<ul>
					<li id="t-whatlinkshere"><a href="Special_WhatLinksHere/Usbgeneralpage.html" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li><li id="t-recentchangeslinked"><a href="Special_RecentChangesLinked/Usbgeneralpage.html" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li><li id="t-specialpages"><a href="Special_SpecialPages.html" title="A list of all special pages [q]" accesskey="q">Special pages</a></li><li id="t-print"><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li><li id="t-permalink"><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;oldid=233692" title="Permanent link to this revision of the page">Permanent link</a></li><li id="t-info"><a href="https://processors.wiki.ti.com/index.php?title=Usbgeneralpage&amp;action=info" title="More information about this page">Page information</a></li>				</ul>
							</div>
		</div>
				</div>
		</div>
				<div id="footer" role="contentinfo">
						<ul id="footer-info">
								<li id="footer-info-lastmod"> This page was last edited on 28 March 2018, at 02:14.</li>
								<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-ShareAlike</a> unless otherwise noted.</li>
							</ul>
						<ul id="footer-places">
								<li id="footer-places-privacy"><a href="Project_Privacy_policy.html" title="Project:Privacy policy">Privacy policy</a></li>
								<li id="footer-places-about"><a href="Project_About.html" title="Project:About">About Texas Instruments Wiki</a></li>
								<li id="footer-places-disclaimer"><a href="Project_General_disclaimer.html" title="Project:General disclaimer">Disclaimers</a></li>
								<li id="footer-places-termsofservice"><a href="Project_Terms_of_Service.html" title="Project:Terms of Service">Terms of Use</a></li>
							</ul>
										<ul id="footer-icons" class="noprint">
										<li id="footer-copyrightico">
						<a href="http://creativecommons.org/licenses/by-sa/3.0/"><img src="https://processors.wiki.ti.com/resources/assets/licenses/cc-by-sa.png" alt="Creative Commons Attribution-ShareAlike" width="88" height="31"/></a>					</li>
										<li id="footer-poweredbyico">
						<a href="http://www.mediawiki.org/"><img src="https://processors.wiki.ti.com/resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31"/></a>					</li>
									</ul>
						<div style="clear: both;"></div>
		</div>
		<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgPageParseReport":{"limitreport":{"cputime":"0.138","walltime":"0.149","ppvisitednodes":{"value":311,"limit":1000000},"ppgeneratednodes":{"value":396,"limit":1000000},"postexpandincludesize":{"value":1179,"limit":2097152},"templateargumentsize":{"value":472,"limit":2097152},"expansiondepth":{"value":2,"limit":40},"expensivefunctioncount":{"value":0,"limit":100},"unstrip-depth":{"value":0,"limit":20},"unstrip-size":{"value":0,"limit":5000000},"timingprofile":["100.00%    4.823      1 -total"," 30.71%    1.481      1 Template:SpArticleStart"," 27.95%    1.348      2 Template:SpNote"," 25.09%    1.210      1 Template:SpLicenseCC-SA"]},"cachereport":{"timestamp":"20201130133128","ttl":86400,"transientcontent":false}}});});</script><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":225});});</script>
	</body>

<!-- Mirrored from processors.wiki.ti.com/index.php/Usbgeneralpage by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 01 Dec 2020 06:34:08 GMT -->
</html>
