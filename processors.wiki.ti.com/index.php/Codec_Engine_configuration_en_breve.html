<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">

<!-- Mirrored from processors.wiki.ti.com/index.php/Codec_Engine_configuration_en_breve by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 01 Dec 2020 04:29:46 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8"/>
<title>Codec Engine configuration en breve - Texas Instruments Wiki</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Codec_Engine_configuration_en_breve","wgTitle":"Codec Engine configuration en breve","wgCurRevisionId":181188,"wgRevisionId":181188,"wgArticleId":86,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["MFP","Framework Components","Codec Engine","DMA","DVEVM"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Codec_Engine_configuration_en_breve","wgRelevantArticleId":86,"wgRequestId":"0b70d8a2252dfed9de371d8a","wgIsProbablyEditable":false,"wgRelevantPageIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[]});mw.loader.state({"site.styles":"ready","noscript":"ready","user.styles":"ready","user":"ready","user.options":"ready","user.tokens":"loading","mediawiki.legacy.shared":"ready","mediawiki.legacy.commonPrint":"ready","mediawiki.sectionAnchor":"ready","mediawiki.skinning.interface":"ready","skins.vector.styles":"ready"});mw.loader.implement("user.tokens@19o3a1s",function($,jQuery,require,module){/*@nomin*/mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});
});mw.loader.load(["site","mediawiki.page.startup","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.toc","mediawiki.searchSuggest","skins.vector.js"]);});</script>
<link rel="stylesheet" href="https://processors.wiki.ti.com/load.php?debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.interface%7Cskins.vector.styles&amp;only=styles&amp;skin=vector"/>
<script async="" src="https://processors.wiki.ti.com/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=vector"></script>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="https://processors.wiki.ti.com/load.php?debug=false&amp;lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=vector"/>
<meta name="generator" content="MediaWiki 1.31.6"/>
<link rel="shortcut icon" href="https://processors.wiki.ti.com/favicon.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="https://processors.wiki.ti.com/opensearch_desc.php" title="Texas Instruments Wiki (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="https://processors.wiki.ti.com/api.php?action=rsd"/>
<link rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/"/>
<link rel="alternate" type="application/atom+xml" title="Texas Instruments Wiki Atom feed" href="https://processors.wiki.ti.com/index.php?title=Special:RecentChanges&amp;feed=atom"/>
<!--[if lt IE 9]><script src="/load.php?debug=false&amp;lang=en&amp;modules=html5shiv&amp;only=scripts&amp;skin=Vector&amp;sync=1"></script><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Codec_Engine_configuration_en_breve rootpage-Codec_Engine_configuration_en_breve skin-vector action-view">		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<div id="content" class="mw-body" role="main">
			<a id="top"></a>
			<div id="siteNotice" class="mw-body-content"><div id="localNotice" lang="en" dir="ltr"><div class="mw-parser-output"><p><br />
<span style="color:#ff0000"><b>NOTICE: The Processors Wiki will End-of-Life on January 15, 2021. It is recommended to download any files or other content you may need that are hosted on processors.wiki.ti.com. The site is now set to read only.</b></span>
</p></div></div></div><div class="mw-indicators mw-body-content">
</div>
<h1 id="firstHeading" class="firstHeading" lang="en">Codec Engine configuration en breve</h1>			<div id="bodyContent" class="mw-body-content">
				<div id="siteSub" class="noprint">From Texas Instruments Wiki</div>				<div id="contentSub"></div>
								<div id="jump-to-nav" class="mw-jump">
					Jump to:					<a href="#mw-head">navigation</a>, 					<a href="#p-search">search</a>
				</div>
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output"><p><b>Codec Engine configuration en breve</b>
</p>
<div id="toc" class="toc"><div class="toctitle" lang="en" dir="ltr"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Introduction"><span class="tocnumber">1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Application_configuration"><span class="tocnumber">2</span> <span class="toctext">Application configuration</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Creating_an_Engine_in_Codec_Engine_configuration"><span class="tocnumber">2.1</span> <span class="toctext">Creating an Engine in Codec Engine configuration</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Configuring_DSPLINK_with_DSP_memory_map_in_Codec_Engine_1.20"><span class="tocnumber">2.2</span> <span class="toctext">Configuring DSPLINK with DSP memory map in Codec Engine 1.20</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5"><a href="#DSP_side_configuration"><span class="tocnumber">3</span> <span class="toctext">DSP side configuration</span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#Setting_up_memory_sections_in_DSP.2FBIOS_configuration_file_.28.tcf.29"><span class="tocnumber">3.1</span> <span class="toctext">Setting up memory sections in DSP/BIOS configuration file (.tcf)</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#DSKT2_configuration_in_Codec_Engine.27s_configuration_file"><span class="tocnumber">3.2</span> <span class="toctext">DSKT2 configuration in Codec Engine's configuration file</span></a>
<ul>
<li class="toclevel-3 tocsection-8"><a href="#Overview"><span class="tocnumber">3.2.1</span> <span class="toctext">Overview</span></a></li>
<li class="toclevel-3 tocsection-9"><a href="#Memory_Type_Mapping"><span class="tocnumber">3.2.2</span> <span class="toctext">Memory Type Mapping</span></a></li>
<li class="toclevel-3 tocsection-10"><a href="#Scratch_Configuration"><span class="tocnumber">3.2.3</span> <span class="toctext">Scratch Configuration</span></a></li>
<li class="toclevel-3 tocsection-11"><a href="#Debugging"><span class="tocnumber">3.2.4</span> <span class="toctext">Debugging</span></a></li>
<li class="toclevel-3 tocsection-12"><a href="#Debugging_-_a_scratch_sharing_use-case"><span class="tocnumber">3.2.5</span> <span class="toctext">Debugging - a scratch sharing use-case</span></a></li>
<li class="toclevel-3 tocsection-13"><a href="#Debugging_-_I.27ve_run_out_of_internal_scratch_for_key_video_algorithms"><span class="tocnumber">3.2.6</span> <span class="toctext">Debugging - I've run out of internal scratch for key video algorithms</span></a></li>
<li class="toclevel-3 tocsection-14"><a href="#More_Info"><span class="tocnumber">3.2.7</span> <span class="toctext">More Info</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-15"><a href="#DMAN3_configuration_in_Codec_Engine.27s_configuration_file"><span class="tocnumber">3.3</span> <span class="toctext">DMAN3 configuration in Codec Engine's configuration file</span></a>
<ul>
<li class="toclevel-3 tocsection-16"><a href="#Debugging_2"><span class="tocnumber">3.3.1</span> <span class="toctext">Debugging</span></a></li>
<li class="toclevel-3 tocsection-17"><a href="#More_info_2"><span class="tocnumber">3.3.2</span> <span class="toctext">More info</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-18"><a href="#Defining_a_server_in_the_Codec_Engine_configuration"><span class="tocnumber">3.4</span> <span class="toctext">Defining a server in the Codec Engine configuration</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-19"><a href="#Other_notes"><span class="tocnumber">4</span> <span class="toctext">Other notes</span></a></li>
<li class="toclevel-1 tocsection-20"><a href="#See_Also"><span class="tocnumber">5</span> <span class="toctext">See Also</span></a></li>
</ul>
</div>

<h3><span class="mw-headline" id="Introduction">Introduction</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Codec_Engine_configuration_en_breve&amp;action=edit&amp;section=1" title="Edit section: Introduction">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>This page summarizes the most important care-abouts in a typical <a href="Category_Codec_Engine.html" title="Category:Codec Engine">Codec Engine</a> configuration.  The best place to start is to study the .cfg and .tcf files in a given Codec Engine example.  Make a copy of them and start modifying the relevant parameters.
</p><p>More details can be found in the Codec Engine User Guides.  But the goal of this page is to point out the things that most users would need to configure, so that they can quickly get started without going through the documentation.
</p>
<h3><span class="mw-headline" id="Application_configuration">Application configuration</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Codec_Engine_configuration_en_breve&amp;action=edit&amp;section=2" title="Edit section: Application configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>This is the configuration that needs to be done in the configuration file (.cfg) of a Codec Engine-based application's executable.
</p>
<h4><span class="mw-headline" id="Creating_an_Engine_in_Codec_Engine_configuration">Creating an Engine in Codec Engine configuration</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Codec_Engine_configuration_en_breve&amp;action=edit&amp;section=3" title="Edit section: Creating an Engine in Codec Engine configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>One of the initial APIs that must be called when using the Codec Engine is <code>Engine_open()</code>; and in order to open an Engine, you must create it first.  You can create one as shown in the example below:
</p><p>&lt;syntaxhighlight lang='javascript'&gt;
var decoder = xdc.useModule('ti.sdo.ce.examples.codecs.viddec_copy.VIDDEC_COPY');
</p><p>var Engine = xdc.useModule('ti.sdo.ce.Engine');
var Engine = Engine.create("decode",   // Engine name. Your C code will use it to reference this engine in Engine_open()
[
</p>
<pre>   //List all codecs that would be part of the engine
   {name &#160;: "viddec_copy",  // Name of the codec. Should match the name in the server if any
    mod  &#160;: decoder,        // The module corresponding to this codec
    local&#160;: true            // Whether this codec runs on the same CPU as the application
   },
</pre>
<p>]);
&lt;/syntaxhighlight&gt;
</p><p><b>NOTE</b> - for ARM+DSP devices there's a better way to do this in Codec Engine &gt;= 2.0 - <a href="Configuring_Codec_Engine_in_Arm_apps_with_createFromServer.html" title="Configuring Codec Engine in Arm apps with createFromServer"> createFromServer()</a>.
</p><p>See the <a href="http://www.ti.com/lit/pdf/sprue67" class="extiw" title="tidoc:sprue67">Codec Engine Application Developer User's Guide</a> for more details.
</p>
<h4><span class="mw-headline" id="Configuring_DSPLINK_with_DSP_memory_map_in_Codec_Engine_1.20">Configuring DSPLINK with DSP memory map in Codec Engine 1.20</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Codec_Engine_configuration_en_breve&amp;action=edit&amp;section=4" title="Edit section: Configuring DSPLINK with DSP memory map in Codec Engine 1.20">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>This is required only on heterogeneous platforms (e.g. DM6446 or OMAP3 devices which contain an ARM and a C6x-based DSP), where the ARM runs the application and the DSP runs algorithms/codecs.  DSP Link is used in this case as a communication layer between the two cores. Setup the armDspLinkConfig field for your engine to *match* the DSP/BIOS configuration file (.tcf) on the DSP side. Only the four memory sections shown in the example below needs to be listed.
</p><p><tt>Code Example:</tt>
&lt;syntaxhighlight lang='javascript'&gt;
demoEngine.armDspLinkConfig = {
</p>
<pre>   memTable: [
       ["DDRALGHEAP", {addr: 0x8F000000, size: 0x00A80000, type: "other"}],
       ["DDR",        {addr: 0x8FA80000, size: 0x00380000, type: "main" }],
       ["DSPLINKMEM", {addr: 0x8FE00000, size: 0x00100000, type: "link" }],
       ["RESETCTRL",  {addr: 0x8FF00000, size: 0x00000080, type: "reset"}],
   ],
</pre>
<p>};
&lt;/syntaxhighlight&gt;
</p><p>See the <a href="http://www.ti.com/lit/pdf/sprue67" class="extiw" title="tidoc:sprue67">Codec Engine Application Developer User's Guide</a> for more details.
</p>
<h3><span class="mw-headline" id="DSP_side_configuration">DSP side configuration</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Codec_Engine_configuration_en_breve&amp;action=edit&amp;section=5" title="Edit section: DSP side configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>This is the configuration that needs to be done in the configuration file (.cfg) of either a DSP server executable (on heterogeneous platforms such as the DM6446) or the DSP application (on DSP-only platforms such as the DM6437).
</p>
<h4><span id="Setting_up_memory_sections_in_DSP/BIOS_configuration_file_(.tcf)"></span><span class="mw-headline" id="Setting_up_memory_sections_in_DSP.2FBIOS_configuration_file_.28.tcf.29">Setting up memory sections in DSP/BIOS configuration file (.tcf)</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Codec_Engine_configuration_en_breve&amp;action=edit&amp;section=6" title="Edit section: Setting up memory sections in DSP/BIOS configuration file (.tcf)">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Define/Adjust memory sections (MEM objects) and heaps. These will be used later in the Codec Engine configuration file.
</p><p><tt>Code Example:</tt>
&lt;syntaxhighlight lang='javascript'&gt;
var mem_ext = [
{
</p>
<pre>   // Definition of a MEM object
   comment:    "DDR: off-chip memory for data",
   name:       "DDR",
   base:       0x8FA80000,   //Base address
   len:        0x00140000,   //Size of DDR memory section
   space:      "code/data"
</pre>
<p>}
];
</p><p>var params = {
</p>
<pre>   clockRate: 594,
   catalogName: "ti.catalog.c6000",
   deviceName: "DM6446",
   regs: device_regs,
   mem: mem_ext           //Use the mem_ext array to define the memory sections
</pre>
<p>};
</p><p>utils.loadPlatform("ti.platforms.generic", params);
</p><p>bios.DDR.createHeap = true;  //Creates a heap in DDR
bios.DDR.heapSize   = 0x80000; // size of heap
&lt;/syntaxhighlight&gt;
</p><p>More details on how to configure DSP/BIOS in general can be found in the <a href="http://www.ti.com/lit/pdf/spru403" class="extiw" title="tidoc:spru403">DSP/BIOS API reference guide</a>.
</p>
<h4><span id="DSKT2_configuration_in_Codec_Engine's_configuration_file"></span><span class="mw-headline" id="DSKT2_configuration_in_Codec_Engine.27s_configuration_file">DSKT2 configuration in Codec Engine's configuration file</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Codec_Engine_configuration_en_breve&amp;action=edit&amp;section=7" title="Edit section: DSKT2 configuration in Codec Engine&#039;s configuration file">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<h5><span class="mw-headline" id="Overview">Overview</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Codec_Engine_configuration_en_breve&amp;action=edit&amp;section=8" title="Edit section: Overview">edit</a><span class="mw-editsection-bracket">]</span></span></h5>
<p>DSKT2 is a module in the <a href="Framework_Components_FAQ.html" title="Framework Components FAQ">Framework Components (FC)</a> product that dynamically manages XDAIS algorithm (e.g. codec) data memory requests.  As of FC 2.21, DSKT2 only supported in DSP/BIOS based environments.
</p>
<h5><span class="mw-headline" id="Memory_Type_Mapping">Memory Type Mapping</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Codec_Engine_configuration_en_breve&amp;action=edit&amp;section=9" title="Edit section: Memory Type Mapping">edit</a><span class="mw-editsection-bracket">]</span></span></h5>
<p>As a crude summary, an algorithm requests one or more blocks of memory during its initialization, each characterized by:
</p>
<ul><li>Space - internal or external</li>
<li>Usage - scratch or persistent</li>
<li>Size</li>
<li>Alignment</li></ul>
<p>The algorithms request abstract memory types, defined by XDAIS's IALG (Interface for ALGorithms) spec.  In systems that use DSKT2, the system integrator must configure DSKT2's abstract IALG memory types to concrete DSP/BIOS memory heaps.  Each IALG memory space must be mapped to an available BIOS heap (defined in the DSP/BIOS .tcf configuration file).  An example DSKT2 config block is here:
</p><p>&lt;syntaxhighlight lang='javascript'&gt;
</p>
<pre>   var DSKT2 = xdc.useModule('ti.sdo.fc.dskt2.DSKT2');
</pre>
<pre>   DSKT2.DARAM0     = "L1DSRAM";
   DSKT2.DARAM1     = "L1DSRAM";
   DSKT2.DARAM2     = "L1DSRAM";
   DSKT2.SARAM0     = "L1DSRAM";
   DSKT2.SARAM1     = "L1DSRAM";
   DSKT2.SARAM2     = "L1DSRAM";
   DSKT2.ESDATA     = "DDRALGHEAP";
   DSKT2.IPROG      = "L1DSRAM";
   DSKT2.EPROG      = "DDRALGHEAP";
   DSKT2.DSKT2_HEAP = "DDR";
</pre>
<p>&lt;/syntaxhighlight&gt;
</p>
<h5><span class="mw-headline" id="Scratch_Configuration">Scratch Configuration</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Codec_Engine_configuration_en_breve&amp;action=edit&amp;section=10" title="Edit section: Scratch Configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h5>
<p>Additionally, to optimize memory utilization, DSKT2 provides the ability to organize algorithms into "scratch groups".  Scratch groups are collections of algorithms that share resources.  Note that the Codec Engine consolidates the notion of these DSKT2 "scratch groups" with other resource groups (e.g. DMAN3's DMA resource sharing groups), and presents these as a single "group Id".  There is more info on Group IDs at <a href="Codec_Engine_GroupIds.html" title="Codec Engine GroupIds"> this article</a>.
</p><p>The <code>DSKT2.DARAM_SCRATCH_SIZES[]</code> and <code>DSKT2.SARAM_SCRATCH_SIZES[]</code> arrays are used to configure DSKT2 with the worst-case size of shared scratch memory for each scratch group.  Codec Engine (CE) users have several methods to configure these arrays:
</p>
<ul><li>CE 1.x prior to 1.10 - system integrators must explicitly configure these DSKT2 scratch arrays.</li>
<li>CE 1.10 and later - Server integrators can configure the Servers to autogenerate these scratch arrays, assuming all codecs implement the necessary <code>.getDaramScratchSize()</code>, and <code>.getSaramScratchSize()</code> methods defined in the <code>ti.sdo.ce.ICodec</code> interface.  The code to enable this autogeneration is here:</li></ul>
<p>&lt;syntaxhighlight lang='javascript'&gt;
var Server = xdc.useModule('ti.sdo.ce.Server');
Server.autoGenScratchSizeArrays = true;
&lt;/syntaxhighlight&gt;
</p><p>Note that the necessary <code>.getDaramScratchSize()</code>, and <code>.getSaramScratchSize()</code> methods were also added in CE 1.10, so many codec producers have <i>not</i> implemented these methods, in which case you won't be able to use this approach.
</p><p>To manually find out how much space to give to each scratch group (which is probably you best bet for most codecs that exist as of today), you can turn the DSKT2 trace on (see the debugging section following this one) to print out algorithm scratch requests for DARAM and SARAM. For example:
</p>
<pre>@0x000fd977:[T:0x88b665f4] ti.sdo.fc.dskt2 - _DSKT2_getScratchRequestInfo&gt; Enter (ialgSpace=IALG_DARAM0, numRecs=9)
@0x000fd9c3:[T:0x88b665f4] ti.sdo.fc.dskt2 - _DSKT2_getScratchRequestInfo&gt; Exit (sizeBestCase=64768, sizeWorstCase=64896, numScratchRecs=1)
</pre>
<p>The above trace snippet was captured while an algorithm is being created and indicates that in the worst case, a total of 64896 bytes were needed for DARAM scratch memory requests, for this particular algorithm.
</p><p>After determining the amount of scratch memory needed by each algorithm, the size for a particular group i is:
</p>
<ul><li><code>DARAM_SCRATCH_SIZES[i]</code> = max(total DARAM scratch memory requested by an algorithm) over all algorithms in group i.</li>
<li><code>SARAM_SCRATCH_SIZES[i]</code> = max(total SARAM scratch memory requested by an algorithm) over all algorithms in group i.</li></ul>
<p>When constrained in amount of internal memory heap space:
</p>
<ul><li>Double-check the scratch sizes arrays to ensure you are not allocating more scratch space then necessary for each scratch group</li>
<li>Assign <code>DSKT2.DSKT2_HEAP</code> to an external heap in the DSP's .cfg file (e.g. <code>DSKT2.DSKT2_HEAP = "DDR";</code>)</li></ul>
<h5><span class="mw-headline" id="Debugging">Debugging</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Codec_Engine_configuration_en_breve&amp;action=edit&amp;section=11" title="Edit section: Debugging">edit</a><span class="mw-editsection-bracket">]</span></span></h5>
<p>In Framework Components 1.x, you can configure <code>DSKT2.debug</code> to true during development to enable obtain some tracing information and/or to insert debug symbols for this module. Just add a line to the server's .cfg file:
</p><p>&lt;syntaxhighlight lang='javascript'&gt;
var DSKT2 = xdc.useModule('ti.sdo.fc.dskt2.DSKT2');
DSKT2.debug=true;  //Add this line
&lt;/syntaxhighlight&gt;
</p><p>In Framework Components 2.x, an additional config param, <code>DSKT2.trace</code>, has been added.  It's orthogonal to <code>DSKT2.debug</code>, meaning you can have all permutations of trace on/off and debug on/off.  It also means that the FC 1.x interpretation of <code>DSKT2.debug = true;</code> providing trace statements is no longer applicable.  FC 2.x users wishing to enable trace need to explicitly set
</p><p>&lt;syntaxhighlight lang='javascript'&gt;DSKT2.trace = true;&lt;/syntaxhighlight&gt;
</p><p>DSKT2 trace lists out all IALG requests from each codec instance and computes totals of memory allocated for each one. This information is useful for sizing your memory map.
</p><p>More details on the syntax with newer releases are here: <a href="FC_Config_Updates.html#Debug_and_Trace_settings" title="FC Config Updates">FC_Config_Updates#Debug_and_Trace_settings</a>
</p>
<h5><span class="mw-headline" id="Debugging_-_a_scratch_sharing_use-case">Debugging - a scratch sharing use-case</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Codec_Engine_configuration_en_breve&amp;action=edit&amp;section=12" title="Edit section: Debugging - a scratch sharing use-case">edit</a><span class="mw-editsection-bracket">]</span></span></h5>
<p>Let's look at e.g. the DVSDK 1.30 loopback (h.264 encode + decode) on DM6446. In the combos / servers dm6446_dvsdk_combos_1_35/packages/ti/sdo/servers/loopback/loopback.cfg you can see: -
</p><p>&lt;syntaxhighlight lang='javascript'&gt;
Server.algs = [
</p>
<pre>   {name: "h264enc", mod: H264ENC, groupId:0,threadAttrs: {
       stackMemId: 0, priority: Server.MINPRI + 1}
   },
   {name: "h264dec", mod: H264DEC, groupId:0,threadAttrs: {
       stackMemId: 0, priority: Server.MINPRI + 1}
   },
</pre>
<p>];
&lt;/syntaxhighlight&gt;
</p><p>This says "let's have both H.264 encode and decode at the same BIOS Task priority and consequently use the same scratch memory group (via usage of the same groupId)".
</p><p>We have 2 codecs so how do we decide what to put for e.g. <code>DSKT2.DARAM_SCRATCH_SIZES[]</code>?
</p><p>Clearly it has to be the greater of the 2 codecs. Let's now look at the codec configuration: -
</p>
<ul><li>packages/ti/sdo/codecs/h264enc/ce/H264ENC.xs - it has: -</li></ul>
<p>&lt;syntaxhighlight lang='javascript'&gt;
function getDaramScratchSize(prog)
{
</p>
<pre>   if (verbose) {
       print("getting DARAM scratch size for " + this.$name
           + " built for the target " + prog.build.target.$name
           + ", running onplatform " +  prog.platformName);
   }
</pre>
<pre>   return (64768);
</pre>
<p>}
&lt;/syntaxhighlight&gt;
</p>
<ul><li>packages/ti/sdo/codecs/h264dec/ce/H264DEC.xs - it returns 49152 for getDaramScratchSize().</li></ul>
<p>Now let's look at the settings for the internal scratch arrays: -
&lt;syntaxhighlight lang='javascript'&gt;
/*
</p>
<pre>* Note that the sizes of these arrays is larger than the 1 element set below.
* Any unassigned elements of the array are initialized to zero.
*/
</pre>
<p>DSKT2.DARAM_SCRATCH_SIZES = [ 65536 ];
DSKT2.SARAM_SCRATCH_SIZES = [ 65536 ];
&lt;/syntaxhighlight&gt;
</p><p>That's fine. This size (65536) is larger than the biggest of both H.264 encode and decode codecs. This works.
</p><p>However if you are a system integrator with 20+ codecs it can get tedious to go check the ce/MODULE.xs of every codec. Let's see if we can use <a href="CE_DEBUG.html" title="CE DEBUG">CE_DEBUG=2</a> to detect problems.
</p><p>First thing is to run the working setup with CE_DEBUG=2. But before that we need to turn on DSKT2 trace in the combo to dump more detailed memory trace information: -
&lt;syntaxhighlight lang='javascript'&gt;
DSKT2.trace = true;
&lt;/syntaxhighlight&gt;
</p><p>And after a rebuild of the servers, we run it via: -
&lt;syntaxhighlight lang='bash'&gt;
CE_DEBUG=2 ./encodedecoded -t 5 &gt; tmp.txt
&lt;/syntaxhighlight&gt;
</p><p>Analyzing the tmp.txt trace dump we see: -
</p>
<pre>[DSP] @0,053,904tk: [+0 T:0x8b80006c] CV - VISA_create(0x0, 'h264dec', 0x8fe05cc0, 0x836, 'ti.sdo.ce.video.IVIDDEC')
...
[DSP] @0,055,355tk: [+4 T:0x8b80006c] ti.sdo.fc.dskt2 - DSKT2_createAlg3&gt; Requested memTab[1]: size=0xf480, align=0x80, space=IALG_DARAM0, attrs=IALG_SCRATCH
...
[DSP] @0,126,012tk: [+4 T:0x8b80006c] ti.sdo.fc.dskt2 - DSKT2_createAlg3&gt; Allocated memTab[1]: base=0x11f04000, size=0xf480, align=0x80, space=IALG_DARAM0, attrs=IALG_SCRATCH
...
...
[DSP] @0,207,816tk: [+0 T:0x8b80006c] CV - VISA_create(0x0, 'h264enc', 0x8fe05cc0, 0x828, 'ti.sdo.ce.video.IVIDENC')
...
[DSP] @0,208,907tk: [+4 T:0x8b80006c] ti.sdo.fc.dskt2 - DSKT2_createAlg3&gt; Requested memTab[1]: size=0xfd00, align=0x80, space=IALG_DARAM0, attrs=IALG_SCRATCH
...
[DSP] @0,231,264tk: [+4 T:0x8b80006c] ti.sdo.fc.dskt2 - DSKT2_createAlg3&gt; Allocated memTab[1]: base=0x11f04000, size=0xfd00, align=0x80, space=IALG_DARAM0, attrs=IALG_SCRATCH
</pre>
<p>One observation is that the <i>real</i> internal scratch requirements of the H.264 decode is 0xf480 (62592) i.e. more than the 49152 reported by the codec in its ce/H264DEC.xs - that's a bug (which will be reported!). However since we set <code>DSKT2.DARAM_SCRATCH_SIZES[]</code> larger all is well.
</p><p>Now let's break it in order to understand how to diagnose such problems!
</p><p>Let's change the server loopback.cfg to&#160;: -
&lt;syntaxhighlight lang='javascript'&gt;
DSKT2.DARAM_SCRATCH_SIZES = [ 62*1024 ];
DSKT2.SARAM_SCRATCH_SIZES = [ 62*1024 ];
&lt;/syntaxhighlight&gt;
</p><p>i.e. a scratch buffer that's big enough for decode but not for encode!
</p><p>The first piece of good news is that we get a warning in the <i>build</i>. <b>Don't ignore this!</b>
</p>
<pre>Warning:  Alg "h264enc" DARAM scratch size exceeds engine configuration for groupId 0
Warning:  Alg "h264enc" SARAM scratch size exceeds engine configuration for groupId 0
</pre>
<p>If we fail to act on this what happens? Again using CE_DEBUG=2 we now see: -
</p>
<pre>[DSP] @0,049,630tk: [+0 T:0x8b80006c] CV - VISA_create(0x0, 'h264dec', 0x8fe05cc0, 0x836, 'ti.sdo.ce.video.IVIDDEC')
...
[DSP] @0,051,013tk: [+4 T:0x8b80006c] ti.sdo.fc.dskt2 - DSKT2_createAlg3&gt; Requested memTab[1]: size=0xf480, align=0x80, space=IALG_DARAM0, attrs=IALG_SCRATCH
...
[DSP] @0,122,123tk: [+4 T:0x8b80006c] ti.sdo.fc.dskt2 - DSKT2_createAlg3&gt; Allocated memTab[1]: base=0x11f04000, size=0xf480, align=0x80, space=IALG_DARAM0, attrs=IALG_SCRATCH
...
...
[DSP] @0,725,708us: [+0 T:0x424c1b60] CV - VISA_create(0x515d8, 'h264enc', 0x424c13e8, 0x828, 'ti.sdo.ce.video.IVIDENC')
...
[DSP] @0,203,358tk: [+4 T:0x8b80006c] ti.sdo.fc.dskt2 - DSKT2_createAlg3&gt; Requested memTab[1]: size=0xfd00, align=0x80, space=IALG_DARAM0, attrs=IALG_SCRATCH
...
[DSP] @0,204,589tk: [+0 T:0x8b80006c] ti.sdo.fc.dskt2 - _DSKT2_useSharedScratch&gt; Exit (status=FALSE)
...
[DSP] @0,227,054tk: [+4 T:0x8b80006c] ti.sdo.fc.dskt2 - DSKT2_createAlg3&gt; Allocated memTab[1]: base=0x8bd39c00, size=0xfd00, align=0x80, space=IALG_ESDATA, attrs=IALG_PERSIST
</pre>
<p>Since there wasn't enough internal scratch allocated via the <code>DSKT2.DARAM_SCRATCH_SIZES[]</code> DSKT2 executed <a href="Framework_Components_FAQ.html#Why_does_DSKT2_provide_external_memory_when_my_alg_asked_for_internal.3F" title="Framework Components FAQ">a fall back path to allocate from <i>external</i> memory</a>. <code>_DSKT2_useSharedScratch</code> failed to allocate from the existing internal scratch buffer, and thus used external memory. That makes sense however many intensive video codecs simply can't operate with external scratch buffers - many frames get dropped and things go downhill rapidly!
</p><p>So, in summary, the troubleshooting tips are: -
</p>
<ul><li>Use <a href="CE_DEBUG.html" title="CE DEBUG">CE_DEBUG</a> (available in CE &gt;= 2.0)</li>
<li>Use <code>DSKT2.trace</code> to get detailed memory allocation information.</li>
<li>Give thought to your settings for the scratch groups in <code>DSKT2.DARAM_SCRATCH_SIZES[]</code> and <code>DSKT2.SARAM_SCRATCH_SIZES[]</code>. Make them big enough.</li></ul>
<p>Caveats?
</p>
<ul><li>There is an <code>Engine_open()</code>, trace-related race condition in Codec Engine which, in multi-threaded applications concurrently calling <code>Engine_open()</code> with remote codecs, may not enable the DSP-side trace "quick enough".  This may prevent the <code>memTab[]</code> initialization info from being printed under CE_DEBUG=2.  The work-around is to serialize the thread's initial calls to <code>Engine_open()</code> so the first thread's call returns before any subsequent <code>Engine_open()</code> calls are made.  This only affects trace enabling - and therefore debugging with CE_DEBUG; it does not affect any functionality.</li></ul>
<h5><span id="Debugging_-_I've_run_out_of_internal_scratch_for_key_video_algorithms"></span><span class="mw-headline" id="Debugging_-_I.27ve_run_out_of_internal_scratch_for_key_video_algorithms">Debugging - I've run out of internal scratch for key video algorithms</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Codec_Engine_configuration_en_breve&amp;action=edit&amp;section=13" title="Edit section: Debugging - I&#039;ve run out of internal scratch for key video algorithms">edit</a><span class="mw-editsection-bracket">]</span></span></h5>
<p>Scenario&#160;: you have an audio and a video algorithm - the latter is often scratch memory hungry. For example on DM644x some of TI's video codecs consume ~62K of 64K internal scratch.
</p><p>So naturally you setup your server cfg file as follows: -
</p><p>&lt;syntaxhighlight lang='javascript'&gt;
Server.algs = [
</p>
<pre>   {name: "h264dec", mod: H264DEC, groupId: 0,threadAttrs: {
       stackMemId: 0, priority: Server.MINPRI + 1}
   },
   {name: "aacdec", mod: AACDEC, groupId: 1,threadAttrs: {
       stackMemId: 0, priority: Server.MINPRI + 2}
   },
</pre>
<p>];
</p><p>DSKT2.DSKT2_HEAP = "DDR2";  /* alloc misc non-alg objects in ext heap */
DSKT2.ALLOW_EXTERNAL_SCRATCH = true;  /* allow for external scratch for non-critical algos */
</p><p>/* Scratch group 0 */
DSKT2.DARAM_SCRATCH_SIZES[0] = 62*1024;    /* &gt;= Video alg scr size */
DSKT2.SARAM_SCRATCH_SIZES[0] = 62*1024;
</p><p>/* Scratch group 1 */
DSKT2.DARAM_SCRATCH_SIZES[1] = 20000;        /* &gt;= Audio alg scr size */
DSKT2.SARAM_SCRATCH_SIZES[1] = 20000;
&lt;/syntaxhighlight&gt;
</p><p>In most cases this works fine. However in some apps it will fail. Why? The answer is because if you create the audio algorithm first it will dedicate 20000 bytes for the audio groupId = 1. DSKT2 will by default try and allocate this from internal memory first assuming that you set your DSKT2 DARAM and SARAM configuration parameters to internal memory (as most people do).
</p><p>You can turn on debug and trace as per <a href="FC_Config_Updates.html" title="FC Config Updates">FC_Config_Updates</a> instructions and it will clearly show this.
</p><p>&lt;syntaxhighlight lang='javascript'&gt;
//Use the DSKT2 library built with debug profile and no trace
xdc.loadPackage('ti.sdo.fc.dskt2').profile = "debug_trace";
&lt;/syntaxhighlight&gt;
</p><p>In this case we require the video algorithm to get the scratch. Audio is less CPU intensive - we can live with these algorithms getting external scratch instead.
</p><p>The solution therefore is to <i>force</i> the audio algorithm to use external scratch no matter what the create() call ordering is.
</p><p>If we look at <a rel="nofollow" class="external text" href="http://software-dl.ti.com/dsps/dsps_registered_sw/sdo_sb/targetcontent/CE/ce_2_23/codec_engine_2_23_01/docs/html/group__ti__sdo__ce__audio1___a_u_d_d_e_c1.html#gea018c45115cbd0a8770533652d64605">AUDDEC1_create()</a> (or any other VISA create API) there is support to achieve what we desire.
</p><p><i>Note</i> - if this link fails/change just go to Codec Engine Release Notes -&gt; Documentation -&gt; API Ref Guide -&gt; AUDDEC1 Interface
</p><p>Under <tt>AUDDEC1_create</tt> we find exactly the feature we need: -
</p>
<pre>In general, name is the name of the codec configured by the system integrator.
However, an optional "argument string" may be appended to the codec name, to allow the
codec's configured priority and/or the heaps where its memory will be allocated, to be overridden.
This optional argument string is of the form ":priority", ":priority:flag", or "::flag".
</pre>
<pre>priority is the new priority to create the codec with.
</pre>
<pre>The flag must be either 0 or 1, and if 1, all memory allocated for the codec will be in the heap that
corresponds to IALG_EXTERNAL. If flag is 0, the memory for the codec will be allocated from the heaps
it has requested. For example, if a codec named "mp3" has been configured into the system, setting name to
"mp3:4" would cause the codec to be created at priority 4, instead of whatever priority was configured.
This feature is useful if more than one instance of the codec are to be created at different priorities.
</pre>
<pre>The flag can be used to prevent the codec from using any internal memory, for example, if it is to be run
at the same time as another codec that must use internal memory, and there is insufficient internal
memory for both.
</pre>
<p>Perfect. So in this case we [application writer] would do: -
</p><p>&lt;syntaxhighlight lang='c'&gt;
</p>
<pre>aud1Hdl = AUDDEC1_create(aud1Eng, "aacdec::1", aud1Params);
</pre>
<p>&lt;/syntaxhighlight&gt;
</p><p>Now our AAC decoder will use external memory for scratch (no matter what the algorithm actually requested) leaving all the internal memory for video scratch.
</p><p><i>Note</i> - for this to work the external heap must also be configured to truly use external memory via e.g.
</p><p>&lt;syntaxhighlight lang='javascript'&gt;
DSKT2.ESDATA = "DDRALGHEAP";
&lt;/syntaxhighlight&gt;
</p>
<h5><span class="mw-headline" id="More_Info">More Info</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Codec_Engine_configuration_en_breve&amp;action=edit&amp;section=14" title="Edit section: More Info">edit</a><span class="mw-editsection-bracket">]</span></span></h5>
<p>See <a href="http://www.ti.com/lit/pdf/spruev5" class="extiw" title="tidoc:spruev5">DSKT2 User's Guide</a> or <a href="Memory_management_in_XDAIS_with_DSKT2.html" title="Memory management in XDAIS with DSKT2">Memory_management_in_XDAIS_with_DSKT2</a> for more details on DSKT2.  Note that the Codec Engine framework uses the DSKT2 APIs internally, so the API descriptions are not so important; however, the concepts behind scratch groups and configuration are still relevant.
</p>
<h4><span id="DMAN3_configuration_in_Codec_Engine's_configuration_file"></span><span class="mw-headline" id="DMAN3_configuration_in_Codec_Engine.27s_configuration_file">DMAN3 configuration in Codec Engine's configuration file</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Codec_Engine_configuration_en_breve&amp;action=edit&amp;section=15" title="Edit section: DMAN3 configuration in Codec Engine&#039;s configuration file">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>DMAN3 is a module that is used for DMA resource management for codecs. To configure it, first set the heapInternal and heapExternal to memory sections with the corresponding heaps. These are used by DMAN3 for all private objects.
</p><p>Code Example:
&lt;syntaxhighlight lang='javascript'&gt;
/* ... in your .cfg script */
DMAN3.heapInternal = "L1DSRAM";
DMAN3.heapExternal = "DDR";
&lt;/syntaxhighlight&gt;
</p><p>Be aware that DMAN3 takes up PaRam 0 for its internal use (as a 'nullparam') by default, hence it must not be assigned for use for anything else.
</p><p>Set <code>paRamBaseIndex</code>, <code>numQdmaChannels</code>, <code>qdmaChannels</code>, <code>numPaRamEntries</code>, <code>tccAllocationMaskL</code>, <code>tccAllocationMaskH</code> to set the resources to be managed by DMAN3.
</p><p>Code Example:
&lt;syntaxhighlight lang='javascript'&gt;
// DMAN3 will inclusively manage PaRAMs 78-125, QDMA channels 0-7, tcc's 32-63
DMAN3.paRamBaseIndex = 78;
DMAN3.numPaRamEntries = 48;
DMAN3.numQdmaChannels = 8;
DMAN3.qdmaChannels = [0,1,2,3,4,5,6,7];
DMAN3.tccAllocationMaskL = 0;
DMAN3.tccAllocationMaskH = 0xffffffff;
&lt;/syntaxhighlight&gt;
</p><p>Note that DMAN3 works based on a division of codecs into different scratch groups, in which all members share the same scratch resources. <a href="Codec_Engine_GroupIds.html" title="Codec Engine GroupIds"> There is more info on group ids here.</a>
</p><p>If you have access to the source code of the algorithm, set <code>numTccGroup</code> and <code>numPaRamGroup</code> for each group id according to the <code>numWaits</code> and <code>numTransfers</code> fields in the IDMA3 requests from the algorithm:
</p>
<ul><li>numTccGroup[i] &gt;= max{sum(numWaits requested by an algo)} among all algos in group i</li>
<li>numPaRamGroup[i] &gt;= max{sum(numTransfers requested by an algo)} among all algos in group i</li>
<li># bits set to 1 in tccAllocationMaskH and tccAllocationMaskL &gt;= sum(all numTccGroups)</li>
<li>numPaRamEntries &gt;= sum(all numPaRamGroups)</li></ul>
<p>If you don't have the data for <code>numWaits</code> and <code>numTransfers</code>, ask the codec producer. Alternatively, for CE version 2.00 or above, you can set
</p><p>&lt;syntaxhighlight lang='javascript'&gt;
DMAN3.trace = true;
&lt;/syntaxhighlight&gt;
</p><p>in your server's cfg file, rebuild it and then run an application that creates the codec instance after setting the environment variables
</p><p>TRACEUTIL_DSP0TRACEMASK="ti.sdo.fc.dman3=01234567", TRACEUTIL_REFRESHPERIOD=200 and TRACEUTIL_DSP0TRACEFILE="". (You can also run the application with <a href="CE_DEBUG.html" title="CE DEBUG">CE_DEBUG</a> set to 2 to see the DMAN3 trace, though the trace would be more verbose.) During algorithm creation, the DMAN3 trace shows the DMA resources being requested by the algorithm, and you can use that information to determine numTccGroup and numPaRamGroup for each group. For example:
</p>
<pre>@0x00106866:[T:0x88b665f4] ti.sdo.fc.dman3 - DMAN3_grantDmaChannels&gt; Alg 0x88100280:
@0x0010689e:[T:0x88b665f4] ti.sdo.fc.dman3 - DMAN3_grantDmaChannels&gt; Total Channels requested 6, PaRams requested 35, Tccs requested 6
</pre>
<p>The above trace snippet indicates that this algorithm/codec instance requested a total of 35 PaRam entries and 6 Tccs. So the group in which this algorithm belongs to (let's say it is in group i) must have at least numTccGroup[i] &gt;= 6 and numTccGroup[i] &gt;= 35.
</p><p>If you are working on a system with ARM + DSP, it is important to ensure the PaRam entries, TCCs and QDMA channels do not conflict with ARM-side usage. If you are running Montavista Linux on the ARM, you can check out the file /opt/mv_pro_4.0/montavista/pro/devkit/lsp/ti-davinci/arch/arm/mach-davinci/dma.c to find out the DMA resources reserved for use for ARM side drivers.
</p><p>When constrained in amount of internal memory heap space:
</p>
<ul><li>Set DMAN3.idma3Internal to false to force DMAN3 to allocate logical DMA channel representations in the internal heap.</li>
<li>Use shared scratch buffer in DSKT2 to allocate the protocol environment objects as follows:</li></ul>
<p>&lt;syntaxhighlight lang='javascript'&gt;
DMAN3.scratchAllocFxn = "DSKT2_allocScratch";
DMAN3.scratchFreeFxn = "DSKT2_freeScratch";
&lt;/syntaxhighlight&gt;
</p>
<h5><span class="mw-headline" id="Debugging_2">Debugging</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Codec_Engine_configuration_en_breve&amp;action=edit&amp;section=16" title="Edit section: Debugging">edit</a><span class="mw-editsection-bracket">]</span></span></h5>
<p>In Framework Components 1.x, you can configure <code>DMAN3.debug</code> to true during development to enable obtain some tracing information and/or to insert debug symbols for this module. Simply add a line to the server's .cfg file:
</p><p>&lt;syntaxhighlight lang='javascript'&gt;
var DMAN3 = xdc.useModule('ti.sdo.fc.dskt2.DMAN3');
DMAN3.debug=true;  //Add this line
&lt;/syntaxhighlight&gt;
</p><p>In Framework Components 2.x, an additional config param, <code>DMAN3.trace</code>, has been added.  It's orthogonal to <code>DMAN3.debug</code>, meaning you can have all permutations of trace on/off and debug on/off.  It also means that the FC 1.x interpretation of <code>DMAN3.debug = true;</code> providing trace statements is no longer applicable.  FC 2.x users wishing to enable trace need to explicitly set
</p><p>&lt;syntaxhighlight lang='javascript'&gt;DMAN3.trace = true;&lt;/syntaxhighlight&gt;.
</p><p>DMAN3 trace lists out all IDMA3 requests from each codec instance and computes total number of Params, QDMA channels and TCCs allocated for each. This information is useful for determining how much DMA resources should be set aside for DMAN3.
</p><p>More details on syntax in newer releases are here: <a href="FC_Config_Updates.html#Debug_and_Trace_settings" title="FC Config Updates">FC_Config_Updates#Debug_and_Trace_settings</a>
</p>
<h5><span class="mw-headline" id="More_info_2">More info</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Codec_Engine_configuration_en_breve&amp;action=edit&amp;section=17" title="Edit section: More info">edit</a><span class="mw-editsection-bracket">]</span></span></h5>
<p>See <a href="http://www.ti.com/lit/pdf/spraag1" class="extiw" title="tidoc:spraag1">Using DMA with Framework Components for C64+</a> for more detail on DMAN3. It is more than you ever need to know since CE automatically calls the DMAN3 APIs.
</p>
<h4><span class="mw-headline" id="Defining_a_server_in_the_Codec_Engine_configuration">Defining a server in the Codec Engine configuration</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Codec_Engine_configuration_en_breve&amp;action=edit&amp;section=18" title="Edit section: Defining a server in the Codec Engine configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>If you have a heterogenous platform, the DSP is considered to be a server for the ARM. To define a server, simply configure the stackSize and priority of the remote messaging server task, and list out all the algorithms to be included as part of it in Server.algs.
</p><p><tt>Code Example:</tt>
&lt;syntaxhighlight lang='javascript'&gt;
var Server = xdc.useModule('ti.sdo.ce.Server');
Server.threadAttrs.stackSize = 16384;   // Stack size of Codec Engine's remote messaging server task.
Server.threadAttrs.priority = Server.MINPRI;
var VIDDEC_COPY =
</p>
<pre>   xdc.useModule('ti.sdo.ce.examples.codecs.viddec_copy.VIDDEC_COPY');
</pre>
<p>Server.algs = [
</p>
<pre>   // List all codecs that are part of this DSP server
   {name: "viddec_copy",  //Pick a name for this codec
    mod: VIDDEC_COPY,     //Specify the module to be used
    groupId: 0,           //Specify which scratch group this codec belongs to
    threadAttrs: {
       stackMemId: 0,     //heapid for stack allocation of the task running the codec. 0 is the BIOS object heap.
       stackSize: 4096,   //Stack size of the task running the codec
       priority: Server.MINPRI + 1   //Priority of the task running the codec
    }
   },
</pre>
<p>];
&lt;/syntaxhighlight&gt;
</p><p>Note that if the application resides on the DSP, then the DSP is no longer a server. Hence an 'Engine' should be created instead, as detailed in the 'Application configuration' section. The groupId and threadAttrs can then be specified as part of the 'Engine' definition.
</p>
<h3><span class="mw-headline" id="Other_notes">Other notes</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Codec_Engine_configuration_en_breve&amp;action=edit&amp;section=19" title="Edit section: Other notes">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Over time, old configuration parameters have evolved and new configuration parameters have been added. For a summary of changes to configuration parameters, see the <a href="CE_Config_Updates.html" title="CE Config Updates">Codec Engine Configuration Updates article</a>.
</p>
<h3><span class="mw-headline" id="See_Also">See Also</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Codec_Engine_configuration_en_breve&amp;action=edit&amp;section=20" title="Edit section: See Also">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ul><li><a href="Codec_Engine_GroupIds.html" title="Codec Engine GroupIds">Codec Engine GroupIds</a></li>
<li><a href="Codec_Engine_StackMemIds.html" title="Codec Engine StackMemIds">Codec Engine StackMemIds</a></li>
<li><a href="http://www.ti.com/lit/pdf/sprued5" class="extiw" title="tidoc:sprued5">Codec Engine Server Integrator's Guide</a></li></ul>

<!-- 
NewPP limit report
Cached time: 20201130173949
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.057 seconds
Real time usage: 0.058 seconds
Preprocessor visited node count: 124/1000000
Preprocessor generated node count: 184/1000000
Post‐expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 2704/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 -total
-->
</div>
<!-- Saved in parser cache with key procwiki:pcache:idhash:86-0!canonical and timestamp 20201130173949 and revision id 181188
 -->
<div class='hf-nsfooter' id='hf-nsfooter-'><table style="text-align:center; background:white; width:100%; text-align:left; height: 65px border-top: 1px solid; border-bottom: 1px solid; border-left: 1px solid; border-right: 1px solid; border-width: 1px; border-style: solid;">
<tr>
<td width="305px"><a href="File_E2e.html" class="image"><img alt="E2e.jpg" src="https://processors.wiki.ti.com/images/8/82/E2e.jpg" width="305" height="63" /></a>
</td>
<td>{{
<ol><li>switchcategory:MultiCore=</li></ol>
<ul><li>For technical support on MultiCore devices, please post your questions in the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/c6000_multi-core_dsps/default.aspx">C6000 MultiCore Forum</a></li>
<li>For questions related to the BIOS MultiCore SDK (MCSDK), please use the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/embedded/f/355.aspx">BIOS Forum</a></li></ul>
<p>Please post only comments related to the article <b>Codec Engine configuration en breve</b> here.<i></i>
</p>
</td>
<td>Keystone=
<ul><li>For technical support on MultiCore devices, please post your questions in the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/c6000_multi-core_dsps/default.aspx">C6000 MultiCore Forum</a></li>
<li>For questions related to the BIOS MultiCore SDK (MCSDK), please use the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/embedded/f/355.aspx">BIOS Forum</a></li></ul>
<p>Please post only comments related to the article <b>Codec Engine configuration en breve</b> here.<i></i>
</p>
</td>
<td>C2000=<i>For technical support on the C2000 please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/microcontrollers/tms320c2000_32-bit_real-time_mcus/f/171.aspx">The C2000 Forum</a>. Please post only comments about the article <b>Codec Engine configuration en breve</b> here.</i>
</td>
<td>DaVinci=<i>For technical support on DaVincoplease post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/davinci_digital_media_processors/default.aspx">The DaVinci Forum</a>. Please post only comments about the article <b>Codec Engine configuration en breve</b> here.</i>
</td>
<td>MSP430=<i>For technical support on MSP430 please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/microcontrollers/msp43016-bit_ultra-low_power_mcus/default.aspx">The MSP430 Forum</a>. Please post only comments about the article <b>Codec Engine configuration en breve</b> here.</i>
</td>
<td>OMAP35x=<i>For technical support on OMAP please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/omap_applications_processors/default.aspx">The OMAP Forum</a>. Please post only comments about the article <b>Codec Engine configuration en breve</b> here.</i>
</td>
<td>OMAPL1=<i>For technical support on OMAP please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/omap_applications_processors/default.aspx">The OMAP Forum</a>. Please post only comments about the article <b>Codec Engine configuration en breve</b> here.</i>
</td>
<td>MAVRK=<i>For technical support on MAVRK please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/development_tools/mavrk/default.aspx">The MAVRK Toolbox Forum</a>. Please post only comments about the article <b>Codec Engine configuration en breve</b> here.</i>
</td>
<td><i>For technical support please post your questions at <a rel="nofollow" class="external text" href="http://e2e.ti.com/">http://e2e.ti.com</a>. Please post only comments about the article <b>Codec Engine configuration en breve</b> here.</i>
<p>}}
</p>
</td></tr></table>
<table style="border-style:solid; border-width:1px; text-align:center; width:100%;">

<tr style="font-size:150%;">
<td rowspan="2"><a href="File_Hyperlink_blue.html" class="image"><img alt="Hyperlink blue.png" src="https://processors.wiki.ti.com/images/9/9f/Hyperlink_blue.png" width="96" height="96" /></a>
</td>
<td><b>Links</b>
</td></tr>
<tr>
<td>
<table style="text-align: left;">
<tr>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/amplifier_and_linear.page">Amplifiers &amp; Linear</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/audio/audio_overview.page">Audio</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/rfif.page">Broadband RF/IF &amp; Digital Radio</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/clocksandtimers/clocks_and_timers.page">Clocks &amp; Timers</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/dataconverters/data_converter.page">Data Converters</a>
</p>
</td>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/mems/mems.page">DLP &amp; MEMS</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/high_reliability.page">High-Reliability</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/interface/interface.page">Interface</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/logic/home_overview.page">Logic</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/powermanagement/power_portal.page">Power Management</a>
</p>
</td>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/dsp/embedded_processor.page">Processors</a>
</p>
<ul><li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/dsp/arm.page">ARM Processors</a></li>
<li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/dsp/home.page">Digital Signal Processors (DSP)</a></li>
<li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/microcontroller/home.page">Microcontrollers (MCU)</a></li>
<li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/omap-applications-processors/the-omap-experience.page">OMAP Applications Processors</a></li></ul>
</td>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/switches_and_multiplexers.page">Switches &amp; Multiplexers</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/temperature_sensor.page">Temperature Sensors &amp; Control ICs</a><br/>
<a rel="nofollow" class="external text" href="http://focus.ti.com/wireless/docs/wirelessoverview.tsp?familyId=2003&amp;sectionId=646&amp;tabId=2735">Wireless Connectivity</a>
</p>
</td></tr></table>
</td></tr></table>
<div id="tiPrivacy"></div>
</div></div>					<div class="printfooter">
						Retrieved from "<a dir="ltr" href="https://processors.wiki.ti.com/index.php?title=Codec_Engine_configuration_en_breve&amp;oldid=181188">https://processors.wiki.ti.com/index.php?title=Codec_Engine_configuration_en_breve&amp;oldid=181188</a>"					</div>
				<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="Special_Categories.html" title="Special:Categories">Categories</a>: <ul><li><a href="Category_MFP.html" title="Category:MFP">MFP</a></li><li><a href="Category_Framework_Components.html" title="Category:Framework Components">Framework Components</a></li><li><a href="Category_Codec_Engine.html" title="Category:Codec Engine">Codec Engine</a></li><li><a href="Category_DMA.html" title="Category:DMA">DMA</a></li><li><a href="Category_DVEVM.html" title="Category:DVEVM">DVEVM</a></li></ul></div></div>				<div class="visualClear"></div>
							</div>
		</div>
		<div id="mw-navigation">
			<h2>Navigation menu</h2>
			<div id="mw-head">
									<div id="p-personal" role="navigation" class="" aria-labelledby="p-personal-label">
						<h3 id="p-personal-label">Personal tools</h3>
						<ul>
							<li id="pt-login"><a href="https://processors.wiki.ti.com/index.php?title=Special:UserLogin&amp;returnto=Codec+Engine+configuration+en+breve" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li><li id="pt-createaccount"><a href="Special_RequestAccount.html" title="You are encouraged to create an account and log in; however, it is not mandatory">Request account</a></li>						</ul>
					</div>
									<div id="left-navigation">
										<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
						<h3 id="p-namespaces-label">Namespaces</h3>
						<ul>
							<li id="ca-nstab-main" class="selected"><span><a href="Codec_Engine_configuration_en_breve.html" title="View the content page [c]" accesskey="c">Page</a></span></li><li id="ca-talk" class="new"><span><a href="https://processors.wiki.ti.com/index.php?title=Talk:Codec_Engine_configuration_en_breve&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page (page does not exist) [t]" accesskey="t">Discussion</a></span></li>						</ul>
					</div>
										<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
												<input type="checkbox" class="vectorMenuCheckbox" aria-labelledby="p-variants-label" />
						<h3 id="p-variants-label">
							<span>Variants</span>
						</h3>
						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
									</div>
				<div id="right-navigation">
										<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
						<h3 id="p-views-label">Views</h3>
						<ul>
							<li id="ca-view" class="collapsible selected"><span><a href="Codec_Engine_configuration_en_breve.html">Read</a></span></li><li id="ca-viewsource" class="collapsible"><span><a href="https://processors.wiki.ti.com/index.php?title=Codec_Engine_configuration_en_breve&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></span></li><li id="ca-history" class="collapsible"><span><a href="https://processors.wiki.ti.com/index.php?title=Codec_Engine_configuration_en_breve&amp;action=history" title="Past revisions of this page [h]" accesskey="h">View history</a></span></li>						</ul>
					</div>
										<div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label">
						<input type="checkbox" class="vectorMenuCheckbox" aria-labelledby="p-cactions-label" />
						<h3 id="p-cactions-label"><span>More</span></h3>
						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
										<div id="p-search" role="search">
						<h3>
							<label for="searchInput">Search</label>
						</h3>
						<form action="https://processors.wiki.ti.com/index.php" id="searchform">
							<div id="simpleSearch">
								<input type="search" name="search" placeholder="Search Texas Instruments Wiki" title="Search Texas Instruments Wiki [f]" accesskey="f" id="searchInput"/><input type="hidden" value="Special:Search" name="title"/><input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton mw-fallbackSearchButton"/><input type="submit" name="go" value="Go" title="Go to a page with this exact name if it exists" id="searchButton" class="searchButton"/>							</div>
						</form>
					</div>
									</div>
			</div>
			<div id="mw-panel">
				<div id="p-logo" role="banner"><a class="mw-wiki-logo" href="Main_Page.html"  title="Visit the main page"></a></div>
						<div class="portal" role="navigation" id="p-navigation" aria-labelledby="p-navigation-label">
			<h3 id="p-navigation-label">Navigation</h3>
			<div class="body">
								<ul>
					<li id="n-mainpage"><a href="Main_Page.html" title="Visit the main page [z]" accesskey="z">Main Page</a></li><li id="n-All-pages"><a href="Special_AllPages.html">All pages</a></li><li id="n-All-categories"><a href="Special_Categories.html">All categories</a></li><li id="n-recentchanges"><a href="Special_RecentChanges.html" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li><li id="n-randompage"><a href="Package_Reflow_Profiles.html" title="Load a random page [x]" accesskey="x">Random page</a></li><li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" title="The place to find out">Help</a></li>				</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id="p-tb" aria-labelledby="p-tb-label">
			<h3 id="p-tb-label">Toolbox</h3>
			<div class="body">
								<ul>
					<li id="t-whatlinkshere"><a href="Special_WhatLinksHere/Codec_Engine_configuration_en_breve.html" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li><li id="t-recentchangeslinked"><a href="Special_RecentChangesLinked/Codec_Engine_configuration_en_breve.html" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li><li id="t-specialpages"><a href="Special_SpecialPages.html" title="A list of all special pages [q]" accesskey="q">Special pages</a></li><li id="t-print"><a href="https://processors.wiki.ti.com/index.php?title=Codec_Engine_configuration_en_breve&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li><li id="t-permalink"><a href="https://processors.wiki.ti.com/index.php?title=Codec_Engine_configuration_en_breve&amp;oldid=181188" title="Permanent link to this revision of the page">Permanent link</a></li><li id="t-info"><a href="https://processors.wiki.ti.com/index.php?title=Codec_Engine_configuration_en_breve&amp;action=info" title="More information about this page">Page information</a></li>				</ul>
							</div>
		</div>
				</div>
		</div>
				<div id="footer" role="contentinfo">
						<ul id="footer-info">
								<li id="footer-info-lastmod"> This page was last edited on 9 July 2014, at 12:39.</li>
								<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-ShareAlike</a> unless otherwise noted.</li>
							</ul>
						<ul id="footer-places">
								<li id="footer-places-privacy"><a href="Project_Privacy_policy.html" title="Project:Privacy policy">Privacy policy</a></li>
								<li id="footer-places-about"><a href="Project_About.html" title="Project:About">About Texas Instruments Wiki</a></li>
								<li id="footer-places-disclaimer"><a href="Project_General_disclaimer.html" title="Project:General disclaimer">Disclaimers</a></li>
								<li id="footer-places-termsofservice"><a href="Project_Terms_of_Service.html" title="Project:Terms of Service">Terms of Use</a></li>
							</ul>
										<ul id="footer-icons" class="noprint">
										<li id="footer-copyrightico">
						<a href="http://creativecommons.org/licenses/by-sa/3.0/"><img src="https://processors.wiki.ti.com/resources/assets/licenses/cc-by-sa.png" alt="Creative Commons Attribution-ShareAlike" width="88" height="31"/></a>					</li>
										<li id="footer-poweredbyico">
						<a href="http://www.mediawiki.org/"><img src="https://processors.wiki.ti.com/resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31"/></a>					</li>
									</ul>
						<div style="clear: both;"></div>
		</div>
		<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgPageParseReport":{"limitreport":{"cputime":"0.057","walltime":"0.058","ppvisitednodes":{"value":124,"limit":1000000},"ppgeneratednodes":{"value":184,"limit":1000000},"postexpandincludesize":{"value":0,"limit":2097152},"templateargumentsize":{"value":0,"limit":2097152},"expansiondepth":{"value":2,"limit":40},"expensivefunctioncount":{"value":0,"limit":100},"unstrip-depth":{"value":0,"limit":20},"unstrip-size":{"value":2704,"limit":5000000},"timingprofile":["100.00%    0.000      1 -total"]},"cachereport":{"timestamp":"20201130173949","ttl":86400,"transientcontent":false}}});});</script><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":316});});</script>
	</body>

<!-- Mirrored from processors.wiki.ti.com/index.php/Codec_Engine_configuration_en_breve by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 01 Dec 2020 04:29:48 GMT -->
</html>
