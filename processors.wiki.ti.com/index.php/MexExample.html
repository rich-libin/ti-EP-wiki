<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">

<!-- Mirrored from processors.wiki.ti.com/index.php/MexExample by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 01 Dec 2020 10:30:37 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8"/>
<title>MexExample - Texas Instruments Wiki</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"MexExample","wgTitle":"MexExample","wgCurRevisionId":189195,"wgRevisionId":189195,"wgArticleId":19757,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["C66x"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"MexExample","wgRelevantArticleId":19757,"wgRequestId":"72308b1074d4b7bbf2eaacf3","wgIsProbablyEditable":false,"wgRelevantPageIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[]});mw.loader.state({"site.styles":"ready","noscript":"ready","user.styles":"ready","user":"ready","user.options":"ready","user.tokens":"loading","mediawiki.legacy.shared":"ready","mediawiki.legacy.commonPrint":"ready","mediawiki.sectionAnchor":"ready","mediawiki.skinning.interface":"ready","skins.vector.styles":"ready"});mw.loader.implement("user.tokens@19o3a1s",function($,jQuery,require,module){/*@nomin*/mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});
});mw.loader.load(["site","mediawiki.page.startup","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.toc","mediawiki.searchSuggest","skins.vector.js"]);});</script>
<link rel="stylesheet" href="https://processors.wiki.ti.com/load.php?debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.interface%7Cskins.vector.styles&amp;only=styles&amp;skin=vector"/>
<script async="" src="https://processors.wiki.ti.com/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=vector"></script>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="https://processors.wiki.ti.com/load.php?debug=false&amp;lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=vector"/>
<meta name="generator" content="MediaWiki 1.31.6"/>
<link rel="shortcut icon" href="https://processors.wiki.ti.com/favicon.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="https://processors.wiki.ti.com/opensearch_desc.php" title="Texas Instruments Wiki (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="https://processors.wiki.ti.com/api.php?action=rsd"/>
<link rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/"/>
<link rel="alternate" type="application/atom+xml" title="Texas Instruments Wiki Atom feed" href="https://processors.wiki.ti.com/index.php?title=Special:RecentChanges&amp;feed=atom"/>
<!--[if lt IE 9]><script src="/load.php?debug=false&amp;lang=en&amp;modules=html5shiv&amp;only=scripts&amp;skin=Vector&amp;sync=1"></script><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-MexExample rootpage-MexExample skin-vector action-view">		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<div id="content" class="mw-body" role="main">
			<a id="top"></a>
			<div id="siteNotice" class="mw-body-content"><div id="localNotice" lang="en" dir="ltr"><div class="mw-parser-output"><p><br />
<span style="color:#ff0000"><b>NOTICE: The Processors Wiki will End-of-Life on January 15, 2021. It is recommended to download any files or other content you may need that are hosted on processors.wiki.ti.com. The site is now set to read only.</b></span>
</p></div></div></div><div class="mw-indicators mw-body-content">
</div>
<h1 id="firstHeading" class="firstHeading" lang="en">MexExample</h1>			<div id="bodyContent" class="mw-body-content">
				<div id="siteSub" class="noprint">From Texas Instruments Wiki</div>				<div id="contentSub"></div>
								<div id="jump-to-nav" class="mw-jump">
					Jump to:					<a href="#mw-head">navigation</a>, 					<a href="#p-search">search</a>
				</div>
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output"><p>
</p><p><br />
</p><p><br />
</p><p><b>This example shows how to take DSP C code that uses TI C66x intrinsic FFT functions and create a mex file for use in Matlab.  This allows you to compare simulation results in Matlab from your DSP code and any straight matlab functions/model you have.</b>
</p><p><br />
</p>
<div id="toc" class="toc"><div class="toctitle" lang="en" dir="ltr"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Library_Requirements"><span class="tocnumber">1</span> <span class="toctext">Library Requirements</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Tool_Requirements"><span class="tocnumber">2</span> <span class="toctext">Tool Requirements</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Executing_the_Example"><span class="tocnumber">3</span> <span class="toctext">Executing the Example</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#makeFftDspLib.m"><span class="tocnumber">4</span> <span class="toctext">makeFftDspLib.m</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#mexFftDspLib.c"><span class="tocnumber">5</span> <span class="toctext">mexFftDspLib.c</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#runExample.m"><span class="tocnumber">6</span> <span class="toctext">runExample.m</span></a></li>
</ul>
</div>

<h1><span class="mw-headline" id="Library_Requirements">Library Requirements</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=MexExample&amp;action=edit&amp;section=1" title="Edit section: Library Requirements">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>This example makes use of intrinsic functions that are part of TI's DSPLib.  Please find the DSPLib as part of the Multicore Software Development Kit (MCSDK).  This can be downloaded at:
</p><p><a rel="nofollow" class="external free" href="http://software-dl.ti.com/sdoemb/sdoemb_public_sw/bios_mcsdk/latest/index_FDS.html">http://software-dl.ti.com/sdoemb/sdoemb_public_sw/bios_mcsdk/latest/index_FDS.html</a>
</p><p>or standalone DSPLib at:
</p><p><a rel="nofollow" class="external free" href="http://software-dl.ti.com/sdoemb/sdoemb_public_sw/dsplib/latest/index_FDS.html">http://software-dl.ti.com/sdoemb/sdoemb_public_sw/dsplib/latest/index_FDS.html</a>
</p><p><br />
After installing, the intrinsic source can be found at:
</p><p><b>C:\ti\dsplib_c66x_3_1_x_x\packages\ti\dsplib\src</b>
</p><p>The functions used for this example are:
</p><p>DSP_fft16x16
</p><p>DSP_fft16x16r
</p><p>DSP_fft16x32
</p><p>DSP_fft32x32
</p><p>DSPF_dp_fftDPxDP
</p><p>DSPF_sp_fftSPxSP
</p><p><br />
</p><p>The intrinsic functions from DSPLib version 3.1.1.1 (and later) will compile with host intrinsic libraries.  If using earlier versions of the DSPLib, edits to the instrinsic files will be needed (See <a rel="nofollow" class="external free" href="Mex_old_DSPLIB_Instr.html">http://processors.wiki.ti.com/index.php/Mex_old_DSPLIB_Instr</a>)
</p><p><br />
</p>
<h1><span class="mw-headline" id="Tool_Requirements">Tool Requirements</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=MexExample&amp;action=edit&amp;section=2" title="Edit section: Tool Requirements">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>This flow requires the C6x intrinsic simulator, available at:
</p><p><a rel="nofollow" class="external free" href="Run_Intrinsics_Code_Anywhere.html">http://processors.wiki.ti.com/index.php/Run_Intrinsics_Code_Anywhere</a>.
</p><p>An environmental variable <b>C6XSIM_INSTALL_DIR</b> indicating its installation directory is needed.
</p><p><br />
</p>
<h1><span class="mw-headline" id="Executing_the_Example">Executing the Example</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=MexExample&amp;action=edit&amp;section=3" title="Edit section: Executing the Example">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>This example was tested with Matlab 7.1.2.0 (R2011a) and VC++ 2008 Express Edition 
</p><p>Please note: The code here does not compile with matlab in-built compiler lcc, use mex -setup in matlab to choose a VC++ compiler.
</p><p>run makeFftDspLib with proper argument flavor to create mex version of the corresponding DSPLIB FFT
</p><p>runExample.m compares the mexed DSPLib FFT output with the output from the MatLab in-built FFTs.
</p>
<h1><span class="mw-headline" id="makeFftDspLib.m">makeFftDspLib.m</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=MexExample&amp;action=edit&amp;section=4" title="Edit section: makeFftDspLib.m">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<pre>function []=makeFftDspLib(flavor)
% function to mex the desired FFT
% flavor - the type of FFT to be used
%          currently supported flavors
%          'DSP_fft16x16'
%          'DSP_fft16x16r'
%          'DSP_fft16x32'
%          'DSP_fft32x32'
%          'DSP_fft32x32s'
%          'DSP_sp_fftSPxSP'
%          'DSP_dp_fftDPxDP'
%

% get directories
% C6x simulator installation directory
c6xSimDir = getenv('C6XSIM_INSTALL_DIR');
% DSPLIB directiry
dspLibDir = './';
mexDir = './';
defines = '-DTMS320C66X -D_TMS320C6600 -DLITTLE_ENDIAN_HOST -D_LITTLE_ENDIAN';

srcFiles  = [c6xSimDir '/C6xSimulator.c ' ...
    c6xSimDir '/C66_ag_intrins.c ' ...
    c6xSimDir '/C66_data_sim.c ' ...
    mexDir '/mexFftDspLib.c '];
includeDir = [' -I' c6xSimDir ' -I' dspLibDir 'packages'];
switch flavor
    case 'DSP_fft16x16'
        srcDir = [dspLibDir '/packages/ti/dsplib/src/DSP_fft16x16/c66/'];
        srcFiles = [srcFiles ...
            srcDir 'gen_twiddle_fft16x16.c '...
            srcDir 'DSP_fft16x16.c'];
        defines = [defines ' -DDSP_FFT16X16'];
        outFile = ['DSP_fft16x16'];
    case 'DSP_fft16x16r'
        srcDir = [dspLibDir '/packages/ti/dsplib/src/DSP_fft16x16r/c66/'];
        srcFiles = [srcFiles ...
            srcDir 'gen_twiddle_fft16x16r.c '...
            srcDir 'DSP_fft16x16r.c'];
        defines = [defines ' -DDSP_FFT16X16R'];
        outFile = ['DSP_fft16x16r'];
    case 'DSP_fft16x32'
        srcDir = [dspLibDir '/packages/ti/dsplib/src/DSP_fft16x32/c66/'];
        srcFiles = [srcFiles ...
            srcDir 'gen_twiddle_fft16x32.c '...
            srcDir 'DSP_fft16x32.c'];
        defines = [defines ' -DDSP_FFT16X32'];
        outFile = ['DSP_fft16x32'];
    case 'DSP_fft32x32'
        srcDir = [dspLibDir '/packages/ti/dsplib/src/DSP_fft32x32/c66/'];
        srcFiles = [srcFiles ...
            srcDir 'gen_twiddle_fft32x32.c '...
            srcDir 'DSP_fft32x32.c'];
        defines = [defines ' -DDSP_FFT32X32'];
        outFile = ['DSP_fft32x32'];
    case 'DSPF_sp_fftSPxSP'
        srcDir = [dspLibDir '/packages/ti/dsplib/src/DSPF_sp_fftSPxSP/c66/'];
        srcFiles = [srcFiles ...
            srcDir 'DSPF_sp_fftSPxSP_opt.c'];
        defines = [defines ' -DDSPF_SP_FFTSPXSP'];
        outFile = ['DSPF_sp_fftSPxSP'];
    case 'DSPF_dp_fftDPxDP'
        srcDir = [dspLibDir '/packages/ti/dsplib/src/DSPF_dp_fftDPxDP/c66/'];
        srcFiles = [srcFiles ...
            srcDir 'DSPF_dp_fftDPxDP.c'];
        defines = [defines ' -DDSPF_DP_FFTDPXDP'];
        outFile = ['DSPF_dp_fftDPxDP'];
    otherwise
        error(['~makeFft.m: flavor not defined for mexing']);
end;

% create the mex command
mexCommand = ['mex -output ' mexDir outFile ' ' srcFiles ...
              includeDir ' ' defines];
% disp(mexCommand);

% evlaute mex command
eval(mexCommand);

return
</pre>
<h1><span class="mw-headline" id="mexFftDspLib.c">mexFftDspLib.c</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=MexExample&amp;action=edit&amp;section=5" title="Edit section: mexFftDspLib.c">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<pre>/**
 *  @file   mexFftDspLib.c
 *  @brief  The file contains mex implementation of DSPLib fft funcstions
 *  only input is input vector (complex or real)
 *  only output is fft of input data (complex)
 *  (C) Copyright 2012, Texas Instruments, Inc.
 */

#include "mex.h"

#ifdef DSP_FFT16X16
#include "ti/dsplib/src/DSP_fft16x16/DSP_fft16x16.h"
#include "ti/dsplib/src/DSP_fft16x16/c66/gen_twiddle_fft16x16.h"

#define IOTYPE short
#define TWIDDLETYPE short
#define MAXFFTSIZE 65536
#define MINFFTSIZE 16
#endif

#ifdef DSP_FFT16X16R
#include "ti/dsplib/src/DSP_fft16x16r/DSP_fft16x16r.h"
#include "ti/dsplib/src/DSP_fft16x16r/c66/gen_twiddle_fft16x16r.h"

#define IOTYPE short
#define TWIDDLETYPE short
#define MAXFFTSIZE 65536
#define MINFFTSIZE 16
#endif

#ifdef DSP_FFT16X32
#include "ti/dsplib/src/DSP_fft16x32/DSP_fft16x32.h"
#include "ti/dsplib/src/DSP_fft16x32/c66/gen_twiddle_fft16x32.h"

#define IOTYPE int
#define TWIDDLETYPE short
#define MAXFFTSIZE 65536
#define MINFFTSIZE 16
#endif

#ifdef DSP_FFT32X32
#include "ti/dsplib/src/DSP_fft32x32/DSP_fft32x32.h"
#include "ti/dsplib/src/DSP_fft32x32/c66/gen_twiddle_fft32x32.h"

#define IOTYPE int
#define TWIDDLETYPE int
#define MAXFFTSIZE 65536
#define MINFFTSIZE 16
#endif

#ifdef DSPF_SP_FFTSPXSP
#include "ti/dsplib/src/DSPF_sp_fftSPxSP/c66/DSPF_sp_fftSPxSP_opt.h"

#define IOTYPE float
#define TWIDDLETYPE float
#define MAXFFTSIZE 131072
#define MINFFTSIZE 8

void gen_twiddle_fftspxsp(float *w, int n);

unsigned char brev[64] = {
    0x0, 0x20, 0x10, 0x30, 0x8, 0x28, 0x18, 0x38,
    0x4, 0x24, 0x14, 0x34, 0xc, 0x2c, 0x1c, 0x3c,
    0x2, 0x22, 0x12, 0x32, 0xa, 0x2a, 0x1a, 0x3a,
    0x6, 0x26, 0x16, 0x36, 0xe, 0x2e, 0x1e, 0x3e,
    0x1, 0x21, 0x11, 0x31, 0x9, 0x29, 0x19, 0x39,
    0x5, 0x25, 0x15, 0x35, 0xd, 0x2d, 0x1d, 0x3d,
    0x3, 0x23, 0x13, 0x33, 0xb, 0x2b, 0x1b, 0x3b,
    0x7, 0x27, 0x17, 0x37, 0xf, 0x2f, 0x1f, 0x3f
};
#endif

#ifdef DSPF_DP_FFTDPXDP
#include "ti/dsplib/src/DSPF_dp_fftDPxDP/c66/DSPF_dp_fftDPxDP.h"

#define IOTYPE double
#define TWIDDLETYPE double
#define MAXFFTSIZE 131072
#define MINFFTSIZE 8

void gen_twiddle_fftdpxdp(double *w, int n);

#endif

/* The gateway routine. */
void mexFunction( int nlhs, mxArray *plhs[],
                  int nrhs, const mxArray *prhs[] )
{

    double *pInputR, *pInputI, * pOutputR, *pOutputI;
	IOTYPE *fftInput, *fftOutput;
	TWIDDLETYPE *twiddle;
    int fftSize, index, size;
    int m, n;

	/* get input vector sizes */
    m = mxGetM(prhs[0]);
    n = mxGetN(prhs[0]);

	/* input error checking */
	if(m==1)
	{
		fftSize = n;
	}
	else if(n==1)
	{
		fftSize = m;
	}
	else
	{
		mexErrMsgTxt("Input must be a vector");
	}

	/* check for fftSize to be power of 2 */
	if((fftSize &amp; (fftSize-1))&#160;!= 0)
	{
		mexErrMsgTxt("size of input vector must be a power of 2");
	}

	if(fftSize &gt;= MAXFFTSIZE)
	{
		mexErrMsgTxt("size of input vector exceeds maximum allowed value");
	}

	if(fftSize &lt;= MINFFTSIZE)
	{
		mexErrMsgTxt("size of input vector is less than minimum allowed value");
	}

	/* allocate memory (twice FFT size to accomodate real amd imaginary) */
    fftInput  = (IOTYPE *)mxCalloc(sizeof(IOTYPE), 2*fftSize);
    fftOutput = (IOTYPE *)mxCalloc(sizeof(IOTYPE), 2*fftSize);
    twiddle   = (TWIDDLETYPE *)mxCalloc(sizeof(TWIDDLETYPE), 2*fftSize);
 
	if(mxIsComplex(prhs[0])) /* input data is complex */
	{
		pInputR = mxGetPr(prhs[0]);
		pInputI = mxGetPi(prhs[0]);
		for (index = 0; index &lt; fftSize; index++)
	    {
			/* fill in real data */
			fftInput[2*index] = (IOTYPE)(pInputR[index]);
			/* fill in imag data */
			fftInput[2*index+1] = (IOTYPE)(pInputI[index]);
		}
	}
	else if(mxIsDouble(prhs[0])) /* input data is real */
	{
		pInputR = mxGetPr(prhs[0]);
		for (index = 0; index &lt; fftSize; index++)
	    {
			/* fill in real data */
			fftInput[2*index] = (IOTYPE)(pInputR[index]);
			/* imaginary part filled with zero */
		}
	}
	else
	{
		mexErrMsgTxt("Input must be a complex or real");
	}

#ifdef DSP_FFT16X16
	/* generate twiddle factor */
	size = gen_twiddle_fft16x16(twiddle, fftSize);
    /* call FFT function */
	DSP_fft16x16(twiddle, fftSize, fftInput, fftOutput);
#endif

#ifdef DSP_FFT16X16R
	{ int i, j, rad;
      j = 0;
      for (i = 0; i &lt;= 31; i++)
        if ((fftSize &amp; (1 &lt;&lt; i)) == 0)
          j++;
        else
          break;

      if (j&#160;% 2 == 0)
        rad = 4;
      else
        rad = 2;
	  /* generate twiddle factor */
	  size = gen_twiddle_fft16x16r(twiddle, fftSize);
      /* call FFT function */
	  DSP_fft16x16r(fftSize, fftInput, twiddle, fftOutput, rad, 0, fftSize);
	}
#endif

#ifdef DSP_FFT16X32
	/* generate twiddle factor */
	size = gen_twiddle_fft16x32(twiddle, fftSize);
    /* call FFT function */
	DSP_fft16x32(twiddle, fftSize, fftInput, fftOutput);
#endif

#ifdef DSP_FFT32X32
	/* generate twiddle factor */
	size = gen_twiddle_fft32x32(twiddle, fftSize, pow(2.0, 31.0) - 0.5);
    /* call FFT function */
	DSP_fft32x32(twiddle, fftSize, fftInput, fftOutput);
#endif

#ifdef DSPF_SP_FFTSPXSP
	{ int i, j, rad;
      j = 0;
      for (i = 0; i &lt;= 31; i++)
        if ((fftSize &amp; (1 &lt;&lt; i)) == 0)
          j++;
        else
          break;

      if (j&#160;% 2 == 0)
        rad = 4;
      else
        rad = 2;
	  /* generate twiddle factor */
	  gen_twiddle_fftspxsp(twiddle, fftSize);
      /* call FFT function */
	  DSPF_sp_fftSPxSP_opt(fftSize, fftInput, twiddle, fftOutput, brev, rad, 0, fftSize);
	}
#endif

#ifdef DSPF_DP_FFTDPXDP
	{ int i, j, rad;
      j = 0;
      for (i = 0; i &lt;= 31; i++)
        if ((fftSize &amp; (1 &lt;&lt; i)) == 0)
          j++;
        else
          break;

      if (j&#160;% 2 == 0)
        rad = 4;
      else
        rad = 2;
	  /* generate twiddle factor */
	  gen_twiddle_fftdpxdp(twiddle, fftSize);
      /* call FFT function */
	  DSPF_dp_fftDPxDP(fftSize, fftInput, twiddle, fftOutput, rad, 0, fftSize);
	}
#endif

    /* put data into matlab output */
	/* create memory */
    plhs[0] = mxCreateDoubleMatrix(m, n, mxCOMPLEX);

	/* get memory pointers */
	pOutputR = mxGetPr(plhs[0]);
	pOutputI = mxGetPi(plhs[0]);

	/* data into output memory */
    for (index = 0; index &lt; fftSize; index++)
    {
        pOutputR[index] = (double) fftOutput[2*index];
        pOutputI[index] = (double) fftOutput[2*index+1];
    }

    /* free all allocated memory */
    mxFree(fftInput);
    mxFree(fftOutput);
    mxFree(twiddle);


}

#ifdef DSPF_SP_FFTSPXSP
#include math.h 
/* Function for generating Specialized sequence of twiddle factors */
void gen_twiddle_fftspxsp(float *w, int n)
{
    int i, j, k;
    const double PI = 3.141592654;

    for (j = 1, k = 0; j &lt;= n &gt;&gt; 2; j = j &lt;&lt; 2)
    {
        for (i = 0; i &lt; n &gt;&gt; 2; i += j)
        {
#ifdef _LITTLE_ENDIAN
            w[k]     = (float) sin (2 * PI * i / n);
            w[k + 1] = (float) cos (2 * PI * i / n);
            w[k + 2] = (float) sin (4 * PI * i / n);
            w[k + 3] = (float) cos (4 * PI * i / n);
            w[k + 4] = (float) sin (6 * PI * i / n);
            w[k + 5] = (float) cos (6 * PI * i / n);
#else
            w[k]     = (float)  cos (2 * PI * i / n);
            w[k + 1] = (float) -sin (2 * PI * i / n);
            w[k + 2] = (float)  cos (4 * PI * i / n);
            w[k + 3] = (float) -sin (4 * PI * i / n);
            w[k + 4] = (float)  cos (6 * PI * i / n);
            w[k + 5] = (float) -sin (6 * PI * i / n);
#endif
            k += 6;
        }
    }
}
#endif

#ifdef DSPF_DP_FFTDPXDP
/* Function for generating Specialized sequence of twiddle factors */
void gen_twiddle_fftdpxdp(double *w, int n)
{
    int i, j, k;
    const double PI = 3.141592654;

    for (j = 1, k = 0; j &lt;= n &gt;&gt; 2; j = j &lt;&lt; 2)
    {
        for (i = 0; i &lt; n &gt;&gt; 2; i += j)
        {
            w[k]     = cos (2 * PI * i / n);
            w[k + 1] = sin (2 * PI * i / n);
            w[k + 2] = cos (4 * PI * i / n);
            w[k + 3] = sin (4 * PI * i / n);
            w[k + 4] = cos (6 * PI * i / n);
            w[k + 5] = sin (6 * PI * i / n);
            k += 6;
        }
    }
}
#endif
</pre>
<h1><span class="mw-headline" id="runExample.m">runExample.m</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=MexExample&amp;action=edit&amp;section=6" title="Edit section: runExample.m">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<pre>% first mex all FFT versions
disp('mexing DSP_fft16x16');
makeFftDspLib('DSP_fft16x16');
disp('mexing DSP_fft16x16r');
makeFftDspLib('DSP_fft16x16r');
disp('mexing DSP_fft16x32');
makeFftDspLib('DSP_fft16x32');
disp('mexing DSP_fft32x32');
makeFftDspLib('DSP_fft32x32');
disp('mexing DSPF_sp_fftSPxSP');
makeFftDspLib('DSPF_sp_fftSPxSP');
disp('mexing DSPF_dp_fftDPxDP');
makeFftDspLib('DSPF_dp_fftDPxDP');

listN=[128 256 512 1024];

for cnt=1:length(listN),
    N=listN(cnt);
    disp('running test For N =');
    disp(N);
   &#160;% scaled input (to ensure no saturation for 16x16 implementations)
    x=fix(2^(15-log(N)/log(4)-1)*rand(N,1));
   &#160;% Matlab FFT
    xfRef=fft(x);
    
    xfOut=DSP_fft16x16(x);
    scale=2^(ceil(log(N)/log(4))-1);
    disp('DSP_fft16x16 SNR:');
    disp(20*log10(norm(scale*xfOut-xfRef)/norm(xfRef)));
    
    xfOut=DSP_fft16x16r(x);
    scale=2^(ceil(log(N)/log(4))-1);
    disp('DSP_fft16x16r SNR:');
    disp(20*log10(norm(scale*xfOut-xfRef)/norm(xfRef)));
    
    xfOut=DSP_fft16x32(x);
    scale=1;
    disp('DSP_fft16x32 SNR:');
    disp(20*log10(norm(scale*xfOut-xfRef)/norm(xfRef)));
    
    xfOut=DSP_fft32x32(x);
    scale=1;
    disp('DSP_fft32x32 SNR:');
    disp(20*log10(norm(scale*xfOut-xfRef)/norm(xfRef)));
    
    xfOut=DSPF_sp_fftSPxSP(x);
    scale=1;
    disp('DSPF_sp_fftSPxSP SNR:');
    disp(20*log10(norm(scale*xfOut-xfRef)/norm(xfRef)));
    
    xfOut=DSPF_dp_fftDPxDP(x);
    scale=1;
    disp('DSPF_dp_fftDPxDP SNR:');
    disp(20*log10(norm(scale*xfOut-xfRef)/norm(xfRef)));
    
end;
</pre>

<!-- 
NewPP limit report
Cached time: 20201201044005
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.021 seconds
Real time usage: 0.022 seconds
Preprocessor visited node count: 44/1000000
Preprocessor generated node count: 88/1000000
Post‐expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 12505/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 -total
-->
</div>
<!-- Saved in parser cache with key procwiki:pcache:idhash:19757-0!canonical and timestamp 20201201044005 and revision id 189195
 -->
</div>					<div class="printfooter">
						Retrieved from "<a dir="ltr" href="https://processors.wiki.ti.com/index.php?title=MexExample&amp;oldid=189195">https://processors.wiki.ti.com/index.php?title=MexExample&amp;oldid=189195</a>"					</div>
				<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="Special_Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="Category_C66x.html" title="Category:C66x">C66x</a></li></ul></div></div>				<div class="visualClear"></div>
							</div>
		</div>
		<div id="mw-navigation">
			<h2>Navigation menu</h2>
			<div id="mw-head">
									<div id="p-personal" role="navigation" class="" aria-labelledby="p-personal-label">
						<h3 id="p-personal-label">Personal tools</h3>
						<ul>
							<li id="pt-login"><a href="https://processors.wiki.ti.com/index.php?title=Special:UserLogin&amp;returnto=MexExample" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li><li id="pt-createaccount"><a href="Special_RequestAccount.html" title="You are encouraged to create an account and log in; however, it is not mandatory">Request account</a></li>						</ul>
					</div>
									<div id="left-navigation">
										<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
						<h3 id="p-namespaces-label">Namespaces</h3>
						<ul>
							<li id="ca-nstab-main" class="selected"><span><a href="MexExample.html" title="View the content page [c]" accesskey="c">Page</a></span></li><li id="ca-talk" class="new"><span><a href="https://processors.wiki.ti.com/index.php?title=Talk:MexExample&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page (page does not exist) [t]" accesskey="t">Discussion</a></span></li>						</ul>
					</div>
										<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
												<input type="checkbox" class="vectorMenuCheckbox" aria-labelledby="p-variants-label" />
						<h3 id="p-variants-label">
							<span>Variants</span>
						</h3>
						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
									</div>
				<div id="right-navigation">
										<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
						<h3 id="p-views-label">Views</h3>
						<ul>
							<li id="ca-view" class="collapsible selected"><span><a href="MexExample.html">Read</a></span></li><li id="ca-viewsource" class="collapsible"><span><a href="https://processors.wiki.ti.com/index.php?title=MexExample&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></span></li><li id="ca-history" class="collapsible"><span><a href="https://processors.wiki.ti.com/index.php?title=MexExample&amp;action=history" title="Past revisions of this page [h]" accesskey="h">View history</a></span></li>						</ul>
					</div>
										<div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label">
						<input type="checkbox" class="vectorMenuCheckbox" aria-labelledby="p-cactions-label" />
						<h3 id="p-cactions-label"><span>More</span></h3>
						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
										<div id="p-search" role="search">
						<h3>
							<label for="searchInput">Search</label>
						</h3>
						<form action="https://processors.wiki.ti.com/index.php" id="searchform">
							<div id="simpleSearch">
								<input type="search" name="search" placeholder="Search Texas Instruments Wiki" title="Search Texas Instruments Wiki [f]" accesskey="f" id="searchInput"/><input type="hidden" value="Special:Search" name="title"/><input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton mw-fallbackSearchButton"/><input type="submit" name="go" value="Go" title="Go to a page with this exact name if it exists" id="searchButton" class="searchButton"/>							</div>
						</form>
					</div>
									</div>
			</div>
			<div id="mw-panel">
				<div id="p-logo" role="banner"><a class="mw-wiki-logo" href="Main_Page.html"  title="Visit the main page"></a></div>
						<div class="portal" role="navigation" id="p-navigation" aria-labelledby="p-navigation-label">
			<h3 id="p-navigation-label">Navigation</h3>
			<div class="body">
								<ul>
					<li id="n-mainpage"><a href="Main_Page.html" title="Visit the main page [z]" accesskey="z">Main Page</a></li><li id="n-All-pages"><a href="Special_AllPages.html">All pages</a></li><li id="n-All-categories"><a href="Special_Categories.html">All categories</a></li><li id="n-recentchanges"><a href="Special_RecentChanges.html" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li><li id="n-randompage"><a href="Package_Reflow_Profiles.html" title="Load a random page [x]" accesskey="x">Random page</a></li><li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" title="The place to find out">Help</a></li>				</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id="p-tb" aria-labelledby="p-tb-label">
			<h3 id="p-tb-label">Toolbox</h3>
			<div class="body">
								<ul>
					<li id="t-whatlinkshere"><a href="Special_WhatLinksHere/MexExample.html" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li><li id="t-recentchangeslinked"><a href="Special_RecentChangesLinked/MexExample.html" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li><li id="t-specialpages"><a href="Special_SpecialPages.html" title="A list of all special pages [q]" accesskey="q">Special pages</a></li><li id="t-print"><a href="https://processors.wiki.ti.com/index.php?title=MexExample&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li><li id="t-permalink"><a href="https://processors.wiki.ti.com/index.php?title=MexExample&amp;oldid=189195" title="Permanent link to this revision of the page">Permanent link</a></li><li id="t-info"><a href="https://processors.wiki.ti.com/index.php?title=MexExample&amp;action=info" title="More information about this page">Page information</a></li>				</ul>
							</div>
		</div>
				</div>
		</div>
				<div id="footer" role="contentinfo">
						<ul id="footer-info">
								<li id="footer-info-lastmod"> This page was last edited on 6 January 2015, at 17:01.</li>
								<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-ShareAlike</a> unless otherwise noted.</li>
							</ul>
						<ul id="footer-places">
								<li id="footer-places-privacy"><a href="Project_Privacy_policy.html" title="Project:Privacy policy">Privacy policy</a></li>
								<li id="footer-places-about"><a href="Project_About.html" title="Project:About">About Texas Instruments Wiki</a></li>
								<li id="footer-places-disclaimer"><a href="Project_General_disclaimer.html" title="Project:General disclaimer">Disclaimers</a></li>
								<li id="footer-places-termsofservice"><a href="Project_Terms_of_Service.html" title="Project:Terms of Service">Terms of Use</a></li>
							</ul>
										<ul id="footer-icons" class="noprint">
										<li id="footer-copyrightico">
						<a href="http://creativecommons.org/licenses/by-sa/3.0/"><img src="https://processors.wiki.ti.com/resources/assets/licenses/cc-by-sa.png" alt="Creative Commons Attribution-ShareAlike" width="88" height="31"/></a>					</li>
										<li id="footer-poweredbyico">
						<a href="http://www.mediawiki.org/"><img src="https://processors.wiki.ti.com/resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31"/></a>					</li>
									</ul>
						<div style="clear: both;"></div>
		</div>
		<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgPageParseReport":{"limitreport":{"cputime":"0.021","walltime":"0.022","ppvisitednodes":{"value":44,"limit":1000000},"ppgeneratednodes":{"value":88,"limit":1000000},"postexpandincludesize":{"value":0,"limit":2097152},"templateargumentsize":{"value":0,"limit":2097152},"expansiondepth":{"value":2,"limit":40},"expensivefunctioncount":{"value":0,"limit":100},"unstrip-depth":{"value":0,"limit":20},"unstrip-size":{"value":12505,"limit":5000000},"timingprofile":["100.00%    0.000      1 -total"]},"cachereport":{"timestamp":"20201201044005","ttl":86400,"transientcontent":false}}});});</script><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":201});});</script>
	</body>

<!-- Mirrored from processors.wiki.ti.com/index.php/MexExample by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 01 Dec 2020 10:30:41 GMT -->
</html>
