<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">

<!-- Mirrored from processors.wiki.ti.com/index.php/UserGuideDisplayDrivers_PSP_04.02.00.07 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 01 Dec 2020 06:37:40 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8"/>
<title>UserGuideDisplayDrivers PSP 04.02.00.07 - Texas Instruments Wiki</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"UserGuideDisplayDrivers_PSP_04.02.00.07","wgTitle":"UserGuideDisplayDrivers PSP 04.02.00.07","wgCurRevisionId":61675,"wgRevisionId":61675,"wgArticleId":9505,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"UserGuideDisplayDrivers_PSP_04.02.00.07","wgRelevantArticleId":9505,"wgRequestId":"ceb8b546874884ba84e8d6aa","wgIsProbablyEditable":false,"wgRelevantPageIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[]});mw.loader.state({"site.styles":"ready","noscript":"ready","user.styles":"ready","user":"ready","user.options":"ready","user.tokens":"loading","mediawiki.legacy.shared":"ready","mediawiki.legacy.commonPrint":"ready","mediawiki.sectionAnchor":"ready","mediawiki.skinning.interface":"ready","skins.vector.styles":"ready"});mw.loader.implement("user.tokens@19o3a1s",function($,jQuery,require,module){/*@nomin*/mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});
});mw.loader.load(["site","mediawiki.page.startup","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.toc","mediawiki.searchSuggest","skins.vector.js"]);});</script>
<link rel="stylesheet" href="https://processors.wiki.ti.com/load.php?debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.interface%7Cskins.vector.styles&amp;only=styles&amp;skin=vector"/>
<script async="" src="https://processors.wiki.ti.com/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=vector"></script>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="https://processors.wiki.ti.com/load.php?debug=false&amp;lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=vector"/>
<meta name="generator" content="MediaWiki 1.31.6"/>
<link rel="shortcut icon" href="https://processors.wiki.ti.com/favicon.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="https://processors.wiki.ti.com/opensearch_desc.php" title="Texas Instruments Wiki (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="https://processors.wiki.ti.com/api.php?action=rsd"/>
<link rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/"/>
<link rel="alternate" type="application/atom+xml" title="Texas Instruments Wiki Atom feed" href="https://processors.wiki.ti.com/index.php?title=Special:RecentChanges&amp;feed=atom"/>
<!--[if lt IE 9]><script src="/load.php?debug=false&amp;lang=en&amp;modules=html5shiv&amp;only=scripts&amp;skin=Vector&amp;sync=1"></script><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-UserGuideDisplayDrivers_PSP_04_02_00_07 rootpage-UserGuideDisplayDrivers_PSP_04_02_00_07 skin-vector action-view">		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<div id="content" class="mw-body" role="main">
			<a id="top"></a>
			<div id="siteNotice" class="mw-body-content"><div id="localNotice" lang="en" dir="ltr"><div class="mw-parser-output"><p><br />
<span style="color:#ff0000"><b>NOTICE: The Processors Wiki will End-of-Life on January 15, 2021. It is recommended to download any files or other content you may need that are hosted on processors.wiki.ti.com. The site is now set to read only.</b></span>
</p></div></div></div><div class="mw-indicators mw-body-content">
</div>
<h1 id="firstHeading" class="firstHeading" lang="en">UserGuideDisplayDrivers PSP 04.02.00.07</h1>			<div id="bodyContent" class="mw-body-content">
				<div id="siteSub" class="noprint">From Texas Instruments Wiki</div>				<div id="contentSub"></div>
								<div id="jump-to-nav" class="mw-jump">
					Jump to:					<a href="#mw-head">navigation</a>, 					<a href="#p-search">search</a>
				</div>
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output"><p><b>Display Driver</b>  
</p>
<div id="toc" class="toc"><div class="toctitle" lang="en" dir="ltr"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Introduction"><span class="tocnumber">1</span> <span class="toctext"><b>Introduction</b></span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#References"><span class="tocnumber">1.1</span> <span class="toctext"><b>References</b></span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Acronyms_.26_Definitions"><span class="tocnumber">1.2</span> <span class="toctext"><b>Acronyms &amp; Definitions</b></span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Hardware_Overview"><span class="tocnumber">1.3</span> <span class="toctext"><b>Hardware Overview</b></span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5"><a href="#Features"><span class="tocnumber">2</span> <span class="toctext"><b>Features</b></span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Architecture"><span class="tocnumber">3</span> <span class="toctext"><b>Architecture</b></span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#Driver_Architecture"><span class="tocnumber">3.1</span> <span class="toctext"><b>Driver Architecture</b></span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Software_Design_Interfaces"><span class="tocnumber">3.2</span> <span class="toctext"><b>Software Design Interfaces</b></span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-9"><a href="#Usage"><span class="tocnumber">4</span> <span class="toctext"><b>Usage</b></span></a>
<ul>
<li class="toclevel-2 tocsection-10"><a href="#Opening_and_Closing_of_Driver"><span class="tocnumber">4.1</span> <span class="toctext"><b>Opening and Closing of Driver</b></span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Command_Line_arguments"><span class="tocnumber">4.2</span> <span class="toctext"><b>Command Line arguments</b></span></a>
<ul>
<li class="toclevel-3 tocsection-12"><a href="#V4L2_Driver"><span class="tocnumber">4.2.1</span> <span class="toctext"><b>V4L2 Driver</b></span></a></li>
<li class="toclevel-3 tocsection-13"><a href="#FBDEV_Driver"><span class="tocnumber">4.2.2</span> <span class="toctext"><b>FBDEV Driver</b></span></a></li>
<li class="toclevel-3 tocsection-14"><a href="#DSS_Library"><span class="tocnumber">4.2.3</span> <span class="toctext"><b>DSS Library</b></span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-15"><a href="#Buffer_Management"><span class="tocnumber">4.3</span> <span class="toctext"><b>Buffer Management</b></span></a></li>
<li class="toclevel-2 tocsection-16"><a href="#Rotation"><span class="tocnumber">4.4</span> <span class="toctext"><b>Rotation</b></span></a></li>
<li class="toclevel-2 tocsection-17"><a href="#Color_Keying"><span class="tocnumber">4.5</span> <span class="toctext"><b>Color Keying</b></span></a></li>
<li class="toclevel-2 tocsection-18"><a href="#Alpha_Blending"><span class="tocnumber">4.6</span> <span class="toctext"><b>Alpha Blending</b></span></a></li>
<li class="toclevel-2 tocsection-19"><a href="#Buffer_Format"><span class="tocnumber">4.7</span> <span class="toctext"><b>Buffer Format</b></span></a></li>
<li class="toclevel-2 tocsection-20"><a href="#Display_Window"><span class="tocnumber">4.8</span> <span class="toctext"><b>Display Window</b></span></a></li>
<li class="toclevel-2 tocsection-21"><a href="#Cropping"><span class="tocnumber">4.9</span> <span class="toctext"><b>Cropping</b></span></a></li>
<li class="toclevel-2 tocsection-22"><a href="#Scaling"><span class="tocnumber">4.10</span> <span class="toctext"><b>Scaling</b></span></a></li>
<li class="toclevel-2 tocsection-23"><a href="#Color_look_table"><span class="tocnumber">4.11</span> <span class="toctext"><b>Color look table</b></span></a></li>
<li class="toclevel-2 tocsection-24"><a href="#Streaming"><span class="tocnumber">4.12</span> <span class="toctext"><b>Streaming</b></span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-25"><a href="#Software_Interfaces"><span class="tocnumber">5</span> <span class="toctext"><b>Software Interfaces</b></span></a>
<ul>
<li class="toclevel-2 tocsection-26"><a href="#Frame-Buffer_Driver_Interface"><span class="tocnumber">5.1</span> <span class="toctext"><b>Frame-Buffer Driver Interface</b></span></a>
<ul>
<li class="toclevel-3 tocsection-27"><a href="#Application_Interface"><span class="tocnumber">5.1.1</span> <span class="toctext"><b>Application Interface</b></span></a></li>
<li class="toclevel-3 tocsection-28"><a href="#Supported_Standard_IOCTLs"><span class="tocnumber">5.1.2</span> <span class="toctext"><b>Supported Standard IOCTLs</b></span></a></li>
<li class="toclevel-3 tocsection-29"><a href="#Supported_Custom_IOCTLs"><span class="tocnumber">5.1.3</span> <span class="toctext"><b>Supported Custom IOCTLs</b></span></a></li>
<li class="toclevel-3 tocsection-30"><a href="#Data_Structures"><span class="tocnumber">5.1.4</span> <span class="toctext"><b>Data Structures</b></span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-31"><a href="#V4L2_Driver_Interface"><span class="tocnumber">5.2</span> <span class="toctext"><b>V4L2 Driver Interface</b></span></a>
<ul>
<li class="toclevel-3 tocsection-32"><a href="#Application_Interface_2"><span class="tocnumber">5.2.1</span> <span class="toctext"><b>Application Interface</b></span></a></li>
<li class="toclevel-3 tocsection-33"><a href="#Supported_Standard_IOCTLs_2"><span class="tocnumber">5.2.2</span> <span class="toctext"><b>Supported Standard IOCTLs</b></span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-34"><a href="#SYSFS_Software_Interfaces"><span class="tocnumber">5.3</span> <span class="toctext"><b>SYSFS Software Interfaces</b></span></a>
<ul>
<li class="toclevel-3 tocsection-35"><a href="#Frame-buffer_Driver_sysfs_attributes"><span class="tocnumber">5.3.1</span> <span class="toctext"><b>Frame-buffer Driver sysfs attributes</b></span></a></li>
<li class="toclevel-3 tocsection-36"><a href="#DSS_Library_sysfs_attributes"><span class="tocnumber">5.3.2</span> <span class="toctext"><b>DSS Library sysfs attributes</b></span></a>
<ul>
<li class="toclevel-4 tocsection-37"><a href="#DSS_Library:_display0.2F1.2F2"><span class="tocnumber">5.3.2.1</span> <span class="toctext"><b>DSS Library: display0/1/2</b></span></a></li>
<li class="toclevel-4 tocsection-38"><a href="#DSS_Library:_Manager0.2F1"><span class="tocnumber">5.3.2.2</span> <span class="toctext"><b>DSS Library: Manager0/1</b></span></a></li>
<li class="toclevel-4 tocsection-39"><a href="#DSS_Library:_Overlay0.2F1.2F2"><span class="tocnumber">5.3.2.3</span> <span class="toctext"><b>DSS Library: Overlay0/1/2</b></span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-40"><a href="#DSS2_SYSFS_Examples"><span class="tocnumber">5.3.3</span> <span class="toctext"><b>DSS2 SYSFS Examples</b></span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-41"><a href="#Miscellaneous_Configurations"><span class="tocnumber">5.4</span> <span class="toctext"><b>Miscellaneous Configurations</b></span></a>
<ul>
<li class="toclevel-3 tocsection-42"><a href="#Switching_output_from_LCD_to_DVI"><span class="tocnumber">5.4.1</span> <span class="toctext"><b>Switching output from LCD to DVI</b></span></a></li>
<li class="toclevel-3 tocsection-43"><a href="#Switching_Overlay0_.28GFX.29_output_from_LCD_to_TV"><span class="tocnumber">5.4.2</span> <span class="toctext"><b>Switching Overlay0 (GFX) output from LCD to TV</b></span></a></li>
<li class="toclevel-3 tocsection-44"><a href="#Cloning_Overlay0_.28GFX.29_output_to_both_LCD_and_TV"><span class="tocnumber">5.4.3</span> <span class="toctext"><b>Cloning Overlay0 (GFX) output to both LCD and TV</b></span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-45"><a href="#Driver_Configuration"><span class="tocnumber">6</span> <span class="toctext"><b>Driver Configuration</b></span></a>
<ul>
<li class="toclevel-2 tocsection-46"><a href="#V4L2_video_driver"><span class="tocnumber">6.1</span> <span class="toctext"><b>V4L2 video driver</b></span></a></li>
<li class="toclevel-2 tocsection-47"><a href="#Framebuffer_driver"><span class="tocnumber">6.2</span> <span class="toctext"><b>Framebuffer driver</b></span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-48"><a href="#Sample_Application_Flow"><span class="tocnumber">7</span> <span class="toctext"><b>Sample Application Flow</b></span></a>
<ul>
<li class="toclevel-2 tocsection-49"><a href="#V4L2-Display_Application_Flow"><span class="tocnumber">7.1</span> <span class="toctext"><b>V4L2-Display Application Flow</b></span></a></li>
<li class="toclevel-2 tocsection-50"><a href="#Fbdev-Display_Application_Flow"><span class="tocnumber">7.2</span> <span class="toctext"><b>Fbdev-Display Application Flow</b></span></a></li>
</ul>
</li>
</ul>
</div>

<h1><span class="mw-headline" id="Introduction"><b>Introduction</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=1" title="Edit section: Introduction">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>Display Sub-System hardware integrates one graphics pipeline, two video pipelines, and two overlay managers (one for digital and one for analog interface). Digital interface is used for LCD and DVI output and analog interface is used for TV out.
</p><p>The primary functionality of the display driver is to provide interfaces to user level applications and management of Display Sub-System hardware.
</p><p>This section defines and describes the usage of user level interfaces of Video Display Driver.
</p><p><br />
<b>NOTE:</b> Please note that the AM3517 and AM/DM37x Display Sub-System module is same as OMAP3x, so terms have been used inter-changeably and referred as OMAP3x in this document.
<br />
In order to enable DVI display on AM3517, user should enable S7.8 (HDMI enable switch).
<br />
</p>
<h2><span class="mw-headline" id="References"><b>References</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=2" title="Edit section: References">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ol><li>Video for Linux Two Home Page [<a rel="nofollow" class="external text" href="http://linux.bytesex.org/v4l2/">http://linux.bytesex.org/v4l2/</a>]</li>
<li>Video for Linux Two API Specification [[<a rel="nofollow" class="external text" href="http://v4l2spec.bytesex.org/v4l2spec/v4l2.pdf">http://v4l2spec.bytesex.org/v4l2spec/v4l2.pdf</a>]</li></ol>
<h2><span id="Acronyms_&amp;_Definitions"></span><span class="mw-headline" id="Acronyms_.26_Definitions"><b>Acronyms &amp; Definitions</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=3" title="Edit section: Acronyms &amp; Definitions">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<table border="1" cellspacing="0" cellpadding="5" width="40%">
<caption><b>Display Driver: Acronyms</b>
</caption>
<tbody><tr>
<th align="left">Acronym
</th>
<th align="left">Definition
</th></tr>
<tr>
<td>V4L2
</td>
<td>Video for Linux Two
</td></tr>
<tr>
<td>DSS
</td>
<td>Display SubSystem
</td></tr>
<tr>
<td>NTSC
</td>
<td>National Television System Committee
</td></tr>
<tr>
<td>PAL
</td>
<td>Phase Alternating Line
</td></tr>
<tr>
<td>LCD
</td>
<td>Liquid Crystal Display
</td></tr>
<tr>
<td>DVI
</td>
<td>Digital Visual Interface
</td></tr></tbody></table>
<p><br />
</p>
<h2><span class="mw-headline" id="Hardware_Overview"><b>Hardware Overview</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=4" title="Edit section: Hardware Overview">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The display subsystem provides the logic to display a video frame from
the memory frame buffer (either SDRAM or SRAM) on a liquid-crystal
display (LCD) panel or a TV set. The display subsystem integrates the
following elements
</p>
<ul><li>Display controller (DISPC) module</li>
<li>Remote frame buffer interface (RFBI) module</li>
<li>Serial display interface (SDI) complex input/output (I/O) module with the associated phased-locked loop (PLL)</li>
<li>Display serial interface (DSI) complex I/O module and a DSI protocol engine</li>
<li>DSI PLL controller that drives a DSI PLL and high-speed (HS) divider</li>
<li>NTSC/PAL video encoder</li></ul>
<h1><span class="mw-headline" id="Features"><b>Features</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=5" title="Edit section: Features">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>The Display driver supports the following features:
</p>
<ul><li>Supports LCD display interface at VGA resolution (480*640)</li>
<li>Supports TV display interface at NTSC/PAL resolutions (both S-Video out and Composite out is supported)</li>
<li>Supports DVI digital interface (mode selection via boot argument).</li>
<li>Supports Graphics pipeline and two video pipelines. Graphics pipeline is supported through fbdev and video pipelines through V4L2.</li>
<li>Supported color formats: On OSD (Graphics pipeline): RGB565, RGB888, ARGB and RGBA. On Video pipelines: YUV422 interleaved, RGB565, RGB888.</li>
<li>Configuration of parameters such as height and width of display screen, bits-per-pixel etc.</li>
<li>Supports setting up of OSD and Video pipeline destinations (TV or LCD) through syfs interface.</li>
<li>Supports buffer management through memory mapped and user pointer buffer exchange for application usage (mmaped).</li>
<li>Supports rotation - 0, 90, 180 and 270 degrees on LCD and TV output</li>
<li>Supports destination and source colorkeying on Video pipelines through V4L2.</li>
<li>Supports alpha blending through ARGB pixel format on Video2 pipeline and RGBA and ARGB format on graphics pipeline and global alpha blending</li></ul>
<p><br />
</p>
<h1><span class="mw-headline" id="Architecture"><b>Architecture</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=6" title="Edit section: Architecture">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>This chapter describes the Driver Architecture and Design concepts
</p>
<h2><span class="mw-headline" id="Driver_Architecture"><b>Driver Architecture</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=7" title="Edit section: Driver Architecture">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>OMAP3x display hardware integrates one graphics pipeline, two video
pipelines, and two overlay managers (one for digital and one for analog
interface). Digital interface is used for LCD and DVI output and analog
interface is used for TV out.
</p><p>The primary functionality of the display driver is to provide interfaces to
user level applications and management to OMAP3x display hardware.
</p><p><br />
This includes, but is not limited to:
</p>
<ul><li>GUI rendering through the graphics pipeline.</li>
<li>Static image or video rendering through two video pipelines.</li>
<li>Connecting each of three pipelines to either LCD or TV output so the display layer is presented on the selected output path.</li>
<li>Image processing (cropping, rotation, mirroring, color conversion, resizing, and etc).</li></ul>
<p><br />
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:563px;"><a href="File_Display-arch.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/2/2b/Display-arch.png" width="561" height="380" class="thumbimage" /></a>  <div class="thumbcaption">OMAP3x Display Subsystem Architecture</div></div></div></div>
<h2><span class="mw-headline" id="Software_Design_Interfaces"><b>Software Design Interfaces</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=8" title="Edit section: Software Design Interfaces">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Above figure (OMAP3x Display Subsystem Architecture) shows the major components that makes up the DSS
software sub-system
</p><p><br />
</p>
<ul><li><b>Display Library</b></li></ul>
<p>This is a HAL/functional layer controlling the bulk of DSS hardware. It exposes the number of APIs controlling the overlay managers, clock, and pipelines to the user interface drivers like V4L2 and FBDEV. It also exposes the functions for registering and de-registering of the various display devices like LCD and DVI to the DSS overlay managers.
<br />
</p>
<ul><li><b>SYSFS interfaces</b></li></ul>
<p>The SYSFS interfaces are mostly used as the control path for configuring the DSS parameters which are common between FBDEV and V4L2 like the alpha blending, color keying, etc. It is also used for switching the output of the pipeline to either LCD or
Digital overlay manager. In future sysfs entries might also be used to switch the modes like NTSC, PAL on TV and 480P, 720P on DVI  outputs.
<br />
</p>
<ul><li><b>Frame Buffer Driver</b></li></ul>
<p>This driver is registered with the FBDEV subsystem, and is responsible for managing the graphics layer frame buffer. Driver creates /dev/fb0 as the device node. Application can open this device node to open the driver and negotiate parameters with the driver through frame buffer ioctls. Application maps driver allocated buffers in the application memory space and fills them for the driver to display.
<br />
</p>
<ul><li><b>Video Applications &amp; V4L2 subsystem</b></li></ul>
<p>Video applications (camera, camcorder, image viewer, etc.) use the standard V4L2 APIs to render static images and video to the video layers, or capture/preview camera images.
<br />
This driver is responsible for managing the video layers frame-buffers. It is a V4L2 compliant driver with some additions to implement special software requirements that target OMAP3x hardware features . This driver conforms to the Linux driver model. For using the  driver, application should create the device nodes /dev/video1 and /dev/video2 device nodes for two video layers. Application can open the driver by opening these device nodes and negotiate the parameters by V4L2 ioctls. Initially application can request the driver to allocate number of buffers and MMAPs these buffers. Then the application can fill up these buffers and pass them to driver for display by using the standard V4L2 streaming ioctls.
</p><p><br />
</p>
<h1><span class="mw-headline" id="Usage"><b>Usage</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=9" title="Edit section: Usage">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h2><span class="mw-headline" id="Opening_and_Closing_of_Driver"><b>Opening and Closing of Driver</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=10" title="Edit section: Opening and Closing of Driver">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The device can be opened using open call from the application, with the device name and mode of operation as parameters. Application can open the driver only in blocking mode. Non-blocking mode of open is not supported.
</p><p><br />
</p>
<ul><li><b>V4L2 Driver</b></li></ul>
<p>The driver will expose two software channels (/dev/video1 and /dev/video2), one for each video pipeline. Both of these channels supports only blocking mode of operations. These channels can only be opened once.
</p><p><br />
</p>
<pre>/* Open a video Display logical channel in blocking mode */
fd = open ("/dev/video1", O_RDWR);
if (fd == -1) {
    perror("Failed to open display device\n");
    return -1;
}
/* Closing of channel */
close (fd);
</pre>
<p><br />
</p>
<ul><li><b>FBDEV Driver</b></li></ul>
<p>The driver will expose one software channels (/dev/fb0) for the graphics pipeline. The driver cannot be opened multiple times. Driver can be opened only once.
</p><p><br />
</p>
<pre>/* Open a graphics Display logical channel in blocking mode */
fd = open ("/dev/fb0", O_RDWR);
if (fd == -1) {
    perror("failed to open display device\n");
    return -1;
}
/* Closing of channels */
close (fd);
</pre>
<p><br />
</p>
<h2><span class="mw-headline" id="Command_Line_arguments"><b>Command Line arguments</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=11" title="Edit section: Command Line arguments">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h3><span class="mw-headline" id="V4L2_Driver"><b>V4L2 Driver</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=12" title="Edit section: V4L2 Driver">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>V4L2 driver supports set of command line argument for, default number of buffers, their buffer size, enable/disable VRFB buffer allocation and debug option for both the video pipelines.
</p><p><br />
V4L2 driver uses the VRFB buffers for rotation. Because of the limitation of the VRFB engine these buffers are quite big in size. Please refer to the Buffer Management section for required and allocated size of the VRFB buffers. VRFB buffers are allocated by driver during vidioc_reqbufs ioctl if the rotation is enabled and freed during vidioc_streamoff. But under heavy system load, memory fragmentation may occur and VFRB buffer allocation may fail. To address this issue V4L2 driver provides command line argument to allocate the VRFB buffers at driver init time and buffers will be freed when driver is unloaded.
</p><p><br />
Below is the list of arguments which V4L2 driver supports -
</p><p><br />
</p>
<table border="1" cellspacing="0" cellpadding="&quot;5&quot;&quot;">
<caption><b>V4L2 Driver Command Line Arguments</b>
</caption>
<tbody><tr>
<th align="left">Argument
</th>
<th align="left">Description
</th></tr>
<tr>
<td>video1_numbuffers
</td>
<td>Number of buffers to be allocated at init time for Video1 device
</td></tr>
<tr>
<td>video2_numbuffers
</td>
<td>Number of buffers to be allocated at init time for Video2 device
</td></tr>
<tr>
<td>video1_bufsize
</td>
<td>Size of the buffer to be allocated for video1 device
</td></tr>
<tr>
<td>video2_bufsize
</td>
<td>Size of the buffer to be allocated for video2 device
</td></tr>
<tr>
<td>vid1_static_vrfb_alloc
</td>
<td>Static allocation of the VRFB buffer for video1 device
</td></tr>
<tr>
<td>vid2_static_vrfb_alloc
</td>
<td>Static allocation of the VRFB buffer for video2 device
</td></tr>
<tr>
<td>debug
</td>
<td>Enable debug messaging
</td></tr></tbody></table>
<p><br />
For dynamic build of the driver, these argument are specified at the time of inserting the driver. For static build of the driver, these argument can be specified along with boot time arguments. Following example shows how to specify command line argument for static and dynamic build.
</p><p><br />
Insert the dynamically built module with following parameters:
</p>
<pre># insmod omap_vout.ko video1_numbuffers=3 video2_numbuffers=3 video1_bufsize=644000 video2_bufsize=644000
vid1_static_vrfb_alloc=y vid2_static_vrfb_alloc=y
</pre>
<p><br />
</p><p>Below is the sample example of bootargs for statically compiled driver from bootloader:
</p>
<pre># setenv bootargs 'console=ttyS0,115200n8 mem=128M root=/dev/nfs noinitrd nfsroot=nfs-server/home,nolock ip=dhcp omap_vout.video1_numbuffers=3 omap_vout.video2_numbuffers=3 omap_vout.video1_bufsize=64400 omap_vout.video2_bufsize=64400 omap_vout.vid1_static_vrfb_alloc=y omap_vout.vid2_static_vrfb_alloc=y'
</pre>
<p><br />
</p>
<ul><li><b>NOTE:</b> The entire command should be entered in a single line.</li></ul>
<p><br />
</p>
<h3><span class="mw-headline" id="FBDEV_Driver"><b>FBDEV Driver</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=13" title="Edit section: FBDEV Driver">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>FBDEV driver supports set of command line argument for enabling/setting rotation angle, enable/disable VRFB rotation, default mode, size of vram and debug option. These command line arguments can only be
used with boot time arguments as FBDEV driver only supports static build.
</p><p><br />
Below is the list of arguments which Fbdev driver supports -
</p>
<table border="1" cellspacing="0" cellpadding="5">
<caption><b>Fbdev Driver Command Line Arguments</b>
</caption>
<tbody><tr>
<th align="left">Argument
</th>
<th align="left">Description
</th></tr>
<tr>
<td>mode
</td>
<td>Default video mode for specified displays
</td></tr>
<tr>
<td>vram
</td>
<td>VRAM allocated memory for a framebuffer, user can individually configure VRAM buffers for each plane/device node
</td></tr>
<tr>
<td>vrfb
</td>
<td>Use VRFB rotation for framebuffer
</td></tr>
<tr>
<td>rotate
</td>
<td>Default rotation applied to framebuffer
</td></tr>
<tr>
<td>test
</td>
<td>Draw test pattern to framebuffer whenever framebuffer settings change
</td></tr>
<tr>
<td>debug
</td>
<td>Enable debug messaging
</td></tr></tbody></table>
<p><br />
Following example shows how to specify 90 degree rotation in boot time argument:
</p>
<pre># setenv bootargs console=ttyS0,115200n8 mem=128M noinitrd root=/dev/nfs nfsroot=nfs-server/home,nolock ip=dhcp omapfb.rotate=1 omapfb.vrfb=y
</pre>
<p><br />
</p><p>Following example shows how to specify size of framebuffer in boot time argument:
</p>
<pre>setenv bootargs console=ttyS0,115200n8 mem=128M noinitrd root=/dev/nfs nfsroot=nfs-server/home,nolock ip=dhcp vram=20M omapfb.vram=0:20M
</pre>
<p><br />
</p><p>Following example shows how to specify mode for framebuffer in boot time argument:
</p>
<pre># setenv bootargs console=ttyS0,115200n8 mem=128M noinitrd root=/dev/nfs nfsroot=nfs-server/home,nolock ip=dhcp omapfb.mode=dvi:720x480@60
</pre>
<p><br />
</p>
<ul><li><b>NOTE:</b> The entire command should be entered in a single line.</li></ul>
<p><br />
</p>
<h3><span class="mw-headline" id="DSS_Library"><b>DSS Library</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=14" title="Edit section: DSS Library">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>There are few arguments which allows control over core DSS functionality.
</p>
<table border="1" cellspacing="0" cellpadding="5" width="40%">
<caption><b>DSS Library Command Line Arguments</b>
</caption>
<tbody><tr>
<th align="left">Argument
</th>
<th align="left">Description
</th></tr>
<tr>
<td>def_disp
</td>
<td>Name of default display, to which all overlays will be connected
</td></tr>
<tr>
<td>debug
</td>
<td>Enable debug messages
</td></tr></tbody></table>
<p><br />
Following example shows how to specify default display to particular output in boot time argument:
</p>
<pre># setenv bootargs console=ttyS0,115200n8 mem=128M noinitrd root=/dev/nfs nfsroot=nfs-server/home,nolock ip=dhcp omapdss.def_disp="dvi" omapdss.debug=y
</pre>
<p><br />
</p>
<ul><li><b>NOTE:</b> The entire command should be entered in a single line.</li></ul>
<p><br />
</p>
<h2><span class="mw-headline" id="Buffer_Management"><b>Buffer Management</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=15" title="Edit section: Buffer Management">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<table border="1" cellspacing="0" cellpadding="5">
<caption><b>Memory requirement for V4L2 and FBDEV driver</b>
</caption>
<tbody><tr>
<th align="left">Driver
</th>
<th align="left">Without Rotation
</th>
<th align="left">With Rotation
</th></tr>
<tr>
<td>Fbdev Driver
</td>
<td>A single buffer of size 480*640*2 bytes, can be changed through bootargs
</td>
<td>A single buffer of size 2048*640*2 bytes, can be changed through bootargs
</td></tr>
<tr>
<td>V4L2 Driver
</td>
<td>Single buffer of 1280*720*4 bytes and Number of buffers is configurable using VIDIOC_REQBUFS ioctl and command line argument
</td>
<td>Same requirement as without rotation. Additionally allocates one buffer of size 3686400 bytes for each context. Number of context are same as the number of buffers allocated using REQBUFS, which is not more than four.
</td></tr></tbody></table>
<p><br />
</p>
<ul><li><b>V4L2 Driver</b></li></ul>
<p>Memory Mapped buffer mode and User pointer buffer mode are the two memory allocation modes supported by driver. In Memory map buffer mode, application can request memory from the driver by calling VIDIOC_REQBUFS ioctl. In this mode, maximum number of buffers is limited to VIDEO_MAX_FRAME (defined in driver header files) and is limited by the available memory in the kernel. If driver is not able to allocate the requested number of buffer, it will return the number of buffer it is able to allocate.
</p><p><br />
The main steps that the application must perform for buffer allocation are:
<br />
</p>
<ol><li><b>Allocating Memory</b></li></ol>
<p>Ioctl: VIDIOC_REQBUFS
</p><p>This is a necessary ioctl for streaming IO. It has to be called for both drivers buffer mode and user buffer mode. Using this ioctl, driver will identify whether driver buffer mode or user buffer mode will be used.
</p><p>It takes a pointer to instance of the <code>v4l2_requestbuffers</code> structure as an argument.
</p><p>User can specify the buffer type (V4L2_BUF_TYPE_VIDEO_OUTPUT), number of buffers, and memory type (V4L2_MEMORY_MMAP, V4L2_MEMORY_USERPTR)at the time of buffer allocation. In case of driver buffer mode, this ioctl also returns the actual number of buffers allocated in count member of v4l2_requestbuffer structure.
</p><p>It can be called with zero number of buffers to free up all the buffers already allocated. It also frees allocated buffers when application changes buffer exchange mechanism. Driver always allocates buffers
of maximum image size supported. If application wants to change buffer size, it can be done through video1_buffsize and video2_buffsize command line arguments.
</p><p>When rotation is enabled, driver also allocates buffer for the VRFB virtual memory space along with the mmap or user buffer. It allocates same number of buffers as the mmap or user buffers. Maximum number of buffers, which can be allocated, is 4 when rotation is enabled.
</p><p><br />
</p>
<pre>/* structure to store buffer request parameters */
struct v4l2_requestbuffers reqbuf;
reqbuf.count = numbuffers;
reqbuf.type = V4L2_BUF_TYPE_VIDEO_OUTPUT;
reqbuf.memory = V4L2_MEMORY_MMAP;
ret = ioctl(fd , VIDIOC_REQBUFS, &amp;reqbuf);
if(ret &lt; 0) {
    printf("cannot allocate memory\n");
    close(fd);
    return -1;
}
</pre>
<p><br />
</p>
<ol><li><b>Getting physical address</b></li></ol>
<p>Ioctl: VIDIOC_QUERYBUF
</p><p>This ioctl is used to query buffer information like buffer size and buffer physical address. This physical address is used in m-mapping the buffers. This ioctl is necessary for driver buffer mode as it provides the physical address of buffers, which are used to mmap system call the buffers.
</p><p>It takes a pointer to instance of v4l2_buffer structure as an argument. User has to specify the buffer type (V4L2_BUF_TYPE_VIDEO_OUTPUT), buffer index, and memory type (V4L2_MEMORY_MMAP)at the time of querying.
</p><p><br />
</p>
<pre>/* allocate buffer by VIDIOC_REQBUFS */
/* structure to query the physical address
of allocated buffer */
struct v4l2_buffer buffer;
/* buffer index for querying -0 */
buffer.index = 0;
buffer.type = V4L2_BUF_TYPE_VIDEO_OUTPUT;
buffer.memory = V4L2_MEMORY_MMAP;
if (ioctl(fd, VIDIOC_QUERYBUF, &amp;buffer) &lt; 0) {
    printf("buffer query error.\n");
    close(fd);
    exit(-1);
}
/*The buffer.m.offset will contain the physical address returned from driver*/
</pre>
<p><br />
</p>
<ol><li><b>Mapping Kernel space address to user space</b></li></ol>
<p>Mapping the kernel buffer to the user space can be done via mmap. User can pass buffer size and physical address of buffer for getting the user space address
</p><p><br />
</p>
<pre>/* allocate buffer by VIDIOC_REQBUFS */
/* query the buffer using VIDIOC_QUERYBUF */
/* addr hold the user space address */
unsigned int addr;
addr = mmap(NULL, buffer.size, PROT_READ | PROT_WRITE, MAP_SHARED, fd, buffer.m.offset);
/* buffer.m.offset is same as returned from VIDIOC_QUERYBUF */

</pre>
<p><br />
</p>
<ul><li><b>FBDEV Driver</b></li></ul>
<p>FBDEV driver supports only memory mapped buffers. Driver allocates one physically contiguous buffers, which can support 480X640 resolution for 16 bpp format.
</p><p>Following steps are required to map buffers in application memory space.
</p><p><br />
</p>
<ol><li><b>Getting fix screen information</b></li></ol>
<p><code>FBIOGET_FSCREENINFO</code> ioctl is used to get the not-changing screen information like physical address of the buffer, size of the buffer, line length.
</p><p><br />
</p>
<pre>/* Getting fix screen information */
struct fb_fix_screeninfo fix;
ret = ioctl(fd, FBIOGET_FSCREENINFO, &amp;fix);
if(ret &lt; 0) {
    printf("Cannot get fix screen information\n");
    close(fd);
    exit(0);
}
printf("Line length =&#160;%d\n",fix.line_length);
printf("Physical Address =&#160;%x\n",fix.smem_start);
printf("Buffer Length =&#160;%d\n",fix.smem_len);
</pre>
<p><br />
</p>
<ol><li><b>Getting Variable screen information</b></li></ol>
<p>FBIOGET_VSCREENINFO ioctl is used to get the variable screen information like resolution, bits per pixel etc...
</p><p><br />
</p>
<pre>/* Getting fix screen information */
struct fb_var_screeninfo var;
ret = ioctl(fd, FBIOGET_VSCREENINFO, &amp;var);
if(ret &lt; 0) {
    printf("Cannot get variable screen information\n");
    close(fd);
    exit(0);
}
printf("Resolution =&#160;%dx%d\n",var.xred, var.yres);
printf("bites per pixel =&#160;%d\n",var.bpp);
</pre>
<p><br />
</p>
<ol><li><b>Mapping Kernel space address to user space</b></li></ol>
<p>Mapping the kernel buffer to the user space can be done via mmap system call.
<br />
</p>
<pre>/* addr hold the user space address */
unsigned int addr, buffersize;
/* Get the fix screen info */
/* Get the variable screen information */
buffersize = fix.line_length * var.yres;
addr = mmap(NULL, buffersize, PROT_READ | PROT_WRITE, MAP_SHARED, fd, 0);
/* buffer.m.offset is same as returned from VIDIOC_QUERYBUF */
</pre>
<p><br />
</p>
<h2><span class="mw-headline" id="Rotation"><b>Rotation</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=16" title="Edit section: Rotation">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Rotation is implemented with use of Rotation Engine module in Virtual Rotation Frame Buffer module in OMAP3x. Rotation engine supports rotation of an image with degree 0, 90, 180 and 270. There are 12 contexts available for rotating an image and there are four virtual memory space associated with each context. To rotate an image, image is written to 0 degree virtual memory for a context and rotated image can read back from the virtual memory for that angle of the same context.
</p><p>For using Rotation Engine, User has to allocate physical memory and provide address of the memory to the rotation engine. The buffer size for this physical buffer should be large enough to store the image to be rotated. When program writes to the virtual address of the context, rotation engine write to this memory space and when program reads image from virtual address, rotation engine reads image from this buffer with rotation angle.
</p><p><br />
</p>
<ul><li><b>V4L2 Driver</b></li></ul>
<p>V4L2 driver supports rotation by using rotation engine in the VRFB module. Driver allocates physical buffers, required for the rotation engine, when application calls VIDIOC_REQBUFS ioctl. Therefore, when this ioctl is called driver allocates buffers for storing image and allocates buffers for the rotation engine. It also programs VRFB rotation engine when this ioctl is called. At the time of enqueing memory mapped buffer, driver copies entire image from mmaped buffer to buffer for the rotation engine using DMA. DSS is programmed to take image from VRFB memory space when rotation is enabled. So DSS always gets rotated image. Maximum four buffers can be allocated using REQBUFS ioctl when rotation is enabled.
</p><p>Driver provides ioctl interface for enabling/disabling and changing the rotation angle. These ioctls are VIDIOC_S_CTRL/VIDIOC_G_CTRL as drive allocates buffer for VRFB during REQBUFS ioctl, application has to enable/set the rotation angle before calling REQBUFS ioctl. After enabling rotation, application can change the rotation angle. Rotation angle cannot be changed while streaming is on.
</p><p>Following code shows how to set rotation angle to 90 degree:
</p><p><br />
</p>
<pre>struct v4l2_control control;
int degree = 90;
control.id = V4L2_CID_ROTATE;
control.value = degree;
ret = ioctl(fd, VIDIOC_S_CTRL, &amp;control);
if (ret &lt; 0) {
    perror("VIDIOC_S_CTRL\n");
    close(fd);
    exit(0);
}
/* Rotation angle is now set to 90 degree. Application can now do streaming to see rotated image*/
</pre>
<p><br />
</p><p><b>NOTE:</b> Rotation value must be set using VIDIOC_S_CTRL before setting any format using VIDIOC_S_FMT as VIDIOC_S_FMT uses rotation value for calculating buffer formats. Also VIDIOC_S_FMT ioctl must be called after changing the rotation angle to change parameters as per the new rotation angle.
</p><p><br />
</p>
<ul><li><b>FBDEV Driver</b></li></ul>
<p>FBDEV driver supports rotation by using rotation engine in the VRFB module. For using this feature of the driver, rotation has to be enabled. Application can enable rotation by enabling/setting rotation angle in boot time argument of the kernel for FBDEV driver. Applications can thus use the FBIOPUT_VSCREENINFO ioctl to set the rotation angle. Applications have to set the 'rotate' field in the fb_var_screeninfo structure equal to the angle of rotation (0, 90, 180 or 270) and call this ioctl. Frame buffer driver also supports the rotation through sysfs entry. Any one of the two method can be used to configure rotation.
</p><p><b>Constraint:</b> While doing rotation x-resolution virtual should be equal to x-resolution. y-resolution virtual should be greater than or equal to yresolution. Please note that VRFB rotation engine requires alignment of 32 bytes in horizontal size and 32 lines in vertical size. So while doing rotation x-resolution should be 32 byte aligned and y resolution and y resolution virtual should be 32 lines aligned. For example for 360X360 required resolution with 16bpp no of bytes per line comes to 360*2=720. Which is not 32 byte aligned. While no of lines comes to 360 which is also ot 32 lines aligned. So actual resolution should be set to 368X368. But if same resolution is required for 32bpp then no of bytes per line comes to 360*4 that is 1440. Which is 32 byte aligned so actual resolution should be set to 360X368. Also the maximum y-res virtual possible is 2048 because of VRFB limitation when rotation enabled.
</p><p>var.rotate variable should not be modified when rotation is not selected through command line arguments else behaviour is unexpected
</p><p><b>NOTE:</b> By default frame buffer driver allocates the buffer for single VGA (480x640) frame considering 0 degree rotation. Please refer to the section <a href="#Command_Line_arguments">Command line arguments</a>
</p><p><br />
Following code listings demos how to set the rotation in frame buffer driver using ioctl and sysfs entry: 
</p>
<pre>struct fb_var_screeninfo var;
/* Set the rotation through ioctl. */
/* Get the Variable screen info through "FBIOGET_VSCREENINFO" */
var.rotate = 1; /* To set rotation angle to 90 degree */
if (ioctl(fd, FBIOPUT_VSCREENINFO, &amp;var)&lt;0) {
    perror("Error:FBIOPUT_VSCREENINFO\n");
    close(fd);
    exit(4);
}
</pre>
<p><br />
</p><p>Setting the rotation through sysfs where 0 - 0 degree, 1 - 90 degree, 2 - 180 degree and 3 - 270 degree respectively:
</p>
<pre># echo 1 &gt; /sys/class/graphics/fb0/rotate
</pre>
<p><br />
</p>
<h2><span class="mw-headline" id="Color_Keying"><b>Color Keying</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=17" title="Edit section: Color Keying">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>There are two types of transparent color keys: Video source transparency and graphics destination transparency key. The encoded pixel color value is compared to the transparency color key. For CLUT bitmaps, the palette index is compared to the transparency color key and not to the palette value pointed out by the palette index.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:452px;"><a href="File_Source_color_keying.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/3/30/Source_color_keying.png" width="450" height="450" class="thumbimage" /></a>  <div class="thumbcaption">Video Source Color keying</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:452px;"><a href="File_Destination_color_keying.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/b/b1/Destination_color_keying.png" width="450" height="414" class="thumbimage" /></a>  <div class="thumbcaption">Video Destination color keying</div></div></div></div>
<p><br />
<b>Constraint:</b> The video source transparency color key and graphics destination transparency color key cannot be active at the same time.
</p><p><br />
User can Color Keying either through V4L2 Driver IOCTL interface or SYSFS interface. 
</p><p><br />
Video source transparency color key value allows defining a color that the matching pixels with that color in the video pipelines are replaced by the pixels in graphics pipeline. It is limited to RGB formats only and non-scaling cases.
</p><p>The Graphics destination color key allows defining a color that the nonmatching pixels in the graphics pipelines prevent video overlay. The destination transparency color key is applicable only in the graphics
region when graphics and video overlap. Otherwise, the destination transparency color key is ignored.
</p><p>Both the keying mechanism cannot be used simultaneously. All color key related IOCTLs are not pipeline oriented. Following example shows how to use source and destination color key using both the interfaces -
</p><p><br />
</p>
<ul><li><b>Using V4L2 IOCTL</b></li></ul>
<p>Enable Source Color Keying:
</p>
<pre>struct v4l2_framebuffer framebuffer;
ret = ioctl (fd, VIDIOC_G_FBUF, &amp;framebuffer);
if (ret &lt; 0) {
    perror ("VIDIOC_G_FBUF");
    close(fd);
    exit(1);
}
/* Set SRC_COLOR_KEYING if device supports that */
if(framebuffer.capability &amp; V4L2_FBUF_CAP_SRC_CHROMAKEY) {
    framebuffer.flags |= V4L2_FBUF_FLAG_SRC_CHROMAKEY;
    framebuffer.flags &amp;= ~V4L2_FBUF_FLAG_CHROMAKEY;
    ret = ioctl (fd, VIDIOC_S_FBUF, &amp;framebuffer);
    if (ret &lt; 0) {
        perror ("VIDIOC_S_FBUF");
        close(fd);
        exit(1);
    }
}
</pre>
<p>Disabling the Source Color Keying:
</p>
<pre>struct v4l2_framebuffer framebuffer;
ret = ioctl (fd, VIDIOC_G_FBUF, &amp;framebuffer);
if (ret &lt; 0) {
    perror ("VIDIOC_G_FBUF");
    close(fd);
    exit(1);
}
if(framebuffer.capability &amp; V4L2_FBUF_CAP_SRC_CHROMAKEY) {
    framebuffer.flags &amp;= ~V4L2_FBUF_FLAG_SRC_CHROMAKEY;
    ret = ioctl (fd, VIDIOC_S_FBUF, &amp;framebuffer);
    if (ret &lt; 0) {
        perror ("VIDIOC_S_FBUF");
        close(fd);
        exit(1);
    }
}
</pre>
<p>Enableing destination color keying:
</p>
<pre>struct v4l2_framebuffer framebuffer;
ret = ioctl (fd, VIDIOC_G_FBUF, &amp;framebuffer);
if (ret &lt; 0) {
    perror ("VIDIOC_G_FBUF");
    close(fd);
    exit(1);
}
/* Set SRC_COLOR_KEYING if device supports that */
if(framebuffer.capability &amp; V4L2_FBUF_CAP_CHROMAKEY) {
    framebuffer.flags |= V4L2_FBUF_FLAG_CHROMAKEY;
    framebuffer.flags &amp;= ~V4L2_FBUF_FLAG_SRC_CHROMAKEY;
    ret = ioctl (fd, VIDIOC_S_FBUF, &amp;framebuffer);
    if (ret &lt; 0) {
        perror ("VIDIOC_S_FBUF");
        close(fd);
        exit(1);
    }
}
</pre>
<p>Disabling destination color keying:
</p>
<pre>struct v4l2_framebuffer framebuffer;
ret = ioctl (fd, VIDIOC_G_FBUF, &amp;framebuffer);
if (ret &lt; 0) {
    perror ("VIDIOC_G_FBUF");
    close(fd);
    exit(1);
}
if(framebuffer.capability &amp; V4L2_FBUF_CAP_CHROMAKEY) {
    framebuffer.flags &amp;= ~V4L2_FBUF_FLAG_CHROMAKEY;
    ret = ioctl (fd, VIDIOC_S_FBUF, &amp;framebuffer);
    if (ret &lt; 0) {
        perror ("VIDIOC_S_FBUF");
        close(fd);
        exit(1);
    }
}
</pre>
<p><br />
Below program listing shows how to set the chromakey value. Please note that chroma key value should be set before enabling the chroma keying. Overlay manager should not be changed between the setting up
of chroma key and enabling the chroma keying.
</p>
<pre>struct v4l2_format fmt;
u8 chromakey = 0xF800; /* Red color RGB565 format */
fmt.type = V4L2_BUF_TYPE_VIDEO_OVERLAY;
ret = ioctl(fd, VIDIOC_G_FMT, &amp;fmt);
if (ret &lt; 0) {
    perror("VIDIOC_G_FMT\n");
    close(fd);
    exit(0);
}
fmt.fmt.win.chromakey = chromakey;
ret = ioctl(fd, VIDIOC_S_FMT, &amp;fmt);
if (ret &lt; 0) {
    perror("VIDIOC_G_FMT\n");
    close(fd);
    exit(0);
}
</pre>
<p>The code snippet below illustrates how to get the chromakey value.
</p>
<pre>struct v4l2_format fmt;
fmt.type = V4L2_BUF_TYPE_VIDEO_OVERLAY;
ret = ioctl(fd, VIDIOC_G_FMT, &amp;fmt);
if (ret &lt; 0) {
    perror("VIDIOC_G_FMT\n");
    close(fd);
    exit(0);
}
printf("Croma value read is&#160;%d\n", fmt.fmt.win.chromakey);
</pre>
<p><br />
</p>
<ul><li><b>SYSFS Interface</b></li></ul>
<p><br />
<br />
</p>
<h2><span class="mw-headline" id="Alpha_Blending"><b>Alpha Blending</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=18" title="Edit section: Alpha Blending">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Alpha blending is a process of blending a foreground color with a background color and producing a new blended color. New blended color depends on the transparency factor referred to as alpha factor of the
foreground color. If the alpha factor is 100% then blended image will have only foreground color. If the alpha factor is 0% blended image will have only back ground color. Any value between 0 to 100% will blend the foreground and background color to produce new blended color depending upon the alpha factor.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:452px;"><a href="File_Transparency-50.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/7/7c/Transparency-50.png" width="450" height="338" class="thumbimage" /></a>  <div class="thumbcaption">Alpha blending with almost 50% transparency</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:452px;"><a href="File_Transparency-100.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/d/d5/Transparency-100.png" width="450" height="338" class="thumbimage" /></a>  <div class="thumbcaption">Alpha blending with almost 100% transparency</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:452px;"><a href="File_Transparency-0.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/5/59/Transparency-0.png" width="450" height="338" class="thumbimage" /></a>  <div class="thumbcaption">Alpha blending with almost 0% transparency</div></div></div></div>
<p><br />
Overlay manager of DSS is capable of supporting the alpha blending. This is done by displaying more than one layer (video and graphics) to the same output device, TV or LCD. Overlay manager supports normal mode and alpha mode of operation. 
</p><p>In normal mode graphics plane is at bottom on top of it is video1 and video2 is on top of video1. While in alpha mode video1 plane is at bottom, video2 is on top of video1, and
graphics plane is above video2. Alpha mode is selectable on any of the output device TV or LCD.
</p><p><br />
Video2 and graphics layer of the DSS is capable of supporting alpha blending. Two types of alpha blending is supported global and pixel alpha blending. ARGB and RGBA formats of the video2 and graphics pipeline
supports pixel based alpha blending. In which A represent the alpha value for each pixel. Thus, each pixel can have different alpha value. While global alpha is the constant alpha factor for the pipeline for all the pixels. Both can be used in conjunction.
</p><p>Both V4L2 and Frame buffer driver supports alpha blending based on pixel format for video2 and graphics pipeline respectively. Global alpha blending is also supported through V4L2 and SYSFS interface. Before using any of the alpha blending methods alpha blending needs to be enabled on the selected output device either through V4L2 ioctl or SYSFS interface. Alpha blending will be enabled on the output device to which video pipeline is connected
</p><p>Following program listing will enable alpha blending through V4L2 driver ioctl -
</p><p><br />
</p>
<pre>struct v4l2_framebuffer framebuffer;
ret = ioctl (fd, VIDIOC_G_FBUF, &amp;framebuffer);
if (ret &lt; 0) {
    perror ("VIDIOC_S_FBUF");
    close(fd);
    return 0;
}
framebuffer.flags |= V4L2_FBUF_FLAG_LOCAL_ALPHA;
framebuffer.flags &amp;= ~(V4L2_FBUF_FLAG_CHROMAKEY | V4L2_FBUF_FLAG_SRC_CHROMAKEY);
ret = ioctl (fd, VIDIOC_S_FBUF, &amp;framebuffer);
if (ret &lt; 0) {
    perror ("VIDIOC_S_FBUF");
    close(fd);
    return 0;
}
</pre>
<p><br />
Following program listing will disable alpha blending through V4L2 driver ioctl -
</p>
<pre>struct v4l2_framebuffer framebuffer;
ret = ioctl (fd, VIDIOC_G_FBUF, &amp;framebuffer);
if (ret &lt; 0) {
    perror ("VIDIOC_S_FBUF");
    close(fd);
    return 0;
}
framebuffer.flags &amp;= ~V4L2_FBUF_FLAG_LOCAL_ALPHA;
ret = ioctl (fd, VIDIOC_S_FBUF, &amp;framebuffer);
if (ret &lt; 0) {
    perror ("VIDIOC_S_FBUF");
    close(fd);
    return 0;
}
</pre>
<p><br />
Following program listing will enable/disable alpha blending through SYSFS entry -
</p>
<pre># echo 0/1 &gt; /sys/devices/platform/omapdss/manager&lt;index&gt;/alpha_blending_enabled

Where,
      0/1   =&gt; 0 - Disable, 1 - Enable.
      index =&gt; 0 - LCD Manager 1 - TV Manager.
</pre>
<p><br />
</p>
<ul><li><b>Global Alpha belnding</b></li></ul>
<p>User can configure global alpha value either through V4L2 IOCTL (V4L2_BUF_TYPE_VIDEO_OVERLAY ) or SYSFS interfac. 
</p><p>Below programlisting shows how to set the global alpha value for video2 pipeline.
</p><p><br />
</p>
<pre>struct v4l2_format fmt;
u8 global_alpha = 128;
fmt.type = V4L2_BUF_TYPE_VIDEO_OVERLAY;
ret = ioctl(fd, VIDIOC_G_FMT, &amp;fmt);
if (ret &lt; 0) {
    perror("VIDIOC_G_FMT\n");
    close(fd);
    exit(0);
}
fmt.fmt.win.global_alpha = global_alpha;
ret = ioctl(fd, VIDIOC_S_FMT, &amp;fmt);
if (ret &lt; 0) {
    perror("VIDIOC_G_FMT\n");
    close(fd);
    exit(0);
}
</pre>
<p><br />
</p>
<ul><li><b>Pixel Based Alpha belnding</b></li></ul>
<p><b>V4L2 Driver</b>
</p><p>V4l2 driver supports alpha blending through ARGB pixel format as well as global alpha value.
</p><p>To set the pixel alpha value set ARGB format by setting format type to V4L2_PIX_FMT_RGB32. Call VIDIOC_S_FMT ioctl of the driver to set it to ARGB format. 
</p><p><br />
</p>
<pre>struct v4l2_format fmt;
/* Set the video type*/
fmt.type = V4L2_BUF_TYPE_VIDEO_OUTPUT;
/* Set the width and height of the picture*/
fmt.fmt.pix.width = 400;
fmt.fmt.pix.height = 400;
/* Set the format to ARGB */
fmt.fmt.pix.pixelformat = V4L2_PIX_FMT_RGB32;
/* Call set format Ioctl */
ret = ioctl(fd, VIDIOC_S_FMT, &amp;fmt);
if (ret &lt; 0) {
    perror("VIDIOC_S_FMT\n");
    close(fd);
    exit(0);
}
</pre>
<p><br />
<b>Note:</b> RGBA format is not supported.
<br />
</p><p><b>FBDEV Driver</b>
</p><p>Pixel alpha value is supported through 32 bpp. Setting the offsets correctly will set the pixel format as ARGB or RGBA.
</p><p>Below program listing shows how to set ARGB pixel format.
</p><p><br />
</p>
<pre>struct fb_var_screeninfo var;
/* Get variable screen information. Variable screen information
* gives information like size of the image, bites per pixel,
* virtual size of the image etc. */
ret = ioctl(fd, FBIOGET_VSCREENINFO, &amp;var);
if (ret &lt; 0) {
    perror("Error reading variable information.\n");
    close(fd);
    exit(3);
}
/* Set bits per pixel and offsets*/
var.red.length= 8;
var.green.length = 8;
var.blue.length = 8;
var.transp.length= 8;
var.transp.offset = 24;
var.red.offset = 16;
var.green.offset =8;
var.blue.offset = 0;
var.bits_per_pixel = 32;
if (ioctl(fd, FBIOPUT_VSCREENINFO, &amp;var)&lt;0) {
    perror("Error:FBIOPUT_VSCREENINFO\n");
    close(fd);
    exit(4);
}
</pre>
<p><br />
User can set the global alpha value for graphics pipeline using sysfs entry, as shown below -
</p>
<pre>#echo &lt;global alpha value&gt; &gt; /sys/devices/platform/omapdss/overlay&lt;index&gt;/global_alpha

Where,
      index =&gt; 0 - GFX Overlay 1 - Vid1 Overlay 2 - Vid2 Overlay
</pre>
<p><br />
<b>NOTE:</b> Before using the global alpha or pixel based alpha Alpha blending needs to be enabled using either sysfs or V4L2 ioctl interface.
</p><p><br />
</p>
<h2><span class="mw-headline" id="Buffer_Format"><b>Buffer Format</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=19" title="Edit section: Buffer Format">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Buffer format describes the pixel format in the image. It also describes the memory organization of each color component within the pixel format. In all buffer formats, blue value is always stored in least significant bits, then green value and then red value.
</p><p><b>V4L2 Driver</b>
</p><p>Video layer supports following buffer format: YUYV, UYVY, RGB565, RGB24 (packed and unpacked). The corresponding v4l2 defines for pixel format are V4L2_PIX_FMT_YUYV, V4L2_PIX_FMT_UYVY, V4L2_PIX_FMT_RGB565, V4L2_PIX_FMT_RGB24 (packed), V4L2_PIX_FMT_RGB32. (For video1 and video2 V4L2_PIX_FMT_RGB32 corresponds to RGB24 unpacked).
</p><p>Buffer format can be changed using VIDIOC_S_FMT ioctl with type as V4L2_BUF_TYPE_VIDEO_OUTPUT and appropriate pixel format type. 
</p><p>Following example shows how to change pixel format to RGB565
</p><p><br />
</p>
<pre>struct v4l2_format fmt;
fmt.type = V4L2_BUF_TYPE_VIDEO_OUTPUT;
fmt.fmt.pix.pixelformat = V4L2_PIX_FMT_RGB565;
ret = ioctl(fd, VIDIOC_S_FMT, &amp;fmt);
if (ret &lt; 0) {
    perror("VIDIOC_S_FMT\n");
    close(fd);
    exit(0);
}
</pre>
<p><br />
<b>FBDEV Driver</b>
</p><p>Graphics layer supports following buffer format: RGB24(un-packed) ARGB, RGBA and RGB565. Buffer format can be changed in FBDEV driver by using bpp, red, green, and blue fields of fb_vscreeninfo structure and ioctl FBIOPUT_VSCREENINFO. Application needs to specify bits per pixel and length and offset of red, green and blue component. Bits-per-pixel and color depth in the pixel aren't quite the same thing. The display controller supports color depths of 1, 2, 4, 8, 12, 16, 24 and 32 bits. Color depth and bits-per-pixel are the same for depths of 1, 2, 4, 8, and 16 bits, but for a color depth of 12 bits the pixel data is padded to 16 bits-per-pixel, and for a color depth of 24 bits the pixel data is padded to 32
bits-per-pixel. So application has to specify bits per pixel 16 and 32 for the color depth 12 and 24. To specify exact color depth, red, green and blue member of the fb_varscreeninfo can be used.
</p><p>Following example shows how to set 12 and 24 bits per pixels.
</p>
<pre>struct fb_varscreeninfo var;
var.bpp = 16;
var.red.length = var.green.length = var.blue.length = 4;
var.red.offset = 8;
var.green.offset = 4;
var.blue.offset = 0;
ret = ioctl(fd, FBIOPUT_VSCREENINFO, &amp;var);
if (ret &lt; 0) {
    perror("FBIOPUT_VSCREENINFO\n");
    close(fd);
    exit(0);
}
</pre>
<p><br />
<b>Buffer Formats</b>
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:452px;"><a href="File_Display-1bpp.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/a/a9/Display-1bpp.png" width="450" height="130" class="thumbimage" /></a>  <div class="thumbcaption">1-BPP Data Memory Organization</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:452px;"><a href="File_Display-2bpp.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/c/c8/Display-2bpp.png" width="450" height="130" class="thumbimage" /></a>  <div class="thumbcaption">2-BPP Data Memory Organization</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:452px;"><a href="File_Display-4bpp.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/5/5d/Display-4bpp.png" width="450" height="130" class="thumbimage" /></a>  <div class="thumbcaption">4-BPP Data Memory Organization</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:452px;"><a href="File_Display-8bpp.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/4/47/Display-8bpp.png" width="450" height="130" class="thumbimage" /></a>  <div class="thumbcaption">8-BPP Data Memory Organization</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:452px;"><a href="File_Display-12bpp.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/2/29/Display-12bpp.png" width="450" height="74" class="thumbimage" /></a>  <div class="thumbcaption">12-BPP Data Memory Organization</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:452px;"><a href="File_Display-16bpp.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/6/6f/Display-16bpp.png" width="450" height="130" class="thumbimage" /></a>  <div class="thumbcaption">16-BPP Data Memory Organization</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:452px;"><a href="File_Display-rgb.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/7/7a/Display-rgb.png" width="450" height="130" class="thumbimage" /></a>  <div class="thumbcaption">24-BPP Data Memory Organization</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:452px;"><a href="File_Display-argb.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/8/85/Display-argb.png" width="450" height="130" class="thumbimage" /></a>  <div class="thumbcaption">ARGB 32-BPP Data Memory Organization</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:452px;"><a href="File_Display-rgba.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/6/68/Display-rgba.png" width="450" height="130" class="thumbimage" /></a>  <div class="thumbcaption">RGBA 32-BPP Data Memory Organization</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:452px;"><a href="File_Display-24bpp-packed.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/f/f3/Display-24bpp-packed.png" width="450" height="134" class="thumbimage" /></a>  <div class="thumbcaption">24-BPP Packed Data Memory Organization</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:452px;"><a href="File_Display-uyvy.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/e/e8/Display-uyvy.png" width="450" height="130" class="thumbimage" /></a>  <div class="thumbcaption">UYVY 4:2:2 Data Memory Organization</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:452px;"><a href="File_Display-yuyv.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/b/ba/Display-yuyv.png" width="450" height="130" class="thumbimage" /></a>  <div class="thumbcaption">YUV2 4:2:2 Data Memory Organization</div></div></div></div>
<p><br />
</p>
<h2><span class="mw-headline" id="Display_Window"><b>Display Window</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=20" title="Edit section: Display Window">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The video pipelines can be connected to either an DVI output LCD output or a TV output either through boot time parameter or through SYSFS interface. Although the display Driver computes a default display window whenever the image size or cropping is changed, an application should position the display window via the VIDIOC_S_FMT I/O control with the V4L2_BUF_TYPE_VIDEO_OVERLAY buffer type. When a switch from LCD
to TV or from TV to LCD happens, an application is expected to adjust the display window. V4L2 driver only supports change of display window.
</p><p>Following example shows how to change display window size.
</p>
<pre>struct v4l2_format fmt;
Fmt.type = V4L2_BUF_TYPE_VIDEO_OVERLAY;
fmt.fmt.win.w.left = 0;
fmt.fmt.win.w.top = 0;
fmt.fmt.win.w.width = 200;
fmt.fmt.win.w.height = 200;
ret = ioctl(fd, VIDIOC_S_FMT, &amp;fmt);
if (ret &lt; 0) {
    perror("VIDIOC_S_FMT\n");
    close(fd);
    exit(0);
}
/* Display window size and position is changed now */
</pre>
<p><br />
</p>
<h2><span class="mw-headline" id="Cropping"><b>Cropping</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=21" title="Edit section: Cropping">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The V4L2 Driver allows an application to define a rectangular portion of the image to be rendered via the VIDIOC_S_CROP Ioctl with the V4L2_BUF_TYPE_VIDEO_OUTPUT buffer type. When application calls VIDIOC_S_FMT ioctl, driver sets default cropping rectangle that is the largest rectangle no larger than the image size and display windows size. The default cropping rectangle is centered in the image. All cropping dimensions are rounded down to even numbers. Changing the size of the cropping rectangle will in general also result in a new default display window. As stated above, an application must adjust the display window accordingly.
</p><p>Following example shows how to change crop size.
</p>
<pre>struct v4l2_crop crop;
crop.type = V4L2_BUF_TYPE_VIDEO_OUTPUT;
crop.c.left = 0;
crop.c.top = 0;
crop.c.width = 320;
crop.c.height = 320;
ret = ioctl(fd, VIDIOC_S_CROP, &amp;crop);
if (ret &lt; 0) {
    perror("VIDIOC_S_CROP\n");
    close(fd);
    exit(0);
}
/* Image cropping rectangle is now changed */
</pre>
<p><br />
</p>
<h2><span class="mw-headline" id="Scaling"><b>Scaling</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=22" title="Edit section: Scaling">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Video pipe line contains scaling unit which is used when transferring pixels from the system memory to the LCD panel or the TV set. The scaling unit consists of two scaling blocks: The vertical scaling block followed by the horizontal scaling block. The two scaling units are independent: Neither of them, only one, or both can be used simultaneously.
</p><p>As scaling unit is on video pipeline, scaling is only supported in V4L2 driver. Scaling is not explicitly exposed at the API level. Instead, the horizontal and vertical scaling factors are based on the display window and the image cropping rectangle. The horizontal scaling factor is computed by dividing the width of the display window by the width of the cropping rectangle. Similarly, the vertical scaling factor is computed by dividing the height of the display window by the height of the cropping rectangle.
</p><p>Down-scaling is limited upto factor 0.25 and the up-scaling factor to 8 in both horizontally and vertically. The display Driver makes sure the limits are never exceeded.
</p><p>The code snippet below illustrates how to scale image by factor of 2.
</p>
<pre>struct v4l2_format fmt;
struct v4l2_crop crop;
/* Changing display window size to 200x200 */
fmt.type = V4L2_BUF_TYPE_VIDEO_OVERLAY;
fmt.fmt.win.w.left = 0;
fmt.fmt.win.w.top = 0;
fmt.fmt.win.w.width = 200;
fmt.fmt.win.w.height = 200;
ret = ioctl(fd, VIDIOC_S_FMT, &amp;fmt);
if (ret &lt; 0) {
    perror("VIDIOC_S_FMT\n");
    close(fd);
    exit(0);
}
/* Changing crop window size to 400x400 */
crop.type = V4L2_BUF_TYPE_VIDEO_OUTPUT;
crop.c.left = 0;
crop.c.top = 0;
crop.c.width = 400;
crop.c.height = 400;
ret = ioctl(fd, VIDIOC_S_CROP, &amp;crop);
if (ret &lt; 0) {
    perror("VIDIOC_S_CROP\n");
    close(fd);
    exit(0);
}
/* Image should be now scaled by factor 2 */
</pre>
<p><br />
</p>
<h2><span class="mw-headline" id="Color_look_table"><b>Color look table</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=23" title="Edit section: Color look table">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The graphics pipeline supports the color look up table. The CLUT mode uses the encoded pixel values from the input image as pointers to index the 24-bit-wide CLUT value: 1-BPP pixels address 2 entries, 2-BPP pixels address 4 entries, 4-BPP pixels address 16 entries, and 8-BPP pixels address 256 entries.
</p><p>Driver supports 1, 2, 4 and 8 bits per pixel image format using color lookup table. FBIOPUTCMAP and FBIOGETCMAP can be used to set and get the color map table. When CLUT is set, the driver makes the hardware to reload the CLUT.
</p><p>Following example shows how to change CLUT.
</p>
<pre>struct fb_cmap cmap;
unsigned short r[4]={0xFF,0x00, 0x00, 0xFF};
unsigned short g[4]={0x00, 0xFF, 0x00, 0xFF};
unsigned short b[4]={0x00, 0x00, 0xFF, 0x00};
cmap.len = 4;
cmap.red = r;
cmap.green = g;
cmap.blue = b;
if (ioctl(fd, FBIOPUTCMAP, &amp;cmap)) {
    perror("FBIOPUTCMAP\n");
    close(fd);
    exit(3);
}
</pre>
<p><br />
</p>
<h2><span class="mw-headline" id="Streaming"><b>Streaming</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=24" title="Edit section: Streaming">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>V4L2 driver supports the streaming of the buffer. To do streaming minimum of three buffers should be requested by the application by using VIDIOC_REQBUFS ioctl. Once driver allocates the requested buffers application should call VIDIOC_QUERYBUF and mmap to get the physical address of the buffers and map the kernel memory to user space as explained earlier. Following are the steps to enable streaming.
</p><p><br />
</p>
<ol><li>Fill the buffers with the image to be displayed in the proper format</li>
<li>Queue buffers to the driver queue using VIDIOC_QBUF ioctl</li>
<li>Start streaming using VIDIOC_STREAMON ioctl</li>
<li>Call VIDIOC_DQBUF to get the displayed buffer</li>
<li>Repeat steps 1, 2, 4 and 5 in a loop for the frame count to be displayed</li>
<li>Call VIDIOC_STREAMOFF ioctl to stop streaming</li></ol>
<p><br />
Following example shows how to do streaming with V4l2 driver
</p>
<pre>/* Initially fill the buffer */
struct v4l2_requestbuffers req;
struct v4l2_buffer buf;
struct v4l2_format fmt;
/* Fill the buffers with the image */
/* Enqueue buffers */
for (i = 0; i &lt; req.count; i++) {
    buf.type = V4L2_BUF_TYPE_VIDEO_OUTPUT;
    buf.index = i;
    buf.memory = V4L2_MEMORY_MMAP;
    ret = ioctl(fd, VIDIOC_QBUF, &amp;buf);
    if (ret &lt; 0) {
        perror("VIDIOC_QBUF\n");
        for (j = 0; j &lt; req.count; j++){
            /* Unmap all the buffers if call fails */
            exit(0);
        }
        printf("VIDIOC_QBUF =&#160;%d\n",i);
    }
}
/* Start streaming */
a = 0;
ret = ioctl(fd, VIDIOC_STREAMON, &amp;a);
if (ret &lt; 0) {
    perror("VIDIOC_STREAMON\n");
    for (i = 0; i &lt; req.count; i++)
        /* Unmap all the buffers if call fails */
    exit(0);
}
/* loop for streaming with 500 Frames*/
for(i = 0&#160;;i &lt; LOOPCOUNT&#160;;i ++) {
    ret = ioctl(fd, VIDIOC_DQBUF, &amp;buf);
    if(ret &lt; 0){
        perror("VIDIOC_DQBUF\n");
        for (j = 0; j &lt; req.count; j++){
            /* Unmap all the buffers if call fails */
        }
        exit(0);
    }
    /* Fill the buffer with new data
    fill(buff_info[buf.index].start, fmt.fmt.pix.width, fmt.fmt.pix.height,0);
    /Queue the buffer again */
    ret = ioctl(fd, VIDIOC_QBUF, &amp;buf);
    if(ret &lt; 0){
        perror("VIDIOC_QBUF\n");
        for (j = 0; j &lt; req.count; j++){
             /* Unmap all the buffers if call fails */
        }
        exit(0);
    }
}
/* Streaming off */
ret = ioctl(fd, VIDIOC_STREAMOFF, &amp;a);
if (ret &lt; 0) {
    perror("VIDIOC_STREAMOFF\n");
    for (i = 0; i &lt; req.count; i++){
        /* Unmap all the buffers if call fails */
    exit(0);
}
</pre>
<p><br />
</p>
<h1><span class="mw-headline" id="Software_Interfaces"><b>Software Interfaces</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=25" title="Edit section: Software Interfaces">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h2><span class="mw-headline" id="Frame-Buffer_Driver_Interface"><b>Frame-Buffer Driver Interface</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=26" title="Edit section: Frame-Buffer Driver Interface">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h3><span class="mw-headline" id="Application_Interface"><b>Application Interface</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=27" title="Edit section: Application Interface">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p><i>open ()</i>
<br />
To open a framebuffer device
<br />
<i>close ()</i>
<br />
To close a framebuffer device
<br />
<i>ioctl ()</i>
<br />
To send ioctl commands to the framebuffer driver.
<br />
<i>mmap ()</i>
<br />
To obtain the framebuffer region as mmap'ed area in user space.
<br />
</p>
<h3><span class="mw-headline" id="Supported_Standard_IOCTLs"><b>Supported Standard IOCTLs</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=28" title="Edit section: Supported Standard IOCTLs">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p><i><b>FBIOGET_VSCREENINFO, FBIOPUT_VSCREENINFO</b></i>
<br />
These I/O controls are used to query and set the so-called variable screen info. This allows an application to query or change the display mode, including the color depth, resolution, timing etc. These I/O controls accept a pointer to a struct fb_var_screeninfo structure. The video mode data supplied in the fb_var_screeninfo struct is translated to values loaded into the display controller registers.
</p><p><br />
<i><b>FBIOGET_FSCREENINFO</b></i>
<br />
This I/O control can be used by applications to get the fixed properties of the display, e.g. the start address of the framebuffer memory. This I/O control accepts a pointer to a struct fb_fix_screeninfo.
</p><p><br />
<i><b>FBIOGETCMAP, FBIOPUTCMAP</b></i>
<br />
These I/O controls are used to get and set the color-map for the framebuffer. These I/O controls accept a pointer to a struct fb_cmap structure.
</p><p><br />
<i><b>FBIO_BLANK</b></i>
<br />
This I/O control is used to blank or unblank the framebuffer console.
</p><p><br />
</p>
<h3><span class="mw-headline" id="Supported_Custom_IOCTLs"><b>Supported Custom IOCTLs</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=29" title="Edit section: Supported Custom IOCTLs">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p><i><b>OMAPFB_WAITFORVSYNC</b></i>
<br />
This ioctl can be used to put an application to sleep until next vertical
sync interval of the display.
</p><p><br />
<i><b>OMAPFB_GET_VRAM_INFO</b></i>
Ioctl returns the configured/allocated vram information.
</p><p><br />
<i><b>OMAPFB_QUERY_MEM</b></i>
<br />
Returns the size and type of the frame buffer.
</p><p><br />
<b>Data Structure:</b>
</p>
<pre>#define OMAPFB_MEMTYPE_SDRAM            0
#define OMAPFB_MEMTYPE_SRAM             1
#define OMAPFB_MEMTYPE_MAX              1
struct omapfb_mem_info {
 __u32 size;
 __u8  type;
 __u8  reserved[3];
};
</pre>
<p><b>Usage:</b>
</p>
<pre>struct omapfb_mem_info mi;
if (ioctl(fb, OMAPFB_QUERY_MEM, &amp;mi)) {
 perror("Error: OMAPFB_QUERY_MEM.\n");
 exit(1);
}
printf("size -&#160;%d\n", mi.size);
printf("type -&#160;%d\n", mi.type);
</pre>
<p><br />
<i><b>OMAPFB_SETUP_MEM</b></i>
<br />
Allows user to setup the frame buffer memory, like size and type.
</p><p><b>Data Structure:</b>
</p>
<pre>#define OMAPFB_MEMTYPE_SDRAM            0
#define OMAPFB_MEMTYPE_SRAM             1
#define OMAPFB_MEMTYPE_MAX              1
struct omapfb_mem_info {
 __u32 size;
 __u8  type;
 __u8  reserved[3];
};
</pre>
<p><b>Usage:</b>
</p>
<pre>struct omapfb_mem_info mi;
mi.size = &lt;Expected size of buffer&gt;
mi.type = &lt;Expected type of buffer&gt;
if (ioctl(fb, OMAPFB_SETUP_MEM, &amp;mi)) {
 perror("Error: OMAPFB_SETUP_MEM.\n");
 exit(1);
}
</pre>
<p><br />
<i><b>OMAPFB_QUERY_PLANE</b></i>
<br />
Query the plane (gfx) and returns the omapfb_plane_info information -
</p><p><b>Data Structure:</b>
</p>
<pre>struct omapfb_plane_info {
 __u32 pos_x;
 __u32 pos_y;
 __u8  enabled;
 __u8  channel_out;
 __u8  mirror;
 __u8  reserved1;
 __u32 out_width;
 __u32 out_height;
 __u32 reserved2[12];
};
</pre>
<p><b>Usage:</b>
</p>
<pre>struct omapfb_plane_info pi;
if (ioctl(fb, OMAPFB_QUERY_PLANE, &amp;pi)) {
 perror("Error: OMAPFB_QUERY_PLANE.\n");
 exit(1);
}
</pre>
<p><br />
<i><b>OMAPFB_SETUP_PLANE</b></i>
<br />
TBD.
</p><p><br />
</p>
<h3><span class="mw-headline" id="Data_Structures"><b>Data Structures</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=30" title="Edit section: Data Structures">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p><i><b>fb_var_screeninfo</b></i>
<br />
This structure is used to query and set the so-called variable screen information. This allows an application to query or change the display mode, including the color depth, resolution, timing etc.
</p><p><br />
<i><b>fb_fix_screeninfo</b></i>
<br />
This structure is used by applications to get the fixed properties of the display, e.g. the start address of the framebuffer memory, framebuffer length etc.
</p><p><br />
<i><b>fb_cmap</b></i>
<br />
This structure is used to get/set the color-map for the framebuffer.
</p><p><br />
</p>
<h2><span class="mw-headline" id="V4L2_Driver_Interface"><b>V4L2 Driver Interface</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=31" title="Edit section: V4L2 Driver Interface">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h3><span class="mw-headline" id="Application_Interface_2"><b>Application Interface</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=32" title="Edit section: Application Interface">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p><b>open()</b>
<br />
To open a video device
</p><p><br />
<b>close()</b>
<br />
To close a video device
</p><p><br />
<b>ioctl()</b>
<br />
To send ioctl commands to the display driver.
</p><p><br />
<b>mmap()</b>
<br />
To memory map a driver allocated buffer to user space
</p><p><br />
</p>
<h3><span class="mw-headline" id="Supported_Standard_IOCTLs_2"><b>Supported Standard IOCTLs</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=33" title="Edit section: Supported Standard IOCTLs">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>This section describes the standard V4L2 IOCTLs supported by the Display Driver. 
<br />
<b>NOTE:</b> Standard IOCTLs that are not listed here are not supported. The Display Driver handles the unsupported ones by returning EINVALerror code.
</p><p><br />
<i><b>VIDIOC_QUERYCAP</b></i>
<br />
This is used to query the driver's capability. The video driver fills a v4l2_capability struct indicating the driver is capable of output and streaming.
</p><p><br />
<i><b>VIDIOC_ENUM_FMT</b></i>
<br />
This is used to enumerate the image formats that are supported by the driver. The driver fills a v4l2_fmtdesc struct.
</p><p><br />
<i><b>VIDIOC_G_FMT</b></i>
<br />
This is used to get the current image format or display window depending on the buffer type. The driver fills the information to a <i>v4l2_format</i> struct.
</p><p><br />
<i><b>VIDIOC_TRY_FMT</b></i>
<br />
This is used to validate a new image format or a new display window depending on the buffer type. The driver may change the passed values if they are not supported. Application should check what is granted.
</p><p><br />
<i><b>VIDIOC_S_FMT</b></i>
<br />
This is used to set a new image format or a new display window depending on the buffer type. The driver may change the passed values if they are not supported. Application should check what is granted if <i>VIDIOC_TRY_FMT</i> is not used first.
</p><p><br />
<i><b>VIDIOC_CROPCAP</b></i>
<br />
This is used to get the default cropping rectangle based on the current image size and the current display panel size. The driver fills a <i>v4l2_cropcap</i> struct.
</p><p><br />
<i><b>VIDIOC_G_CROP</b></i>
<br />
This is used to get the current cropping rectangle. The driver fills a <i>v4l2_crop</i> struct.
</p><p><br />
<i><b>VIDIOC_S_CROP</b></i>
<br />
This is used to set a new cropping rectangle. The driver fills a <i>v4l2_crop</i> struct. Application should check what is granted.
</p><p><br />
<i><b>VIDIOC_REQBUFS</b></i>
<br />
This is used to request a number of buffers that can later be memory mapped. The driver fills a <i>v4l2_request</i> buffers struct. Application should check how many buffers are granted.
</p><p><br />
<i><b>VIDIOC_QUERYBUF</b></i>
<br />
This is used to get a buffer's information so mmap can be called for that buffer. The driver fills a <i>v4l2_buffer</i> struct.
</p><p><br />
<i><b>VIDIOC_QBUF</b></i>
<br />
This is used to queue a buffer by passing a <i>v4l2_buffer</i> struct associated to that buffer.
</p><p><br />
<i><b>VIDIOC_DQBUF</b></i>
<br />
This is used to dequeue a buffer by passing a <i>v4l2_buffer</i> struct associated to that buffer.
</p><p><br />
<i><b>VIDIOC_STREAMON</b></i>
<br />
This is used to turn on streaming. After that, any <i>VIDIOC_QBUF</i> results in an image being rendered.
</p><p><br />
<i><b>VIDIOC_S_CTRL, VIDIOC_G_CTRL, VIDIOC_QUERYCTRL</b></i>
<br />
These ioctls are used to set/get and query various V4L2 controls like rotation, mirror and background color. Currently only rotation is supported.
</p><p><br />
<i><b>VIDIOC_STREAMOFF</b></i>
<br />
This is used to turn off streaming.
</p><p><br />
</p>
<h2><span class="mw-headline" id="SYSFS_Software_Interfaces"><b>SYSFS Software Interfaces</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=34" title="Edit section: SYSFS Software Interfaces">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>User can control all dynamic configuration of DSS core and Fbdev functionality thorugh SYSFS interface.
</p>
<h3><span class="mw-headline" id="Frame-buffer_Driver_sysfs_attributes"><b>Frame-buffer Driver sysfs attributes</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=35" title="Edit section: Frame-buffer Driver sysfs attributes">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Following attributes are available for user control -
</p>
<pre>#
# ls -1 /sys/class/graphics/fb0/
bits_per_pixel
blank
console
cursor
dev
device
mirror
mode
modes
name
overlays
overlays_rotate
pan
phys_addr
power
rotate
rotate_type
size
state
stride
subsystem
uevent
virt_addr
virtual_size
#
</pre>
<p><br />
</p>
<table border="1" cellspacing="0" cellpadding="5" width="40%">
<caption><b>Frame-buffer Driver sysfs attributes</b>
</caption>
<tbody><tr>
<th align="left">Acronym
</th>
<th align="left">Definition
</th></tr>
<tr>
<td>bits_per_pixel
</td>
<td>Allows user to control bits per pixel configuration, currently the supported values are 16, 24 and 32.
<pre># echo 16/24/32 &gt; /sys/class/graphics/fb0/ bits_per_pixel
</pre>
</td></tr>
<tr>
<td>blank
</td>
<td>Allows user to control lcd display blanking configuration independently.
<pre># echo 0/4  &gt; /sys/class/graphics/fb0/blank

Values only 0(FB_BLANK_UNBLANK) and 4(FB_BLANK_POWERDOWN) is supported
</pre>
</td></tr>
<tr>
<td>rotate
</td>
<td>Allows user to control rotation through this entry,
<pre># echo 0/1/2/3 &gt; /sys/class/graphics/fb0/rotate

0 - 0 degree, 1 - 90 degree, 2 - 180 degree and 3 - 270 degree respectively.
</pre>
</td></tr>
<tr>
<td>rotate_type
</td>
<td>Allows user to control rotation type through this entry,
<pre># echo 0/1 &gt; /sys/class/graphics/fb0/rotate_type

0 - DMA based rotation,
1 - VRFB based rotation.
Currently only VRFB based rotation is supported.
</pre>
</td></tr>
<tr>
<td>virtual_size
</td>
<td>Allows user to configure xres_virtual and yres_virtual parameters of frame-buffer,
<pre># cat /sys/class/graphics/fb0/virtual_size
480,640
</pre>
</td></tr>
<tr>
<td>virt_addr
</td>
<td>Readonly entry, displays virtual address of the frame-buffer memory.
</td></tr>
<tr>
<td>phys_addr
</td>
<td>Readonly entry, displays physical address of the frame-buffer memory.
</td></tr></tbody></table>
<p><br />
</p>
<h3><span class="mw-headline" id="DSS_Library_sysfs_attributes"><b>DSS Library sysfs attributes</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=36" title="Edit section: DSS Library sysfs attributes">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>DSS library provides/exports following attributes, which explained in detail below -
</p>
<pre>#
# ls -1 /sys/devices/platform/omapdss/
bus
display0
display1
display2
driver
manager0
manager1
microamps_requested_vdda_dac
modalias
overlay0
overlay1
overlay2
power
subsystem
uevent
#
</pre>
<p><br />
</p>
<h4><span id="DSS_Library:_display0/1/2"></span><span class="mw-headline" id="DSS_Library:_display0.2F1.2F2"><b>DSS Library: display0/1/2</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=37" title="Edit section: DSS Library: display0/1/2">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>In all total 3 output displays are supported on EVM,
</p>
<pre>#
# ls -1 /sys/devices/platform/omapdss/display0/
bus
driver
enabled
microamps_requested_vdvi
mirror
name
power
rotate
subsystem
tear_elim
timings
uevent
update_mode
wss
#
</pre>
<table border="1" cellspacing="0" cellpadding="5" width="40%">
<caption><b>DSS Library-display0/1/2: sysfs attributes</b>
</caption>
<tbody><tr>
<th align="left">Acronym
</th>
<th align="left">Definition
</th></tr>
<tr>
<td>enabled
</td>
<td>User can enable/disable the display through this entry
</td></tr>
<tr>
<td>timings
</td>
<td>Displays the timing configuration for specific display panel
</td></tr>
<tr>
<td>name
</td>
<td>Shows name of the display panel/output
</td></tr></tbody></table>
<h4><span id="DSS_Library:_Manager0/1"></span><span class="mw-headline" id="DSS_Library:_Manager0.2F1"><b>DSS Library: Manager0/1</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=38" title="Edit section: DSS Library: Manager0/1">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>In all total 2 managers are supported on EVM,
</p>
<pre>#
# ls -1 /sys/devices/platform/omapdss/manager0/
alpha_blending_enabled
default_color
display
name
trans_key_enabled
trans_key_type
trans_key_value
#
</pre>
<table border="1" cellspacing="0" cellpadding="5" width="40%">
<caption><b>DSS Library-Manager0/1: sysfs attributes</b>
</caption>
<tbody><tr>
<th align="left">Acronym
</th>
<th align="left">Definition
</th></tr>
<tr>
<td>alpha_blending_enabled
</td>
<td>User can enable/disable Alpha-blending through this entry.
</td></tr>
<tr>
<td>display
</td>
<td>Allows user to control the output display, user can set the output to any of the display
</td></tr>
<tr>
<td>trans_key_enabled
</td>
<td>User can enable/disable Transparency key keying through this entry
</td></tr>
<tr>
<td>trans_key_type
</td>
<td>User can control the Transparency key type here.
</td></tr>
<tr>
<td>trans_key_value
</td>
<td>User can configure Transparency color keying value through this entry.
</td></tr></tbody></table>
<p><br />
</p>
<h4><span id="DSS_Library:_Overlay0/1/2"></span><span class="mw-headline" id="DSS_Library:_Overlay0.2F1.2F2"><b>DSS Library: Overlay0/1/2</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=39" title="Edit section: DSS Library: Overlay0/1/2">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>In all total 3 Overlays/Planes/Pipelines are supported on EVM,
</p>
<pre>#
# ls -1 /sys/devices/platform/omapdss/overlay0/
enabled
global_alpha
input_size
manager
name
output_size
position
screen_width
#
</pre>
<table border="1" cellspacing="0" cellpadding="5" width="40%">
<caption><b>DSS Library-display0/1/2: sysfs attributes</b>
</caption>
<tbody><tr>
<th align="left">Acronym
</th>
<th align="left">Definition
</th></tr>
<tr>
<td>enabled
</td>
<td>User can enable/disable overlay through this entry.
</td></tr>
<tr>
<td>global_alpha
</td>
<td>User can configure global alpha value through this entry.
</td></tr>
<tr>
<td>manager
</td>
<td>Allows control over manager &lt;-&gt; overlay interface, user can configure any overlay to any of the manager
</td></tr></tbody></table>
<h3><span class="mw-headline" id="DSS2_SYSFS_Examples"><b>DSS2 SYSFS Examples</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=40" title="Edit section: DSS2 SYSFS Examples">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Please refer <a rel="nofollow" class="external text" href="http://processors.wiki.ti.com/index.php?title=DSS2_SYSFS_Examples">DSS2 SYSFS examples</a> for examples of using sysfs interface to change display settings.
</p>
<h2><span class="mw-headline" id="Miscellaneous_Configurations"><b>Miscellaneous Configurations</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=41" title="Edit section: Miscellaneous Configurations">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The default setup/configuration is -
</p><p><br />
</p>
<pre>GFX   =&gt; - -  \       DVI
               \
Vid1  =&gt; - - =&gt; =&gt; =&gt; LCD
               /
Vid2  =&gt; _ _  /       TV
</pre>
<p><br />
</p><p>User can control/configure the various interfaces like, overlay &lt;=&gt; manager &lt;=&gt; display. This section demonstrate/explains the dynamic switching of output using above interfaces.
</p><p><br />
</p>
<h3><span class="mw-headline" id="Switching_output_from_LCD_to_DVI"><b>Switching output from LCD to DVI</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=42" title="Edit section: Switching output from LCD to DVI">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Follow the steps below to switch output from LCD to DVI interface:
</p>
<ul><li>Disable LCD display</li></ul>
<pre># echo 0 &gt; /sys/devices/platform/omapdss/display0/enabled
</pre>
<ul><li>Disable manager link to display</li></ul>
<pre># echo "" &gt; /sys/devices/platform/omapdss/manager0/display
</pre>
<ul><li>Configure the framebuffer driver for target display panel size</li></ul>
<pre># fbset -fb /dev/fb0 -xres $w -yres $h -vxres $w -vyres $h
</pre>
<ul><li>Configure manager to DVI display interface</li></ul>
<pre># echo "dvi" &gt; /sys/devices/platform/omapdss/manager0/display
</pre>
<ul><li>Enable DVI display</li></ul>
<pre># echo 1 &gt; /sys/devices/platform/omapdss/display2/enabled
</pre>
<p><br />
<b>NOTE:</b> Similar steps must be followed for switching from DVI to LCD.
</p><p><br />
<b>NOTE:</b> Please note that the user can read the panel configuration through sysfs entry "/sys/devices/platform/omapdss/display&lt;index&gt;/timings"
</p><p><br />
</p>
<h3><span id="Switching_Overlay0_(GFX)_output_from_LCD_to_TV"></span><span class="mw-headline" id="Switching_Overlay0_.28GFX.29_output_from_LCD_to_TV"><b>Switching Overlay0 (GFX) output from LCD to TV</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=43" title="Edit section: Switching Overlay0 (GFX) output from LCD to TV">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Follow below steps to switch output from LCD to TV interface -
</p>
<ul><li>Disable GFX overlay</li></ul>
<pre># echo 0 &gt; /sys/devices/platform/omapdss/overlay0/enabled
</pre>
<ul><li>Disable GFX overlay link to LCD manager</li></ul>
<pre># echo "" &gt; /sys/devices/platform/omapdss/overlay0/manager
</pre>
<ul><li>Disable LCD display output</li></ul>
<pre># echo 0 &gt; /sys/devices/platform/omapdss/display0/enabled
</pre>
<ul><li>Configure the framebuffer driver for target display panel size</li></ul>
<pre># fbset -fb /dev/fb0 -xres $w -yres $h -vxres $w -vyres $h
</pre>
<ul><li>Switch GFX overlay to TV manager</li></ul>
<pre># echo "tv" &gt; /sys/devices/platform/omapdss/overlay0/manager
</pre>
<ul><li>Enable TV display interface</li></ul>
<pre># echo 1 &gt; /sys/devices/platform/omapdss/display1/enabled
</pre>
<ul><li>Enable GFX overlay</li></ul>
<pre># echo 1 &gt; /sys/devices/platform/omapdss/overlay0/enabled
</pre>
<p><br />
<b>NOTE:</b> Similar steps must follow for other (Video 1 &amp; 2) overlays.
<br />
</p><p><br />
</p>
<h3><span id="Cloning_Overlay0_(GFX)_output_to_both_LCD_and_TV"></span><span class="mw-headline" id="Cloning_Overlay0_.28GFX.29_output_to_both_LCD_and_TV"><b>Cloning Overlay0 (GFX) output to both LCD and TV</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=44" title="Edit section: Cloning Overlay0 (GFX) output to both LCD and TV">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Follow below steps to clone GFX overlay output to both LCD and TV -
</p><p><br />
</p>
<ul><li>Disable GFX overlay</li></ul>
<pre># echo 0 &gt; /sys/devices/platform/omapdss/overlay0/enabled
</pre>
<ul><li>Disable Video1 overlay</li></ul>
<pre># echo 0 &gt; /sys/devices/platform/omapdss/overlay1/enabled
</pre>
<ul><li>If fb1 is configured, disable link between Frame-buffer and overlay1</li></ul>
<pre># echo "" &gt; /sys/class/graphics/fb1/overlays
</pre>
<ul><li>Attach overlay 0 and overlay 1 to FB0</li></ul>
<pre># echo "0,1" &gt; /sys/class/graphics/fb0/overlays
</pre>
<ul><li>Configure overlay1</li></ul>
<pre># echo "$w,$h" &gt; /sys/devices/platform/omapdss/overlay0/output_size
</pre>
<ul><li>Set the overlay1 manager to TV</li></ul>
<pre># echo "tv" &gt; /sys/devices/platform/omapdss/overlay0/manager
</pre>
<ul><li>Enable both overlay (overlay 0 and 1)</li></ul>
<pre># echo "1" &gt; /sys/devices/platform/omapdss/overlay0/enabled
# echo "1" &gt; /sys/devices/platform/omapdss/overlay1/enabled
</pre>
<ul><li>Enable TV out</li></ul>
<pre># echo "1" &gt; /sys/devices/platform/omapdss/display1/enabled
</pre>
<p><br />
</p>
<h1><span class="mw-headline" id="Driver_Configuration"><b>Driver Configuration</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=45" title="Edit section: Driver Configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h2><span class="mw-headline" id="V4L2_video_driver"><b>V4L2 video driver</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=46" title="Edit section: V4L2 video driver">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>To V4L2 video driver start the Linux Kernel Configuration tool.
</p>
<pre>$ make menuconfig ARCH=arm
</pre>
<ul><li>Select "Device Drivers" from the main menu.</li></ul>
<pre>    ...
    ...
    Kernel Features  ---&gt;
    Boot options  ---&gt;
    CPU Power Management  ---&gt;
    Floating point emulation  ---&gt;
    Userspace binary formats  ---&gt;
    Power management options  ---&gt;
[*] Networking support  ---&gt;
"    Device Drivers  ---&gt;"
    ...
    ...
</pre>
<p><br />
</p>
<ul><li>Select "Multimedia support" from the menu.</li></ul>
<pre>    ...
    ...
    Sonics Silicon Backplane  ---&gt;
    Multifunction device drivers  ---&gt;
[*] Voltage and Current Regulator Support  ---&gt;
"&lt;*&gt; Multimedia support  ---&gt;"
    Graphics support  ---&gt;
&lt;*&gt; Sound card support  ---&gt;
[*] HID Devices  ---&gt;
[*] USB support  ---&gt;
    ...
    ...
</pre>
<p><br />
</p>
<ul><li>Select "Video For Linux" from the menu.</li></ul>
<pre>    ...
    ...
    *** Multimedia core support ***
"&lt;*&gt;   Video For Linux"
[*]     Enable Video For Linux API 1 (DEPRECATED)
&lt; &gt;   DVB for Linux
    ...
    ...
</pre>
<p><br />
</p>
<ul><li>Select "Video capture adapters" from the same menu. Press &lt;ENTER&gt; to enter the corresponding sub-menu.</li></ul>
<pre>    ...
    ...
[ ]   Customize analog and hybrid tuner modules to build  ---&gt;
"[*]   Video capture adapters  ---&gt;"
[ ]   Memory-to-memory multimedia devices  ---&gt;
[ ]   Radio Adapters  ---&gt;
[ ]   DAB adapters
    ...
    ...
</pre>
<p><br />
</p>
<ul><li>Select "OMAP2/OMAP3 V4L2-DSS drivers" from the menu.</li></ul>
<pre>    ...
    ...
-*-   VPSS System module driver
&lt;*&gt;   VPFE Video Capture Driver
&lt;*&gt;     DM6446 CCDC HW module
"&lt;*&gt;   OMAP2/OMAP3 V4L2-Display driver"
&lt; &gt;   CPiA2 Video For Linux
    ...
    ...
</pre>
<p><br />
</p>
<ul><li>In case of modular build choose "M" for "OMAP2/OMAP3 V4L2-Display driver", as shown below -</li></ul>
<pre>    ...
    ...
-*-   VPSS System module driver
&lt;*&gt;   VPFE Video Capture Driver
&lt;*&gt;     DM6446 CCDC HW module
"&lt;M&gt;   OMAP2/OMAP3 V4L2-Display driver"
&lt; &gt;   CPiA2 Video For Linux
    ...
    ...
</pre>
<p>All dependencies are being handled through standard Linux Kconfig rules; after building the modules it will create "omap-vout.ko" file under "&lt;kernel home&gt;/drivers/media/video/omap/" directory.
</p><p><b>NOTE:</b> Please note that based on Kconfig rule, other dependent module may get build as module, so please make sure that you insert all other dependent modules into the kernel before using omap-vout.ko. 
</p>
<h2><span class="mw-headline" id="Framebuffer_driver"><b>Framebuffer driver</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=47" title="Edit section: Framebuffer driver">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<pre>$ make menuconfig ARCH=arm
</pre>
<ul><li>Select "Device Drivers" from the main menu.</li></ul>
<pre>...
    ...
    Kernel Features  ---&gt;
    Boot options  ---&gt;
    CPU Power Management  ---&gt;
    Floating point emulation  ---&gt;
    Userspace binary formats  ---&gt;
    Power management options  ---&gt;
[*] Networking support  ---&gt;
"   Device Drivers  ---&gt;"
    ...
    ...
</pre>
<p><br />
</p>
<ul><li>Select "Graphics support" from the menu.</li></ul>
<pre>    ...
    ...
    Sonics Silicon Backplane  ---&gt;
    Multifunction device drivers  ---&gt;
[*] Voltage and Current Regulator Support  ---&gt;
&lt;*&gt; Multimedia support  ---&gt;
"    Graphics support  ---&gt;"
&lt;*&gt; Sound card support  ---&gt;
[*] HID Devices  ---&gt;
[*] USB support  ---&gt;
    ...
    ...
</pre>
<p><br />
</p>
<ul><li>Select "Support for frame buffer devices" from the menu.</li></ul>
<pre>    ...
    ...
&lt;M&gt; Lowlevel video output switch controls
"&lt;*&gt; Support for frame buffer devices  ---&gt;"
&lt; &gt; Virtual Frame Buffer support (ONLY FOR TESTING!)
&lt; &gt; E-Ink Broadsheet/Epson S1D13521 controller support
&lt; &gt; Fujitsu MB862xx GDC support
    ...
    ...
</pre>
<p><br />
</p>
<ul><li>Select "OMAP2/3 Display Subsystem support (EXPERIMENTAL)" from the same menu.</li></ul>
<pre>    ...
    ...
&lt; &gt; Fujitsu MB862xx GDC support
&lt; &gt; E-Ink Broadsheet/Epson S1D13521 controller support
[ ] Check bootloader initialization
"-*- OMAP2/3 Display Subsystem support (EXPERIMENTAL)  ---&gt;"
[*] Backlight &amp; LCD device support  ---&gt;
    ...
    ...
</pre>
<p><br />
</p>
<ul><li>Configure default VRAM size to the required/expected size of buffer, the default is 4MB.</li></ul>
<p>Go inside option "OMAP2/3 Display Subsystem support"
</p>
<pre>    ...
    ...
--- OMAP2/3 Display Subsystem support (EXPERIMENTAL)
"(4)   VRAM size (MB)"
[*]   Debug support
    ...
    ...
</pre>
<p><br />
</p>
<ul><li>Select "DPI support" from the menu.</li></ul>
<pre>    ...
    ...
[ ]   Debug support
[*]   DPI support
[ ]   RFBI support
    ...
    ...
</pre>
<p><br />
</p>
<ul><li>Select "VENC support" from the menu.</li></ul>
<pre>    ...
    ...
[ ]   Debug support
[ ]   RFBI support
"[*]   VENC support"
         OMAP2_VENC_OUT_TYPE (Use S-Video output interface)  ---&gt;
[ ]   SDI support
    ...
    ...
</pre>
<p>The default TV out interface is  S-Video. Other option available is Composite.
<br />
<b>NOTE:</b> On OMAP3EVM-1 (&lt; Rev-E) SW1.6 is used to select between S-Video and Composite outputs. <b>ON&#160;:- S-Video, OFF&#160;:- Composite</b>
</p><p><br />
</p>
<ul><li>Select DSI Clock as a source clock for DSS/DISPC</li></ul>
<pre>    ...
    ...
  [ ]   SDI support
  [*]   DSI support
      [*]     Use DSI PLL for PCLK (EXPERIMENTAL)
  [ ]   Fake VSYNC irq from manual update displays

</pre>
<p><b>NOTE:</b> Please note that by default DSI clock is enabled as a source clock for DSS/DISPC.
</p>
<ul><li>Select "OMAP2/3 frame buffer support" from the same menu. Press &lt;ENTER&gt; to enter the corresponding sub-menu.</li></ul>
<pre>    ...
    ...
[ ]   Fake VSYNC irq from manual update displays
(1)   Minimum FCK/PCK ratio (for scaling)
"&lt;*&gt;   OMAP2/3 frame buffer support (EXPERIMENTAL)  ---&gt;"
      OMAP2/3 Display Device Drivers  ---&gt;
    ...
    ...
</pre>
<p><br />
</p>
<ul><li>Value for Number of framebuffers can be changed here.</li></ul>
<pre>--- OMAP2/3 frame buffer support (EXPERIMENTAL)
[*]   Debug support for OMAP2/3 FB
"(1)   Number of framebuffers"
</pre>
<p><b>NOTE:</b> If this value is set as 1, the graphics pipeline of the DSS is controlled by the FBDEV interface and both video pipelines by the V4L2 interface.
<br />
If this value is set as 2, the graphics pipeline and one video pipeline is controlled by the FBDEV interface and one video pipeline by the V4L2 interface.
<br />
If this value is set as 3, all 3 pipelines are controlled by the FBDEV interface.
</p><p><br />
</p>
<ul><li>Select the supported display panels, exit one level up to the menu "OMAP2/3 Display Subsystem support" and go inside "OMAP2/3 Display Device Drivers"</li></ul>
<pre>    ...
    ...
(1)   Minimum FCK/PCK ratio (for scaling)
&lt;*&gt;   OMAP2/3 frame buffer support (EXPERIMENTAL)  ---&gt;
"OMAP2/3 Display Device Drivers  ---&gt;"
    ...
    ...
</pre>
<p><br />
</p>
<ul><li>Select the supported display panels, as shown below</li></ul>
<pre>&lt;*&gt; Generic Panel
&lt;*&gt; Sharp LS037V7DW01 LCD Panel
&lt;*&gt; Sharp LQ043T1DG01 LCD Panel
&lt; &gt; Taal DSI Panel
    ...
    ...
</pre>
<p><b>NOTE:</b> In case of OMAP3EVM "Sharp LS037V7DW01 LCD Panel" is used and in case of AM3517EVM "Sharp LQ043T1DG01 LCD Panel" is being used.
</p><p><br />
<br />
</p>
<ul><li>In case of modular build choose "M" for "OMAP2/3 Display Subsystem support (EXPERIMENTAL)", as shown below -</li></ul>
<pre>    ...
    ...
&lt; &gt; Fujitsu MB862xx GDC support
&lt; &gt; E-Ink Broadsheet/Epson S1D13521 controller support
[ ] Check bootloader initialization
"&lt;M&gt; OMAP2/3 Display Subsystem support (EXPERIMENTAL)  ---&gt;"
[*] Backlight &amp; LCD device support  ---&gt;
    ...
    ...
</pre>
<p>All dependencies are being handled through standard Linux Kconfig rules; after building the modules it will create various .ko files under "&lt;kernel home&gt;/drivers/video/omap2/" directory.
</p><p><b>NOTE:</b> Please note that based on Kconfig rule, other dependent module may get build as module, so please make sure that you insert all other dependent modules into the kernel before using omapfb.ko. 
</p><p><br />
</p>
<h1><span class="mw-headline" id="Sample_Application_Flow"><b>Sample Application Flow</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=48" title="Edit section: Sample Application Flow">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>This chapter describes the application flow using the V4l2 and FBDEV drivers.
</p>
<h2><span class="mw-headline" id="V4L2-Display_Application_Flow"><b>V4L2-Display Application Flow</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=49" title="Edit section: V4L2-Display Application Flow">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p><br />
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:294px;"><a href="File_V4l2_apps_flow.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/1/18/V4l2_apps_flow.png" width="292" height="783" class="thumbimage" /></a>  <div class="thumbcaption">Application for v4l2 driver using MMAP buffers</div></div></div></div>
<p><br />
</p>
<h2><span class="mw-headline" id="Fbdev-Display_Application_Flow"><b>Fbdev-Display Application Flow</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;section=50" title="Edit section: Fbdev-Display Application Flow">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p><br />
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:259px;"><a href="File_Fbdev_apps_flow.html" class="image"><img alt="" src="https://processors.wiki.ti.com/images/5/5c/Fbdev_apps_flow.png" width="257" height="480" class="thumbimage" /></a>  <div class="thumbcaption">Application for FBDEV driver</div></div></div></div>

<!-- 
NewPP limit report
Cached time: 20201201021311
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.165 seconds
Real time usage: 0.178 seconds
Preprocessor visited node count: 1054/1000000
Preprocessor generated node count: 2104/1000000
Post‐expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 22348/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 -total
-->
</div>
<!-- Saved in parser cache with key procwiki:pcache:idhash:9505-0!canonical and timestamp 20201201021311 and revision id 61675
 -->
<div class='hf-nsfooter' id='hf-nsfooter-'><table style="text-align:center; background:white; width:100%; text-align:left; height: 65px border-top: 1px solid; border-bottom: 1px solid; border-left: 1px solid; border-right: 1px solid; border-width: 1px; border-style: solid;">
<tr>
<td width="305px"><a href="File_E2e.html" class="image"><img alt="E2e.jpg" src="https://processors.wiki.ti.com/images/8/82/E2e.jpg" width="305" height="63" /></a>
</td>
<td>{{
<ol><li>switchcategory:MultiCore=</li></ol>
<ul><li>For technical support on MultiCore devices, please post your questions in the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/c6000_multi-core_dsps/default.aspx">C6000 MultiCore Forum</a></li>
<li>For questions related to the BIOS MultiCore SDK (MCSDK), please use the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/embedded/f/355.aspx">BIOS Forum</a></li></ul>
<p>Please post only comments related to the article <b>UserGuideDisplayDrivers PSP 04.02.00.07</b> here.<i></i>
</p>
</td>
<td>Keystone=
<ul><li>For technical support on MultiCore devices, please post your questions in the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/c6000_multi-core_dsps/default.aspx">C6000 MultiCore Forum</a></li>
<li>For questions related to the BIOS MultiCore SDK (MCSDK), please use the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/embedded/f/355.aspx">BIOS Forum</a></li></ul>
<p>Please post only comments related to the article <b>UserGuideDisplayDrivers PSP 04.02.00.07</b> here.<i></i>
</p>
</td>
<td>C2000=<i>For technical support on the C2000 please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/microcontrollers/tms320c2000_32-bit_real-time_mcus/f/171.aspx">The C2000 Forum</a>. Please post only comments about the article <b>UserGuideDisplayDrivers PSP 04.02.00.07</b> here.</i>
</td>
<td>DaVinci=<i>For technical support on DaVincoplease post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/davinci_digital_media_processors/default.aspx">The DaVinci Forum</a>. Please post only comments about the article <b>UserGuideDisplayDrivers PSP 04.02.00.07</b> here.</i>
</td>
<td>MSP430=<i>For technical support on MSP430 please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/microcontrollers/msp43016-bit_ultra-low_power_mcus/default.aspx">The MSP430 Forum</a>. Please post only comments about the article <b>UserGuideDisplayDrivers PSP 04.02.00.07</b> here.</i>
</td>
<td>OMAP35x=<i>For technical support on OMAP please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/omap_applications_processors/default.aspx">The OMAP Forum</a>. Please post only comments about the article <b>UserGuideDisplayDrivers PSP 04.02.00.07</b> here.</i>
</td>
<td>OMAPL1=<i>For technical support on OMAP please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/omap_applications_processors/default.aspx">The OMAP Forum</a>. Please post only comments about the article <b>UserGuideDisplayDrivers PSP 04.02.00.07</b> here.</i>
</td>
<td>MAVRK=<i>For technical support on MAVRK please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/development_tools/mavrk/default.aspx">The MAVRK Toolbox Forum</a>. Please post only comments about the article <b>UserGuideDisplayDrivers PSP 04.02.00.07</b> here.</i>
</td>
<td><i>For technical support please post your questions at <a rel="nofollow" class="external text" href="http://e2e.ti.com/">http://e2e.ti.com</a>. Please post only comments about the article <b>UserGuideDisplayDrivers PSP 04.02.00.07</b> here.</i>
<p>}}
</p>
</td></tr></table>
<table style="border-style:solid; border-width:1px; text-align:center; width:100%;">

<tr style="font-size:150%;">
<td rowspan="2"><a href="File_Hyperlink_blue.html" class="image"><img alt="Hyperlink blue.png" src="https://processors.wiki.ti.com/images/9/9f/Hyperlink_blue.png" width="96" height="96" /></a>
</td>
<td><b>Links</b>
</td></tr>
<tr>
<td>
<table style="text-align: left;">
<tr>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/amplifier_and_linear.page">Amplifiers &amp; Linear</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/audio/audio_overview.page">Audio</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/rfif.page">Broadband RF/IF &amp; Digital Radio</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/clocksandtimers/clocks_and_timers.page">Clocks &amp; Timers</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/dataconverters/data_converter.page">Data Converters</a>
</p>
</td>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/mems/mems.page">DLP &amp; MEMS</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/high_reliability.page">High-Reliability</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/interface/interface.page">Interface</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/logic/home_overview.page">Logic</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/powermanagement/power_portal.page">Power Management</a>
</p>
</td>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/dsp/embedded_processor.page">Processors</a>
</p>
<ul><li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/dsp/arm.page">ARM Processors</a></li>
<li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/dsp/home.page">Digital Signal Processors (DSP)</a></li>
<li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/microcontroller/home.page">Microcontrollers (MCU)</a></li>
<li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/omap-applications-processors/the-omap-experience.page">OMAP Applications Processors</a></li></ul>
</td>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/switches_and_multiplexers.page">Switches &amp; Multiplexers</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/temperature_sensor.page">Temperature Sensors &amp; Control ICs</a><br/>
<a rel="nofollow" class="external text" href="http://focus.ti.com/wireless/docs/wirelessoverview.tsp?familyId=2003&amp;sectionId=646&amp;tabId=2735">Wireless Connectivity</a>
</p>
</td></tr></table>
</td></tr></table>
<div id="tiPrivacy"></div>
</div></div>					<div class="printfooter">
						Retrieved from "<a dir="ltr" href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;oldid=61675">https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;oldid=61675</a>"					</div>
				<div id="catlinks" class="catlinks catlinks-allhidden" data-mw="interface"></div>				<div class="visualClear"></div>
							</div>
		</div>
		<div id="mw-navigation">
			<h2>Navigation menu</h2>
			<div id="mw-head">
									<div id="p-personal" role="navigation" class="" aria-labelledby="p-personal-label">
						<h3 id="p-personal-label">Personal tools</h3>
						<ul>
							<li id="pt-login"><a href="https://processors.wiki.ti.com/index.php?title=Special:UserLogin&amp;returnto=UserGuideDisplayDrivers+PSP+04.02.00.07" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li><li id="pt-createaccount"><a href="Special_RequestAccount.html" title="You are encouraged to create an account and log in; however, it is not mandatory">Request account</a></li>						</ul>
					</div>
									<div id="left-navigation">
										<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
						<h3 id="p-namespaces-label">Namespaces</h3>
						<ul>
							<li id="ca-nstab-main" class="selected"><span><a href="UserGuideDisplayDrivers_PSP_04.02.00.html" title="View the content page [c]" accesskey="c">Page</a></span></li><li id="ca-talk" class="new"><span><a href="https://processors.wiki.ti.com/index.php?title=Talk:UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page (page does not exist) [t]" accesskey="t">Discussion</a></span></li>						</ul>
					</div>
										<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
												<input type="checkbox" class="vectorMenuCheckbox" aria-labelledby="p-variants-label" />
						<h3 id="p-variants-label">
							<span>Variants</span>
						</h3>
						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
									</div>
				<div id="right-navigation">
										<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
						<h3 id="p-views-label">Views</h3>
						<ul>
							<li id="ca-view" class="collapsible selected"><span><a href="UserGuideDisplayDrivers_PSP_04.02.00.html">Read</a></span></li><li id="ca-viewsource" class="collapsible"><span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></span></li><li id="ca-history" class="collapsible"><span><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=history" title="Past revisions of this page [h]" accesskey="h">View history</a></span></li>						</ul>
					</div>
										<div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label">
						<input type="checkbox" class="vectorMenuCheckbox" aria-labelledby="p-cactions-label" />
						<h3 id="p-cactions-label"><span>More</span></h3>
						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
										<div id="p-search" role="search">
						<h3>
							<label for="searchInput">Search</label>
						</h3>
						<form action="https://processors.wiki.ti.com/index.php" id="searchform">
							<div id="simpleSearch">
								<input type="search" name="search" placeholder="Search Texas Instruments Wiki" title="Search Texas Instruments Wiki [f]" accesskey="f" id="searchInput"/><input type="hidden" value="Special:Search" name="title"/><input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton mw-fallbackSearchButton"/><input type="submit" name="go" value="Go" title="Go to a page with this exact name if it exists" id="searchButton" class="searchButton"/>							</div>
						</form>
					</div>
									</div>
			</div>
			<div id="mw-panel">
				<div id="p-logo" role="banner"><a class="mw-wiki-logo" href="Main_Page.html"  title="Visit the main page"></a></div>
						<div class="portal" role="navigation" id="p-navigation" aria-labelledby="p-navigation-label">
			<h3 id="p-navigation-label">Navigation</h3>
			<div class="body">
								<ul>
					<li id="n-mainpage"><a href="Main_Page.html" title="Visit the main page [z]" accesskey="z">Main Page</a></li><li id="n-All-pages"><a href="Special_AllPages.html">All pages</a></li><li id="n-All-categories"><a href="Special_Categories.html">All categories</a></li><li id="n-recentchanges"><a href="Special_RecentChanges.html" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li><li id="n-randompage"><a href="Package_Reflow_Profiles.html" title="Load a random page [x]" accesskey="x">Random page</a></li><li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" title="The place to find out">Help</a></li>				</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id="p-tb" aria-labelledby="p-tb-label">
			<h3 id="p-tb-label">Toolbox</h3>
			<div class="body">
								<ul>
					<li id="t-whatlinkshere"><a href="Special_WhatLinksHere/UserGuideDisplayDrivers_PSP_04.02.00.html" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li><li id="t-recentchangeslinked"><a href="Special_RecentChangesLinked/UserGuideDisplayDrivers_PSP_04.02.00.html" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li><li id="t-specialpages"><a href="Special_SpecialPages.html" title="A list of all special pages [q]" accesskey="q">Special pages</a></li><li id="t-print"><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li><li id="t-permalink"><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;oldid=61675" title="Permanent link to this revision of the page">Permanent link</a></li><li id="t-info"><a href="https://processors.wiki.ti.com/index.php?title=UserGuideDisplayDrivers_PSP_04.02.00.07&amp;action=info" title="More information about this page">Page information</a></li>				</ul>
							</div>
		</div>
				</div>
		</div>
				<div id="footer" role="contentinfo">
						<ul id="footer-info">
								<li id="footer-info-lastmod"> This page was last edited on 13 June 2011, at 10:23.</li>
								<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-ShareAlike</a> unless otherwise noted.</li>
							</ul>
						<ul id="footer-places">
								<li id="footer-places-privacy"><a href="Project_Privacy_policy.html" title="Project:Privacy policy">Privacy policy</a></li>
								<li id="footer-places-about"><a href="Project_About.html" title="Project:About">About Texas Instruments Wiki</a></li>
								<li id="footer-places-disclaimer"><a href="Project_General_disclaimer.html" title="Project:General disclaimer">Disclaimers</a></li>
								<li id="footer-places-termsofservice"><a href="Project_Terms_of_Service.html" title="Project:Terms of Service">Terms of Use</a></li>
							</ul>
										<ul id="footer-icons" class="noprint">
										<li id="footer-copyrightico">
						<a href="http://creativecommons.org/licenses/by-sa/3.0/"><img src="https://processors.wiki.ti.com/resources/assets/licenses/cc-by-sa.png" alt="Creative Commons Attribution-ShareAlike" width="88" height="31"/></a>					</li>
										<li id="footer-poweredbyico">
						<a href="http://www.mediawiki.org/"><img src="https://processors.wiki.ti.com/resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31"/></a>					</li>
									</ul>
						<div style="clear: both;"></div>
		</div>
		<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgPageParseReport":{"limitreport":{"cputime":"0.165","walltime":"0.178","ppvisitednodes":{"value":1054,"limit":1000000},"ppgeneratednodes":{"value":2104,"limit":1000000},"postexpandincludesize":{"value":0,"limit":2097152},"templateargumentsize":{"value":0,"limit":2097152},"expansiondepth":{"value":2,"limit":40},"expensivefunctioncount":{"value":0,"limit":100},"unstrip-depth":{"value":0,"limit":20},"unstrip-size":{"value":22348,"limit":5000000},"timingprofile":["100.00%    0.000      1 -total"]},"cachereport":{"timestamp":"20201201021311","ttl":86400,"transientcontent":false}}});});</script><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":228});});</script>
	</body>

<!-- Mirrored from processors.wiki.ti.com/index.php/UserGuideDisplayDrivers_PSP_04.02.00.07 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 01 Dec 2020 06:37:42 GMT -->
</html>
