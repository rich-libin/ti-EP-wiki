<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">

<!-- Mirrored from processors.wiki.ti.com/index.php/Setting_up_AM35x_SDRC_registers by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 01 Dec 2020 07:18:57 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8"/>
<title>Setting up AM35x SDRC registers - Texas Instruments Wiki</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Setting_up_AM35x_SDRC_registers","wgTitle":"Setting up AM35x SDRC registers","wgCurRevisionId":114538,"wgRevisionId":114538,"wgArticleId":4950,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["AM35x"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Setting_up_AM35x_SDRC_registers","wgRelevantArticleId":4950,"wgRequestId":"712a5eab29202a71975381a3","wgIsProbablyEditable":false,"wgRelevantPageIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[]});mw.loader.state({"site.styles":"ready","noscript":"ready","user.styles":"ready","user":"ready","user.options":"ready","user.tokens":"loading","mediawiki.legacy.shared":"ready","mediawiki.legacy.commonPrint":"ready","mediawiki.sectionAnchor":"ready","mediawiki.skinning.interface":"ready","skins.vector.styles":"ready"});mw.loader.implement("user.tokens@19o3a1s",function($,jQuery,require,module){/*@nomin*/mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});
});mw.loader.load(["site","mediawiki.page.startup","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.toc","mediawiki.searchSuggest","skins.vector.js"]);});</script>
<link rel="stylesheet" href="https://processors.wiki.ti.com/load.php?debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.interface%7Cskins.vector.styles&amp;only=styles&amp;skin=vector"/>
<script async="" src="https://processors.wiki.ti.com/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=vector"></script>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="https://processors.wiki.ti.com/load.php?debug=false&amp;lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=vector"/>
<meta name="generator" content="MediaWiki 1.31.6"/>
<link rel="shortcut icon" href="https://processors.wiki.ti.com/favicon.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="https://processors.wiki.ti.com/opensearch_desc.php" title="Texas Instruments Wiki (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="https://processors.wiki.ti.com/api.php?action=rsd"/>
<link rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/"/>
<link rel="alternate" type="application/atom+xml" title="Texas Instruments Wiki Atom feed" href="https://processors.wiki.ti.com/index.php?title=Special:RecentChanges&amp;feed=atom"/>
<!--[if lt IE 9]><script src="/load.php?debug=false&amp;lang=en&amp;modules=html5shiv&amp;only=scripts&amp;skin=Vector&amp;sync=1"></script><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Setting_up_AM35x_SDRC_registers rootpage-Setting_up_AM35x_SDRC_registers skin-vector action-view">		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<div id="content" class="mw-body" role="main">
			<a id="top"></a>
			<div id="siteNotice" class="mw-body-content"><div id="localNotice" lang="en" dir="ltr"><div class="mw-parser-output"><p><br />
<span style="color:#ff0000"><b>NOTICE: The Processors Wiki will End-of-Life on January 15, 2021. It is recommended to download any files or other content you may need that are hosted on processors.wiki.ti.com. The site is now set to read only.</b></span>
</p></div></div></div><div class="mw-indicators mw-body-content">
</div>
<h1 id="firstHeading" class="firstHeading" lang="en">Setting up AM35x SDRC registers</h1>			<div id="bodyContent" class="mw-body-content">
				<div id="siteSub" class="noprint">From Texas Instruments Wiki</div>				<div id="contentSub"></div>
								<div id="jump-to-nav" class="mw-jump">
					Jump to:					<a href="#mw-head">navigation</a>, 					<a href="#p-search">search</a>
				</div>
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output"><p><br />
</p>
<div id="toc" class="toc"><div class="toctitle" lang="en" dir="ltr"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Introduction"><span class="tocnumber">1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#PAD_CONFIG_registers"><span class="tocnumber">2</span> <span class="toctext">PAD_CONFIG registers</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#SDRAM_General_Configuration_Registers"><span class="tocnumber">3</span> <span class="toctext">SDRAM General Configuration Registers</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#DDR_PHY_Control_Registers"><span class="tocnumber">4</span> <span class="toctext">DDR PHY Control Registers</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#AC_timing_registers"><span class="tocnumber">5</span> <span class="toctext">AC timing registers</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Setting_Refresh_rate"><span class="tocnumber">6</span> <span class="toctext">Setting Refresh rate</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Power_Management_Control_Register"><span class="tocnumber">7</span> <span class="toctext">Power Management Control Register</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Shadow_Registers"><span class="tocnumber">8</span> <span class="toctext">Shadow Registers</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#System_Control_Module_Registers"><span class="tocnumber">9</span> <span class="toctext">System Control Module Registers</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#Initialization_Sequence"><span class="tocnumber">10</span> <span class="toctext">Initialization Sequence</span></a></li>
<li class="toclevel-1 tocsection-11"><a href="#More_Tips"><span class="tocnumber">11</span> <span class="toctext">More Tips</span></a></li>
</ul>
</div>

<h1><span class="mw-headline" id="Introduction">Introduction</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Setting_up_AM35x_SDRC_registers&amp;action=edit&amp;section=1" title="Edit section: Introduction">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>The following information describes how to set the SDRC registers in the AM35x SDRC module depending on the&#160;mDDR or DDR2&#160;memory that you are using. Only 32-bit configurations are addressed in this wiki.
</p>
<h1><span class="mw-headline" id="PAD_CONFIG_registers">PAD_CONFIG registers</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Setting_up_AM35x_SDRC_registers&amp;action=edit&amp;section=2" title="Edit section: PAD CONFIG registers">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>Almost all SDRC signals are enabled by default for DDR functionality in the pin muxing registers of AM35x.  The only exception is the SDRC_CKE0, which is configured to safe mode by default.  You must configure this to mode 0 to enable proper functionality of this signal.
</p><p>CONTROL_PADCONF_SDRC_CKE0 (0x48002260) - set bits [18:16] to 0.
</p>
<h1><span class="mw-headline" id="SDRAM_General_Configuration_Registers">SDRAM General Configuration Registers</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Setting_up_AM35x_SDRC_registers&amp;action=edit&amp;section=3" title="Edit section: SDRAM General Configuration Registers">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<ul><li><b>SDRAM_CONFIG (@0x6D000008)- </b>The values in this register will depend a lot on your memory configuration. Here are some tips to configure each value:<br />
<ul><li><i>REG_SDRAM_TYPE - </i>LPDDR1 (mDDR) = 1, DDR2 = 2</li>
<li><i>REG_IBANK_POS </i>- This register sets up the internal bank position. Please see "SDRAM Address Mapping" section of the TRM for more information</li>
<li><i>REG_DDR_TERM - </i>DDR2 termination resistor value. This is typically set to 0 for no termination.  Refer to <a href="https://processors.wiki.ti.com/images/e/e9/ODT-support_v4.pdf" class="internal" title="ODT-support v4.pdf"> ODT support presentation</a> for more information on using ODT.</li>
<li><i>REG_DDR2_DDQS</i> - DDR2 differential DQS enable. Set to 0 when using LPDDR (mDDR) for single ended DQS. Set to 1 when using DDR2 for differential DQS.</li>
<li><i>REG_DDR_DISABLE_DLL - </i>Set to 0 for normal operation</li>
<li><i>REG_SDRAM_DRIVE -</i>SDRAM drive strength. For LPDDR1, typically you would set this to 1 for weak drive strength. Some boards with LPDDR may require full drive strength depending on board size and trace impedances. For DDR2, set to 0 for full drive strength.</li>
<li><i>REG_NARROW_MODE - </i>SDRAM data bus width. Set to 0 for 32-bit and set to 1 for 16-bit. All other values are reserved.</li>
<li><i>REG_CL - </i>CAS Latency. The value of this field defines the CAS latency to be used when accessing connected SDRAM devices. This value should come directly from the DDR datasheet. Value of 2, 3, 5, and 6 (CAS latency of 2, 3, 1.5, and 2.5) are supported for LPDDR1. Value of 2, 3, 4, 5, and 6 (CAS latency of 2, 3, 4, 5, and 6) are supported for DDR2. All other values are reserved.  Ensure that the value in this register agrees with the value in READ_LATENCY in DDR_PHY_CTRL_1 register.</li>
<li><i>REG_ROWSIZE -</i> This field is only used when reg_ibank_pos field in SDRAM Configuration register is set to 1, 2, or 3.  Should be set to the number of row address bits defined in the DDR datasheet.</li></ul></li></ul>
<table cellspacing="1" cellpadding="1" width="300" border="1" style="margin: 1em auto 1em auto;">

<tbody><tr>
<td># of row bits
</td>
<td>REG_ROWSIZE Value
</td></tr>
<tr>
<td>9
</td>
<td>0
</td></tr>
<tr>
<td>10
</td>
<td>1
</td></tr>
<tr>
<td>11
</td>
<td>2
</td></tr>
<tr>
<td>12
</td>
<td>3
</td></tr>
<tr>
<td>13
</td>
<td>4
</td></tr>
<tr>
<td>14
</td>
<td>5
</td></tr>
<tr>
<td>15
</td>
<td>6
</td></tr>
<tr>
<td>16
</td>
<td>7
</td></tr></tbody></table>
<ul><li><ul><li><i>REG_IBANK - </i>Internal Bank setup. Defines number of banks inside connected SDRAM devices. Set to 0 for 1 bank, set to 1 for 2 banks, set to 2 for 4 banks, and set to 3 for 8 banks. All other values are reserved.</li>
<li><i>REG_EBANK - </i>External chip select setup. Defines whether SDRAM accesses will use 1 or 2 chip select lines. Set to 0 to use sdrc_cs0 only.  Set to 1 to use both sdrc_cs0 and sdrc_cs1.</li>
<li><i>REG_PAGESIZE - </i>Page Size. Defines the internal page size of connected SDRAM devices. Should be set to the number of column address bits defined in the DDR datasheet</li></ul></li></ul>
<table cellspacing="1" cellpadding="1" width="300" border="1" style="margin: 1em auto 1em auto;">

<tbody><tr>
<td># of column address bits
</td>
<td>REG_PAGESIZE Value
</td></tr>
<tr>
<td>8 (256-word page)
</td>
<td>0
</td></tr>
<tr>
<td>9 (512-word page)
</td>
<td>1
</td></tr>
<tr>
<td>10 (1024-word page)
</td>
<td>2
</td></tr>
<tr>
<td>11 (2048-word page)
</td>
<td>3
</td></tr></tbody></table>
<p><br />
</p>
<h1><span class="mw-headline" id="DDR_PHY_Control_Registers">DDR PHY Control Registers</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Setting_up_AM35x_SDRC_registers&amp;action=edit&amp;section=4" title="Edit section: DDR PHY Control Registers">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<ul><li><b>DDR_PHY_CTRL_1 (@0x6D0000E4)</b>
<ul><li><i>TESTIN_LB_CK_SELECT</i> - Set to 0.</li>
<li><i>CONFIG_VTP_DYNAMIC_UPDATE</i> - This bit controls the VTP (Voltage, Temperature, Process) Compensation for the DDR I/Os. The VTP Compensation needs to be calibrated after each DDR PHY reset. Here is the sequence you should follow to properly calibrate the I/Os.<span style="color: brown">
<ul><li>Give PHY RST (which in turn also gives reset to vtp controller).
<ul><li>To give this reset, set bit REG_RESET_PHY to 1 in IODFT_TLGC register (reg. addr. 0x6D00 0060) of EMIF module</li>
<li>Poll till REG_RESET_PHY flag gets cleared. This makes sure that reset to phy got deasserted.</li></ul></li>
<li>Set CONFIG_VTP_DYNAMIC_UPDATE = 1.
<ul><li>Set field CONFIG_VTP_DYNAMIC_UPDATE in DDR_PHY_CTRL_1 register (reg. addr. 0x6D00 00E4) of EMIF module</li>
<li>Set field CONFIG_VTP_DYNAMIC_UPDATE in DDR_PHY_CTRL_1_SHDW register (reg. addr. 0x6D00 00E8) of EMIF module</li></ul></li>
<li>Poll for assertion of VTP_READY flag from the VTP controller.
<ul><li>VTP_READY status can be read from VTP_READY bit in register CONTROL_DEVCONF3 (reg. addr. 0x4800 2584) in system control module</li></ul></li>
<li>Clear CONFIG_VTP_DYNAMIC_UPDATE to 0 in both DDR_PHY_CTRL_1 and DDR_PHY_CTRL_1_SHDW register. (Keeping CONFIG_VTP_DYNAMIC_UPDATE set to 1 will consume more power and should not be necessary for most applications).</li>
<li>Continue to initialize the rest of the EMIF.</li></ul></span></li>
<li><i>CONFIG_DLL_MODE</i> - Set to 0.</li>
<li><i>DR_16B_MODE_PWRSAVE</i> - Set to 0.</li>
<li><i>CONFIG_EXT_STRBEN</i> - use 0 (Internal Strobe) for DDR2; use 1 (External Strobe) for LPDDR1</li>
<li><i>CONFIG_PWRDN_DISABLE</i> - this bit controls the power to the receive IO buffer. Setting the bit to 0 will conserve power by shutting down the buffer when no read accesses are occurring. Alternatively, set it to 1 to keep power to the buffers enabled.</li>
<li><i>READ_LATENCY</i> - This value should be set to the following</li></ul></li></ul>
<p>(CAS latency + 1) &gt;= READ_LATENCY &gt;= CAS latency 
</p><p>It defines the read latency for read data from the DDR. Typically the max value is used (ie, CAS latency + 1), but better performance can be achieved with the mimimum value.  Ensure that the value in this register agrees with the value in REG_CL in SDRAM_CONFIG register. 
</p>
<ul><li><b>DDR_PHY_CTRL_2 (@6D0000EC)</b> - This register should be set to 0x00000000
<ul><li><i>CONFIG_RX_DLL_BYPASS</i> - Set to 0.</li>
<li><i>CONFIG_TX_STRB_DATA_ALIGN</i> - Set to 0.</li></ul></li></ul>
<p>To configure the DDR PHY, setup DDR_PHY_CTRL_1, DDR_PHY_CTRL_1_SHDW, and DDR_PHY_CTRL_2 to the appropriate values, and then reset the DDR PHY setting IODFT_TLGC.REG_RESET_PHY (bit 10 of address 0x6D000060) to 1. Wait for STATUS.REG_PHY_DLL_READY (bit 2 of address 0x6D000004) to be set to 1 to ensure PHY is ready for normal operation.
</p>
<h1><span class="mw-headline" id="AC_timing_registers">AC timing registers</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Setting_up_AM35x_SDRC_registers&amp;action=edit&amp;section=5" title="Edit section: AC timing registers">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<ul><li><b>SDRAM_TIM_1, SDRAM_TIM_2, and SDRAM_TIM_3</b></li></ul>
<p>This spreadsheet will help you determine the optimal values for the AC timing registers:
</p><p><a href="https://processors.wiki.ti.com/images/9/9e/AM35x_DDR_register_calc_tool.zip" class="internal" title="AM35x DDR register calc tool.zip"> AM35x DDR Calculation tool (.zip)</a>
</p><p>The values in yellow need to be changed based on the datasheet values for your memory. Ensure that you enter the correct values for the speed grade of your device. The tCK value should represent the speed at which you will be running the device (not necessarily the minimum value in the datasheet). The register values for the AM35x AC timing registers will be calculated based on these inputs. For more conservative values, you can back off these optimal values (ie, increase each value by 1 or 2).
</p>
<h1><span class="mw-headline" id="Setting_Refresh_rate">Setting Refresh rate</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Setting_up_AM35x_SDRC_registers&amp;action=edit&amp;section=6" title="Edit section: Setting Refresh rate">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<ul><li><b>SDRAM_REF_CTRL</b> - To set the refresh rate, get the Periodic Refresh interval tREFI from the memory datasheet.  Note that this value is typcially in the us range.  Some datasheets may refer to a "Refresh Interval time" in the millisecond range (64ms, for example), however, this value needs to be divided by the number of refresh cycles needed (typically 8000).<br />
<ul><li><i>REG_REFRESH_RATE - </i>the number of clock cycles required to cause a refresh interval of 7.8 us or 15.7 us for the appropriate SDRAM used. This field is not byte writable, i.e., all 16 bits of this field need to be written simultaneously. Here are some examples</li></ul></li>
<li>For 166 MHz memory system with 15.7us refresh rate:  166 * 15.7 = 2606.2 or 0xA2E</li>
<li>For 166 MHz memory system with 7.8us refresh rate:  166 * 7.8us = 1294.8 or 0x50E</li></ul>
<h1><span class="mw-headline" id="Power_Management_Control_Register">Power Management Control Register</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Setting_up_AM35x_SDRC_registers&amp;action=edit&amp;section=7" title="Edit section: Power Management Control Register">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>This register is typically set to 0x80000000, which enables smart-idle mode and disables automatic power management.  If you want to use the automatic power management, you would set REG_LP_MODE to the power state that you want to enter after a timeout value setup in REG_PM_TIM.  
</p><p>For more details on these registers, please refer to the AM35x TRM. 
</p>
<ul><li><b>PWR_MGMT_CTRL (@0x6D000038)</b>
<ul><li><i>REG_IDLEMODE -&#160;</i>Power-Idle IP Generic mode.<i>&#160;</i>0 = Force Idle Mode; 1 = No-Idle mode; 2 = Smart Idle.</li>
<li><i>REG_DPD_EN - </i>Deep Power Down enable (setting this to 1 overides REG_LP_MODE)</li>
<li><i>REG_LP_MODE - </i>Auto Power management enable. 0 = disable&#160;auto pwr mgmt; 1 = clock stop; 2 = Self Refresh; 3 = Power-Down&#160;</li>
<li><i>REG_PM_TIM - </i>Power Management Timer.&#160; Number of clock cycles to wait after EMIF is idle before going into power saving mode.</li></ul></li></ul>
<h1><span class="mw-headline" id="Shadow_Registers">Shadow Registers</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Setting_up_AM35x_SDRC_registers&amp;action=edit&amp;section=8" title="Edit section: Shadow Registers">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>The AM35x devices support smart idle mode for power conservation.  Upon returning from smart idle mode, the shadow registers are loaded into the SDRC registers. 
</p>
<ul><li><i>SDRAM_REF_CTRL_SHDW - </i>Refresh Control Shadow Register.  Ensure that this register is written with the same value as SDRAM_REF_CTRL register.</li>
<li><i>SDRAM_TIM_1_SHDW - </i>SDRAM Timing 1 Shadow Register.  Ensure that this register is written with the same value as SDRAM_TIM_1 register.</li>
<li><i>SDRAM_TIM_2_SHDW </i>- SDRAM Timing 2 Shadow Register. Ensure that this register is written with the same value as SDRAM_TIM_2 register.</li>
<li><i>SDRAM_TIM_3_SHDW</i> - SDRAM Timing 3 Shadow Register.  Ensure that this register is written with the same value as SDRAM_TIM_3 register.</li>
<li><i>PWR_MGMT_CTRL_SHDW - </i>Power Management Control Shadow Register.  Ensure that this register is written with the same value as PWR_MGMT_CTRL register.</li>
<li><i>DDR_PHY_CTRL_1_SHDW</i> - DDR PHY Control 1 Shadow Register.  Ensure that this register is written with the same value as DDR_PHY_CTRL_1.</li></ul>
<h1><span class="mw-headline" id="System_Control_Module_Registers">System Control Module Registers</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Setting_up_AM35x_SDRC_registers&amp;action=edit&amp;section=9" title="Edit section: System Control Module Registers">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>There are a few pertinent registers in the System Control Module (SCM) that affect DDR operation
</p><p><br />
</p>
<ul><li><b>CONTROL_DEVCONF3 (@0x48002584)</b> - Typically, this register stays at its default value except for DDR_CMOSEN.  Typical values are 0x00008600 for DDR2, and 0x00009600 for mDDR.  Below are the details for each bit.</li></ul>
<ul><li><ul><li><i>DDRPHY_CLK_EN</i> - Set this bit to 1 for normal operation.  Set to 0 to turn off clocks to PHY to save power.</li>
<li><i>EMIF4A_FCLKEN</i> - Set this to 0 for normal operation</li>
<li><i>VTP_PWRSAVE</i> - this is typically set to 0.</li>
<li><i>DDR_CMOSEN</i> - Set to 0 for DDR2.  Set to 1 for mDDR</li>
<li><i>VTP_DRVSTRENGTH</i> - Should be left at the default 0x3</li>
<li><i>DDR_VREF_EN</i> - Set to 0 to choose external reference for VREF.  Consult the layout guidelines in the datasheet for more information on setting up this reference voltage externally.</li>
<li><i>DDR_VREF_TAP</i> - keep this at the default value of 0.  Only used when an internal reference is selected</li>
<li><i>VTP_READY</i> - this is a read-only bit</li>
<li><i>DDR_CONFIG_TERMOFF</i> - This controls the parallel termination during a non-read cycle for all SDRC data signals.  Set to 0 for normal operation.  Other settings are not typically necessary and will result in increased power consumption.  Refer to <a href="https://processors.wiki.ti.com/images/e/e9/ODT-support_v4.pdf" class="internal" title="ODT-support v4.pdf"> ODT support presentation</a> for more information on using ODT.</li>
<li><i>DDR_CONFIG_TERMON</i> - This controls the parallel termination during a read cycle for all SDRC data signals.  Set to 0 for normal operation.  Other settings are not typically necessary and will result in increased power consumption. Refer to <a href="https://processors.wiki.ti.com/images/e/e9/ODT-support_v4.pdf" class="internal" title="ODT-support v4.pdf"> ODT support presentation</a> for more information on using ODT.</li></ul></li></ul>
<h1><span class="mw-headline" id="Initialization_Sequence">Initialization Sequence</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Setting_up_AM35x_SDRC_registers&amp;action=edit&amp;section=10" title="Edit section: Initialization Sequence">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<ul><li>The best source for proper initialization sequence is the xloader source code, which can be found from TI's<a rel="nofollow" class="external text" href="http://focus.ti.com/docs/toolsw/folders/print/linuxsdk-am35x.html">TI's Linux Software Development Kit</a> in board/am3517evm/am3517evm.c.</li>
<li>In general, here are the steps to take:</li></ul>
<ol><li>Setup DDR PHY control registers</li>
<li>Reset the PHY (using IODFT_TLGC) and wait till complete</li>
<li>Perform a VTP calibrate</li>
<li>Configure EMIF
<ol><li>Setup timing registers (SDRAM_TIM_xxx)</li>
<li>Setup Power control reg (PWR_MGMT_CTRL)</li>
<li>Setup refresh rate (SDRAM_REF_CTRL)</li>
<li>Setup SDRAM configuration register (SDRAM_CONFIG)</li></ol></li></ol>
<p><br /> 
</p><p>When you write to SDRAM_CONFIG, this kicks off the hardware sequence which initializes the DDR interface (the details are described in the TRM).  
</p><p>Step 3 is not in the linux code because this was a recent enhancement to our DDR initialization sequence (and is another reason why it isn't in the TRM yet).  The VTP calibration sequence performs a calibration on the DDR I/Os.  A lot of designs may work without this calibration (as in the case of the EVM), but you will likely see more robust performance with the calibration.
</p>
<h1><span class="mw-headline" id="More_Tips">More Tips</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Setting_up_AM35x_SDRC_registers&amp;action=edit&amp;section=11" title="Edit section: More Tips">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<ul><li>AM35x can only handle a max of 1GByte of memory over 2 chip selects. Furthermore, it is recommended that you only present 2 loads to the AM35x SDRC signals. Some memories increase capacity by stacking dies in their packages. For example, a package with 2 dies presents 2 loads to the SDRC signals. Ensure that your configuration does not present more than 2 loads to the AM35x SDRC signals</li></ul>
<p>8Gb = 1GByte<br />4Gb = 512MByte<br />2Gb = 256MByte<br />1Gb = 128MByte<br />
</p>
<!-- 
NewPP limit report
Cached time: 20201130185822
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.050 seconds
Real time usage: 0.052 seconds
Preprocessor visited node count: 44/1000000
Preprocessor generated node count: 50/1000000
Post‐expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 0/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 -total
-->
</div>
<!-- Saved in parser cache with key procwiki:pcache:idhash:4950-0!canonical and timestamp 20201130185822 and revision id 114538
 -->
<div class='hf-nsfooter' id='hf-nsfooter-'><table style="text-align:center; background:white; width:100%; text-align:left; height: 65px border-top: 1px solid; border-bottom: 1px solid; border-left: 1px solid; border-right: 1px solid; border-width: 1px; border-style: solid;">
<tr>
<td width="305px"><a href="File_E2e.html" class="image"><img alt="E2e.jpg" src="https://processors.wiki.ti.com/images/8/82/E2e.jpg" width="305" height="63" /></a>
</td>
<td>{{
<ol><li>switchcategory:MultiCore=</li></ol>
<ul><li>For technical support on MultiCore devices, please post your questions in the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/c6000_multi-core_dsps/default.aspx">C6000 MultiCore Forum</a></li>
<li>For questions related to the BIOS MultiCore SDK (MCSDK), please use the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/embedded/f/355.aspx">BIOS Forum</a></li></ul>
<p>Please post only comments related to the article <b>Setting up AM35x SDRC registers</b> here.<i></i>
</p>
</td>
<td>Keystone=
<ul><li>For technical support on MultiCore devices, please post your questions in the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/c6000_multi-core_dsps/default.aspx">C6000 MultiCore Forum</a></li>
<li>For questions related to the BIOS MultiCore SDK (MCSDK), please use the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/embedded/f/355.aspx">BIOS Forum</a></li></ul>
<p>Please post only comments related to the article <b>Setting up AM35x SDRC registers</b> here.<i></i>
</p>
</td>
<td>C2000=<i>For technical support on the C2000 please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/microcontrollers/tms320c2000_32-bit_real-time_mcus/f/171.aspx">The C2000 Forum</a>. Please post only comments about the article <b>Setting up AM35x SDRC registers</b> here.</i>
</td>
<td>DaVinci=<i>For technical support on DaVincoplease post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/davinci_digital_media_processors/default.aspx">The DaVinci Forum</a>. Please post only comments about the article <b>Setting up AM35x SDRC registers</b> here.</i>
</td>
<td>MSP430=<i>For technical support on MSP430 please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/microcontrollers/msp43016-bit_ultra-low_power_mcus/default.aspx">The MSP430 Forum</a>. Please post only comments about the article <b>Setting up AM35x SDRC registers</b> here.</i>
</td>
<td>OMAP35x=<i>For technical support on OMAP please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/omap_applications_processors/default.aspx">The OMAP Forum</a>. Please post only comments about the article <b>Setting up AM35x SDRC registers</b> here.</i>
</td>
<td>OMAPL1=<i>For technical support on OMAP please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/omap_applications_processors/default.aspx">The OMAP Forum</a>. Please post only comments about the article <b>Setting up AM35x SDRC registers</b> here.</i>
</td>
<td>MAVRK=<i>For technical support on MAVRK please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/development_tools/mavrk/default.aspx">The MAVRK Toolbox Forum</a>. Please post only comments about the article <b>Setting up AM35x SDRC registers</b> here.</i>
</td>
<td><i>For technical support please post your questions at <a rel="nofollow" class="external text" href="http://e2e.ti.com/">http://e2e.ti.com</a>. Please post only comments about the article <b>Setting up AM35x SDRC registers</b> here.</i>
<p>}}
</p>
</td></tr></table>
<table style="border-style:solid; border-width:1px; text-align:center; width:100%;">

<tr style="font-size:150%;">
<td rowspan="2"><a href="File_Hyperlink_blue.html" class="image"><img alt="Hyperlink blue.png" src="https://processors.wiki.ti.com/images/9/9f/Hyperlink_blue.png" width="96" height="96" /></a>
</td>
<td><b>Links</b>
</td></tr>
<tr>
<td>
<table style="text-align: left;">
<tr>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/amplifier_and_linear.page">Amplifiers &amp; Linear</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/audio/audio_overview.page">Audio</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/rfif.page">Broadband RF/IF &amp; Digital Radio</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/clocksandtimers/clocks_and_timers.page">Clocks &amp; Timers</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/dataconverters/data_converter.page">Data Converters</a>
</p>
</td>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/mems/mems.page">DLP &amp; MEMS</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/high_reliability.page">High-Reliability</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/interface/interface.page">Interface</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/logic/home_overview.page">Logic</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/powermanagement/power_portal.page">Power Management</a>
</p>
</td>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/dsp/embedded_processor.page">Processors</a>
</p>
<ul><li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/dsp/arm.page">ARM Processors</a></li>
<li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/dsp/home.page">Digital Signal Processors (DSP)</a></li>
<li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/microcontroller/home.page">Microcontrollers (MCU)</a></li>
<li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/omap-applications-processors/the-omap-experience.page">OMAP Applications Processors</a></li></ul>
</td>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/switches_and_multiplexers.page">Switches &amp; Multiplexers</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/temperature_sensor.page">Temperature Sensors &amp; Control ICs</a><br/>
<a rel="nofollow" class="external text" href="http://focus.ti.com/wireless/docs/wirelessoverview.tsp?familyId=2003&amp;sectionId=646&amp;tabId=2735">Wireless Connectivity</a>
</p>
</td></tr></table>
</td></tr></table>
<div id="tiPrivacy"></div>
</div></div>					<div class="printfooter">
						Retrieved from "<a dir="ltr" href="https://processors.wiki.ti.com/index.php?title=Setting_up_AM35x_SDRC_registers&amp;oldid=114538">https://processors.wiki.ti.com/index.php?title=Setting_up_AM35x_SDRC_registers&amp;oldid=114538</a>"					</div>
				<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="Special_Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="Category_AM35x.html" title="Category:AM35x">AM35x</a></li></ul></div></div>				<div class="visualClear"></div>
							</div>
		</div>
		<div id="mw-navigation">
			<h2>Navigation menu</h2>
			<div id="mw-head">
									<div id="p-personal" role="navigation" class="" aria-labelledby="p-personal-label">
						<h3 id="p-personal-label">Personal tools</h3>
						<ul>
							<li id="pt-login"><a href="https://processors.wiki.ti.com/index.php?title=Special:UserLogin&amp;returnto=Setting+up+AM35x+SDRC+registers" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li><li id="pt-createaccount"><a href="Special_RequestAccount.html" title="You are encouraged to create an account and log in; however, it is not mandatory">Request account</a></li>						</ul>
					</div>
									<div id="left-navigation">
										<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
						<h3 id="p-namespaces-label">Namespaces</h3>
						<ul>
							<li id="ca-nstab-main" class="selected"><span><a href="Setting_up_AM35x_SDRC_registers.html" title="View the content page [c]" accesskey="c">Page</a></span></li><li id="ca-talk"><span><a href="Talk_Setting_up_AM35x_SDRC_registers.html" rel="discussion" title="Discussion about the content page [t]" accesskey="t">Discussion</a></span></li>						</ul>
					</div>
										<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
												<input type="checkbox" class="vectorMenuCheckbox" aria-labelledby="p-variants-label" />
						<h3 id="p-variants-label">
							<span>Variants</span>
						</h3>
						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
									</div>
				<div id="right-navigation">
										<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
						<h3 id="p-views-label">Views</h3>
						<ul>
							<li id="ca-view" class="collapsible selected"><span><a href="Setting_up_AM35x_SDRC_registers.html">Read</a></span></li><li id="ca-viewsource" class="collapsible"><span><a href="https://processors.wiki.ti.com/index.php?title=Setting_up_AM35x_SDRC_registers&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></span></li><li id="ca-history" class="collapsible"><span><a href="https://processors.wiki.ti.com/index.php?title=Setting_up_AM35x_SDRC_registers&amp;action=history" title="Past revisions of this page [h]" accesskey="h">View history</a></span></li>						</ul>
					</div>
										<div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label">
						<input type="checkbox" class="vectorMenuCheckbox" aria-labelledby="p-cactions-label" />
						<h3 id="p-cactions-label"><span>More</span></h3>
						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
										<div id="p-search" role="search">
						<h3>
							<label for="searchInput">Search</label>
						</h3>
						<form action="https://processors.wiki.ti.com/index.php" id="searchform">
							<div id="simpleSearch">
								<input type="search" name="search" placeholder="Search Texas Instruments Wiki" title="Search Texas Instruments Wiki [f]" accesskey="f" id="searchInput"/><input type="hidden" value="Special:Search" name="title"/><input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton mw-fallbackSearchButton"/><input type="submit" name="go" value="Go" title="Go to a page with this exact name if it exists" id="searchButton" class="searchButton"/>							</div>
						</form>
					</div>
									</div>
			</div>
			<div id="mw-panel">
				<div id="p-logo" role="banner"><a class="mw-wiki-logo" href="Main_Page.html"  title="Visit the main page"></a></div>
						<div class="portal" role="navigation" id="p-navigation" aria-labelledby="p-navigation-label">
			<h3 id="p-navigation-label">Navigation</h3>
			<div class="body">
								<ul>
					<li id="n-mainpage"><a href="Main_Page.html" title="Visit the main page [z]" accesskey="z">Main Page</a></li><li id="n-All-pages"><a href="Special_AllPages.html">All pages</a></li><li id="n-All-categories"><a href="Special_Categories.html">All categories</a></li><li id="n-recentchanges"><a href="Special_RecentChanges.html" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li><li id="n-randompage"><a href="Package_Reflow_Profiles.html" title="Load a random page [x]" accesskey="x">Random page</a></li><li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" title="The place to find out">Help</a></li>				</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id="p-tb" aria-labelledby="p-tb-label">
			<h3 id="p-tb-label">Toolbox</h3>
			<div class="body">
								<ul>
					<li id="t-whatlinkshere"><a href="Special_WhatLinksHere/Setting_up_AM35x_SDRC_registers.html" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li><li id="t-recentchangeslinked"><a href="Special_RecentChangesLinked/Setting_up_AM35x_SDRC_registers.html" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li><li id="t-specialpages"><a href="Special_SpecialPages.html" title="A list of all special pages [q]" accesskey="q">Special pages</a></li><li id="t-print"><a href="https://processors.wiki.ti.com/index.php?title=Setting_up_AM35x_SDRC_registers&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li><li id="t-permalink"><a href="https://processors.wiki.ti.com/index.php?title=Setting_up_AM35x_SDRC_registers&amp;oldid=114538" title="Permanent link to this revision of the page">Permanent link</a></li><li id="t-info"><a href="https://processors.wiki.ti.com/index.php?title=Setting_up_AM35x_SDRC_registers&amp;action=info" title="More information about this page">Page information</a></li>				</ul>
							</div>
		</div>
				</div>
		</div>
				<div id="footer" role="contentinfo">
						<ul id="footer-info">
								<li id="footer-info-lastmod"> This page was last edited on 24 July 2012, at 22:15.</li>
								<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-ShareAlike</a> unless otherwise noted.</li>
							</ul>
						<ul id="footer-places">
								<li id="footer-places-privacy"><a href="Project_Privacy_policy.html" title="Project:Privacy policy">Privacy policy</a></li>
								<li id="footer-places-about"><a href="Project_About.html" title="Project:About">About Texas Instruments Wiki</a></li>
								<li id="footer-places-disclaimer"><a href="Project_General_disclaimer.html" title="Project:General disclaimer">Disclaimers</a></li>
								<li id="footer-places-termsofservice"><a href="Project_Terms_of_Service.html" title="Project:Terms of Service">Terms of Use</a></li>
							</ul>
										<ul id="footer-icons" class="noprint">
										<li id="footer-copyrightico">
						<a href="http://creativecommons.org/licenses/by-sa/3.0/"><img src="https://processors.wiki.ti.com/resources/assets/licenses/cc-by-sa.png" alt="Creative Commons Attribution-ShareAlike" width="88" height="31"/></a>					</li>
										<li id="footer-poweredbyico">
						<a href="http://www.mediawiki.org/"><img src="https://processors.wiki.ti.com/resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31"/></a>					</li>
									</ul>
						<div style="clear: both;"></div>
		</div>
		<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgPageParseReport":{"limitreport":{"cputime":"0.050","walltime":"0.052","ppvisitednodes":{"value":44,"limit":1000000},"ppgeneratednodes":{"value":50,"limit":1000000},"postexpandincludesize":{"value":0,"limit":2097152},"templateargumentsize":{"value":0,"limit":2097152},"expansiondepth":{"value":2,"limit":40},"expensivefunctioncount":{"value":0,"limit":100},"unstrip-depth":{"value":0,"limit":20},"unstrip-size":{"value":0,"limit":5000000},"timingprofile":["100.00%    0.000      1 -total"]},"cachereport":{"timestamp":"20201130185822","ttl":86400,"transientcontent":false}}});});</script><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":228});});</script>
	</body>

<!-- Mirrored from processors.wiki.ti.com/index.php/Setting_up_AM35x_SDRC_registers by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 01 Dec 2020 07:19:00 GMT -->
</html>
