<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">

<!-- Mirrored from processors.wiki.ti.com/index.php/PRU_Training:_Hands-on_Labs by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 01 Dec 2020 08:47:52 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8"/>
<title>PRU Training: Hands-on Labs - Texas Instruments Wiki</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"PRU_Training:_Hands-on_Labs","wgTitle":"PRU Training: Hands-on Labs","wgCurRevisionId":236565,"wgRevisionId":236565,"wgArticleId":36166,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Pages with broken file links"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"PRU_Training:_Hands-on_Labs","wgRelevantArticleId":36166,"wgRequestId":"382fe2ccd2ccfcc19619d010","wgIsProbablyEditable":false,"wgRelevantPageIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[]});mw.loader.state({"site.styles":"ready","noscript":"ready","user.styles":"ready","user":"ready","user.options":"ready","user.tokens":"loading","mediawiki.legacy.shared":"ready","mediawiki.legacy.commonPrint":"ready","mediawiki.sectionAnchor":"ready","mediawiki.skinning.interface":"ready","skins.vector.styles":"ready"});mw.loader.implement("user.tokens@19o3a1s",function($,jQuery,require,module){/*@nomin*/mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});
});mw.loader.load(["site","mediawiki.page.startup","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.toc","mediawiki.searchSuggest","skins.vector.js"]);});</script>
<link rel="stylesheet" href="https://processors.wiki.ti.com/load.php?debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.interface%7Cskins.vector.styles&amp;only=styles&amp;skin=vector"/>
<script async="" src="https://processors.wiki.ti.com/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=vector"></script>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="https://processors.wiki.ti.com/load.php?debug=false&amp;lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=vector"/>
<meta name="generator" content="MediaWiki 1.31.6"/>
<link rel="shortcut icon" href="https://processors.wiki.ti.com/favicon.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="https://processors.wiki.ti.com/opensearch_desc.php" title="Texas Instruments Wiki (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="https://processors.wiki.ti.com/api.php?action=rsd"/>
<link rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/"/>
<link rel="alternate" type="application/atom+xml" title="Texas Instruments Wiki Atom feed" href="https://processors.wiki.ti.com/index.php?title=Special:RecentChanges&amp;feed=atom"/>
<!--[if lt IE 9]><script src="/load.php?debug=false&amp;lang=en&amp;modules=html5shiv&amp;only=scripts&amp;skin=Vector&amp;sync=1"></script><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-PRU_Training_Hands-on_Labs rootpage-PRU_Training_Hands-on_Labs skin-vector action-view">		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<div id="content" class="mw-body" role="main">
			<a id="top"></a>
			<div id="siteNotice" class="mw-body-content"><div id="localNotice" lang="en" dir="ltr"><div class="mw-parser-output"><p><br />
<span style="color:#ff0000"><b>NOTICE: The Processors Wiki will End-of-Life on January 15, 2021. It is recommended to download any files or other content you may need that are hosted on processors.wiki.ti.com. The site is now set to read only.</b></span>
</p></div></div></div><div class="mw-indicators mw-body-content">
</div>
<h1 id="firstHeading" class="firstHeading" lang="en">PRU Training: Hands-on Labs</h1>			<div id="bodyContent" class="mw-body-content">
				<div id="siteSub" class="noprint">From Texas Instruments Wiki</div>				<div id="contentSub"></div>
								<div id="jump-to-nav" class="mw-jump">
					Jump to:					<a href="#mw-head">navigation</a>, 					<a href="#p-search">search</a>
				</div>
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output"><p><a href="File_TIBanner.html" class="image"><img alt="TIBanner.png" src="https://processors.wiki.ti.com/images/c/cd/TIBanner.png" width="667" height="87" /></a> </p><div id="toc" class="toc"><div class="toctitle" lang="en" dir="ltr"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Lab_Configuration"><span class="tocnumber">1</span> <span class="toctext">Lab Configuration</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Hardware"><span class="tocnumber">1.1</span> <span class="toctext">Hardware</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Software"><span class="tocnumber">1.2</span> <span class="toctext">Software</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Supported_Platforms"><span class="tocnumber">1.3</span> <span class="toctext">Supported Platforms</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5"><a href="#LAB_1:_Toggle_LED_with_PRU_GPO"><span class="tocnumber">2</span> <span class="toctext">LAB 1: Toggle LED with PRU GPO</span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#Objective"><span class="tocnumber">2.1</span> <span class="toctext">Objective</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Key_Points"><span class="tocnumber">2.2</span> <span class="toctext">Key Points</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Lab_Steps"><span class="tocnumber">2.3</span> <span class="toctext">Lab Steps</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-9"><a href="#LAB_2:_Read_Push_Button_Switch_on_PRU0_GPI_.26_Toggle_LED_with_PRU1_GPO"><span class="tocnumber">3</span> <span class="toctext">LAB 2:  Read Push Button Switch on PRU0 GPI &amp; Toggle LED with PRU1 GPO</span></a>
<ul>
<li class="toclevel-2 tocsection-10"><a href="#Objective_2"><span class="tocnumber">3.1</span> <span class="toctext">Objective</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Lab_Steps_2"><span class="tocnumber">3.2</span> <span class="toctext">Lab Steps</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-12"><a href="#LAB_3:_Temperature_Monitor_Application"><span class="tocnumber">4</span> <span class="toctext">LAB 3:  Temperature Monitor Application</span></a>
<ul>
<li class="toclevel-2 tocsection-13"><a href="#Objective_3"><span class="tocnumber">4.1</span> <span class="toctext">Objective</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="#Lab_Steps_3"><span class="tocnumber">4.2</span> <span class="toctext">Lab Steps</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-15"><a href="#LAB_4:_Introduction_to_Linux_driver"><span class="tocnumber">5</span> <span class="toctext">LAB 4: Introduction to Linux driver</span></a>
<ul>
<li class="toclevel-2 tocsection-16"><a href="#Objective_4"><span class="tocnumber">5.1</span> <span class="toctext">Objective</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="#Lab_Steps_4"><span class="tocnumber">5.2</span> <span class="toctext">Lab Steps</span></a>
<ul>
<li class="toclevel-3 tocsection-18"><a href="#Build_the_PRU_Firmware"><span class="tocnumber">5.2.1</span> <span class="toctext">Build the PRU Firmware</span></a></li>
<li class="toclevel-3 tocsection-19"><a href="#Configure_the_Kernel"><span class="tocnumber">5.2.2</span> <span class="toctext">Configure the Kernel</span></a></li>
<li class="toclevel-3 tocsection-20"><a href="#Build_the_Linux_Kernel_and_remoteproc_Driver"><span class="tocnumber">5.2.3</span> <span class="toctext">Build the Linux Kernel and remoteproc Driver</span></a></li>
<li class="toclevel-3 tocsection-21"><a href="#Modify_Device_Tree_Files_to_Account_for_PRU_Cape"><span class="tocnumber">5.2.4</span> <span class="toctext">Modify Device Tree Files to Account for PRU Cape</span></a></li>
<li class="toclevel-3 tocsection-22"><a href="#Copy_files_to_the_target_filesystem"><span class="tocnumber">5.2.5</span> <span class="toctext">Copy files to the target filesystem</span></a></li>
<li class="toclevel-3 tocsection-23"><a href="#Boot_the_new_device_tree_and_FS_on_the_Target"><span class="tocnumber">5.2.6</span> <span class="toctext">Boot the new device tree and FS on the Target</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-24"><a href="#LAB_5:_RPMsg_Communication_between_ARM_and_PRU"><span class="tocnumber">6</span> <span class="toctext">LAB 5: RPMsg Communication between ARM and PRU</span></a>
<ul>
<li class="toclevel-2 tocsection-25"><a href="#Objective_5"><span class="tocnumber">6.1</span> <span class="toctext">Objective</span></a></li>
<li class="toclevel-2 tocsection-26"><a href="#Lab_Steps_5"><span class="tocnumber">6.2</span> <span class="toctext">Lab Steps</span></a>
<ul>
<li class="toclevel-3 tocsection-27"><a href="#Build_the_PRU_Firmware_2"><span class="tocnumber">6.2.1</span> <span class="toctext">Build the PRU Firmware</span></a>
<ul>
<li class="toclevel-4 tocsection-28"><a href="#Using_CCSv6"><span class="tocnumber">6.2.1.1</span> <span class="toctext">Using CCSv6</span></a></li>
<li class="toclevel-4 tocsection-29"><a href="#Using_the_Provided_Makefile"><span class="tocnumber">6.2.1.2</span> <span class="toctext">Using the Provided Makefile</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-30"><a href="#Build_the_RPMsg_Client_Sample_Driver"><span class="tocnumber">6.2.2</span> <span class="toctext">Build the RPMsg Client Sample Driver</span></a></li>
<li class="toclevel-3 tocsection-31"><a href="#Copy_files_to_the_target_file_system"><span class="tocnumber">6.2.3</span> <span class="toctext">Copy files to the target file system</span></a></li>
<li class="toclevel-3 tocsection-32"><a href="#Part_1:_Kernel_space_communication"><span class="tocnumber">6.2.4</span> <span class="toctext">Part 1: Kernel space communication</span></a>
<ul>
<li class="toclevel-4 tocsection-33"><a href="#What_just_happened.3F"><span class="tocnumber">6.2.4.1</span> <span class="toctext">What just happened?</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-34"><a href="#Part_2:_User_Space_Communication"><span class="tocnumber">6.2.5</span> <span class="toctext">Part 2: User Space Communication</span></a>
<ul>
<li class="toclevel-4 tocsection-35"><a href="#What_just_happened.3F_2"><span class="tocnumber">6.2.5.1</span> <span class="toctext">What just happened?</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-36"><a href="#Part_3:_User_Space_Application"><span class="tocnumber">6.2.6</span> <span class="toctext">Part 3: User Space Application</span></a>
<ul>
<li class="toclevel-4 tocsection-37"><a href="#What_just_happened.3F_3"><span class="tocnumber">6.2.6.1</span> <span class="toctext">What just happened?</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-38"><a href="#LAB_6:_Blinking_LEDs_with_RPMsg_from_Linux_User_Space"><span class="tocnumber">7</span> <span class="toctext">LAB 6: Blinking LEDs with RPMsg from Linux User Space</span></a>
<ul>
<li class="toclevel-2 tocsection-39"><a href="#Objective_6"><span class="tocnumber">7.1</span> <span class="toctext">Objective</span></a></li>
<li class="toclevel-2 tocsection-40"><a href="#Lab_Steps_6"><span class="tocnumber">7.2</span> <span class="toctext">Lab Steps</span></a>
<ul>
<li class="toclevel-3 tocsection-41"><a href="#Build_the_PRU_Firmware_3"><span class="tocnumber">7.2.1</span> <span class="toctext">Build the PRU Firmware</span></a>
<ul>
<li class="toclevel-4 tocsection-42"><a href="#Using_CCSv6_2"><span class="tocnumber">7.2.1.1</span> <span class="toctext">Using CCSv6</span></a></li>
<li class="toclevel-4 tocsection-43"><a href="#Using_the_Provided_Makefile_2"><span class="tocnumber">7.2.1.2</span> <span class="toctext">Using the Provided Makefile</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-44"><a href="#Copy_files_to_the_target_file_system_2"><span class="tocnumber">7.2.2</span> <span class="toctext">Copy files to the target file system</span></a></li>
<li class="toclevel-3 tocsection-45"><a href="#Part_1:_Linux_Command_Line_LED_Toggling"><span class="tocnumber">7.2.3</span> <span class="toctext">Part 1: Linux Command Line LED Toggling</span></a>
<ul>
<li class="toclevel-4 tocsection-46"><a href="#What_just_happened.3F_4"><span class="tocnumber">7.2.3.1</span> <span class="toctext">What just happened?</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-47"><a href="#Part_2:_Linux_Shell_Script_LED_Toggling"><span class="tocnumber">7.2.4</span> <span class="toctext">Part 2: Linux Shell Script LED Toggling</span></a>
<ul>
<li class="toclevel-4 tocsection-48"><a href="#What_just_happened.3F_5"><span class="tocnumber">7.2.4.1</span> <span class="toctext">What just happened?</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-49"><a href="#Archive"><span class="tocnumber">8</span> <span class="toctext">Archive</span></a></li>
</ul>
</div>
 
<p><big><big><big>Introduction</big></big></big> 
</p>
<hr />
<p>The labs provided on this page will give you a hands on tutorial of the PRU, C-compiler, and Linux driver.  Each of the following sections below will walk you through a particular Lab exercise, including the step-by-step instructions to complete the lab.
</p><p><big><big><b>NOTE:</b> In this guide commands to be executed for each step will be marked in <b>BOLD</b></big></big>.
</p><p><br />
</p>
<h1><span class="mw-headline" id="Lab_Configuration">Lab Configuration</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=1" title="Edit section: Lab Configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>The following are the hardware and software configurations for this lab. The steps in this lab are written against this configuration. The concepts of the lab will apply to other configurations but will need to be adapted accordingly.
</p>
<h2><span class="mw-headline" id="Hardware">Hardware</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=2" title="Edit section: Hardware">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<dl><dd><ul><li>AM335x Beaglebone Black - <a rel="nofollow" class="external text" href="http://beagleboard.org/Products">Order Now</a></li>
<li>BeagleBone PRU Cape - <a rel="nofollow" class="external text" href="http://www.ti.com/tool/PRUCAPE">Order Now</a></li>
<li>5V power supply <i>or</i> USB cable connection</li>
<li>JTAG emulator</li>
<li>FTDI cable</li></ul></dd></dl>
<h2><span class="mw-headline" id="Software">Software</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=3" title="Edit section: Software">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<dl><dd><ul><li><a rel="nofollow" class="external text" href="http://www.ti.com/tool/PROCESSOR-SDK-AM335X">Linux Processor SDK</a> installed. This lab assumes the latest Linux Processor SDK is installed in /home/sitara. If you use a different location please modify the below steps accordingly.</li>
<li>The PRU Software Support Package is now included in the 'example-applications/pru-icss-x.y.z/' folder of the Linux Processor SDK (as of v2.0.2.11). If you are using RTOS or running Windows on your development machine, you can download the support package from the git repository <a rel="nofollow" class="external text" href="https://git.ti.com/pru-software-support-package/pru-software-support-package/trees/master">here</a>. This lab assumes that the software package is installed in /home/sitara/&lt;ti-sdk...&gt;/example-applications/pru-icss-x.y.z.  However, the notation <i><b>&lt;PRU_SW_PATH&gt;</b></i> will be used throughout the labs to reference this assumed installation location.  If you use a different location please modify the steps below.</li>
<li><a rel="nofollow" class="external text" href="http://software-dl.ti.com/ccs/esd/documents/ccs_downloads.html#Code_Composer_Studio_Version_6_Downloads">CCSv6</a></li>
<li><a rel="nofollow" class="external text" href="http://software-dl.ti.com/codegen/non-esd/downloads/download.htm#PRU">PRU Code Generation Tools</a> (also available through the CCS App Center)</li></ul></dd></dl>
<p><br />
</p>
<h2><span class="mw-headline" id="Supported_Platforms">Supported Platforms</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=4" title="Edit section: Supported Platforms">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>This hands-on guide is focused on the AM335x processor on the Beaglebone Black due to the availability of the PRU cape for this platform as well as access to the PRU pins externally. However, the concept of loading/running firmwares described here will translate to the AM437x and AM57xx devices as well. The PRU Software Support Package supports all three of these devices.
</p><p><br />
</p>
<h1><span class="mw-headline" id="LAB_1:_Toggle_LED_with_PRU_GPO">LAB 1: Toggle LED with PRU GPO</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=5" title="Edit section: LAB 1: Toggle LED with PRU GPO">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h2><span class="mw-headline" id="Objective">Objective</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=6" title="Edit section: Objective">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Toggle an LED using the PRU0 R30 GPO in Direct Output Mode (default).
</p>
<h2><span class="mw-headline" id="Key_Points">Key Points</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=7" title="Edit section: Key Points">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<dl><dd><ul><li>Compile PRU code</li>
<li>Load PRU code using CCS</li>
<li>Step through PRU code in CCS</li></ul></dd></dl>
<h2><span class="mw-headline" id="Lab_Steps">Lab Steps</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=8" title="Edit section: Lab Steps">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />Before beginning, ensure that the kernel is not booting and/or already up and running. BeagleBone Black has an eMMC device with a kernel pre-built and flashed ready for boot; however, if the kernel loads prior to our connection to the ARM in CCS then you may experience issues with the debugger. These are primarily caused by the kernel enabling the MMU. Use a minicom console to stop U-Boot to prevent the kernel from booting. <br /><br />To work around this, first try popping out the microSD card if one is inserted. If the blue LEDs on the BBB are toggling when power is applied, then the board is still booting off the eMMC. On the BBB opposite the RJ-45 (Ethernet) connector, there is a push button almost directly under the audio jack that may be difficult to access with the PRU cape on. Press and hold this while power is applied, then release. You should no longer see the flashing lights.</div>
<dl><dd>1. Launch CCSv6 and select the default Workspace.</dd>
<dd>2. Create a new PRU project.
<dl><dd>a. Select <b>File-&gt;New-&gt;CCS Project</b>.</dd>
<dd>b. In the far-right dropdown next to Target, <b>select BeagleBone_Black</b>.</dd>
<dd>c. Select <b>PRU tab</b>, specify a <b>Project Name (toggle_led works well)</b>, and verify that Compiler version is <b>TI v2.1.0</b> or higher.</dd>
<dd>d. Select <b>Finish</b>.
<dl><dd><a href="File_Pru_lab1_newproj.html" class="image" title="pru_lab1_newproj.png"><img alt="pru_lab1_newproj.png" src="https://processors.wiki.ti.com/images/3/37/Pru_lab1_newproj.png" width="423" height="512" /></a></dd></dl></dd></dl></dd>
<dd>3. Main.c should open automatically. Let's start creating our example code!
<dl><dd>a. Include <b>stdint and pru_cfg</b> headers.</dd>
<dd>b. Declare the <b>r30 register</b>.</dd></dl></dd></dl>
<p>&lt;syntaxhighlight lang="c"&gt;
</p>
<ol><li>include &lt;stdint.h&gt;</li>
<li>include &lt;pru_cfg.h&gt;</li></ol>
<p>volatile register uint32_t __R30; 
&lt;/syntaxhighlight&gt;
</p>
<dl><dd>4. Add the include path for the header files so that the compiler can find them.
<dl><dd>a. Select <b>Project-&gt;Properties</b>.</dd>
<dd>b. Select <b>Build-&gt;PRU Compiler-&gt;Include Options</b>.</dd>
<dd>c. In the box marked <i>"Add dir to #include search path"</i> <b>click the file icon with a green +</b>.</dd>
<dd>d. Specify the <b>directory to the include file</b> which for the BeagleBone Black is <i>&lt;PRU_SW_PATH&gt;/include/am335x</i>
<dl><dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />If there is already a <i>${CCS_BASE_ROOT}/pru/include</i> directory, <b>delete it</b> by clicking the file icon with a red X<b>.</b></div></dd>
<dd><a href="File_Pru_lab1_include.html" class="image"><img alt="Pru lab1 include.png" src="https://processors.wiki.ti.com/images/9/97/Pru_lab1_include.png" width="600" height="435" /></a></dd></dl></dd></dl></dd>
<dd>5. Now we will begin coding inside the main function.
<dl><dd>a. Declare a <b>temporary variable called gpo</b> to represent GPO values.</dd>
<dd>b. Set GPI and GPO to <b>Mode 0</b> (Direct Output).</dd>
<dd>c. Create an infinite loop <b>which toggles the GPO pin(s)</b> and <b>delays one half second</b>.</dd></dl></dd></dl>
<p>&lt;syntaxhighlight lang="c"&gt;
void main(){
</p>
<pre>   volatile uint32_t gpo; 
</pre>
<pre>   /* GPI Mode 0, GPO Mode 0 */
   CT_CFG.GPCFG0 = 0;
</pre>
<pre>  /* Clear GPO pins */
   __R30 = 0x0000;
</pre>
<pre>   while(1){
        gpo = __R30;
        gpo ^= 0xF;
        __R30 = gpo;
        __delay_cycles(100000000); // half-second delay
   }
</pre>
<p>}
&lt;/syntaxhighlight&gt;
</p>
<dl><dd>6. Add the linker command file.
<dl><dd>a. Delete <b>AM335x.cmd</b> from the project folder, if it was added automatically.</dd>
<dd>b. Select <b>Project-&gt;Add Files...</b></dd>
<dd>c. Navigate to the <i>&lt;PRU_SW_PATH&gt;/labs/lab_1</i> folder and select the <b>AM335x_PRU.cmd</b> file.
<dl><dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />Select <b>Copy files</b> and <b>OK</b> in the File Operation dialog box that appears when file is selected.</div></dd>
<dd><a href="File_Pru_lab1_fileopbox.html" class="image" title="pru_lab1_fileopbox.png"><img alt="pru_lab1_fileopbox.png" src="https://processors.wiki.ti.com/images/d/dc/Pru_lab1_fileopbox.png" width="400" height="203" /></a></dd></dl></dd></dl></dd>
<dd>7. Build the project.
<dl><dd>a. Select <b>Project-&gt;Build All</b>.</dd>
<dd>b. This should now compile successfully! If not, correct any errors until build completes.</dd></dl></dd>
<dd>8. Select View-&gt;Target Configurations to see a list of available configurations. <b>Note</b> that this list may be empty.
<dl><dd>a. To create a new one <b>right click in the white space</b> in the Target Configurations window and select <b>New Target Configuration</b>.</dd>
<dd>b. Specify a <b>filename</b> (such as <b>BBB_SDXDS200_pru.ccxml</b> if using a XDS200 emulator) and select <b>Finish</b>.</dd>
<dd>c. After the file opens select your <b>emulator</b> in the <b>Connection</b> drop-down.</dd>
<dd>d. Under Board or Device select the <b>BeagleBone_Black</b>.</dd>
<dd>e. Click the <b>Advanced</b> tab at the bottom of that window, select the <b>CortxA8 core</b>, and browse to the <b>PRU_CAPE.gel file</b> (found in <i>&lt;PRU_SW_PATH&gt;/pru_cape).</i></dd>
<dd>f. Click Save and close this file.
<dl><dd><a href="File_Pru_lab1_targetconfig.html" class="image" title="pru_lab1_targetconfig.png"><img alt="pru_lab1_targetconfig.png" src="https://processors.wiki.ti.com/images/7/79/Pru_lab1_targetconfig.png" width="600" height="305" /></a></dd></dl></dd></dl></dd>
<dd>9. Let’s launch the debugger and load the code!
<dl><dd>a. In the "Target Configurations" view, right click the Target Configuration file we just created and select <b>Launch Selected Configuration</b>. Note that <b>Launch Selected Configuration</b> might not appear if you right click the file in a view other than "Target Configurations".</dd>
<dd>b. After it loads right click on the CortxA8 core and select <b>Connect Target</b>.</dd>
<dd>c. Run the GEL script under <b>Scripts-&gt;Initialization-&gt;PRU_Cape_Init</b>.
<dl><dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />This runs basic initialization code for pin muxing.</div></dd></dl></dd>
<dd>d. After the script runs, right click on the CortxA8 core and select <b>Disconnect Target</b>.</dd>
<dd>e. Right click on the PRU_0 core and select <b>Connect Target</b>.</dd>
<dd>f. Load the example you just build by selecting <b>Run-&gt;Load-&gt;Load Program</b>.</dd>
<dd>g. Select <b>Browse</b>, navigate to the project directory (by default /home/sitara/workspace_6.0/toggle_led/debug/) and select the <b>toggle_led.out</b> file.</dd>
<dd>h. Select the <b>green arrow</b> to run your code.</dd>
<dd>i. You should now see the LEDs toggle!</dd></dl></dd>
<dd>10. When you're all done enjoying your work, terminate the debug session using the big red square.</dd></dl>
<p><br />
</p>
<h1><span id="LAB_2:_Read_Push_Button_Switch_on_PRU0_GPI_&amp;_Toggle_LED_with_PRU1_GPO"></span><span class="mw-headline" id="LAB_2:_Read_Push_Button_Switch_on_PRU0_GPI_.26_Toggle_LED_with_PRU1_GPO">LAB 2:  Read Push Button Switch on PRU0 GPI &amp; Toggle LED with PRU1 GPO</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=9" title="Edit section: LAB 2: Read Push Button Switch on PRU0 GPI &amp; Toggle LED with PRU1 GPO">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h2><span class="mw-headline" id="Objective_2">Objective</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=10" title="Edit section: Objective">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>PRU multi-core communication.
</p>
<h2><span class="mw-headline" id="Lab_Steps_2">Lab Steps</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=11" title="Edit section: Lab Steps">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<dl><dd>1. Launch CCSv6 and select the default Workspace.</dd>
<dd>2. Create two new PRU projects – one for PRU0 and one for PRU1.
<dl><dd>a. Select <b>File-&gt;New-&gt;CCS Project</b>.</dd>
<dd>b. In the far-right dropdown next to Target, <b>select BeagleBone_Black</b>.</dd>
<dd>c. Select <b>PRU tab</b>, specify a <b>Project Name</b> (e.g., button_led_0 &amp; button_led_1), and verify that Compiler version is <b>TI v2.1.0</b> or higher.</dd>
<dd>d. Select <b>Finish</b>.</dd>
<dd>e. <b>Remember to create two separate projects, button_led_0 &amp; button_led_1</b>.</dd></dl></dd>
<dd>3. Copy the button_led_<i>n</i>.c and AM335x_PRU.cmd from the <i>&lt;PRU_SW_PATH&gt;/labs/lab_2</i> directory into the new projects.
<dl><dd>a. You can do this by selecting <b>File-&gt;Open File</b>, navigating to the button_led_<i>n</i>.c and AM335x_PRU.cmd and <b>copying them to the project</b>.</dd>
<dd>b. Alternatively, you can browse to the directory in an explorer window and drag/drop them as you would in Windows, or use Project-&gt;Add Files...</dd></dl></dd>
<dd>4. Remove main.c from the projects. main() has been implemented in button_led_<i>n</i>.c</dd>
<dd>5. Now we will begin modifying the code in button_led_0.c
<dl><dd>a. Include the <b>pru_intc.h header file</b>. Open it and examine the contents for a better understanding of the pruIntc structure.  You should find it in <i>&lt;PRU_SW_PATH&gt;/include</i></dd>
<dd>b. Notice the new <b>declaration for the r31 register</b> as we did previously for the r30 register. This allows us to directly access this register to generate interrupts.</dd>
<dd>c. Notice the <b>declarations for the interrupt</b> we will generate to signal to PRU1 that SW1 was pressed. The PRU cores can generate interrupts manually using events 16-31; however, these are mapped to bits [3:0] in the r31 register. Additionally we have to trigger bit 5 to strobe the interrupt. As an example, we pass 0b000 ORed with 0x20 to generate an interrupt on event 16. For more information see the definition of r31 writes in the device specific TRM.</dd></dl></dd></dl>
<p>&lt;syntaxhighlight lang = "c"&gt;
/* Defines */
/* PRU0-to-PRU1 interrupt */
</p>
<ol><li>define PRU0_PRU1_EVT (16)</li>
<li>define PRU0_PRU1_TRIGGER (__R31 = (PRU0_PRU1_EVT - 16) | (1 &lt;&lt; 5))</li></ol>
<p>&lt;/syntaxhighlight&gt;
</p>
<dl><dd><dl><dd>d. Define the <b>GPI offset</b> for SW1 which is located in GPI5.</dd></dl></dd></dl>
<p>&lt;syntaxhighlight lang = "c"&gt;
/* SW1 offset */
</p>
<ol><li>define SW1 (1 &lt;&lt; 5)</li></ol>
<p>&lt;/syntaxhighlight&gt;
</p>
<dl><dd><dl><dd>e. Go to the <b>configIntc function</b>. This function is mostly intact, but you will need to <b>fill out the register values</b> in order to configure the interrupt. Refer to the PRU INTC register descriptions in the device specific TRM for register layouts. For this exercise you will want to configure these registers such that:
<dl><dd>i.	<b>Event 16 is mapped to Channel 1</b></dd>
<dd>ii.	<b>Channel 1 is mapped to Host 1</b></dd>
<dd>iii.	<b>Ensure event 16 is clear</b></dd>
<dd>iv.	<b>Enable event 16</b></dd>
<dd>v.	<b>Enable Host 1</b></dd>
<dd>vi.	<b>Globally enable interrupts</b></dd></dl></dd></dl></dd></dl>
<p>&lt;syntaxhighlight lang = "c"&gt;
/* Map event 16 to channel 1 */ 
CT_INTC.CMR4_bit.CH_MAP_16 = 1;
</p><p>/* Map channel 1 to host 1 */
CT_INTC.HMR0_bit.HINT_MAP_1 = 1;
</p><p>/* Ensure event 16 is cleared */
CT_INTC.SICR = 16;
</p><p>/* Enable event 16 */
CT_INTC.EISR = 16;
</p><p>/* Enable Host interrupt 1 */
CT_INTC.HIEISR |= (1 &lt;&lt; 0);
</p><p>/* Globally enable host interrupts */
CT_INTC.GER = 1;
&lt;/syntaxhighlight&gt;
</p>
<dl><dd><dl><dd><dl><dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />Remember that you can use the CodeCompletion feature within CCS for a list of available registers and bit fields in the structure! To access it simply hit Ctrl+space after the dot (it should also open automatically when you type the dot).</div></dd></dl></dd>
<dd>f. Within the while(1) loop we are going to begin <b>polling the status of the R31 register</b> to determine if the button has been pressed. When the button is pressed, you will generate the interrupt to PRU1 and wait 500ms as a cheap 'debounce'.</dd></dl></dd></dl>
<p>&lt;syntaxhighlight lang = "c"&gt;
while(1){
</p>
<pre>   if ((__R31 &amp; SW1)&#160;!= SW1){
       /* Interrupt PRU1, wait 500ms for cheap "debounce" */
       /* TODO: Trigger interrupt - see #defines */
       __delay_cycles(100000000); /* 500ms @ 200MHz */
</pre>
<p>&lt;/syntaxhighlight&gt;
</p>
<dl><dd><dl><dd><dl><dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />The switches are active low so we are looking for it to go low.</div></dd></dl></dd></dl></dd>
<dd>6. Save the file, and then add the include directory to the Include Search Path to the button_led_0 project.
<dl><dd>a. Select <b>Project-&gt;Properties</b>.</dd>
<dd>b. Select <b>Build-&gt;PRU Compiler-&gt;Include Options</b>.</dd>
<dd>c. In the box marked <i>"Add dir to #include search path"</i> <b>click the file icon with a green +</b>.</dd>
<dd>d. Specify the <b>directory to the include file</b> which for the BeagleBone Black is <i>&lt;PRU_SW_PATH&gt;/include/am335x</i>
<dl><dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />If there is already a <i>${CCS_BASE_ROOT}/pru/include</i> directory, <b>delete it</b> by clicking the file icon with a red X.</div></dd></dl></dd></dl></dd>
<dd>7. Select OK and <b>build the project</b>. This should now compile successfully! If not, correct any errors until build completes.</dd>
<dd>8. Let's go modify the code in button_led_1.c
<dl><dd>a. Include the <b>pru_intc.h header file</b>.</dd>
<dd>b. Notice the <b>define for HOST1_MASK</b>. Hosts 0 and 1 are automatically mapped to bits 30 and 31, respectively, in the r31 register. To view the status of Host 1 we mask out the lower 31 bits.</dd>
<dd>c. Create a <b>define to toggle the BLUE LED</b> which is located on <b>PRU1 GPO 3</b>.</dd></dl></dd></dl>
<p>&lt;syntaxhighlight lang = "c"&gt;
</p>
<ol><li>define TOGGLE_BLUE (__R30 ^= (1 &lt;&lt; 3))</li></ol>
<p>&lt;/syntaxhighlight&gt;
</p>
<dl><dd><dl><dd>d. Notice the while(1) loop which is waiting for the Host 1 interrupt.</dd></dl></dd></dl>
<p>&lt;syntaxhighlight lang = "c"&gt;
/* Spin in loop until interrupt on HOST 1 is detected */
while(1){
</p>
<pre>   if (__R31 &amp; HOST1_MASK){
       TOGGLE_BLUE;
</pre>
<p>&lt;/syntaxhighlight&gt;
</p>
<dl><dd><dl><dd>e. Once the interrupt is received we need to clear it by <b>clearing the event</b>.</dd></dl></dd></dl>
<p>&lt;syntaxhighlight lang = "c"&gt;
/* Clear interrupt event */
CT_INTC.SICR = 16;
&lt;/syntaxhighlight&gt;
</p>
<dl><dd>9. Save the file, and then add the include directory to the Include Search Path of the button_led_1 project as before.</dd>
<dd>10. Select OK and then <b>build the project</b>. This should now compile successfully! If not, correct any errors until build completes.</dd>
<dd>11. Let's launch the debugger and load the code!
<dl><dd>a. Right click the Target Configuration file we created earlier and select <b>Launch Selected Configuration</b>.</dd>
<dd>b. After it loads right click on the CortxA8 core and select <b>Connect Target</b>.</dd>
<dd>c. Run the GEL script under <b>Scripts-&gt;Initialization-&gt;Init</b>.</dd>
<dd>d. Right click on the PRU0 core and select <b>Connect Target</b>.</dd>
<dd>e. Load the example you just built by selecting <b>Project-&gt;Load-&gt;Load Program</b>, then navigate to the project for button_led_0 and <b>select button_led_0.out</b></dd>
<dd>f. Select the <b>green arrow</b> to run your code.</dd>
<dd>g. Right click on the PRU1 core and select <b>Connect Target</b>.</dd>
<dd>h. Load the second example you built by selecting <b>Run-&gt;Load-&gt;Load Program</b>, then navigate to the project for button_led_1 and <b>select button_led_1.out</b></dd>
<dd>i. Select the <b>green arrow</b> to run your code.</dd>
<dd>j. You should now see the other BLUE LED toggle when you press SW1! If not, keeping reading...</dd></dl></dd>
<dd>12. Do you see the LED light up when you press SW1? If not, it sounds like a problem you will have to debug...
<dl><dd>a. For this exercise we are going to take it easy on you and provide the answer; however, first a quick explanation of why your code is not working.</dd>
<dd>b. This is a very tightly controlled while loop containing only 4 assembly instructions. Because every instruction is single cycle it will only take <b>4 cycles</b> to complete. Normally this would not be an issue, but there is a <b>slight delay in the time it takes for our write to the SICR to actually clear event 16</b>.</dd>
<dd>c. To work around these we need to add a <b>very small CPU delay</b> after the write to SICR. We chose <b>5 cycles</b> even though it is overkill, but we wanted to be safe and guarantee that the event was cleared before the loop cycled back.</dd></dl></dd></dl>
<p>&lt;syntaxhighlight lang = "c"&gt;
/* Clear interrupt event */
CT_INTC.SICR = 16;
/* Delay to ensure the event is cleared in INTC */
__delay_cycles(5);
&lt;/syntaxhighlight&gt;
</p>
<dl><dd><dl><dd>d. <b>Without this delay, r31[31] is still high when the loop repeats and checks the status of the interrupt</b>. Since the event has not been cleared yet, the <b>GPO pin is instantly toggled off</b> before we can see it toggled on.</dd>
<dd>e. <b>Rebuild the project, reload and observe.</b> The LED should now toggle when you press SW1! No, really, you should. If you don't, this time it really is a bug.</dd></dl></dd></dl>
<p><br />
</p>
<h1><span class="mw-headline" id="LAB_3:_Temperature_Monitor_Application">LAB 3:  Temperature Monitor Application</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=12" title="Edit section: LAB 3: Temperature Monitor Application">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h2><span class="mw-headline" id="Objective_3">Objective</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=13" title="Edit section: Objective">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Design a temperature monitor application on the PRU that periodically measures ambient temperature and toggles a Red LED if the temperature increases and a Blue LED if the temperature decreases.
</p>
<h2><span class="mw-headline" id="Lab_Steps_3">Lab Steps</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=14" title="Edit section: Lab Steps">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<dl><dd>1. Go through the <a rel="nofollow" class="external text" href="https://training.ti.com/sitara™-arm®-processors-boot-camp-building-blocks-pru-development-4-part-series">PRU Module 3 Training session</a> on "Designing a PRU Application."  This interactive training session introduces a step-by-step design process and walks through  using this process to design a Temperature Monitor application for the PRU.</dd>
<dd>The Temperature Monitor application based on the training session is already written for you.  However, you can also try writing the Temperature Monitor application yourself!  The rest of this lab will take a closer look at the source code, run it on the PRU, and measure PRU cycles using the CCS debugger...</dd>
<dd>2. Launch CCSv6 and select the default Workspace.</dd>
<dd>3. Create two new PRU projects – one for PRU0 and one for PRU1.
<dl><dd>a. Select <b>File-&gt;New-&gt;CCS Project</b>.</dd>
<dd>b. Next to Target <b>select BeagleBone_Black</b>.</dd>
<dd>c. Select <b>PRU tab</b>, specify a new <b>Project Name</b> (e.g., temp_monitor_slave_0 &amp; temp_monitor_master_1), verify that Compiler version is <b>TI v2.1.0</b>, and select “Empty Project.”  Note:  If “Empty Project (with main.c)” is selected, you will need to delete <i><b>main.c</b></i> in the project directory (added by default).</dd>
<dd>d. Select <b>Finish</b>.</dd>
<dd>e. <b>Remember to create two separate projects</b>.</dd></dl></dd>
<dd>4. Copy the temp_monitor_master_1.c, PRU_1wire.h, AM335x_PRU.cmd, and resource_table_empty.h from the <i>&lt;PRU_SW_PATH&gt;/pru_cape/pru_fw/PRU_HDQ_TempSensor1</i> directory into the new temp_monitor_master_1 project
<dl><dd>a. You can do this by selecting <b>File-&gt;Open File</b>, navigating to the temp_monitor_master_1.c, PRU_1wire.h, AM335x_PRU.cmd, and resource_table_empty.h; and <b>copying them to the project</b>.</dd>
<dd>b. Alternatively, you can browse to the directory in an explorer window and drag/drop them as you would in Windows.</dd></dl></dd>
<dd>5. Copy the temp_monitor_slave_0.c, PRU_1wire.h, AM335x_PRU.cmd and resource_table_empty.h from the <i>&lt;PRU_SW_PATH&gt;/pru_cape/pru_fw/PRU_HDQ_TempSensor0</i> directory into the new temp_monitor_slave_0 project</dd>
<dd>6. For each project, add the include directory to the Include Search Path.
<dl><dd>a. Select <b>Project-&gt;Properties</b>.</dd>
<dd>b. Select <b>Build-&gt;PRU Compiler-&gt;Include Options</b>.</dd>
<dd>c. In the box marked <i>"Add dir to #include search path"</i> <b>click the file icon with a green +</b>.</dd>
<dd>d. Specify the <b>directory to the include file</b> which for the BeagleBone Black is <i>&lt;PRU_SW_PATH&gt;/include/am335x</i>
<dl><dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />If there is already a <i>${CCS_BASE_ROOT}/pru/include</i> directory, <b>delete it</b> by clicking the file icon with a red X.</div></dd></dl></dd></dl></dd>
<dd>7. <b>Build</b> each project.</dd>
<dd>8. Let's take a look at the code in temp_monitor_master_1.c
<dl><dd>a. Notice the mapping for the interrupt controller in the <b>intc_config function</b>. Both lab 2 &amp; 3 use the same basic steps to configure the INTC. However, the temp monitor implementation in lab 3 uses non-indexed registers (i.e. ESR0, SECR0, etc), whereas lab 2 used the indexed registers (i.e. EISR, SICR, etc). <b>The indexed and non-indexed registers offer two approaches to accomplish the same end result</b>.</dd>
<dd>b. Review the event to channel to host mapping.  Note "Host 0" will be used to interrupt the PRU0 slave and "Host 1" will be used to interrupt the PRU1 master.</dd>
<dd>c. Notice that after the PRU master code configures the INTC and PWM, it waits on an interrupt from the PRU slave that indicates the slave has completed its own configuration steps and is ready to start communicating with the temperature sensor. <b>Does this impact the order that we need to run each PRU core?</b>
<dl><dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />If the PRU INTC is not configured before the PRU slave starts running, the event generated by the PRU slave will not be detected and the PRU master will be perpetually waiting for this event. To eliminate this configuration dependency, an alternate solution would be to have the ARM pre-configure the PRU INTC prior to enabling the PRU cores.</div></dd></dl></dd>
<dd>d. Notice how the PRU master code handles monitoring for multiple interrupts. The code first detects that an event has generated on the specific Host interrupt and then checks what is the highest priority event that has occurred on this Host interrupt.</dd></dl></dd></dl>
<p>&lt;syntaxhighlight lang = "c"&gt;
/* Detect interrupt */ 
while((__R31 &amp; 0x80000000) == 0){}
</p><p>/* Identify highest priority event */
int_val = CT_INTC.HIPIR1;
&lt;/syntaxhighlight&gt;
</p>
<dl><dd><dl><dd><dl><dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />The priority for a given interrupt can be controlled through the PRU INTC system event and channel mapping— lowered numbered events and channels have higher priority.  In our temp monitor implementation, <b>which event will have the highest priority?</b></div></dd></dl></dd></dl></dd>
<dd>9. Let's go look at the code in temp_monitor_slave_0.c
<dl><dd>a. Notice that as observed in the PRU master code, the PRU slave first configures the IEP Timer and DigIO and then interrupts the PRU master to signal that it’s ready to communicate with the temperature sensor.</dd>
<dd>b. Notice that in the <b>iep_timer_config function</b>, the PRU slave stores different increments of time required by 1-wire protocol (i.e. 480 us, 60 us, 15 us, 1 us) as separate PRU IEP CMP values.  The 1-Wire Protocol functions (<b>write_0, write_1, read, init</b>) then call the <b>timer function</b> that detects an IEP interrupt for the appropriate CMP value.
<dl><dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />In <b>timer function</b> we add a <b>very small CPU delay</b> after clearing the IEP timer event source and before clearing the PRU INT— similar to lab 2. Without this delay, the CMP_STATUS is still set when the INTC status is cleared and the INTC will immediately re-detect and set the event.</div></dd></dl></dd></dl></dd></dl>
<p>&lt;syntaxhighlight lang = "c"&gt;
/* Clear IEP Timer system event */ 
CT_IEP.CMP_STATUS = (1 &lt;&lt; wait480us);
__delay_cycles(4);
CT_INTC.SECR0 = (1 &lt;&lt; PRU_IEP_EVT);
&lt;/syntaxhighlight&gt;
</p>
<dl><dd><dl><dd>c. Notice that the 1-Wire Protocol functions (<b>write_0, write_1, read, init</b>) configure the IEP DigIO for tri-state mode to allow the 1-wire signal to float "high". For example in the <b>init function</b>:</dd></dl></dd></dl>
<p>&lt;syntaxhighlight lang = "c"&gt;
/* Drive OUT_1WIRE low */
CT_IEP.DIGIO_DATA_OUT_EN = 0x0; 
</p><p>timer(wait480us); 
</p><p>/* Set OUT_1WIRE in tri-state mode */ 
CT_IEP.DIGIO_DATA_OUT_EN = OUT_1WIRE;
&lt;/syntaxhighlight&gt;
</p>
<dl><dd><dl><dd>d. Notice that the other steps in the PRU slave code match the diagram that we architected in Design Step 5.</dd></dl></dd>
<dd>10. Let’s launch the debugger and load the code!
<dl><dd>a. Right click the Target Configuration file we created earlier and select <b>Launch Selected Configuration</b>.</dd>
<dd>b. After it loads right click on the CortxA8 core and select <b>Connect Target</b>.</dd>
<dd>c. Run the GEL script under <b>Scripts-&gt;Initialization-&gt;Init</b>.</dd>
<dd>d. Right click on the PRU1 core and select <b>Connect Target</b>.</dd>
<dd>e. Load the example you just built by selecting <b>Project-&gt;Load-&gt;Load Program</b>, then navigate to the project for temp_monitor_master_1 and <b>select temp_monitor_master_1.out</b></dd>
<dd>f. Select the <b>green arrow</b> to run your code.
<dl><dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />PRU1 needs to be run first because of the INTC configuration dependency.</div></dd></dl></dd>
<dd>g. Right click on the PRU0 core and select <b>Connect Target</b>.</dd>
<dd>h. Load the second example you built by selecting <b>Project-&gt;Load-&gt;Load Program</b>, then navigate to the project for temp_monitor_slave_0 and <b>select temp_monitor_slave_0.out</b></dd>
<dd>i. Select the <b>green arrow</b> to run your code.</dd>
<dd>j. You should now see the RED or BLUE LED toggle depending on the change in temperature!  (Note neither LED will be illuminated if there is no change in temperature.)</dd>
<dd>k. Place either your thumb or the palm of your hand over TEMP1 temperature sensor to see the temperature rise and the RED LED illuminated.  Remove your thumb or palm to see the temperature fall and the BLUE LED illuminated.</dd></dl></dd>
<dd>11. During our design discussion, we were unsure how many PRU cycles the CRC calculation would consume.  Let’s actually measure the PRU cycles using the CCS debugger!
<dl><dd>a. Click on each PRU core and select the <b>yellow pause button</b> to suspend each core.</dd>
<dd>b. Reload the code for each PRU core by selecting <b>Project-&gt;Load-&gt;Reload Program</b>.</dd>
<dd>c. Click on the <b>PRU0 core</b>.</dd>
<dd>d. Set a breakpoint in <b>temp_monitor_slave_0.c, line 139</b> when the PRU calculates the CRC.</dd>
<dd>e. Click on the <b>PRU1 core</b> and select the <b>green arrow</b> to run your code.</dd>
<dd>f. Click on the <b>PRU0 core</b> and select the <b>green arrow</b> to run your code</dd>
<dd>g. When the PRU0 core breaks on line 139, open the Registers window and enable the PRU Cycle Counter in the <b>PRU0_CTRL.CTRL[CTR_EN]</b>. If the Registers window is not already open, select <b>View-&gt;Registers</b></dd>
<dd>h. Select <b>Run-&gt;Step Over</b> to step over this line.</dd>
<dd>i. In the Registers window, read the value in <b>PRU0_CTRL.CYCLE</b> register.  This is the number of PRU cycles required to calculate the CRC for each byte.</dd></dl></dd></dl>
<p><br />
</p>
<h1><span class="mw-headline" id="LAB_4:_Introduction_to_Linux_driver">LAB 4: Introduction to Linux driver</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=15" title="Edit section: LAB 4: Introduction to Linux driver">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h2><span class="mw-headline" id="Objective_4">Objective</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=16" title="Edit section: Objective">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>To test the Linux remoteproc driver. We will first add a resource table to the projects we created earlier in lab 2, rebuild those projects, load the .out files into the target filesystem and then use the remoteproc driver to load that code into the PRU cores.
</p>
<div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />Beginning with Linux Processor SDK 2.0.2.11 the remoteproc and rpmsg drivers are enabled by default in the provided kernel configuration and default binaries. Therefore, it is no longer necessary to modify the .config in order to load firmwares into the PRU cores. If you are using a version of the Linux Processor SDK prior to 2.0.2.11 please see the archive links at the bottom of this page.</div>
<p><br />
</p>
<h2><span class="mw-headline" id="Lab_Steps_4">Lab Steps</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=17" title="Edit section: Lab Steps">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h3><span class="mw-headline" id="Build_the_PRU_Firmware">Build the PRU Firmware</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=18" title="Edit section: Build the PRU Firmware">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<dl><dd>1. Launch CCSv6 and select the default Workspace.</dd>
<dd>2. Open the <b>button_led_0 project</b>.
<dl><dd>a. In the button_led_0 project, select <b>File-&gt;Open File</b> and copy in the <b>resource_table_0.h file</b> from <i>&lt;PRU_SW_PATH&gt;/labs/lab_4</i> or use <b>Project-&gt;Add Files...</b> to add the file to the project and copy it into the workspace.</dd>
<dd>b. In the AM335x.cmd file, add a line telling the linker where to place the new <b>.resource_table</b> section.
<dl><dd><dl><dd><a href="File_Pru_lab4_linkcmd.html" class="image"><img alt="Pru lab4 linkcmd.png" src="https://processors.wiki.ti.com/images/f/f4/Pru_lab4_linkcmd.png" width="600" height="320" /></a></dd></dl></dd></dl></dd>
<dd>c. In button_led_0.c <b>include the resource_table_0.h file</b>.</dd></dl></dd></dl>
<p>&lt;syntaxhighlight lang = "c"&gt;
</p>
<ol><li>include &lt;stdint.h&gt;</li>
<li>include &lt;pru_cfg.h&gt;</li>
<li>include &lt;pru_intc.h&gt;</li>
<li>include "resource_table_0.h"</li></ol>
<p>&lt;/syntaxhighlight&gt;
</p>
<dl><dd><dl><dd>d. <b>Rebuild the project</b> and ensure that it builds correctly without errors.</dd></dl></dd>
<dd>3. Open the <b>button_led_1 project</b>.
<dl><dd>a. Select <b>File-&gt;Open File</b> and copy in the <b>resource_table_1.h file</b> from <i>&lt;PRU_SW_PATH&gt;/labs/lab_4</i> or use <b>Project-&gt;Add Files...</b> and copy the file into the workspace.</dd>
<dd>b. In button_led_1.c <b>include the resource_table_1.h file</b>.</dd>
<dd>c. Rebuild the project and ensure that it builds correctly without errors.</dd>
<dd>d. You may choose to launch the debugger and verify that both projects run without issues.</dd></dl></dd></dl>
<h3><span class="mw-headline" id="Configure_the_Kernel">Configure the Kernel</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=19" title="Edit section: Configure the Kernel">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<dl><dd><dl><dd><dl><dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />This step is needed before building the kernel, kernel modules, device tree files, etc. For more information about these steps, see the <a rel="nofollow" class="external text" href="http://software-dl.ti.com/processor-sdk-linux/esd/docs/latest/linux/Foundational_Components_Kernel_Users_Guide.html">Kernel Users Guide</a>.</div></dd></dl></dd></dl></dd>
<dd>4. Prepare to build the kernel, kernel modules, device tree files, etc
<dl><dd>a. Export the terminal PATH to where the cross compiler toolchain files can be found. This can be found in the <i>linux-devkit/sysroots/&lt;Arago Linux&gt;/user/bin</i> of your SDK directory where your Arago Linux version may be <i>x86_64-arago-linux</i>. Be sure to include <i>/home/&lt;user&gt;/</i> before your SDK directory.
<dl><dd><b>export PATH=$PATH:&lt;SDK path&gt;/linux-devkit/sysroots/&lt;Arago Linux&gt;/usr/bin/</b></dd>
<dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />You will have to do this each time you open a new terminal.</div></dd></dl></dd>
<dd>b. Clean the kernel sources
<dl><dd><b>make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- distclean</b></dd></dl></dd>
<dd>c. Configure the kernel
<dl><dd><b>make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- tisdk_am335x-evm_defconfig</b></dd></dl></dd></dl></dd></dl>
<h3><span class="mw-headline" id="Build_the_Linux_Kernel_and_remoteproc_Driver">Build the Linux Kernel and remoteproc Driver</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=20" title="Edit section: Build the Linux Kernel and remoteproc Driver">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<dl><dd>5. Beginning with Linux Processor SDK v2.0.2.11, the remoteproc and rpmsg modules are enabled by default and included out of the box in the Linux Processor SDK. These instructions assume users use the prebuilt kernel and driver modules used in the create SD card script, so we do not need to rebuild the kernel and driver modules. See section "Copy files to the target filesystem" for information on using the create SD card script. More information on enabling the remoteproc and rpmsg modules may be found in the "How to Enable PRU Support in Kernel" section <a rel="nofollow" class="external text" href="http://software-dl.ti.com/processor-sdk-linux/esd/docs/latest/linux/Foundational_Components_PRU-ICSS_PRU_ICSSG.html#getting-started-with-pru-icss">here</a>.</dd></dl>
<h3><span class="mw-headline" id="Modify_Device_Tree_Files_to_Account_for_PRU_Cape">Modify Device Tree Files to Account for PRU Cape</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=21" title="Edit section: Modify Device Tree Files to Account for PRU Cape">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<dl><dd>The SDK includes example device tree source files for several TI and community boards, like the Beaglebone Black. Since the PRU cape requires certain pin muxing and configuration to be configured to be usable in Linux, this requires modifications to the device tree files.</dd></dl>
<dl><dd>6. Modify to SDK provided DTS (devicetree source) files to account for the PRU cape.
<dl><dd>a. Copy the am335x-boneblack-prucape.dtsi from the <b>&lt;PRU_SW_PATH&gt;/pru_cape</b> directory to arch/arm/boot/dts.</dd>
<dd>b. In your kernel source tree, open arch/arm/boot/dts/am335x-boneblack.dts for editing.</dd>
<dd>c. Add the below line to include the PRU Cape DTS file <b>to the bottom</b> of the am335x-boneblack.dts file.
<dl><dd><b>#include "am335x-boneblack-prucape.dtsi"</b></dd>
<dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />It is very important that this edit be made at the end of the file. Not included with the other include files. Device Trees work with an "overlay" mentality, applying changes as they are found serially to a "tree" structure. We need the edits made for the PRU cape to be applied last.</div></dd></dl></dd>
<dd>d. Save the file.</dd>
<dd>e. Compile the DTS file:
<dl><dd><b>make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- am335x-boneblack.dtb</b></dd></dl></dd></dl></dd></dl>
<h3><span class="mw-headline" id="Copy_files_to_the_target_filesystem">Copy files to the target filesystem</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=22" title="Edit section: Copy files to the target filesystem">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<dl><dd>So far, we've built the PRU firmware and the modified device tree. Now, we need to copy these files to the target filesystem. We're going to keep things simple and make some assumptions. If you've done things differently in your set up, then you'll need to adapt these instructions to your set up.</dd></dl>
<dl><dd>7. We need to get the new device tree and PRU firmware running on the Beaglebone Black. The easiest way to do this is with an SD card. There are lots of other alternatives (boot from TFTP with an initramfs, boot from TFTP and mount the FS over NFS, copy everything to the Beaglebone Black's eMMC, etc.). Feel free to adapt these instructions to your desired setup.
<dl><dd>a. Use the script included with the SDK to create a bootable SD card. You can find instructions on this process <a href="http://software-dl.ti.com/processor-sdk-linux/esd/docs/latest/linux/Overview_Getting_Started_Guide.html#linux-sd-card-creation-guide" class="mw-redirect" title="Sitara Linux SDK create SD card script">here</a>.</dd>
<dd>b. Once the card is created, mount it on your Linux host to copy the files to it.</dd>
<dd>c. The rootfs partition on the SD card contains the target filesystem. Copy the files from your development host to the SD card:
<dl><dd>a. Copy the <b>button_led_0.out</b> and <b>button_led_1.out</b> from your CCS workspace where they were built to the <b>/lib/firmware/pru</b> directory of the rootfs partition.</dd>
<dd>b. Make a copy of am335x-boneblack.dtb, in the same directory arch/arm/boot/dts, and change its name to am335x-boneblack-prucape.dtb.</dd>
<dd>c. Copy the am335x-boneblack-prucape.dtb from arch/arm/boot/dts to the boot directory of the rootfs partition of the SD card.</dd>
<dd>d. Change the "am335x-boneblack.dtb" symlink in the rootfs/boot directory to point to the am335x-boneblack-prucape.dtb instead of the default.
<dl><dd><b>sudo ln -f -s am335x-boneblack-prucape.dtb am335x-boneblack.dtb</b></dd></dl></dd>
<dd>e. Use the <b>sync</b> command to make sure all of your changes have been committed to the SD card.</dd></dl></dd></dl></dd></dl>
<p><br />
</p>
<h3><span class="mw-headline" id="Boot_the_new_device_tree_and_FS_on_the_Target">Boot the new device tree and FS on the Target</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=23" title="Edit section: Boot the new device tree and FS on the Target">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<dl><dd>Now we're ready to try everything out.</dd></dl>
<dl><dd>8. Move the SD card from the host PC to the target board.</dd>
<dd>9. Boot the Beaglebone Black from the SD Card by holding down the "boot" button while applying power with either the USB cable or a dedicated 5V power source. The "boot" button may be difficult to get to with the PRU cape in place. It is right above the micro SD card slot.</dd>
<dd>10. Wait for the kernel to boot. At the prompt, login with "root" and no password.</dd>
<dd>11. Use the remoteproc sysfs interface to specify which firmwares you want the remoteproc driver to load
<dl><dd><dl><dd><b>echo 'pru/button_led_0.out' &gt; /sys/class/remoteproc/remoteproc1/firmware</b></dd>
<dd><b>echo 'pru/button_led_1.out' &gt; /sys/class/remoteproc/remoteproc2/firmware</b></dd></dl></dd></dl></dd>
<dd>12. Once again use the remoteproc sysfs interface to load and then run the PRU cores
<dl><dd><dl><dd><b>echo 'start' &gt; /sys/class/remoteproc/remoteproc1/state</b></dd>
<dd><b>echo 'start' &gt; /sys/class/remoteproc/remoteproc2/state</b></dd></dl></dd></dl></dd>
<dd>13. Observe the LEDs blink.
<dl><dd>a. Once 'start' has been echoed into the 'state' attribute the remoteproc firmware will load the PRU cores and then run them. You should be able to see the LED toggle as you press the switch as before in Lab 2.</dd>
<dd>b.If you would like to unload and then reload the PRU cores, use the commands below:
<dl><dd><b>echo 'stop' &gt; /sys/class/remoteproc/remoteproc1/state</b></dd>
<dd><b>echo 'stop' &gt; /sys/class/remoteproc/remoteproc2/state</b></dd>
<dd><b>echo 'start' &gt; /sys/class/remoteproc/remoteproc1/state</b></dd>
<dd><b>echo 'start' &gt; /sys/class/remoteproc/remoteproc2/state</b></dd></dl></dd></dl></dd></dl>
<p><br />
</p>
<h1><span class="mw-headline" id="LAB_5:_RPMsg_Communication_between_ARM_and_PRU">LAB 5: RPMsg Communication between ARM and PRU</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=24" title="Edit section: LAB 5: RPMsg Communication between ARM and PRU">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h2><span class="mw-headline" id="Objective_5">Objective</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=25" title="Edit section: Objective">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>This lab will show how to build a firmware that uses the rpmsg_lib PRU library in order to enable communication with the ARM core running Linux. Part 1 will walk you through creating the PRU firmware and loading the modules necessary for PRU to kernel space communication. Part 2 will use a different Linux module in order to expose a user space interface for PRU communication. Part 3 will show how to create a user space C application that can send and receive messages to a PRU core. <b>This lab expects to use the remoteproc Linux driver to load the PRU firmware. Please complete and understand <a href="PRU_Training__Hands-on_Labs.html#LAB_4:_Introduction_to_Linux_driver" title="PRU Training: Hands-on Labs"> Lab 4</a> before beginning this lab.</b>
</p>
<h2><span class="mw-headline" id="Lab_Steps_5">Lab Steps</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=26" title="Edit section: Lab Steps">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h3><span class="mw-headline" id="Build_the_PRU_Firmware_2">Build the PRU Firmware</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=27" title="Edit section: Build the PRU Firmware">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<h4><span class="mw-headline" id="Using_CCSv6">Using CCSv6</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=28" title="Edit section: Using CCSv6">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<dl><dd>1. Launch CCSv6 and select the default Workspace.</dd>
<dd>2. Import the <b>PRU_RPMsg_Echo_Interrupt1</b> and <b>PRU_Halt</b> projects from the lab_5 solution folder.
<dl><dd>a. <b>Project-&gt;Import CCS Projects...</b></dd>
<dd>b. Click <b>Browse...</b></dd>
<dd>c. Navigate to <b>&lt;PRU_SW_PATH&gt;/labs/lab_5/solution</b> and click <b>OK</b> (where &lt;PRU_SW_PATH&gt; is the path to your PRU Software Support Package installation).</dd>
<dd>d. Click the checkbox next to both projects in order to select them and then click <b>Finish</b>. (For this lab, you do not need to check 'Automatically import referenced projects...' or 'Copy project into workspace'.)
<dl><dd><a href="File_Lab5_import.html" class="image"><img alt="Lab5 import.png" src="https://processors.wiki.ti.com/images/0/0d/Lab5_import.png" width="613" height="668" /></a></dd></dl></dd></dl></dd>
<dd>3. Make sure that the compiler include options for both projects point to the include folders provided with the software package.
<dl><dd>a. <b>Right-click on each project in the Project Explorer and then click Properties</b>.</dd>
<dd>b. Expand <b>Build</b> then expand <b>PRU Compiler</b> and then click on <b>Include Options</b>.</dd>
<dd>c. Make sure that <b>"../../../../../include"</b> is there as an include path.</dd>
<dd>d. Also make sure that <b>"../../../../../include/am335x"</b> is there as an include path.
<dl><dd><a href="File_2_0-Lab5_include_path.html" class="image"><img alt="2 0-Lab5 include path.PNG" src="https://processors.wiki.ti.com/images/a/a1/2_0-Lab5_include_path.PNG" width="934" height="617" /></a></dd></dl></dd>
<dd>d. Click <b>OK</b>.</dd></dl></dd>
<dd>4. Make sure that the <b>rpmsg_lib</b> library is added in the <b>PRU_RPMsg_Echo_Interrupt1</b> project.
<dl><dd>a. <b>Right-click on PRU_RPMsg_Echo_Interrupt1 in the Project Explorer and then click Properties</b>.</dd>
<dd>b. Expand <b>Build</b> then expand <b>PRU Linker</b> and then click on <b>File Search Path</b>.</dd>
<dd>c. Make sure that <b>"../../../../../lib/rpmsg_lib.lib"</b> is there as an included library file.
<dl><dd><a href="File_Lab5_include_library.html" class="image"><img alt="Lab5 include library.png" src="https://processors.wiki.ti.com/images/b/be/Lab5_include_library.png" width="933" height="618" /></a></dd></dl></dd>
<dd>d. Click <b>OK</b>.</dd></dl></dd>
<dd>5. Build each project and make sure there are no errors.
<dl><dd>a. <b>Right-click on each project in the Project Explorer and then click Rebuild Project</b>.</dd></dl></dd></dl>
<p><br />
</p>
<h4><span class="mw-headline" id="Using_the_Provided_Makefile">Using the Provided Makefile</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=29" title="Edit section: Using the Provided Makefile">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<dl><dd>6. Open a command prompt or terminal window.</dd>
<dd>7. Set the PRU_CGT environment variable to point to the PRU code generation tools folder. This folder is included in the Linux Processor SDK v2.0.2.11 and newer.
<dl><dd>a. Linux: <b>export PRU_CGT=&lt;path_to_Linux_proc_sdk&gt;/linux-devkit/sysroots/x86_64-arago-linux/usr/share/ti/cgt-pru</b></dd>
<dd>b. Windows: <b>set PRU_CGT=C:/TI/ccs_v6_&lt;version&gt;/ccsv6/tools/compiler/ti-cgt-pru_2.1.0</b></dd></dl></dd>
<dd>8. Change to the PRU_RPMsg_Echo_Interrupt1 directory.
<dl><dd>a. <b>cd &lt;PRU_SW_PATH&gt;/labs/lab_5/solution/PRU_RPMsg_Echo_Interrupt1</b> (where &lt;PRU_SW_PATH&gt; is the path to your PRU Software Support Package installation).</dd></dl></dd>
<dd>9. Clean the previously generated files, if they exist.
<dl><dd>a. <b>make clean</b></dd></dl></dd>
<dd>10. Build the project.
<dl><dd>a. <b>make</b></dd></dl></dd>
<dd>11. Change to the <b>PRU_Halt</b> directory and repeat the <b>make clean</b> and <b>make</b> commands. The generated project files will be available in a folder named <b>gen</b> in each project directory. The output for each project should be similar to the below screen shot:
<dl><dd><dl><dd><a href="File_Lab5_build_project.html" class="image"><img alt="Lab5 build project.png" src="https://processors.wiki.ti.com/images/0/02/Lab5_build_project.png" width="814" height="828" /></a></dd></dl></dd></dl></dd></dl>
<p><br />
</p>
<h3><span class="mw-headline" id="Build_the_RPMsg_Client_Sample_Driver">Build the RPMsg Client Sample Driver</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=30" title="Edit section: Build the RPMsg Client Sample Driver">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<dl><dd>12. Open a terminal on your Linux development machine and navigate to the Linux source directory.
<dl><dd>a. <b>cd &lt;SDK path&gt;/board-support/linux&lt;version&gt;</b> (where &lt;SDK path&gt; is the location of your Processor SDK installation)</dd></dl></dd>
<dd>13. Enable the RPMsg Client Sample driver in the kernel config.
<dl><dd><div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br />Be sure that you have already followed all the instructions in <a href="PRU_Training__Hands-on_Labs.html#LAB_4:_Introduction_to_Linux_driver" title="PRU Training: Hands-on Labs"> Lab 4</a>. If you opened a new terminal window, you will have to export the PATH again.</div></dd>
<dd>a. <b>make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- distclean</b></dd>
<dd>b. <b>make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- tisdk_am335x-evm_defconfig</b></dd>
<dd>c. <b>make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- menuconfig</b></dd>
<dd>d. Navigate to <b>Kernel hacking-&gt;Sample kernel code</b> and type '<b>Y'</b></dd>
<dd>e. After typing '<b>Y'</b> to include <b>Sample kernel code</b> then press <b>Enter</b> on <b>Sample kernel code</b></dd>
<dd>f. Scroll down until you get to <b>Build rpmsg client sample</b> and type '<b>M'</b>
<dl><dd><a href="File_2_0-lab5_menuconfig_rpmsg_client_sample.html" class="image"><img alt="2 0-lab5 menuconfig rpmsg client sample.png" src="https://processors.wiki.ti.com/images/9/9b/2_0-lab5_menuconfig_rpmsg_client_sample.png" width="725" height="488" /></a></dd></dl></dd>
<dd>g. Save the config and exit menuconfig.</dd>
<dd>h. Build the driver: <b>make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf-</b></dd></dl></dd></dl>
<p><br />
</p>
<h3><span class="mw-headline" id="Copy_files_to_the_target_file_system">Copy files to the target file system</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=31" title="Edit section: Copy files to the target file system">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<dl><dd>At this point in the lab, we have built our two PRU firmwares as well as the new Linux driver. Now we need to get those three files into the file system of the Beaglebone Black. These next steps will show where to put each file in the file system. It is left up to the user as to how to get the files into the file system (<a href="PRU_Training__Hands-on_Labs.html#LAB_4:_Introduction_to_Linux_driver" title="PRU Training: Hands-on Labs"> Lab 4</a> gives instructions on how to do this with an SD card but use whatever method is most convenient in your development environment).</dd></dl>
<dl><dd>14. Copy the <b>PRU_RPMsg_Echo_Interrupt1.out</b> file that we generated above to the <b>/lib/firmware</b> directory in your file system. Keep in mind that the .out file will be in different locations depending on whether you built with CCS (Debug or Release folder) or with the Makefile (gen folder).</dd>
<dd>15. Now copy the <b>PRU_Halt.out</b> file (that we also generated above) to the <b>/lib/firmware</b> directory.</dd>
<dd>16. Copy the below module from the Linux kernel tree to the <b>/home/root/modules</b> directory in the file system.
<dl><dd>a. samples/rpmsg/rpmsg_client_sample.ko</dd></dl></dd></dl>
<dl><dd>Now we should have the two PRU firmwares in the /lib/firmware directory as well as the kernel module in the /home/root/modules directory of the file system.</dd></dl>
<p><br />
</p>
<h3><span class="mw-headline" id="Part_1:_Kernel_space_communication">Part 1: Kernel space communication</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=32" title="Edit section: Part 1: Kernel space communication">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<dl><dd>It's time to run the RPMsg echo example with the client sample module. This lab assumes that you are able to boot the board and navigate to the <b>/home/root/modules</b> directory. If you are having trouble getting to that point, <a href="PRU_Training__Hands-on_Labs.html#LAB_4:_Introduction_to_Linux_driver" title="PRU Training: Hands-on Labs"> Lab 4</a> gives an example on how to get there by booting with an SD card.</dd></dl>
<dl><dd>1. Use the remoteproc sysfs interface to point the remoteproc driver to the newly built firmwares for each PRU
<dl><dd><b>echo 'PRU_Halt.out' &gt; /sys/class/remoteproc/remoteproc1/firmware</b></dd>
<dd><b>echo 'PRU_RPMsg_Echo_Interrupt1.out' &gt; /sys/class/remoteproc/remoteproc2/firmware</b></dd></dl></dd>
<dd>2. Once again use the remoteproc sysfs to load and the run the PRU cores
<dl><dd><b>echo 'start' &gt; /sys/class/remoteproc/remoteproc1/state</b></dd>
<dd><b>echo 'start' &gt; /sys/class/remoteproc/remoteproc2/state</b></dd></dl></dd>
<dd>3. In the <b>/home/root/modules</b> directory of our board we should have our newly built module:
<dl><dd>a. <b>rpmsg_client_sample.ko</b></dd></dl></dd>
<dd>4. In this portion of the lab we need to insert the module to kickoff the back and forth RPMsg echo sample:
<dl><dd>a. <b>insmod rpmsg_client_sample.ko</b></dd></dl></dd>
<dd>5. After inserting the module, you will see the rpmsg_client_sample driver print 100 messages to the console and then exit.</dd>
<dd>6. If you would like to re-run the echo sample you can remove the rpmsg_client_sample driver and then insert it again:
<dl><dd>a. <b>rmmod rpmsg_client_sample.ko</b></dd>
<dd>b. <b>insmod rpmsg_client_sample.ko</b></dd></dl></dd></dl>
<h4><span id="What_just_happened?"></span><span class="mw-headline" id="What_just_happened.3F">What just happened?</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=33" title="Edit section: What just happened?">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p><b>RPMsg Client Sample Module</b>
</p>
<dl><dd>Let's discuss the RPMsg Client Sample module first. Open up the file <b>/samples/rpmsg/rpmsg_client_sample.c</b> from the Linux kernel source with a text editor. There are two methods in this file that are important for our example: <b>rpmsg_sample_probe()</b> and <b>rpmsg_sample_cb()</b>.</dd></dl>
<dl><dd><b>rpmsg_sample_probe()</b></dd>
<dd>This function gets called every time an <b>rpmsg_channel</b> is created with a name that matches the <b>.name</b> attribute of the rpmsg_driver_sample_id_table. The name that corresponds to this module, and that is in its id_table, is <b>"rpmsg-client-sample"</b> (remember that name, we'll see it again soon). So, when an rpmsg_channel with the name <b>"rpmsg-client-sample"</b> is created, the rpmsg_sample_probe function is called with the rpmsg_channel as its only parameter. Looking at the rest of the probe function in the source code we can see that our module allocates some memory for idata and then uses <b>rpmsg_send()</b> to send a hello world message to the processor on the other end of the recently opened channel. In our example, the processor at the other end of the channel is PRU1.</dd></dl>
<dl><dd><b>rpmsg_sample_cb()</b></dd>
<dd>This callback function occurs each time a new message is received at the ARM core on the rpmsg_channel. In our example, when PRU1 sends a message through the rpmsg_channel this function is called on the ARM side. In the source code we can see that the kernel module increments its message count, checks to see if it has reached the message limit (100 messages), and if it has not reached the limit it sends another hello world message.</dd></dl>
<dl><dd>This RPMsg Client Sample shows everything necessary to create a kernel module that can communicate with a PRU core through RPMsg. However, this module does not expose an interface to Linux user space applications so its usefulness is limited.</dd></dl>
<p><b>PRU RPMsg Echo Firmware</b>
</p>
<dl><dd>Now let's look at the <b>lab_5/solution/PRU_RPMsg_Echo_Interrupt1/main.c</b> file in a text editor. At the top of the file notice the CHAN_NAME definition: <b>"rpmsg-client-sample"</b>. This is the same name that we pointed out above in the RPMsg Client Sample driver and this is how we ensure that our firmware probes that kernel module. The comments are fairly descriptive in the source code but I'll point out a few things here in the main() method:
<ul><li>An RPMsg channel is created using the <b>pru_rpmsg_channel</b> function. This is where we use the CHAN_NAME definition that matches our sample client module</li>
<li>After an interrupt is received (and we do the necessary checks to ensure that the interrupt corresponds to a message receive event) then we use the <b>pru_rpmsg_receive</b> function to receive the message from the other end of the channel</li>
<li>In this example we are simply echoing whatever message we received back to the sender. So we use the <b>rpmsg_pru_send</b> function and swap the src and dst values and send the message back.</li></ul></dd></dl>
<p><b>PRU Halt Firmware</b>
</p>
<dl><dd>This firmware is used to generate a valid firmware image for PRU0 in our example. We need to have a firmware that contains a resource_table section to be loaded into both PRU cores or else the pruss_remoteproc module will give us errors when we insert it. Since we did not need PRU0 to do anything in our example we just loaded it with a firmware that only has one instruction in the main method: __halt().</dd></dl>
<p><b>Putting It together</b>
</p>
<dl><dd>Both of our firmwares that we built were loaded into the PRU cores and the cores were ran. After this, but before inserting the client sample module, PRU0 halted itself and PRU1 created its side of an RPMsg channel with the name <b>"rpmsg-client-sample"</b>, and then began waiting for messages to arrive. After we inserted the rpmsg_client_sample module, the RPMsg channel creation was completed and a source and destination were assigned to both sides (the PRU chooses its source address with CHAN_PORT and the ARM address is assigned by the RPMsg Linux driver). Since an RPMsg channel was created with our special name the rpmsg_client_sample module's probe() function was called which started off a chain of 100 messages back and forth between the Linux kernel on the ARM and PRU1.</dd></dl>
<p><br />
</p>
<h3><span class="mw-headline" id="Part_2:_User_Space_Communication">Part 2: User Space Communication</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=34" title="Edit section: Part 2: User Space Communication">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<dl><dd>1. We are now going to make a very small modification to our PRU echo firmware which will allow it to create an RPMsg channel with a different Linux module (rpmsg_pru.ko) that exposes a character device interface to user space.
<dl><dd>a. Change the CHAN_NAME definition in <b>lab_5/solution/PRU_RPMsg_Echo_Interrupt1/main.c</b> from <b>"rpmsg-client-sample"</b> to <b>"rpmsg-pru"</b></dd>
<dd>b. Rebuild the firmware using either CCS or the Makefile using the steps given above</dd>
<dd>c. Copy the firmware to the <b>/lib/firmware</b> directory in your board's file system</dd>
<dd>d. Make sure that the <b>firmware</b> attribute in the remoteproc sysfs interface still points to the newly copied PRU_RPMsg_Echo_Interrupt1.out firmware (command given above)</dd></dl></dd>
<dd>2. If you haven't rebooted your board, remove the rpmsg_client_sample module
<dl><dd>a. <b>rmmod rpmsg_client_sample.ko</b> (will not be used in this part of the example)</dd></dl></dd>
<dd>3. Use the remoteproc sysfs interface to reload PRU1
<dl><dd>a. <b>echo 'stop' &gt; /sys/class/remoteproc/remoteproc2/state</b></dd>
<dd>b. <b>echo 'start' &gt; /sys/class/remoteproc/remoteproc2/state</b></dd></dl></dd>
<dd>4. Check to make sure a character device was created for our RPMsg channel
<dl><dd>a. <b>ls /dev/ | grep pru</b></dd>
<dd>b. There should be a character device named rpmsg_pru31 (since 31 was the CHAN_PORT in the PRU firmware)</dd>
<dd>c. You can 'echo' and 'cat' the rpmsg_pru31 device file
<dl><dd><ul><li><b>echo "Hello" &gt; /dev/rpmsg_pru31</b></li>
<li><b>echo "World" &gt; /dev/rpmsg_pru31</b></li>
<li><b>cat /dev/rpmsg_pru31</b> (you will need to type Ctrl+c after this command because of the way the read works)</li></ul>
<dl><dd><ul><li>You should see 'Hello' and 'World' echoed back to you on separate lines</li></ul></dd></dl></dd></dl></dd></dl></dd></dl>
<h4><span id="What_just_happened?_2"></span><span class="mw-headline" id="What_just_happened.3F_2">What just happened?</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=35" title="Edit section: What just happened?">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p><b>PRU RPMsg Echo Firmware</b>
</p>
<dl><dd>We changed the CHAN_NAME of our PRU firmware and then reloaded it. This channel name change causes our channel to connect to, and then probe, a completely different Linux kernel module. In this case, rpmsg_pru.ko.</dd></dl>
<p><b>PRU Halt Firmware</b>
</p>
<dl><dd>This firmware remained unchanged and just halts PRU0 once it has been loaded.</dd></dl>
<p><b>RPMsg PRU Module</b>
</p>
<dl><dd>Now we'll take a look at the RPMsg PRU module. Open up the file <b>/drivers/rpmsg/rpmsg_pru.c</b> from the Linux kernel source with a text editor. Note the .name attribute in the id_table is <b>"rpmsg-pru"</b> which matches our newly re-built PRU1 firmware CHAN_NAME definition. You can study the module source in depth if you'd like but the gist of it is that this module implements both the RPMsg functions necessary for communication between the PRU and the kernel as well as the functions needed to expose a character device file interface from the kernel to user space. Once the RPMsg channel is created the probe function will be called which creates the character device and places the device file in the /dev/ directory with the name rpmsg_pruX where X is the channel address of the PRU specified by the CHAN_PORT definition in the PRU firmware.</dd></dl>
<p><b>Putting It together</b>
</p>
<dl><dd>When we write to the character device file in the /dev/ directory (echo "Hello" &gt; /dev/rpmsg_pru31) the rpmsg_pru_write function is called which takes our message and sends it over RPMsg to the PRU core. When the PRU core echoes the message back, the rpmsg_pru_cb function is called which stores the message in a fifo in the kernel. When we read from the character device file in the /dev/ directory (cat /dev/rpmsg_pru31) the rpmsg_pru_read function is called which pulls messages from the kernel fifo and passes them to user space.</dd></dl>
<p><br />
</p>
<h3><span class="mw-headline" id="Part_3:_User_Space_Application">Part 3: User Space Application</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=36" title="Edit section: Part 3: User Space Application">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<dl><dd>1. Instead of using echo and cat to read and write our file from the command line, let's use a C program running in user space to pass messages back and forth with the PRU through the character device interface.
<dl><dd>a. Copy the <b>rpmsg_pru_user_space_echo.c</b> file from the labs/lab_5 directory to the home directory of your Beaglebone Black board</dd>
<dd>b. Check to make sure your '/dev/rpmsg_pru31' character device exists and is ready for communication. If not you need to load and start PRU1 using the firmware from Part 2 above.
<dl><dd><b>echo 'PRU_RPMsg_Echo_Interrupt1.out' &gt; /sys/class/remoteproc/remoteproc2/firmware</b></dd>
<dd><b>echo 'start' &gt; /sys/class/remoteproc/remoteproc2/state</b></dd></dl></dd>
<dd>c. Compile the C program using gcc on the A8
<dl><dd><b>gcc rpmsg_pru_user_space_echo.c -o rpmsg_pru_user_space_echo.out</b></dd></dl></dd>
<dd>d. Run the newly compiled user space application
<dl><dd><b>./rpmsg_pru_user_space_echo.out</b></dd>
<dd>At this point you should see 100 messages being passed back and forth between the application and PRU1 before the program exits. This program is meant to mimic the earlier echo example that was running from kernel space. This example accomplishes the same thing from a user space application using the character device interface exposed by the rpmsg_pru.ko module.</dd></dl></dd></dl></dd></dl>
<h4><span id="What_just_happened?_3"></span><span class="mw-headline" id="What_just_happened.3F_3">What just happened?</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=37" title="Edit section: What just happened?">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p><b>rpmsg_pru_user_space_echo.c</b>
</p>
<dl><dd>Open the provided C file with a text editor and take a look at its contents. We open the character device file with read and write permissions (if it exists) and then we send a 'hello world!' message to the PRU. We then use the poll interface of the character device to wait on a response from the PRU. Once a response is received we print it to the console. We do this for 100 message and exit the program.</dd></dl>
<p><b>Putting It together</b>
</p>
<dl><dd>We use CHAN_NAME <b>"rpmsg-pru"</b> in our PRU firmware in order to connect with the module that exposes the character device interface at /dev/rpmsg_pru31. We then open, read, write, and close that character device file using our user space C application. The written messages are sent down to the PRU core, the PRU core echoes the message back, and then the message is read back at the C program. This is an arbitrary example but this setup can be modified to enable any number of use cases that call for PRU&lt;-&gt;Linux user space communication. Lab 6 will expand on this slightly and show a use case where the blinking of LEDs can be controlled from user space messages sent to a PRU core.</dd></dl>
<p><br />
</p>
<h1><span class="mw-headline" id="LAB_6:_Blinking_LEDs_with_RPMsg_from_Linux_User_Space">LAB 6: Blinking LEDs with RPMsg from Linux User Space</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=38" title="Edit section: LAB 6: Blinking LEDs with RPMsg from Linux User Space">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h2><span class="mw-headline" id="Objective_6">Objective</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=39" title="Edit section: Objective">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>This lab will shows a PRU firmware that can parse an RPMsg message from Linux user space and toggle LEDs accordingly. Part 1 will use the echo command from the Linux command line to send a message containing which LEDs to toggle through RPMsg to PRU0. Part 2 will use a shell script to ask the user which LED(s) should be toggled and then sends the response to PRU0 through RPMsg.  <b>It is expected that you have completed and understand <a href="PRU_Training__Hands-on_Labs.html#LAB_4:_Introduction_to_Linux_driver" title="PRU Training: Hands-on Labs"> Lab 4</a> and <a href="PRU_Training__Hands-on_Labs.html#LAB_5:_RPMsg_Communication_between_ARM_and_PRU" title="PRU Training: Hands-on Labs"> Lab 5</a> before beginning this lab. </b>
</p>
<h2><span class="mw-headline" id="Lab_Steps_6">Lab Steps</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=40" title="Edit section: Lab Steps">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h3><span class="mw-headline" id="Build_the_PRU_Firmware_3">Build the PRU Firmware</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=41" title="Edit section: Build the PRU Firmware">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<h4><span class="mw-headline" id="Using_CCSv6_2">Using CCSv6</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=42" title="Edit section: Using CCSv6">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<dl><dd>1. Launch CCSv6 and select the default Workspace</dd>
<dd>2. Import the <b>PRU_RPMsg_LED0</b> project from the lab_6 solution folder
<dl><dd>a. <b>Project-&gt;Import CCS Projects...</b></dd>
<dd>b. Click <b>Browse...</b></dd>
<dd>c. Navigate to <i>&lt;PRU_SW_PATH&gt;/labs/lab_6/solution</i> and click <b>OK</b> (where &lt;PRU_SW_PATH&gt; is the path to your PRU Software Support Package installation)</dd>
<dd>d. Click the checkbox next to the project in order to select it and then click <b>Finish</b> (you do not need to check 'Automatically import referenced projects...' or 'Copy project into workspace')
<dl><dd><a href="File_Lab6_import.html" class="image"><img alt="Lab6 import.PNG" src="https://processors.wiki.ti.com/images/b/b2/Lab6_import.PNG" width="613" height="668" /></a></dd></dl></dd></dl></dd>
<dd>3. Make sure that the compiler include options for the project point to the include folder provided with the software package
<dl><dd>a. <b>Right-click on the project in the Project Explorer and then click Properties</b></dd>
<dd>b. Expand <b>Build</b> then expand <b>PRU Compiler</b> and then click on <b>Include Options</b></dd>
<dd>c. Make sure that <b>"../../../../../include"</b> is there as an include path</dd>
<dd>d. Also make sure that <b>"../../../../../include/am335x"</b> is there as an include path
<dl><dd><a href="File_2_0-Lab6_include_path.html" class="image"><img alt="2 0-Lab6 include path.PNG" src="https://processors.wiki.ti.com/images/5/5b/2_0-Lab6_include_path.PNG" width="932" height="618" /></a></dd></dl></dd>
<dd>d. Click <b>OK</b></dd></dl></dd>
<dd>4. Make sure that the <b>rpmsg_lib</b> library is added in the project
<dl><dd>a. <b>Right-click on PRU_RPMsg_LED0 in the Project Explorer and then click Properties</b></dd>
<dd>b. Expand <b>Build</b> then expand <b>PRU Linker</b> and then click on <b>File Search Path</b></dd>
<dd>c. Make sure that <b>"../../../../../lib/rpmsg_lib.lib"</b> is there as an included library file
<dl><dd><a href="File_Lab6_include_library.html" class="image"><img alt="Lab6 include library.png" src="https://processors.wiki.ti.com/images/e/eb/Lab6_include_library.png" width="933" height="636" /></a></dd></dl></dd>
<dd>d. Click <b>OK</b></dd></dl></dd>
<dd>5. Build the project and make sure there are no errors
<dl><dd>a. <b>Right-click on the project in the Project Explorer and then click Rebuild Project</b></dd></dl></dd></dl>
<h4><span class="mw-headline" id="Using_the_Provided_Makefile_2">Using the Provided Makefile</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=43" title="Edit section: Using the Provided Makefile">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<dl><dd>6. Open a command prompt or terminal window</dd>
<dd>7. Set the PRU_CGT environment variable to point to the PRU code generation tools folder. This folder is included in the Linux Processor SDK v2.0.2.11 and newer.
<dl><dd>a. Linux: <b>export PRU_CGT=&lt;path_to_Linux_proc_sdk&gt;/linux-devkit/sysroots/x86_64-arago-linux/usr/share/ti/cgt-pru</b></dd>
<dd>b. Windows: <b>set PRU_CGT=C:/TI/ccs_v6_0_1/ccsv6/tools/compiler/ti-cgt-pru_2.1.0</b></dd></dl></dd>
<dd>8. Change to the PRU_RPMsg_LED0 directory
<dl><dd>a. <b>cd &lt;PRU_SW_PATH&gt;/labs/lab_6/solution/PRU_RPMsg_LED0</b></dd></dl></dd>
<dd>9. Clean the previously generated files if they exist.
<dl><dd>a. <b>make clean</b></dd></dl></dd>
<dd>10. Build the project.
<dl><dd>a. <b>make</b></dd>
<dd>The output for the project should be similar to the below screen shot:
<dl><dd><a href="File_Lab6_build_project.html" class="image"><img alt="Lab6 build project.png" src="https://processors.wiki.ti.com/images/d/db/Lab6_build_project.png" width="814" height="793" /></a></dd></dl></dd></dl></dd></dl>
<p><br />
</p>
<h3><span class="mw-headline" id="Copy_files_to_the_target_file_system_2">Copy files to the target file system</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=44" title="Edit section: Copy files to the target file system">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<dl><dd>Now we need to move our built files to the file system on the board.</dd></dl>
<dl><dd>11. Copy the <b>PRU_RPMsg_LED0.out</b> file that we generated above to the <b>/lib/firmware</b> directory in your file system. Keep in mind that the .out file will be in different locations depending on whether you built with CCS (Debug or Release folder) or with the Makefile (gen folder).</dd>
<dd>12. Now copy the <b>PRU_Halt.out</b> file (that we generated in <a href="PRU_Training__Hands-on_Labs.html#LAB_5:_RPMsg_Communication_between_ARM_and_PRU" title="PRU Training: Hands-on Labs"> Lab 5</a>) to the <b>/lib/firmware</b> directory.</dd></dl>
<dl><dd>Now we should have the two PRU firmwares in the /lib/firmware directory.</dd></dl>
<p><br />
</p>
<h3><span class="mw-headline" id="Part_1:_Linux_Command_Line_LED_Toggling">Part 1: Linux Command Line LED Toggling</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=45" title="Edit section: Part 1: Linux Command Line LED Toggling">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<dl><dd>This lab assumes that the Linux device tree modifications have been made to allow PRU0 to control the LEDs on the PRU cape. See <a href="PRU_Training__Hands-on_Labs.html#LAB_4:_Introduction_to_Linux_driver" title="PRU Training: Hands-on Labs"> Lab 4</a>.</dd></dl>
<dl><dd>1. The modules necessary for this lab are included in the default Linux configuration of the Linux Processor SDK.</dd>
<dd>2. After the board finishes booting you need to use the remoteproc sysfs interface to point the driver to the correct firmwares and then load and run them.
<dl><dd>a. <b>echo 'PRU_RPMsg_LED0.out' &gt; /sys/class/remoteproc/remoteproc1/firmware</b></dd>
<dd>b. <b>echo 'PRU_Halt.out' &gt; /sys/class/remoteproc/remoteproc2/firmware</b></dd>
<dd>c. <b>echo 'start' &gt; /sys/class/remoteproc/remoteproc1/state</b></dd>
<dd>d. <b>echo 'start' &gt; /sys/class/remoteproc/remoteproc2/state</b></dd></dl></dd>
<dd>3. Check to make sure the RPMsg PRU character device has been created
<dl><dd>a. <b>ls /dev/ | grep pru</b></dd>
<dd>b. You should see rpmsg_pru30 in the list of devices (because 30 is the CHAN_PORT we used in the PRU_PRMsg_LED0 firmware)</dd></dl></dd>
<dd>4. Send an RPMsg message from the Linux command line to turn on the Red ('r' or 'R'), Blue ('b' or 'B'), Orange ('o' or 'O'), or Green ('g' or 'G') LED on the PRU cape
<dl><dd>a. <b>echo "r" &gt; /dev/rpmsg_pru30</b></dd>
<dd>b. <b>echo "G" &gt; /dev/rpmsg_pru30</b></dd>
<dd>c. <b>echo "rgbo" &gt; /dev/rpmsg_pru30</b>
<dl><dd>Each time you echo a string into the PRU, you should see the corresponding LEDs toggle on the PRU cape.</dd></dl></dd></dl></dd></dl>
<h4><span id="What_just_happened?_4"></span><span class="mw-headline" id="What_just_happened.3F_4">What just happened?</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=46" title="Edit section: What just happened?">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p><b>PRU_RPMsg_LED0</b>
</p>
<dl><dd>Open the main.c file provided in the labs/lab_6/solution/PRU_RPMsg_LED0 folder in a text editor. Notice that CHAN_NAME is "rpmsg-pru" which matches our Linux driver at drivers/rpmsg/rpmsg_pru.c. Also notice that CHAN_PORT is 30 in this example which creates a character device at /dev/rpmsg_pru30. Once a message is received its payload is iterated through looking for any of our LED characters ('rgboRGBO') and if one is found that LED color is toggled using register R30.</dd></dl>
<dl><dd>If there were other tasks that the PRU firmware needed to handle, outside of receiving messages, then using interrupts to check for new messages would be faster. <b>Interrupt based and polling based RPMsg examples are provided for each PRU core in the examples folder of the PRU Software Support Package.</b></dd></dl>
<p><b>Putting It together</b>
</p>
<dl><dd>This example once again connects the PRU firmware with Linux user space using the rpmsg_pru.ko module. As you write to the character device file (using the echo commands) the messages are passed to PRU0 where they are parsed looking for the LED colors to toggle. When a character that corresponds to a color is found by PRU0, that LED is toggled on the PRU cape.</dd></dl>
<p><br />
</p>
<h3><span class="mw-headline" id="Part_2:_Linux_Shell_Script_LED_Toggling">Part 2: Linux Shell Script LED Toggling</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=47" title="Edit section: Part 2: Linux Shell Script LED Toggling">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<dl><dd>This lab assumes that you have just completed Part 1 above and the rpmsg_pru30 character device still exists and the PRU_RPMsg_LED0 firmware is still loaded into PRU0.</dd></dl>
<dl><dd>1. Copy the pru0_led.sh file from the labs/lab_6/ folder into the file system of your board</dd>
<dd>2. On the board, navigate to the directory where you just copied the script and execute it
<dl><dd>a. <b>./pru0_led.sh</b> (If it does not execute, try giving it execute permissions: <b>chmod +x pru0_led.sh</b>)</dd>
<dd>b. You should get a prompt at the command line asking you to enter a color to toggle. Follow the directions and the LEDs on the PRU cape should light up and turn off. Type 'q' to quit the script and return to the command line.</dd></dl></dd></dl>
<h4><span id="What_just_happened?_5"></span><span class="mw-headline" id="What_just_happened.3F_5">What just happened?</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=48" title="Edit section: What just happened?">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p><b>pru0_led.sh</b>
</p>
<dl><dd>Open the pru0_led.sh script found in the /labs/lab_6/ folder in a text editor. This is a very simple script that asks for user input and then passes it down to PRU0 by using the echo command and the character device file.</dd></dl>
<p><br />
</p>
<h1><span class="mw-headline" id="Archive">Archive</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit&amp;section=49" title="Edit section: Archive">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<ul><li><a rel="nofollow" class="external text" href="index7be0.html?title=PRU_Training:_Hands-on_Labs&amp;oldid=229500"><i> <u><b>Processor SDK Linux 03.03.00.04</b></u></i></a></li>
<li><a rel="nofollow" class="external text" href="indexaf01.html?title=PRU_Training:_Hands-on_Labs&amp;oldid=221969"><i> <u><b>Processor SDK Linux 03.00.00.04</b></u></i></a></li>
<li><a rel="nofollow" class="external text" href="indexaa23.html?title=PRU_Training:_Hands-on_Labs&amp;oldid=219560"><i> <u><b>Processor SDK Linux 02.00.02.11</b></u></i></a></li>
<li><a rel="nofollow" class="external text" href="index83b7.html?title=PRU_Training:_Hands-on_Labs&amp;oldid=214826"><i> <u><b>Processor SDK Linux 02.00.01.07</b></u></i></a></li>
<li><a rel="nofollow" class="external text" href="indexe351.html?title=PRU_Training:_Hands-on_Labs&amp;oldid=212302"><i> <u><b>Processor SDK Linux 02.00.00.00</b></u></i></a></li>
<li><a rel="nofollow" class="external text" href="indexf003.html?title=PRU_Training:_Hands-on_Labs&amp;oldid=208553"><i> <u><b>Processor SDK Linux 01.00.00.03</b></u></i></a></li>
<li><a rel="nofollow" class="external text" href="index604b.html?title=PRU_Training:_Hands-on_Labs&amp;oldid=205024"><i> <u><b>Processor SDK Linux 1.00.00.00</b></u></i></a></li></ul>

<!-- 
NewPP limit report
Cached time: 20201201052004
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.189 seconds
Real time usage: 0.204 seconds
Preprocessor visited node count: 824/1000000
Preprocessor generated node count: 4388/1000000
Post‐expand include size: 7983/2097152 bytes
Template argument size: 7196/2097152 bytes
Highest expansion depth: 3/40
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 0/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%   28.638      1 -total
 14.52%    4.157      1 Template:ArchiveLinks-ProcSDKv01.00.00.03
 13.29%    3.806      1 Template:ArchiveLinks-ProcSDKv02.00.01.07
 11.61%    3.324      1 Template:ArchiveLinks-ProcSDKv03.00.00.04
 11.26%    3.224      1 Template:ArchiveLinks-ProcSDKv03.03.00.04
 10.98%    3.145      1 Template:ArchiveLinks-ProcSDKLinux-1.00.00.00
 10.74%    3.077      1 Template:ArchiveLinks-ProcSDKv02.00.02.11
  9.30%    2.664      1 Template:ArchiveLinks-ProcSDKv02.00.00.00
  9.30%    2.662     17 Template:SpNote
-->
</div>
<!-- Saved in parser cache with key procwiki:pcache:idhash:36166-0!canonical and timestamp 20201201052004 and revision id 236565
 -->
<div class='hf-nsfooter' id='hf-nsfooter-'><table style="text-align:center; background:white; width:100%; text-align:left; height: 65px border-top: 1px solid; border-bottom: 1px solid; border-left: 1px solid; border-right: 1px solid; border-width: 1px; border-style: solid;">
<tr>
<td width="305px"><a href="File_E2e.html" class="image"><img alt="E2e.jpg" src="https://processors.wiki.ti.com/images/8/82/E2e.jpg" width="305" height="63" /></a>
</td>
<td>{{
<ol><li>switchcategory:MultiCore=</li></ol>
<ul><li>For technical support on MultiCore devices, please post your questions in the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/c6000_multi-core_dsps/default.aspx">C6000 MultiCore Forum</a></li>
<li>For questions related to the BIOS MultiCore SDK (MCSDK), please use the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/embedded/f/355.aspx">BIOS Forum</a></li></ul>
<p>Please post only comments related to the article <b>PRU Training: Hands-on Labs</b> here.<i></i>
</p>
</td>
<td>Keystone=
<ul><li>For technical support on MultiCore devices, please post your questions in the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/c6000_multi-core_dsps/default.aspx">C6000 MultiCore Forum</a></li>
<li>For questions related to the BIOS MultiCore SDK (MCSDK), please use the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/embedded/f/355.aspx">BIOS Forum</a></li></ul>
<p>Please post only comments related to the article <b>PRU Training: Hands-on Labs</b> here.<i></i>
</p>
</td>
<td>C2000=<i>For technical support on the C2000 please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/microcontrollers/tms320c2000_32-bit_real-time_mcus/f/171.aspx">The C2000 Forum</a>. Please post only comments about the article <b>PRU Training: Hands-on Labs</b> here.</i>
</td>
<td>DaVinci=<i>For technical support on DaVincoplease post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/davinci_digital_media_processors/default.aspx">The DaVinci Forum</a>. Please post only comments about the article <b>PRU Training: Hands-on Labs</b> here.</i>
</td>
<td>MSP430=<i>For technical support on MSP430 please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/microcontrollers/msp43016-bit_ultra-low_power_mcus/default.aspx">The MSP430 Forum</a>. Please post only comments about the article <b>PRU Training: Hands-on Labs</b> here.</i>
</td>
<td>OMAP35x=<i>For technical support on OMAP please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/omap_applications_processors/default.aspx">The OMAP Forum</a>. Please post only comments about the article <b>PRU Training: Hands-on Labs</b> here.</i>
</td>
<td>OMAPL1=<i>For technical support on OMAP please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/omap_applications_processors/default.aspx">The OMAP Forum</a>. Please post only comments about the article <b>PRU Training: Hands-on Labs</b> here.</i>
</td>
<td>MAVRK=<i>For technical support on MAVRK please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/development_tools/mavrk/default.aspx">The MAVRK Toolbox Forum</a>. Please post only comments about the article <b>PRU Training: Hands-on Labs</b> here.</i>
</td>
<td><i>For technical support please post your questions at <a rel="nofollow" class="external text" href="http://e2e.ti.com/">http://e2e.ti.com</a>. Please post only comments about the article <b>PRU Training: Hands-on Labs</b> here.</i>
<p>}}
</p>
</td></tr></table>
<table style="border-style:solid; border-width:1px; text-align:center; width:100%;">

<tr style="font-size:150%;">
<td rowspan="2"><a href="File_Hyperlink_blue.html" class="image"><img alt="Hyperlink blue.png" src="https://processors.wiki.ti.com/images/9/9f/Hyperlink_blue.png" width="96" height="96" /></a>
</td>
<td><b>Links</b>
</td></tr>
<tr>
<td>
<table style="text-align: left;">
<tr>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/amplifier_and_linear.page">Amplifiers &amp; Linear</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/audio/audio_overview.page">Audio</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/rfif.page">Broadband RF/IF &amp; Digital Radio</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/clocksandtimers/clocks_and_timers.page">Clocks &amp; Timers</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/dataconverters/data_converter.page">Data Converters</a>
</p>
</td>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/mems/mems.page">DLP &amp; MEMS</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/high_reliability.page">High-Reliability</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/interface/interface.page">Interface</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/logic/home_overview.page">Logic</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/powermanagement/power_portal.page">Power Management</a>
</p>
</td>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/dsp/embedded_processor.page">Processors</a>
</p>
<ul><li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/dsp/arm.page">ARM Processors</a></li>
<li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/dsp/home.page">Digital Signal Processors (DSP)</a></li>
<li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/microcontroller/home.page">Microcontrollers (MCU)</a></li>
<li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/omap-applications-processors/the-omap-experience.page">OMAP Applications Processors</a></li></ul>
</td>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/switches_and_multiplexers.page">Switches &amp; Multiplexers</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/temperature_sensor.page">Temperature Sensors &amp; Control ICs</a><br/>
<a rel="nofollow" class="external text" href="http://focus.ti.com/wireless/docs/wirelessoverview.tsp?familyId=2003&amp;sectionId=646&amp;tabId=2735">Wireless Connectivity</a>
</p>
</td></tr></table>
</td></tr></table>
<div id="tiPrivacy"></div>
</div></div>					<div class="printfooter">
						Retrieved from "<a dir="ltr" href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;oldid=236565">https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;oldid=236565</a>"					</div>
				<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="Special_Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="https://processors.wiki.ti.com/index.php?title=Category:Pages_with_broken_file_links&amp;action=edit&amp;redlink=1" class="new" title="Category:Pages with broken file links (page does not exist)">Pages with broken file links</a></li></ul></div></div>				<div class="visualClear"></div>
							</div>
		</div>
		<div id="mw-navigation">
			<h2>Navigation menu</h2>
			<div id="mw-head">
									<div id="p-personal" role="navigation" class="" aria-labelledby="p-personal-label">
						<h3 id="p-personal-label">Personal tools</h3>
						<ul>
							<li id="pt-login"><a href="https://processors.wiki.ti.com/index.php?title=Special:UserLogin&amp;returnto=PRU+Training%3A+Hands-on+Labs" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li><li id="pt-createaccount"><a href="Special_RequestAccount.html" title="You are encouraged to create an account and log in; however, it is not mandatory">Request account</a></li>						</ul>
					</div>
									<div id="left-navigation">
										<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
						<h3 id="p-namespaces-label">Namespaces</h3>
						<ul>
							<li id="ca-nstab-main" class="selected"><span><a href="PRU_Training__Hands-on_Labs.html" title="View the content page [c]" accesskey="c">Page</a></span></li><li id="ca-talk" class="new"><span><a href="https://processors.wiki.ti.com/index.php?title=Talk:PRU_Training:_Hands-on_Labs&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page (page does not exist) [t]" accesskey="t">Discussion</a></span></li>						</ul>
					</div>
										<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
												<input type="checkbox" class="vectorMenuCheckbox" aria-labelledby="p-variants-label" />
						<h3 id="p-variants-label">
							<span>Variants</span>
						</h3>
						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
									</div>
				<div id="right-navigation">
										<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
						<h3 id="p-views-label">Views</h3>
						<ul>
							<li id="ca-view" class="collapsible selected"><span><a href="PRU_Training__Hands-on_Labs.html">Read</a></span></li><li id="ca-viewsource" class="collapsible"><span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></span></li><li id="ca-history" class="collapsible"><span><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=history" title="Past revisions of this page [h]" accesskey="h">View history</a></span></li>						</ul>
					</div>
										<div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label">
						<input type="checkbox" class="vectorMenuCheckbox" aria-labelledby="p-cactions-label" />
						<h3 id="p-cactions-label"><span>More</span></h3>
						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
										<div id="p-search" role="search">
						<h3>
							<label for="searchInput">Search</label>
						</h3>
						<form action="https://processors.wiki.ti.com/index.php" id="searchform">
							<div id="simpleSearch">
								<input type="search" name="search" placeholder="Search Texas Instruments Wiki" title="Search Texas Instruments Wiki [f]" accesskey="f" id="searchInput"/><input type="hidden" value="Special:Search" name="title"/><input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton mw-fallbackSearchButton"/><input type="submit" name="go" value="Go" title="Go to a page with this exact name if it exists" id="searchButton" class="searchButton"/>							</div>
						</form>
					</div>
									</div>
			</div>
			<div id="mw-panel">
				<div id="p-logo" role="banner"><a class="mw-wiki-logo" href="Main_Page.html"  title="Visit the main page"></a></div>
						<div class="portal" role="navigation" id="p-navigation" aria-labelledby="p-navigation-label">
			<h3 id="p-navigation-label">Navigation</h3>
			<div class="body">
								<ul>
					<li id="n-mainpage"><a href="Main_Page.html" title="Visit the main page [z]" accesskey="z">Main Page</a></li><li id="n-All-pages"><a href="Special_AllPages.html">All pages</a></li><li id="n-All-categories"><a href="Special_Categories.html">All categories</a></li><li id="n-recentchanges"><a href="Special_RecentChanges.html" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li><li id="n-randompage"><a href="Package_Reflow_Profiles.html" title="Load a random page [x]" accesskey="x">Random page</a></li><li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" title="The place to find out">Help</a></li>				</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id="p-tb" aria-labelledby="p-tb-label">
			<h3 id="p-tb-label">Toolbox</h3>
			<div class="body">
								<ul>
					<li id="t-whatlinkshere"><a href="Special_WhatLinksHere/PRU_Training__Hands-on_Labs.html" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li><li id="t-recentchangeslinked"><a href="Special_RecentChangesLinked/PRU_Training__Hands-on_Labs.html" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li><li id="t-specialpages"><a href="Special_SpecialPages.html" title="A list of all special pages [q]" accesskey="q">Special pages</a></li><li id="t-print"><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li><li id="t-permalink"><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;oldid=236565" title="Permanent link to this revision of the page">Permanent link</a></li><li id="t-info"><a href="https://processors.wiki.ti.com/index.php?title=PRU_Training:_Hands-on_Labs&amp;action=info" title="More information about this page">Page information</a></li>				</ul>
							</div>
		</div>
				</div>
		</div>
				<div id="footer" role="contentinfo">
						<ul id="footer-info">
								<li id="footer-info-lastmod"> This page was last edited on 22 April 2019, at 10:59.</li>
								<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-ShareAlike</a> unless otherwise noted.</li>
							</ul>
						<ul id="footer-places">
								<li id="footer-places-privacy"><a href="Project_Privacy_policy.html" title="Project:Privacy policy">Privacy policy</a></li>
								<li id="footer-places-about"><a href="Project_About.html" title="Project:About">About Texas Instruments Wiki</a></li>
								<li id="footer-places-disclaimer"><a href="Project_General_disclaimer.html" title="Project:General disclaimer">Disclaimers</a></li>
								<li id="footer-places-termsofservice"><a href="Project_Terms_of_Service.html" title="Project:Terms of Service">Terms of Use</a></li>
							</ul>
										<ul id="footer-icons" class="noprint">
										<li id="footer-copyrightico">
						<a href="http://creativecommons.org/licenses/by-sa/3.0/"><img src="https://processors.wiki.ti.com/resources/assets/licenses/cc-by-sa.png" alt="Creative Commons Attribution-ShareAlike" width="88" height="31"/></a>					</li>
										<li id="footer-poweredbyico">
						<a href="http://www.mediawiki.org/"><img src="https://processors.wiki.ti.com/resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31"/></a>					</li>
									</ul>
						<div style="clear: both;"></div>
		</div>
		<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgPageParseReport":{"limitreport":{"cputime":"0.189","walltime":"0.204","ppvisitednodes":{"value":824,"limit":1000000},"ppgeneratednodes":{"value":4388,"limit":1000000},"postexpandincludesize":{"value":7983,"limit":2097152},"templateargumentsize":{"value":7196,"limit":2097152},"expansiondepth":{"value":3,"limit":40},"expensivefunctioncount":{"value":0,"limit":100},"unstrip-depth":{"value":0,"limit":20},"unstrip-size":{"value":0,"limit":5000000},"timingprofile":["100.00%   28.638      1 -total"," 14.52%    4.157      1 Template:ArchiveLinks-ProcSDKv01.00.00.03"," 13.29%    3.806      1 Template:ArchiveLinks-ProcSDKv02.00.01.07"," 11.61%    3.324      1 Template:ArchiveLinks-ProcSDKv03.00.00.04"," 11.26%    3.224      1 Template:ArchiveLinks-ProcSDKv03.03.00.04"," 10.98%    3.145      1 Template:ArchiveLinks-ProcSDKLinux-1.00.00.00"," 10.74%    3.077      1 Template:ArchiveLinks-ProcSDKv02.00.02.11","  9.30%    2.664      1 Template:ArchiveLinks-ProcSDKv02.00.00.00","  9.30%    2.662     17 Template:SpNote"]},"cachereport":{"timestamp":"20201201052004","ttl":86400,"transientcontent":false}}});});</script><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":242});});</script>
	</body>

<!-- Mirrored from processors.wiki.ti.com/index.php/PRU_Training:_Hands-on_Labs by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 01 Dec 2020 08:48:11 GMT -->
</html>
