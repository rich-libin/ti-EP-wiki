<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">

<!-- Mirrored from processors.wiki.ti.com/index.php/AMSDK_u-boot_User%27s_Guide by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 01 Dec 2020 06:23:23 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8"/>
<title>AMSDK u-boot User's Guide - Texas Instruments Wiki</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"AMSDK_u-boot_User's_Guide","wgTitle":"AMSDK u-boot User's Guide","wgCurRevisionId":218015,"wgRevisionId":218015,"wgArticleId":13619,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["AM335x"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"AMSDK_u-boot_User's_Guide","wgRelevantArticleId":13619,"wgRequestId":"f89cc487305990d55145e2c6","wgIsProbablyEditable":false,"wgRelevantPageIsProbablyEditable":false,"wgRestrictionEdit":["sysop"],"wgRestrictionMove":["sysop"]});mw.loader.state({"site.styles":"ready","noscript":"ready","user.styles":"ready","user":"ready","user.options":"ready","user.tokens":"loading","mediawiki.legacy.shared":"ready","mediawiki.legacy.commonPrint":"ready","mediawiki.sectionAnchor":"ready","mediawiki.skinning.interface":"ready","skins.vector.styles":"ready"});mw.loader.implement("user.tokens@19o3a1s",function($,jQuery,require,module){/*@nomin*/mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});
});mw.loader.load(["site","mediawiki.page.startup","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.toc","mediawiki.searchSuggest","skins.vector.js"]);});</script>
<link rel="stylesheet" href="https://processors.wiki.ti.com/load.php?debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.interface%7Cskins.vector.styles&amp;only=styles&amp;skin=vector"/>
<script async="" src="https://processors.wiki.ti.com/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=vector"></script>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="https://processors.wiki.ti.com/load.php?debug=false&amp;lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=vector"/>
<meta name="generator" content="MediaWiki 1.31.6"/>
<link rel="shortcut icon" href="https://processors.wiki.ti.com/favicon.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="https://processors.wiki.ti.com/opensearch_desc.php" title="Texas Instruments Wiki (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="https://processors.wiki.ti.com/api.php?action=rsd"/>
<link rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/"/>
<link rel="alternate" type="application/atom+xml" title="Texas Instruments Wiki Atom feed" href="https://processors.wiki.ti.com/index.php?title=Special:RecentChanges&amp;feed=atom"/>
<!--[if lt IE 9]><script src="/load.php?debug=false&amp;lang=en&amp;modules=html5shiv&amp;only=scripts&amp;skin=Vector&amp;sync=1"></script><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-AMSDK_u-boot_User_s_Guide rootpage-AMSDK_u-boot_User_s_Guide skin-vector action-view">		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<div id="content" class="mw-body" role="main">
			<a id="top"></a>
			<div id="siteNotice" class="mw-body-content"><div id="localNotice" lang="en" dir="ltr"><div class="mw-parser-output"><p><br />
<span style="color:#ff0000"><b>NOTICE: The Processors Wiki will End-of-Life on January 15, 2021. It is recommended to download any files or other content you may need that are hosted on processors.wiki.ti.com. The site is now set to read only.</b></span>
</p></div></div></div><div class="mw-indicators mw-body-content">
</div>
<h1 id="firstHeading" class="firstHeading" lang="en">AMSDK u-boot User's Guide</h1>			<div id="bodyContent" class="mw-body-content">
				<div id="siteSub" class="noprint">From Texas Instruments Wiki</div>				<div id="contentSub"></div>
								<div id="jump-to-nav" class="mw-jump">
					Jump to:					<a href="#mw-head">navigation</a>, 					<a href="#p-search">search</a>
				</div>
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output"><p><b><big><big><big><span style="color:red">Content is no longer maintained and is being kept for reference only!</span></big></big></big></b>
<br />
</p><p><br />
Return to the <a href="Sitara_Linux_Software_Developer%e2%80%99s_Guide.html" title="Sitara Linux Software Developer’s Guide"><u><b>Sitara Linux Software Developer's Guide</b></u></a> 
</p><p><a href="File_TIBanner.html" class="image"><img alt="TIBanner.png" src="https://processors.wiki.ti.com/images/c/cd/TIBanner.png" width="667" height="87" /></a> 
</p>
<div id="toc" class="toc"><div class="toctitle" lang="en" dir="ltr"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Overview"><span class="tocnumber">1</span> <span class="toctext">Overview</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#General_Information"><span class="tocnumber">2</span> <span class="toctext">General Information</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Updated_Toolchain"><span class="tocnumber">2.1</span> <span class="toctext">Updated Toolchain</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Building_MLO_and_u-boot"><span class="tocnumber">2.2</span> <span class="toctext">Building MLO and u-boot</span></a>
<ul>
<li class="toclevel-3 tocsection-5"><a href="#Cleaning_the_Sources"><span class="tocnumber">2.2.1</span> <span class="toctext">Cleaning the Sources</span></a></li>
<li class="toclevel-3 tocsection-6"><a href="#Compiling_MLO_and_u-boot"><span class="tocnumber">2.2.2</span> <span class="toctext">Compiling MLO and u-boot</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-7"><a href="#U-Boot_Environment"><span class="tocnumber">2.3</span> <span class="toctext">U-Boot Environment</span></a>
<ul>
<li class="toclevel-3 tocsection-8"><a href="#Restoring_defaults"><span class="tocnumber">2.3.1</span> <span class="toctext">Restoring defaults</span></a></li>
<li class="toclevel-3 tocsection-9"><a href="#Networking_Environment"><span class="tocnumber">2.3.2</span> <span class="toctext">Networking Environment</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-10"><a href="#Working_with_USB_Device_Firmware_Upgrade"><span class="tocnumber">2.4</span> <span class="toctext">Working with USB Device Firmware Upgrade</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-11"><a href="#Using_the_network_.28Wired_or_USB.29"><span class="tocnumber">3</span> <span class="toctext">Using the network (Wired or USB)</span></a>
<ul>
<li class="toclevel-2 tocsection-12"><a href="#Booting_U-Boot_from_the_network"><span class="tocnumber">3.1</span> <span class="toctext">Booting U-Boot from the network</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#Multiple_Interfaces"><span class="tocnumber">3.2</span> <span class="toctext">Multiple Interfaces</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="#Network_configuration_via_DHCP"><span class="tocnumber">3.3</span> <span class="toctext">Network configuration via DHCP</span></a></li>
<li class="toclevel-2 tocsection-15"><a href="#Manual_network_configuration"><span class="tocnumber">3.4</span> <span class="toctext">Manual network configuration</span></a></li>
<li class="toclevel-2 tocsection-16"><a href="#Booting_Linux_from_the_network"><span class="tocnumber">3.5</span> <span class="toctext">Booting Linux from the network</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="#Automatically_programming_flash_from_a_network_boot"><span class="tocnumber">3.6</span> <span class="toctext">Automatically programming flash from a network boot</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-18"><a href="#Using_NAND"><span class="tocnumber">4</span> <span class="toctext">Using NAND</span></a>
<ul>
<li class="toclevel-2 tocsection-19"><a href="#Writing_to_NAND_from_U-Boot"><span class="tocnumber">4.1</span> <span class="toctext">Writing to NAND from U-Boot</span></a></li>
<li class="toclevel-2 tocsection-20"><a href="#Writing_to_NAND_via_DFU"><span class="tocnumber">4.2</span> <span class="toctext">Writing to NAND via DFU</span></a></li>
<li class="toclevel-2 tocsection-21"><a href="#Booting_from_NAND"><span class="tocnumber">4.3</span> <span class="toctext">Booting from NAND</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-22"><a href="#Using_removable_media"><span class="tocnumber">5</span> <span class="toctext">Using removable media</span></a>
<ul>
<li class="toclevel-2 tocsection-23"><a href="#Updating_an_SD_card_from_a_host_PC"><span class="tocnumber">5.1</span> <span class="toctext">Updating an SD card from a host PC</span></a></li>
<li class="toclevel-2 tocsection-24"><a href="#Updating_an_SD_card_or_eMMC_using_DFU"><span class="tocnumber">5.2</span> <span class="toctext">Updating an SD card or eMMC using DFU</span></a></li>
<li class="toclevel-2 tocsection-25"><a href="#Booting_Linux_from_SD_card"><span class="tocnumber">5.3</span> <span class="toctext">Booting Linux from SD card</span></a></li>
<li class="toclevel-2 tocsection-26"><a href="#Booting_Linux_from_USB_storage"><span class="tocnumber">5.4</span> <span class="toctext">Booting Linux from USB storage</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-27"><a href="#Using_SPI"><span class="tocnumber">6</span> <span class="toctext">Using SPI</span></a>
<ul>
<li class="toclevel-2 tocsection-28"><a href="#Writing_to_SPI_from_U-Boot"><span class="tocnumber">6.1</span> <span class="toctext">Writing to SPI from U-Boot</span></a></li>
<li class="toclevel-2 tocsection-29"><a href="#Booting_from_SPI"><span class="tocnumber">6.2</span> <span class="toctext">Booting from SPI</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-30"><a href="#Using_NOR"><span class="tocnumber">7</span> <span class="toctext">Using NOR</span></a>
<ul>
<li class="toclevel-2 tocsection-31"><a href="#Building_u-boot_to_flash_it_and_boot_from_it"><span class="tocnumber">7.1</span> <span class="toctext">Building u-boot to flash it and boot from it</span></a></li>
<li class="toclevel-2 tocsection-32"><a href="#Writing_to_NOR_from_U-Boot"><span class="tocnumber">7.2</span> <span class="toctext">Writing to NOR from U-Boot</span></a></li>
<li class="toclevel-2 tocsection-33"><a href="#Booting_u-boot_from_NOR"><span class="tocnumber">7.3</span> <span class="toctext">Booting u-boot from NOR</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-34"><a href="#Archived_Versions"><span class="tocnumber">8</span> <span class="toctext">Archived Versions</span></a></li>
<li class="toclevel-1 tocsection-35"><a href="#Additional_Information"><span class="tocnumber">9</span> <span class="toctext">Additional Information</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Overview">Overview</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AMSDK_u-boot_User%27s_Guide&amp;action=edit&amp;section=1" title="Edit section: Overview">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p><b><big><big><big><span style="color:red">Content is no longer maintained and is being kept for reference only!</span></big></big></big></b>
<br />
</p><p><br />
This document covers the general use of U-Boot v2012.10 and the AMSDK on following platforms: 
</p>
<ul><li>am335x EVM</li>
<li>am335x EVM-SK</li>
<li>BeagleBone</li></ul>
<p>For am3517 EVM, am37x EVM and Beagleboard xM support please see the <a rel="nofollow" class="external text" href="http://processors.wiki.ti.com/index.php?title=AMSDK_u-boot_User%27s_Guide&amp;oldid=109080"><u><b>AMSDK 5.05.00 documentation</b></u></a>. For am180x information please see <a href="GSG__Building_Software_Components_for_OMAP-L1.html#Rebuilding_U-Boot" class="mw-redirect" title="GSG: Building Software Components for OMAP-L1"><u><b>this page</b></u></a>. 
</p><p>The latest release has been validated in the following hardware configurations. If your hardware platform is not listed below you can either use the release provided in the <a rel="nofollow" class="external text" href="http://www.ti.com/tool/linuxezsdk-sitara">SDK</a> for your device or try this u-boot release and provide <a rel="nofollow" class="external text" href="mailto:sdk_feedback@list.ti.com">feedback</a> on issues encountered so they can be addressed in a future release. 
</p>
<table>

<tbody><tr>
<th>Board
</th>
<th>Wired ethernet
</th>
<th>USB gadget ethernet
</th>
<th>NAND
</th>
<th>SD/MMC
</th>
<th>USB Host (mass storage)
</th>
<th>SPI flash
</th></tr>
<tr>
<td>AM335x EVM
</td>
<td>yes
</td>
<td>yes
</td>
<td>yes
</td>
<td>yes
</td>
<td>yes
</td>
<td>yes
</td></tr>
<tr>
<td>AM335x EVM-SK
</td>
<td>yes
</td>
<td>yes
</td>
<td>N/A
</td>
<td>yes
</td>
<td>yes
</td>
<td>N/A
</td></tr>
<tr>
<td>Beaglebone
</td>
<td>yes
</td>
<td>N/A
</td>
<td>N/A
</td>
<td>yes
</td>
<td>yes
</td>
<td>N/A
</td></tr></tbody></table>
<p>We assume that a GCC-based toolchain has already been installed and the serial port for the board has been configured. If this is not the case, please refer back to the <a href="Sitara_Linux_Software_Developer%e2%80%99s_Guide.html" title="Sitara Linux Software Developer’s Guide">Sitara Linux Software Developer’s Guide</a>. We also assume that a Linux Kernel has already been built (or has been provided) as well as an appropriate filesystem image. Installing and setting up DHCP or TFTP servers is also outside of the scope of this document, but snippets of information are provided to show how to use a specific feature, when needed. 
</p><p>Finally, please note that not all boards have all of the interfaces documented here. For example, the BeagleBoard xM and BeagleBone do not have NAND. 
</p>
<h2><span class="mw-headline" id="General_Information">General Information</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AMSDK_u-boot_User%27s_Guide&amp;action=edit&amp;section=2" title="Edit section: General Information">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h3><span class="mw-headline" id="Updated_Toolchain">Updated Toolchain</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AMSDK_u-boot_User%27s_Guide&amp;action=edit&amp;section=3" title="Edit section: Updated Toolchain">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Starting with Sitara Linux SDK 6.0 the location of the toolchain has changed and for non ARM 9 devices a new Linaro based toolchain will be used. Details about the change in toolchain location can be found <a rel="nofollow" class="external text" href="http://software-dl.ti.com/processor-sdk-linux/esd/docs/latest/linux/Overview_Getting_Started_Guide.html#gcc-toolchain#Updated.C2.A0Linux-Devkit_Structure">here</a>. Also details about the switch to Linaro can be found <a rel="nofollow" class="external text" href="http://software-dl.ti.com/processor-sdk-linux/esd/docs/latest/linux/Overview_Getting_Started_Guide.html#gcc-toolchain#Switch_to_Linaro">here</a>. 
</p><p>AM18x users are not affected by the switch to Linaro. Therefore, any references to the Linaro toolchain prefix "<b>arm-linux-gnueabihf</b>-" should be replaced with "<b>arm-arago-linux-gnueabi-</b>".
</p><p><br />
</p>
<h3><span class="mw-headline" id="Building_MLO_and_u-boot">Building MLO and u-boot</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AMSDK_u-boot_User%27s_Guide&amp;action=edit&amp;section=4" title="Edit section: Building MLO and u-boot">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>We strongly recommend the use of separate object directories when building. This is done with O= parameter to make. We also recommend that you<br /> use an output directory name that is identical to the make target name. That way if you are working with multiple make targets it is very<br /> easy to know which folder contains the u-boot binaries that you are interested in. 
</p>
<h4><span class="mw-headline" id="Cleaning_the_Sources">Cleaning the Sources</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AMSDK_u-boot_User%27s_Guide&amp;action=edit&amp;section=5" title="Edit section: Cleaning the Sources">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>If you did not use a separate object directory: 
</p>
<pre>$ make CROSS_COMPILE=arm-linux-gnueabihf- ARCH=arm distclean
</pre> 
<p>If you used 'O=am335x_evm' as your object directory: 
</p>
<pre>$ rm -rf ./am335x_evm
</pre> 
<h4><span class="mw-headline" id="Compiling_MLO_and_u-boot">Compiling MLO and u-boot</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AMSDK_u-boot_User%27s_Guide&amp;action=edit&amp;section=6" title="Edit section: Compiling MLO and u-boot">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Building of both u-boot and SPL is done with a single make command. The make target depends on the board in question: 
</p>
<table>

<tbody><tr>
<th>Board
</th>
<th>make target
</th></tr>
<tr>
<td>AM335x EVM, AM335x EVM-SK, Beaglebone
</td>
<td>am335x_evm
</td></tr></tbody></table>
<pre>$ make CROSS_COMPILE=arm-linux-gnueabihf- ARCH=arm O=make_target_from_table_above make_target_from_table_above
</pre> 
<h3><span class="mw-headline" id="U-Boot_Environment">U-Boot Environment</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AMSDK_u-boot_User%27s_Guide&amp;action=edit&amp;section=7" title="Edit section: U-Boot Environment">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<h4><span class="mw-headline" id="Restoring_defaults">Restoring defaults</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AMSDK_u-boot_User%27s_Guide&amp;action=edit&amp;section=8" title="Edit section: Restoring defaults">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>It is possible to reset the set of U-Boot environment variables to their defaults and if desired, save them to where the environment is stored, if applicable. To do so, issue the following commands: 
</p>
<pre>U-Boot # env default -f -a
U-Boot # saveenv
</pre> 
<h4><span class="mw-headline" id="Networking_Environment">Networking Environment</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AMSDK_u-boot_User%27s_Guide&amp;action=edit&amp;section=9" title="Edit section: Networking Environment">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>When using a USB-Ethernet dongle a valid MAC address must be set in the environment. To create a valid address please read <a rel="nofollow" class="external text" href="http://www.denx.de/wiki/view/DULG/WhereCanIGetAValidMACAddress"><u><b>this page</b></u></a>. Then issue the following command: 
</p>
<pre>U-Boot # setenv usbethaddr value:from:link:above
</pre> 
<p>Then start the USB subsystem: 
</p>
<pre>U-Boot # usb start
</pre> 
<p>The default behavior of U-Boot is to utilize all information that a DHCP server passes to us when the user issues the <b>dhcp</b> command. This will include the dhcp parameter <i>next-server</i> which indicates where to fetch files from via TFTP. There may be times however where the dhcp server on your network provides incorrect information and you are unable to modify the server. In this case the following steps can be helpful: 
</p>
<pre>U-Boot # setenv autoload no
U-Boot # dhcp
U-Boot # setenv serverip correct.server.ip
U-Boot # tftp
</pre> 
<p>Another alternative is to utilize the full syntax of the tftp command: 
</p>
<pre>U-Boot # setenv autoload no
U-Boot # dhcp
U-Boot # tftp ${loadaddr} server.ip:fileName
</pre> 
<h3><span class="mw-headline" id="Working_with_USB_Device_Firmware_Upgrade">Working with USB Device Firmware Upgrade</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AMSDK_u-boot_User%27s_Guide&amp;action=edit&amp;section=10" title="Edit section: Working with USB Device Firmware Upgrade">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>When working with USB Device Firmware Upgrade (DFU), regardless of the medium to be written to and of the board being used, there are some general things to keep in mind. First of all, you will need to get a copy of the <b>dfu-util</b> program installed on your host. If your distribution does not provide this package you will need to build it from source. Second, the examples that follow assume a single board is plugged into the host PC. If you have more than one device plugged in you will need to use the options that <b>dfu-util</b> provides for specifying a single device to work with. Finally, while one could build a U-Boot that supports both DFU writing to NAND and DFU writing to SD or eMMC, it would result in a more complicated environment to work from, so this has been avoided. 
</p>
<h2><span id="Using_the_network_(Wired_or_USB)"></span><span class="mw-headline" id="Using_the_network_.28Wired_or_USB.29">Using the network (Wired or USB)</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AMSDK_u-boot_User%27s_Guide&amp;action=edit&amp;section=11" title="Edit section: Using the network (Wired or USB)">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>This section documents how to configure the network and use it to load files and then boot the Linux Kernel using a root filesystem mounted over NFS. At this time, no special builds of U-Boot are required to perform these operations on the supported hardware. 
</p>
<h3><span class="mw-headline" id="Booting_U-Boot_from_the_network">Booting U-Boot from the network</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AMSDK_u-boot_User%27s_Guide&amp;action=edit&amp;section=12" title="Edit section: Booting U-Boot from the network">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>In some cases we support loading SPL and U-Boot over the network because of ROM support. In some cases, a special build of U-Boot may be required. In addition, the DHCP server is needed to reply to the target with the file to fetch via tftp. In order to facilitate this, the <b>vendor-class-identifier</b> DHCP field is filled out by the ROM and the values are listed in the table below. Finally, you will need to use the <b>spl/u-boot-spl.bin</b> and <b>u-boot.img</b> files to boot. 
</p>
<table class="FCK&#95;_ShowTableBorders">

<tbody><tr>
<th>Board
</th>
<th>make target
</th>
<th>Supported interfaces
</th>
<th>ROM vendor-class-identifier value
</th>
<th>SPL vendor-class-identifier value
</th></tr>
<tr>
<td>AM335x EVM
</td>
<td>am335x_evm
</td>
<td>CPSW ethernet
</td>
<td>DM814x ROM (PG1.0) or AM335x ROM (PG2.0 and later)
</td>
<td>AM335x U-Boot SPL
</td></tr>
<tr>
<td>AM335x EVM (PG2.0 and later)
</td>
<td>am335x_evm_usbspl
</td>
<td>SPL and U-Boot via USB RNDIS
</td>
<td>AM335x ROM
</td>
<td>AM335x U-Boot SPL
</td></tr>
<tr>
<td>AM335x EVM (PG1.0)
</td>
<td>am335x_evm_uart_usbspl
</td>
<td>SPL via UART, U-Boot via USB RNDIS
</td>
<td>&#160;N/A
</td>
<td>AM335x U-Boot SPL
</td></tr>
<tr>
<td>AM335x HS EVM (PG2.0)
</td>
<td>am335x_hs_evm_usb
</td>
<td>SPL and U-boot via USB RNDIS
</td>
<td>AM335x ROM
</td>
<td>AM335x U-Boot SPL
</td></tr></tbody></table>
<p>If using ISC dhcpd an example host entry would look like this: 
</p>
<pre>host am335x_evm {
  hardware ethernet de:ad:be:ee:ee:ef;
  # Check for PG1.0, typically CPSW
  if substring (option vendor-class-identifier, 0, 10) = "DM814x ROM" {
    filename "u-boot-spl.bin";
  # Check for PG2.0, CPSW or USB RNDIS
  } elsif substring (option vendor-class-identifier, 0, 10) = "AM335x ROM" {
    filename "u-boot-spl.bin";
  } elsif substring (option vendor-class-identifier, 0, 17) = "AM335x U-Boot SPL" {
    filename "u-boot.img";
  } else {
    filename "uImage-am335x-evm.bin";
  } 
} 
</pre> 
<p>Note that in a factory type setting, the substring tests can be done inside of the subnet declaration to set the default filename value for the subnet, and overriden (if needed) in a host entry. 
</p><p>If you have removed NetworkManager from your system (which is not the default in most distributions) you need to configure your /etc/network/interfaces file thusly: 
</p>
<pre>allow-hotplug usb0
iface usb0 inet static
        address 192.168.1.1
        netmask 255.255.255.0
        post-up service isc-dhcp-server reload
</pre> 
<p>If you are using NetworkManager you need to create two files. First, as root create /etc/NetworkManager/system-connections/AM335x USB RNDIS (and use \ to escape the space) with the following content: 
</p>
<pre>[802-3-ethernet]
duplex=full
mac-address=AA:BB:CC:11:22:33

[connection]
id=AM335X USB RNDIS
uuid=INSERT THE CONTENTS OF 'uuidgen' HERE
type=802-3-ethernet

[ipv6]
method=ignore

[ipv4]
method=manual
addresses1=192.168.1.1;16;
</pre> 
<p>Seccond as root, and ensuring execute permissions, create /etc/NetworkManager/dispatcher.d/99am335x-dhcp-server 
</p>
<pre>#!/bin/sh

IF=$1
STATUS=$2

if [ "$IF" = "usb0" ] &amp;&amp; [ "$STATUS" = "up" ]; then
	service isc-dhcp-server reload
fi
</pre> 
<h3><span class="mw-headline" id="Multiple_Interfaces">Multiple Interfaces</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AMSDK_u-boot_User%27s_Guide&amp;action=edit&amp;section=13" title="Edit section: Multiple Interfaces">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>On some boards, for example when we have both a wired interface and USB RNDIS gadget ethernet, it can be desirable to change from the default U-Boot behavior of cycling over each interface it knows to telling U-Boot to use a single interface. For example, on start you may see lines like: 
</p>
<pre>Net:   cpsw, usb_ether
</pre> 
<p>So to ensure that we use <b>usb_ether</b> first issue the following command: 
</p>
<pre>U-Boot # setenv ethact usb_ether
</pre> 
<h3><span class="mw-headline" id="Network_configuration_via_DHCP">Network configuration via DHCP</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AMSDK_u-boot_User%27s_Guide&amp;action=edit&amp;section=14" title="Edit section: Network configuration via DHCP">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>To configure the network via DHCP, use the following commands: 
</p>
<pre>U-Boot # setenv autoload no
U-Boot # dhcp
</pre> 
<p>And ensure that a DHCP server is configured to serve addresses for the network you are connected to. 
</p>
<h3><span class="mw-headline" id="Manual_network_configuration">Manual network configuration</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AMSDK_u-boot_User%27s_Guide&amp;action=edit&amp;section=15" title="Edit section: Manual network configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>To configure the network manually, the <b>ipaddr</b>, <b>serverip</b>, <b>gatewayip</b> and <b>netmask</b>: 
</p>
<pre>U-Boot # setenv ipaddr 192.168.1.2
U-Boot # setenv serverip 192.168.1.1
U-Boot # setenv gatewayip 192.168.1.1
U-Boot # setenv netmask 255.255.255.0
</pre> 
<h3><span class="mw-headline" id="Booting_Linux_from_the_network">Booting Linux from the network</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AMSDK_u-boot_User%27s_Guide&amp;action=edit&amp;section=16" title="Edit section: Booting Linux from the network">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Within the default environment for each board that supports networking there is a boot command called <b>netboot</b> that will automatically load the kernel and boot. For the exact details of each use <b>printenv</b> on the <b>netboot</b> variable and then in turn <b>printenv</b> other sub-sections of the command. The most important variables here are <b>rootpath</b> and <b>nfsopts</b>. 
</p>
<h3><span class="mw-headline" id="Automatically_programming_flash_from_a_network_boot">Automatically programming flash from a network boot</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AMSDK_u-boot_User%27s_Guide&amp;action=edit&amp;section=17" title="Edit section: Automatically programming flash from a network boot">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Given the ability to load and execute software via network interfaces in the ROMs of some platform, one usage of this functionality is custom build of U-Boot that has a default boot command that will write a payload to flash. This is done by a combination of building a special purpose U-Boot (see the table below) and writing a U-Boot script (a series of commands in a text file that we pass to mkimage). 
</p>
<table>

<tbody><tr>
<th>Board
</th>
<th>make target
</th>
<th>Supported interfaces
</th></tr>
<tr>
<td>AM335x EVM
</td>
<td>am335x_evm_restore_flash
</td>
<td>CPSW ethernet
</td></tr>
<tr>
<td>AM335x EVM (PG2.0 and later)
</td>
<td>am335x_evm_restore_flash_usbspl
</td>
<td>SPL and U-Boot via USB RNDIS
</td></tr>
<tr>
<td>AM335x EVM (PG1.0)
</td>
<td>am335x_evm_restore_flash_uart_usbspl
</td>
<td>SPL via UART, U-Boot via USB RNDIS
</td></tr></tbody></table>
<p>An example script file, which we call <b>debrick.txt</b> that will download files via tftp and then write them to NAND looks like: 
</p>
<pre># erase NAND
nand erase.chip
# get MLO
tftp 0x81000000 MLO
# make 4 copies in the RAM
cp.b 0x81000000 0x81020000 20000
cp.b 0x81000000 0x81040000 20000
cp.b 0x81000000 0x81060000 20000
# get u-boot.img
tftp 0x81080000 u-boot.img
# write the whole block (4*MLO + u-boot.img) to NAND
nand write 0x81000000 0x0 0x260000
</pre> 
<p>We then need to run that file through <b>mkimage</b>: 
</p>
<pre>mkimage -A arm -O U-Boot -C none -T script -d debrick.txt debrick.scr
</pre> 
<p>Then <b>debrick.scr</b>, along with <b>MLO</b> and <b>u-boot.img</b> go in to the top directory that your tftp server uses to serve files from. Along with having configured the dhcp server as discussed above to boot the target machine it will now boot and program the NAND flash. 
</p>
<h2><span class="mw-headline" id="Using_NAND">Using NAND</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AMSDK_u-boot_User%27s_Guide&amp;action=edit&amp;section=18" title="Edit section: Using NAND">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>This section documents how to write files to the NAND device and use it to load and then boot the Linux Kernel using a root filesystem also found on NAND. At this time, no special builds of U-Boot are required to perform these operations on the supported hardware. Finally, for simplicity we assume the files are being loaded from an SD card. Using the network interface (if applicable) is documented above. 
</p>
<h3><span class="mw-headline" id="Writing_to_NAND_from_U-Boot">Writing to NAND from U-Boot</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AMSDK_u-boot_User%27s_Guide&amp;action=edit&amp;section=19" title="Edit section: Writing to NAND from U-Boot">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Note: 
</p>
<ul><li>From the U-Boot build, the <b>MLO</b> and <b>u-boot.img</b> files are the ones to be written.</li>
<li>We load all files from an SD card in this example but they can just as easily be loaded via network (documented above) or other interface that exists.</li>
<li>The default layout of the NAND that each supported device supports is the same for MLO and U-Boot which is why all of the nand erase and write locations are the same for that section.</li>
<li>This series of commands will write <b>MLO</b> to the default location and then the backup locations that the ROM will look in as well.</li></ul>
<pre>U-Boot # mmc rescan
U-Boot # nand erase 0x0 0x780000
U-Boot # fatload mmc 0 0x81000000 MLO
U-Boot # cp.b 0x81000000 0x81020000 20000
U-Boot # cp.b 0x81000000 0x81040000 20000
U-Boot # cp.b 0x81000000 0x81060000 20000
U-Boot # fatload mmc 0 0x81080000 u-boot.img
U-Boot # fatload mmc 0 0x81280000 uImage
U-Boot # nand write 0x81000000 0x0 0x780000
U-Boot # saveenv
</pre> 
<h3><span class="mw-headline" id="Writing_to_NAND_via_DFU">Writing to NAND via DFU</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AMSDK_u-boot_User%27s_Guide&amp;action=edit&amp;section=20" title="Edit section: Writing to NAND via DFU">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Currently in boards that support using DFU, the default build supports writing to NAND, so no custom build is required. To see the list of available places to write to (in DFU terms, altsettings) use the <b>mtdparts</b> command to list the known MTD partitions and <b>printenv dfu_alt_settings</b> to see how they are mapped and exposed to <b>dfu-util</b>. 
</p>
<pre>U-Boot# mtdparts

device nand0 &lt;nand0&gt;, # parts = 5
 #: name                size            offset          mask_flags
 0: SPL                 0x00020000      0x00000000      0
 1: SPL.backup1         0x00020000      0x00020000      0
 2: SPL.backup2         0x00020000      0x00040000      0
 3: SPL.backup3         0x00020000      0x00060000      0
 4: u-boot              0x001e0000      0x00080000      0
 5: u-boot-env          0x00020000      0x00260000      0
 6: kernel              0x00500000      0x00280000      0
 7: rootfs              0x0f880000      0x00780000      0

active partition: nand0,0 - (SPL) 0x00080000 @ 0x00000000
U-Boot# printenv dfu_alt_info
dfu_alt_info=SPL part 0 1;SPL.backup1 part 0 2;SPL.backup2 part 0 3;SPL.backup3 part 0 4;u-boot part 0 5;kernel part 0 7;rootfs part 0 8
</pre> 
<p>This means that you can tell dfu-util to write anything to any of: 
</p>
<ul><li>SPL</li>
<li>SPL.backup1</li>
<li>SPL.backup2</li>
<li>SPL.backup3</li>
<li>u-boot</li>
<li>kernel</li>
<li>rootfs</li></ul>
<p>Before writing you must erase at least the area to be written to. Then to start DFU on the target on the first NAND device: 
</p>
<pre>U-Boot # nand erase.chip
U-Boot # dfu nand 0
</pre> 
<p>Then on the host PC to write <b>MLO</b> to the first SPL partition: 
</p>
<pre>$ sudo dfu-util -D MLO -a SPL
</pre> 
<p>Finally, if you do: 
</p>
<pre>U-Boot # setenv nandsilent true
</pre> 
<p>prior to starting dfu in U-Boot, a number of messages will be supressed and a slightly faster write will occur. 
</p>
<h3><span class="mw-headline" id="Booting_from_NAND">Booting from NAND</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AMSDK_u-boot_User%27s_Guide&amp;action=edit&amp;section=21" title="Edit section: Booting from NAND">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Within the default environment for each board that supports nand there is a boot command called <b>nandboot</b> that will automatically load the kernel and boot. For the exact details of each use <b>printenv</b> on the <b>nandboot</b> variable and then in turn <b>printenv</b> other sub-sections of the command. The most important variables here are <b>nandroot</b> and <b>nandrootfstype</b>. 
</p>
<h2><span class="mw-headline" id="Using_removable_media">Using removable media</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AMSDK_u-boot_User%27s_Guide&amp;action=edit&amp;section=22" title="Edit section: Using removable media">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Using removable media such as SD/MMC cards or a USB flash drive (or SD card in a USB card reader) use very similar techniques. The biggest difference is that only SD/MMC can be used by the ROM at power-on. Once U-Boot is running however, a USB device can be used for the kernel and the root filesystem. 
</p>
<h3><span class="mw-headline" id="Updating_an_SD_card_from_a_host_PC">Updating an SD card from a host PC</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AMSDK_u-boot_User%27s_Guide&amp;action=edit&amp;section=23" title="Edit section: Updating an SD card from a host PC">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>This section assume that you have created an SD card following the instructions on <a href="http://software-dl.ti.com/processor-sdk-linux/esd/docs/latest/linux/Overview_Getting_Started_Guide.html#linux-sd-card-creation-guide" class="mw-redirect" title="Sitara Linux SDK create SD card script">Sitara Linux SDK create SD card script</a> or have made a compatible layout by hand. In this case, you will need to copy the <b>MLO</b>, <b>u-boot.img</b> and <b>uImage</b> files to the <i>boot</i> partition. At this point, the card is now bootable in the SD card slot. 
</p>
<h3><span class="mw-headline" id="Updating_an_SD_card_or_eMMC_using_DFU">Updating an SD card or eMMC using DFU</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AMSDK_u-boot_User%27s_Guide&amp;action=edit&amp;section=24" title="Edit section: Updating an SD card or eMMC using DFU">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Currently in boards that support using DFU, the default build do not support writing to SD card or eMMC, so a custom build is required. Please see the table below for how to build a binary that does DFU writing to MMC. To see the list of available places to write to (in DFU terms, altsettings) use the <b>mmc part</b> command to list the partitions on the MMC device and <b>printenv dfu_alt_settings</b> to see how they are mapped and exposed to <b>dfu-util</b>. 
</p>
<table>

<tbody><tr>
<th>Board
</th>
<th>Build target
</th></tr>
<tr>
<td>AM335x EVM, EVM-SK and Beaglebone
</td>
<td>am335x_evm_dfu_mmc
</td></tr></tbody></table>
<pre>U-Boot# mmc part

Partition Map for MMC device 0  --   Partition Type: DOS

Partition     Start Sector     Num Sectors     Type
    1                   63          144522       c Boot
    2               160650         1847475      83
    3              2024190         1815345      83
U-Boot# printenv dfu_alt_info
dfu_alt_info=boot part 0 1;rootfs part 0 2;MLO fat 0 1;u-boot.img fat 0 1;uEnv.txt fat 0 1"
</pre> 
<p>This means that you can tell dfu-util to write anything to any of: 
</p>
<ul><li>boot</li>
<li>rootfs</li></ul>
<p>And that the <b>MLO</b>, <b>u-boot.img</b> and <b>uEnv.txt</b> files are to be written to a FAT filesystem. 
</p><p>To start DFU on the target on the first MMC device: 
</p>
<pre>U-Boot # dfu mmc 0
</pre> 
<p>Then on the host PC to write <b>MLO</b> to the boot partition: 
</p>
<pre>$ sudo dfu-util -D MLO -a boot
</pre> 
<p>Finally, if you do: 
</p>
<pre>U-Boot # setenv mmcsilent true
</pre> 
<p>prior to starting dfu in U-Boot, a number of messages will be supressed and a slightly faster write will occur. 
</p>
<h3><span class="mw-headline" id="Booting_Linux_from_SD_card">Booting Linux from SD card</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AMSDK_u-boot_User%27s_Guide&amp;action=edit&amp;section=25" title="Edit section: Booting Linux from SD card">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Within the default environment for each board that supports SD/MMC there is a boot command called <b>mmcboot</b> that will set the boot arguments correctly and start the kernel. In this case however, you must first run <b>loaduimagefat</b> or <b>loaduimage</b> to first load the kernel into memory. For the exact details of each use <b>printenv</b> on the <b>mmcboot</b>, <b>loaduimagefat</b> and <b>loaduimage</b> variables and then in turn <b>printenv</b> other sub-sections of the command. The most important variables here are <b>mmcroot</b> and <b>mmcrootfstype</b>. 
</p>
<h3><span class="mw-headline" id="Booting_Linux_from_USB_storage">Booting Linux from USB storage</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AMSDK_u-boot_User%27s_Guide&amp;action=edit&amp;section=26" title="Edit section: Booting Linux from USB storage">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>To load the Linux Kernel and rootfs from USB rather than SD/MMC card, if we assume that the USB device is partitioned the same way as an SD/MMC card is, we can utilize the <b>mmcboot</b> command to boot. To do this, perform the following steps: 
</p>
<pre>U-Boot # usb start
U-Boot # setenv mmcroot /dev/sda2 ro
U-Boot # fatload usb 0 ${kloadaddr} ${bootfile}
U-Boot # run mmcboot
</pre> 
<h2><span class="mw-headline" id="Using_SPI">Using SPI</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AMSDK_u-boot_User%27s_Guide&amp;action=edit&amp;section=27" title="Edit section: Using SPI">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>This section documents how to write files to the SPI device and use it to load and then boot the Linux Kernel using a root filesystem also found on SPI. At this time, no special builds of U-Boot are required to perform these operations on the supported hardware. The table below however, lists builds that will also use the SPI flash for the environment instead of the default, which typically is NAND. Finally, for simplicity we assume the files are being loaded from an SD card. Using the network interface (if applicable) is documented above. 
</p>
<h3><span class="mw-headline" id="Writing_to_SPI_from_U-Boot">Writing to SPI from U-Boot</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AMSDK_u-boot_User%27s_Guide&amp;action=edit&amp;section=28" title="Edit section: Writing to SPI from U-Boot">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Note: 
</p>
<ul><li>From the U-Boot build, the <b>MLO.byteswap</b> and <b>u-boot.img</b> files are the ones to be written.</li>
<li>We load all files from an SD card in this example but they can just as easily be loaded via network (documented above) or other interface that exists.</li></ul>
<table>

<tbody><tr>
<th>Board
</th>
<th>Build target
</th></tr>
<tr>
<td>AM335x EVM
</td>
<td>am335x_evm_spiboot
</td></tr></tbody></table>
<pre>U-Boot # mmc rescan
U-Boot # sf probe 0
U-Boot # sf erase 0 +80000
U-Boot # fatload mmc 0 ${loadaddr} MLO.byteswap
U-Boot # sf write ${loadaddr} 0 ${filesize}
U-Boot # fatload mmc 0 ${loadaddr} u-boot.img
U-Boot # sf write ${loadaddr} 0x20000 ${filesize}
U-Boot # sf erase 80000 +${spiimgsize}
U-Boot # fatload mmc 0 ${loadaddr} uImage
U-Boot # sf write ${loadaddr} ${spisrcaddr} ${filesize}
</pre> 
<h3><span class="mw-headline" id="Booting_from_SPI">Booting from SPI</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AMSDK_u-boot_User%27s_Guide&amp;action=edit&amp;section=29" title="Edit section: Booting from SPI">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Within the default environment for each board that supports SPI there is a boot command called <b>spiboot</b> that will automatically load the kernel and boot. For the exact details of each use <b>printenv</b> on the <b>spiboot</b> variable and then in turn <b>printenv</b> other sub-sections of the command. The most important variables here are <b>spiroot</b> and <b>spirootfstype</b>. 
</p>
<h2><span class="mw-headline" id="Using_NOR">Using NOR</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AMSDK_u-boot_User%27s_Guide&amp;action=edit&amp;section=30" title="Edit section: Using NOR">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>This section documents how to write files to the NOR device and use it to boot u-boot. At this time, there are two builds of u-boot that are used: the first boots from memory or peripherals and is used to flash the second, which will boot from NOR. The table below however, lists the two builds. Finally, for simplicity we assume the files are being loaded from an SD card. Using the network interface (if applicable) is documented above. 
</p>
<table>

<tbody><tr>
<th>Board
</th>
<th>Build target
</th></tr>
<tr>
<td>AM335x EVM
</td>
<td>am335x_evm_nor
</td></tr>
<tr>
<td>AM335x EVM
</td>
<td>am3335x_evm_norboot
</td></tr></tbody></table>
<p><br /> 
</p>
<h3><span class="mw-headline" id="Building_u-boot_to_flash_it_and_boot_from_it">Building u-boot to flash it and boot from it</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AMSDK_u-boot_User%27s_Guide&amp;action=edit&amp;section=31" title="Edit section: Building u-boot to flash it and boot from it">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<pre>$ make O=sees-nor CROSS_COMPILE=arm-linux-gnueabihf- ARCH=arm am335x_evm_nor
$ make O=boots-nor CROSS_COMPILE=arm-linux-gnueabihf- ARCH=arm am335x_evm_norboot
</pre> 
<p>Copy sees-nor/MLO sees-nor/u-boot.img boots-nor/u-boot.bin to an SD card. 
</p><p>Note: 
</p>
<ul><li>From the "sees-nor" U-Boot build, the <b>MLO</b> and <b>u-boot.img</b> files are the ones used to flash the "boots-nor" <b>u-boot.bin</b> that will boot from NOR.</li>
<li>We load all files from an SD card in this example but they can just as easily be loaded via network (documented above) or other interface that exists.</li></ul>
<h3><span class="mw-headline" id="Writing_to_NOR_from_U-Boot">Writing to NOR from U-Boot</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AMSDK_u-boot_User%27s_Guide&amp;action=edit&amp;section=32" title="Edit section: Writing to NOR from U-Boot">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<pre>U-Boot # mmc rescan
U-Boot # fatload mmc 0 0x82000000 u-boot.bin
U-Boot # protect off all
U-Boot # erase all
U-Boot # cp.b 0x82000000 0x08000000 0x60000
U-Boot # protect on all
</pre> 
<h3><span class="mw-headline" id="Booting_u-boot_from_NOR">Booting u-boot from NOR</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AMSDK_u-boot_User%27s_Guide&amp;action=edit&amp;section=33" title="Edit section: Booting u-boot from NOR">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Set the sysboot pins so that XIP is in the boot order and reset the board. 
</p>
<h2><span class="mw-headline" id="Archived_Versions">Archived Versions</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AMSDK_u-boot_User%27s_Guide&amp;action=edit&amp;section=34" title="Edit section: Archived Versions">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li><a rel="nofollow" class="external text" href="http://processors.wiki.ti.com/index.php?title=AMSDK_u-boot_User%27s_Guide&amp;oldid=151547"><u><b>5.07.00</b></u></a></li>
<li><a rel="nofollow" class="external text" href="http://processors.wiki.ti.com/index.php?title=AMSDK_u-boot_User%27s_Guide&amp;oldid=88139"><u><b>5.03.03</b></u></a></li>
<li><a rel="nofollow" class="external text" href="http://processors.wiki.ti.com/index.php?title=AMSDK_u-boot_User%27s_Guide&amp;oldid=83941"><u><b>5.03.00</b></u></a></li>
<li><a rel="nofollow" class="external text" href="http://processors.wiki.ti.com/index.php?title=AMSDK_u-boot_User%27s_Guide&amp;oldid=109080"><u><b>5.05.00</b></u></a></li></ul>
<h2><span class="mw-headline" id="Additional_Information">Additional Information</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AMSDK_u-boot_User%27s_Guide&amp;action=edit&amp;section=35" title="Edit section: Additional Information">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li>AM335x
<ul><li><a href="Am335x_Flash_Programming_Guide.html" class="mw-redirect" title="Am335x Flash Programming Guide"><u><b>AM335x Flash Programming Guide</b></u></a></li>
<li><a href="AM335x_U-Boot_User%27s_Guide.html" title="AM335x U-Boot User&#39;s Guide"><u><b>AM335x u-boot User's Guide</b></u></a></li></ul></li></ul>

<!-- 
NewPP limit report
Cached time: 20201201020643
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.080 seconds
Real time usage: 0.082 seconds
Preprocessor visited node count: 424/1000000
Preprocessor generated node count: 778/1000000
Post‐expand include size: 669/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 5102/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    1.361      1 Template:Sitara_SDK_Linaro_Switch_Template
100.00%    1.361      1 -total
-->
</div>
<!-- Saved in parser cache with key procwiki:pcache:idhash:13619-0!canonical and timestamp 20201201020643 and revision id 218015
 -->
<div class='hf-nsfooter' id='hf-nsfooter-'><table style="text-align:center; background:white; width:100%; text-align:left; height: 65px border-top: 1px solid; border-bottom: 1px solid; border-left: 1px solid; border-right: 1px solid; border-width: 1px; border-style: solid;">
<tr>
<td width="305px"><a href="File_E2e.html" class="image"><img alt="E2e.jpg" src="https://processors.wiki.ti.com/images/8/82/E2e.jpg" width="305" height="63" /></a>
</td>
<td>{{
<ol><li>switchcategory:MultiCore=</li></ol>
<ul><li>For technical support on MultiCore devices, please post your questions in the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/c6000_multi-core_dsps/default.aspx">C6000 MultiCore Forum</a></li>
<li>For questions related to the BIOS MultiCore SDK (MCSDK), please use the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/embedded/f/355.aspx">BIOS Forum</a></li></ul>
<p>Please post only comments related to the article <b>AMSDK u-boot User&#39;s Guide</b> here.<i></i>
</p>
</td>
<td>Keystone=
<ul><li>For technical support on MultiCore devices, please post your questions in the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/c6000_multi-core_dsps/default.aspx">C6000 MultiCore Forum</a></li>
<li>For questions related to the BIOS MultiCore SDK (MCSDK), please use the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/embedded/f/355.aspx">BIOS Forum</a></li></ul>
<p>Please post only comments related to the article <b>AMSDK u-boot User&#39;s Guide</b> here.<i></i>
</p>
</td>
<td>C2000=<i>For technical support on the C2000 please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/microcontrollers/tms320c2000_32-bit_real-time_mcus/f/171.aspx">The C2000 Forum</a>. Please post only comments about the article <b>AMSDK u-boot User&#39;s Guide</b> here.</i>
</td>
<td>DaVinci=<i>For technical support on DaVincoplease post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/davinci_digital_media_processors/default.aspx">The DaVinci Forum</a>. Please post only comments about the article <b>AMSDK u-boot User&#39;s Guide</b> here.</i>
</td>
<td>MSP430=<i>For technical support on MSP430 please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/microcontrollers/msp43016-bit_ultra-low_power_mcus/default.aspx">The MSP430 Forum</a>. Please post only comments about the article <b>AMSDK u-boot User&#39;s Guide</b> here.</i>
</td>
<td>OMAP35x=<i>For technical support on OMAP please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/omap_applications_processors/default.aspx">The OMAP Forum</a>. Please post only comments about the article <b>AMSDK u-boot User&#39;s Guide</b> here.</i>
</td>
<td>OMAPL1=<i>For technical support on OMAP please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/omap_applications_processors/default.aspx">The OMAP Forum</a>. Please post only comments about the article <b>AMSDK u-boot User&#39;s Guide</b> here.</i>
</td>
<td>MAVRK=<i>For technical support on MAVRK please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/development_tools/mavrk/default.aspx">The MAVRK Toolbox Forum</a>. Please post only comments about the article <b>AMSDK u-boot User&#39;s Guide</b> here.</i>
</td>
<td><i>For technical support please post your questions at <a rel="nofollow" class="external text" href="http://e2e.ti.com/">http://e2e.ti.com</a>. Please post only comments about the article <b>AMSDK u-boot User&#39;s Guide</b> here.</i>
<p>}}
</p>
</td></tr></table>
<table style="border-style:solid; border-width:1px; text-align:center; width:100%;">

<tr style="font-size:150%;">
<td rowspan="2"><a href="File_Hyperlink_blue.html" class="image"><img alt="Hyperlink blue.png" src="https://processors.wiki.ti.com/images/9/9f/Hyperlink_blue.png" width="96" height="96" /></a>
</td>
<td><b>Links</b>
</td></tr>
<tr>
<td>
<table style="text-align: left;">
<tr>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/amplifier_and_linear.page">Amplifiers &amp; Linear</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/audio/audio_overview.page">Audio</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/rfif.page">Broadband RF/IF &amp; Digital Radio</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/clocksandtimers/clocks_and_timers.page">Clocks &amp; Timers</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/dataconverters/data_converter.page">Data Converters</a>
</p>
</td>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/mems/mems.page">DLP &amp; MEMS</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/high_reliability.page">High-Reliability</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/interface/interface.page">Interface</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/logic/home_overview.page">Logic</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/powermanagement/power_portal.page">Power Management</a>
</p>
</td>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/dsp/embedded_processor.page">Processors</a>
</p>
<ul><li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/dsp/arm.page">ARM Processors</a></li>
<li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/dsp/home.page">Digital Signal Processors (DSP)</a></li>
<li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/microcontroller/home.page">Microcontrollers (MCU)</a></li>
<li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/omap-applications-processors/the-omap-experience.page">OMAP Applications Processors</a></li></ul>
</td>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/switches_and_multiplexers.page">Switches &amp; Multiplexers</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/temperature_sensor.page">Temperature Sensors &amp; Control ICs</a><br/>
<a rel="nofollow" class="external text" href="http://focus.ti.com/wireless/docs/wirelessoverview.tsp?familyId=2003&amp;sectionId=646&amp;tabId=2735">Wireless Connectivity</a>
</p>
</td></tr></table>
</td></tr></table>
<div id="tiPrivacy"></div>
</div></div>					<div class="printfooter">
						Retrieved from "<a dir="ltr" href="https://processors.wiki.ti.com/index.php?title=AMSDK_u-boot_User%27s_Guide&amp;oldid=218015">https://processors.wiki.ti.com/index.php?title=AMSDK_u-boot_User%27s_Guide&amp;oldid=218015</a>"					</div>
				<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="Special_Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="Category_AM335x.html" title="Category:AM335x">AM335x</a></li></ul></div></div>				<div class="visualClear"></div>
							</div>
		</div>
		<div id="mw-navigation">
			<h2>Navigation menu</h2>
			<div id="mw-head">
									<div id="p-personal" role="navigation" class="" aria-labelledby="p-personal-label">
						<h3 id="p-personal-label">Personal tools</h3>
						<ul>
							<li id="pt-login"><a href="https://processors.wiki.ti.com/index.php?title=Special:UserLogin&amp;returnto=AMSDK+u-boot+User%27s+Guide" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li><li id="pt-createaccount"><a href="Special_RequestAccount.html" title="You are encouraged to create an account and log in; however, it is not mandatory">Request account</a></li>						</ul>
					</div>
									<div id="left-navigation">
										<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
						<h3 id="p-namespaces-label">Namespaces</h3>
						<ul>
							<li id="ca-nstab-main" class="selected"><span><a href="AMSDK_u-boot_User%27s_Guide.html" title="View the content page [c]" accesskey="c">Page</a></span></li><li id="ca-talk" class="new"><span><a href="https://processors.wiki.ti.com/index.php?title=Talk:AMSDK_u-boot_User%27s_Guide&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page (page does not exist) [t]" accesskey="t">Discussion</a></span></li>						</ul>
					</div>
										<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
												<input type="checkbox" class="vectorMenuCheckbox" aria-labelledby="p-variants-label" />
						<h3 id="p-variants-label">
							<span>Variants</span>
						</h3>
						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
									</div>
				<div id="right-navigation">
										<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
						<h3 id="p-views-label">Views</h3>
						<ul>
							<li id="ca-view" class="collapsible selected"><span><a href="AMSDK_u-boot_User%27s_Guide.html">Read</a></span></li><li id="ca-viewsource" class="collapsible"><span><a href="https://processors.wiki.ti.com/index.php?title=AMSDK_u-boot_User%27s_Guide&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></span></li><li id="ca-history" class="collapsible"><span><a href="https://processors.wiki.ti.com/index.php?title=AMSDK_u-boot_User%27s_Guide&amp;action=history" title="Past revisions of this page [h]" accesskey="h">View history</a></span></li>						</ul>
					</div>
										<div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label">
						<input type="checkbox" class="vectorMenuCheckbox" aria-labelledby="p-cactions-label" />
						<h3 id="p-cactions-label"><span>More</span></h3>
						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
										<div id="p-search" role="search">
						<h3>
							<label for="searchInput">Search</label>
						</h3>
						<form action="https://processors.wiki.ti.com/index.php" id="searchform">
							<div id="simpleSearch">
								<input type="search" name="search" placeholder="Search Texas Instruments Wiki" title="Search Texas Instruments Wiki [f]" accesskey="f" id="searchInput"/><input type="hidden" value="Special:Search" name="title"/><input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton mw-fallbackSearchButton"/><input type="submit" name="go" value="Go" title="Go to a page with this exact name if it exists" id="searchButton" class="searchButton"/>							</div>
						</form>
					</div>
									</div>
			</div>
			<div id="mw-panel">
				<div id="p-logo" role="banner"><a class="mw-wiki-logo" href="Main_Page.html"  title="Visit the main page"></a></div>
						<div class="portal" role="navigation" id="p-navigation" aria-labelledby="p-navigation-label">
			<h3 id="p-navigation-label">Navigation</h3>
			<div class="body">
								<ul>
					<li id="n-mainpage"><a href="Main_Page.html" title="Visit the main page [z]" accesskey="z">Main Page</a></li><li id="n-All-pages"><a href="Special_AllPages.html">All pages</a></li><li id="n-All-categories"><a href="Special_Categories.html">All categories</a></li><li id="n-recentchanges"><a href="Special_RecentChanges.html" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li><li id="n-randompage"><a href="Package_Reflow_Profiles.html" title="Load a random page [x]" accesskey="x">Random page</a></li><li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" title="The place to find out">Help</a></li>				</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id="p-tb" aria-labelledby="p-tb-label">
			<h3 id="p-tb-label">Toolbox</h3>
			<div class="body">
								<ul>
					<li id="t-whatlinkshere"><a href="Special_WhatLinksHere/AMSDK_u-boot_User%27s_Guide.html" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li><li id="t-recentchangeslinked"><a href="Special_RecentChangesLinked/AMSDK_u-boot_User%27s_Guide.html" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li><li id="t-specialpages"><a href="Special_SpecialPages.html" title="A list of all special pages [q]" accesskey="q">Special pages</a></li><li id="t-print"><a href="https://processors.wiki.ti.com/index.php?title=AMSDK_u-boot_User%27s_Guide&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li><li id="t-permalink"><a href="https://processors.wiki.ti.com/index.php?title=AMSDK_u-boot_User%27s_Guide&amp;oldid=218015" title="Permanent link to this revision of the page">Permanent link</a></li><li id="t-info"><a href="https://processors.wiki.ti.com/index.php?title=AMSDK_u-boot_User%27s_Guide&amp;action=info" title="More information about this page">Page information</a></li>				</ul>
							</div>
		</div>
				</div>
		</div>
				<div id="footer" role="contentinfo">
						<ul id="footer-info">
								<li id="footer-info-lastmod"> This page was last edited on 28 June 2016, at 12:39.</li>
								<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-ShareAlike</a> unless otherwise noted.</li>
							</ul>
						<ul id="footer-places">
								<li id="footer-places-privacy"><a href="Project_Privacy_policy.html" title="Project:Privacy policy">Privacy policy</a></li>
								<li id="footer-places-about"><a href="Project_About.html" title="Project:About">About Texas Instruments Wiki</a></li>
								<li id="footer-places-disclaimer"><a href="Project_General_disclaimer.html" title="Project:General disclaimer">Disclaimers</a></li>
								<li id="footer-places-termsofservice"><a href="Project_Terms_of_Service.html" title="Project:Terms of Service">Terms of Use</a></li>
							</ul>
										<ul id="footer-icons" class="noprint">
										<li id="footer-copyrightico">
						<a href="http://creativecommons.org/licenses/by-sa/3.0/"><img src="https://processors.wiki.ti.com/resources/assets/licenses/cc-by-sa.png" alt="Creative Commons Attribution-ShareAlike" width="88" height="31"/></a>					</li>
										<li id="footer-poweredbyico">
						<a href="http://www.mediawiki.org/"><img src="https://processors.wiki.ti.com/resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31"/></a>					</li>
									</ul>
						<div style="clear: both;"></div>
		</div>
		<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgPageParseReport":{"limitreport":{"cputime":"0.080","walltime":"0.082","ppvisitednodes":{"value":424,"limit":1000000},"ppgeneratednodes":{"value":778,"limit":1000000},"postexpandincludesize":{"value":669,"limit":2097152},"templateargumentsize":{"value":0,"limit":2097152},"expansiondepth":{"value":2,"limit":40},"expensivefunctioncount":{"value":0,"limit":100},"unstrip-depth":{"value":0,"limit":20},"unstrip-size":{"value":5102,"limit":5000000},"timingprofile":["100.00%    1.361      1 Template:Sitara_SDK_Linaro_Switch_Template","100.00%    1.361      1 -total"]},"cachereport":{"timestamp":"20201201020643","ttl":86400,"transientcontent":false}}});});</script><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":232});});</script>
	</body>

<!-- Mirrored from processors.wiki.ti.com/index.php/AMSDK_u-boot_User%27s_Guide by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 01 Dec 2020 06:23:29 GMT -->
</html>
