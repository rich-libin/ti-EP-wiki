<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">

<!-- Mirrored from processors.wiki.ti.com/index.php/AM335X_USB_Driver_User_Guide_04.06.00 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 01 Dec 2020 06:20:46 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8"/>
<title>AM335X USB Driver User Guide 04.06.00 - Texas Instruments Wiki</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"AM335X_USB_Driver_User_Guide_04.06.00","wgTitle":"AM335X USB Driver User Guide 04.06.00","wgCurRevisionId":114478,"wgRevisionId":114478,"wgArticleId":15318,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["AM335x"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"AM335X_USB_Driver_User_Guide_04.06.00","wgRelevantArticleId":15318,"wgRequestId":"918b3b0707c750a9dc0e6171","wgIsProbablyEditable":false,"wgRelevantPageIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[]});mw.loader.state({"site.styles":"ready","noscript":"ready","user.styles":"ready","user":"ready","user.options":"ready","user.tokens":"loading","mediawiki.legacy.shared":"ready","mediawiki.legacy.commonPrint":"ready","mediawiki.sectionAnchor":"ready","mediawiki.skinning.interface":"ready","skins.vector.styles":"ready"});mw.loader.implement("user.tokens@19o3a1s",function($,jQuery,require,module){/*@nomin*/mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});
});mw.loader.load(["site","mediawiki.page.startup","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.toc","mediawiki.searchSuggest","skins.vector.js"]);});</script>
<link rel="stylesheet" href="https://processors.wiki.ti.com/load.php?debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.interface%7Cskins.vector.styles&amp;only=styles&amp;skin=vector"/>
<script async="" src="https://processors.wiki.ti.com/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=vector"></script>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="https://processors.wiki.ti.com/load.php?debug=false&amp;lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=vector"/>
<meta name="generator" content="MediaWiki 1.31.6"/>
<link rel="shortcut icon" href="https://processors.wiki.ti.com/favicon.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="https://processors.wiki.ti.com/opensearch_desc.php" title="Texas Instruments Wiki (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="https://processors.wiki.ti.com/api.php?action=rsd"/>
<link rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/"/>
<link rel="alternate" type="application/atom+xml" title="Texas Instruments Wiki Atom feed" href="https://processors.wiki.ti.com/index.php?title=Special:RecentChanges&amp;feed=atom"/>
<!--[if lt IE 9]><script src="/load.php?debug=false&amp;lang=en&amp;modules=html5shiv&amp;only=scripts&amp;skin=Vector&amp;sync=1"></script><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-AM335X_USB_Driver_User_Guide_04_06_00 rootpage-AM335X_USB_Driver_User_Guide_04_06_00 skin-vector action-view">		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<div id="content" class="mw-body" role="main">
			<a id="top"></a>
			<div id="siteNotice" class="mw-body-content"><div id="localNotice" lang="en" dir="ltr"><div class="mw-parser-output"><p><br />
<span style="color:#ff0000"><b>NOTICE: The Processors Wiki will End-of-Life on January 15, 2021. It is recommended to download any files or other content you may need that are hosted on processors.wiki.ti.com. The site is now set to read only.</b></span>
</p></div></div></div><div class="mw-indicators mw-body-content">
</div>
<h1 id="firstHeading" class="firstHeading" lang="en">AM335X USB Driver User Guide 04.06.00</h1>			<div id="bodyContent" class="mw-body-content">
				<div id="siteSub" class="noprint">From Texas Instruments Wiki</div>				<div id="contentSub"></div>
								<div id="jump-to-nav" class="mw-jump">
					Jump to:					<a href="#mw-head">navigation</a>, 					<a href="#p-search">search</a>
				</div>
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output"><p><br />
</p>
<div style="width:800px; text-align:justify;"> 
<div style="display:block; clear: both; margin: 10px 0px; padding: 0px; background-color: #ee1d23; text-align:right;"><a href="File_TIBanner.html" class="image"><img alt="TIBanner.png" src="https://processors.wiki.ti.com/images/c/cd/TIBanner.png" width="667" height="87" /></a></div>
<div style="display:block; margin: 5px 0px; padding: 2px 5px; font-size:1.5em; font-weight:bold; text-align:left;">AM335X USB Driver User Guide</div>
<div style="display:block; margin: 5px 0px; padding: 2px; color: #666666; font-size:1.0em; font-weight:bold; text-align:right;">Linux PSP</div> 
<p><br />
<br /> 
</p>
<div id="toc" class="toc"><div class="toctitle" lang="en" dir="ltr"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Quick_Start_Guide"><span class="tocnumber">1</span> <span class="toctext"><b>Quick Start Guide</b></span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Introduction"><span class="tocnumber">2</span> <span class="toctext"><b>Introduction</b></span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#References"><span class="tocnumber">2.1</span> <span class="toctext"><b>References</b></span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Acronyms_.26_Definitions"><span class="tocnumber">2.2</span> <span class="toctext"><b>Acronyms &amp; Definitions</b></span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5"><a href="#Linux_Software_Architecture"><span class="tocnumber">3</span> <span class="toctext"><b> Linux Software Architecture </b></span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#MUSB_controller_driver"><span class="tocnumber">3.1</span> <span class="toctext"><b>MUSB controller driver </b></span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Linux_USB_Stack_Architecture"><span class="tocnumber">3.2</span> <span class="toctext"><b>Linux USB Stack Architecture </b></span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-8"><a href="#Driver_Features"><span class="tocnumber">4</span> <span class="toctext"><b>Driver Features</b></span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Configuration"><span class="tocnumber">5</span> <span class="toctext"><b>Configuration</b></span></a>
<ul>
<li class="toclevel-2 tocsection-10"><a href="#MUSB_controller_driver_2"><span class="tocnumber">5.1</span> <span class="toctext"><b>MUSB controller driver</b></span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#USB_Host_Configuration"><span class="tocnumber">5.2</span> <span class="toctext"><b>USB Host Configuration</b></span></a>
<ul>
<li class="toclevel-3 tocsection-12"><a href="#Host_Mass_Storage_Class_.28MSC.29"><span class="tocnumber">5.2.1</span> <span class="toctext"><b>Host Mass Storage Class (MSC)</b></span></a></li>
<li class="toclevel-3 tocsection-13"><a href="#Host_HID_class"><span class="tocnumber">5.2.2</span> <span class="toctext"><b>Host HID class</b></span></a></li>
<li class="toclevel-3 tocsection-14"><a href="#Host_Audio_class"><span class="tocnumber">5.2.3</span> <span class="toctext"><b>Host Audio class</b></span></a></li>
<li class="toclevel-3 tocsection-15"><a href="#Host_Video_class"><span class="tocnumber">5.2.4</span> <span class="toctext"><b>Host Video class</b></span></a></li>
<li class="toclevel-3 tocsection-16"><a href="#Host_CDC_class"><span class="tocnumber">5.2.5</span> <span class="toctext"><b>Host CDC class</b></span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-17"><a href="#USB_Device_Configuration"><span class="tocnumber">5.3</span> <span class="toctext"><b>USB Device Configuration</b></span></a>
<ul>
<li class="toclevel-3 tocsection-18"><a href="#Device_CDC_and_RNDIS_gadget"><span class="tocnumber">5.3.1</span> <span class="toctext"><b>Device CDC and RNDIS gadget </b></span></a></li>
<li class="toclevel-3 tocsection-19"><a href="#Device_File_Storage_gadget"><span class="tocnumber">5.3.2</span> <span class="toctext"><b>Device File Storage gadget </b></span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-20"><a href="#Module_build"><span class="tocnumber">5.4</span> <span class="toctext"><b> Module build </b></span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-21"><a href="#Port_mode_configuration"><span class="tocnumber">6</span> <span class="toctext"><b> Port mode configuration </b></span></a></li>
<li class="toclevel-1 tocsection-22"><a href="#Modular_tests"><span class="tocnumber">7</span> <span class="toctext"><b> Modular tests </b></span></a></li>
<li class="toclevel-1 tocsection-23"><a href="#USB_OTG_.28HNP.2FSRP.29_testing"><span class="tocnumber">8</span> <span class="toctext"><b> USB OTG (HNP/SRP) testing </b></span></a></li>
<li class="toclevel-1 tocsection-24"><a href="#Software_Interface"><span class="tocnumber">9</span> <span class="toctext"><b> Software Interface </b></span></a></li>
</ul>
</div>

<h1><span class="mw-headline" id="Quick_Start_Guide"><b>Quick Start Guide</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AM335X_USB_Driver_User_Guide_04.06.00&amp;action=edit&amp;section=1" title="Edit section: Quick Start Guide">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>This section is a quick guide on how to start using usb ports on AM335x platform with supplied pre-built binaries. Please refer to <a href="Usb-am335x-quick-start.html" title="Usb-am335x-quick-start"> USB Quick Start</a>
</p>
<h1><span class="mw-headline" id="Introduction"><b>Introduction</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AM335X_USB_Driver_User_Guide_04.06.00&amp;action=edit&amp;section=2" title="Edit section: Introduction">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>AM335x USB subsystem has two instance of mentor usb controller. Each controller is based on USB2.0 standards supporting high, full and low speed. Communication Port Programming Interface 4.1 (CPPI4.1) DMA controller is used by each musb controller to transfer data between external memory and endpoint FIFOs. There are 15 Tx and 15 Rx endpoints for each musb controller in addition to endpoint-0. CPPI4.1 DMA can not be used for data transfers on endpoint-0 and so CPU is used for all transfers on endpoint-0. 
Please refer to AM335x Technical Reference Manual (TRM) for details. 
</p>
<h2><span class="mw-headline" id="References"><b>References</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AM335X_USB_Driver_User_Guide_04.06.00&amp;action=edit&amp;section=3" title="Edit section: References">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li>The USB2.0 specification standard <a rel="nofollow" class="external text" href="http://www.usb.org/developers/docs/usb_20_101111.zip">USB 2.0 spec </a></li>
<li>AM335x Technical Reference Manual <a rel="nofollow" class="external text" href="http://ti.com/lit/ds/symlink/am3358.pdf">here</a></li></ul>
<h2><span id="Acronyms_&amp;_Definitions"></span><span class="mw-headline" id="Acronyms_.26_Definitions"><b>Acronyms &amp; Definitions</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AM335X_USB_Driver_User_Guide_04.06.00&amp;action=edit&amp;section=4" title="Edit section: Acronyms &amp; Definitions">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<table border="1" cellspacing="0" cellpadding="5" width="40%">

<tbody><tr>
<th style="background-color: green;">Acronym
</th>
<th style="background-color: green;">Definition
</th></tr>
<tr>
<td>USB
</td>
<td>Universal Serial Bus
</td></tr>
<tr>
<td>OTG
</td>
<td>On The Go
</td></tr>
<tr>
<td>HS/FS/LS
</td>
<td>Highspeed/Fullspeed/LowSpeed
</td></tr>
<tr>
<td>UAC
</td>
<td>USB Audio Class
</td></tr>
<tr>
<td>UVC
</td>
<td>USB Video Class
</td></tr>
<tr>
<td>HID
</td>
<td>Human Interface Devices
</td></tr>
<tr>
<td>CDC
</td>
<td>Communication Device Class
</td></tr>
<tr>
<td>RNDIS
</td>
<td>Remote Network Device Interface Specification
</td></tr>
<tr>
<td>DTM
</td>
<td>Driver Test Manager
</td></tr></tbody></table>
<h1><span class="mw-headline" id="Linux_Software_Architecture"><b> Linux Software Architecture </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AM335X_USB_Driver_User_Guide_04.06.00&amp;action=edit&amp;section=5" title="Edit section: Linux Software Architecture">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h2><span class="mw-headline" id="MUSB_controller_driver"><b>MUSB controller driver </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AM335X_USB_Driver_User_Guide_04.06.00&amp;action=edit&amp;section=6" title="Edit section: MUSB controller driver">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The Linux MUSB controller driver is a host controller driver (HCD) and gadget controller driver for musb controller. As musb controller is an OTG controller so each musb port can act as either as host or as a device. The musb host controller driver (HCD) registers the host controller hardware to linux usb core stack and similarly musb gadget controller driver registers itself to the udc core.
</p>
<h2><span class="mw-headline" id="Linux_USB_Stack_Architecture"><b>Linux USB Stack Architecture </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AM335X_USB_Driver_User_Guide_04.06.00&amp;action=edit&amp;section=7" title="Edit section: Linux USB Stack Architecture">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Linux usb stack is a layered architecture where musb controller driver is at lowest layer. Linux USB core layer provides API interface to host class drivers and forwards the request from class drivers to intended host controller driver. Gadget drivers (function driver) binds itself with gadget controller driver and uses gadget drivers functions to perform data transfers.
</p><p><a href="File_Usb-stack-arch-image.html" class="image"><img alt="Usb-stack-arch-image.JPG" src="https://processors.wiki.ti.com/images/1/1a/Usb-stack-arch-image.JPG" width="782" height="668" /></a>
</p>
<h1><span class="mw-headline" id="Driver_Features"><b>Driver Features</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AM335X_USB_Driver_User_Guide_04.06.00&amp;action=edit&amp;section=8" title="Edit section: Driver Features">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>This section describes the Linux musb controller driver feature.
</p>
<ul><li>The musb controller driver can be built as loadable module or statically built inside the kernel image.</li>
<li>Supports both PIO (non DMA mode) and DMA mode (Note: DMA mode not applicable for control endpoint)</li>
<li>Concurrent usage of both the musb ports either in host or in device mode.</li></ul>
<p>Please refer the table below for supported usb class and gadget drivers with the release.
</p>
<table cellspacing="0" cellpadding="5" border="1" style="width: 800px">

<tbody><tr style="background: rgb(221, 255, 221)">
<th colspan="2"><b>Host</b>
</th>
<th colspan="2"><b>Device</b>
</th></tr>
<tr>
<th><b>Feature</b>
</th>
<th><b>Status</b>
</th>
<th><b>Feature</b>
</th>
<th><b>Status</b>
</th></tr>
<tr>
<td>Hub class
</td>
<td style="background: #00A000;"><b>Supported</b>
</td>
<td>File Storage Gadget
</td>
<td style="background: #00A000;"><b>Supported</b>
</td></tr>
<tr>
<td>HID
</td>
<td style="background: #00A000;"><b>Supported</b>
</td>
<td>CDC
</td>
<td style="background: #00A000;"><b>Supported</b>
</td></tr>
<tr>
<td>MSC
</td>
<td style="background: #00A000;"><b>Supported</b>
</td>
<td>RNDIS
</td>
<td style="background: #00A000;"><b>Supported</b>
</td></tr>
<tr>
<td>UVC
</td>
<td style="background: #00A000;"><b>Supported from PSP-04.06.00.05 onward</b>
</td>
<td>
</td>
<td>
</td></tr>
<tr>
<td>UAC
</td>
<td style="background: #00A000;"><b>Supported from PSP-04.06.00.05 onward</b>
</td>
<td>
</td>
<td>
</td></tr>
<tr>
<td>OTG (HNP)
</td>
<td style="background: #00A000;"><b>Supported from PSP-04.06.00.05 onward</b>
</td>
<td>
</td>
<td>
</td></tr></tbody></table>
<p><br />
</p>
<h1><span class="mw-headline" id="Configuration"><b>Configuration</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AM335X_USB_Driver_User_Guide_04.06.00&amp;action=edit&amp;section=9" title="Edit section: Configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>This section describes the kernel config options to be selected for building musb controller driver along with host class and gadget drivers.   
</p><p><br />
</p>
<h2><span class="mw-headline" id="MUSB_controller_driver_2"><b>MUSB controller driver</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AM335X_USB_Driver_User_Guide_04.06.00&amp;action=edit&amp;section=10" title="Edit section: MUSB controller driver">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Please refer <a href="UsbConfigControllerDriver.html" title="UsbConfigControllerDriver">MUSB Controller Driver Config</a> for kernel config option for MUSB controller driver. 
</p>
<h2><span class="mw-headline" id="USB_Host_Configuration"><b>USB Host Configuration</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AM335X_USB_Driver_User_Guide_04.06.00&amp;action=edit&amp;section=11" title="Edit section: USB Host Configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>This section has details of USB host class kernel configurations.
</p>
<h3><span id="Host_Mass_Storage_Class_(MSC)"></span><span class="mw-headline" id="Host_Mass_Storage_Class_.28MSC.29"><b>Host Mass Storage Class (MSC)</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AM335X_USB_Driver_User_Guide_04.06.00&amp;action=edit&amp;section=12" title="Edit section: Host Mass Storage Class (MSC)">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Please refer <a href="UsbConfigHostMSC.html" title="UsbConfigHostMSC">Host MSC</a> for kernel config options to be enabled for host mass storage class.
</p>
<h3><span class="mw-headline" id="Host_HID_class"><b>Host HID class</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AM335X_USB_Driver_User_Guide_04.06.00&amp;action=edit&amp;section=13" title="Edit section: Host HID class">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Please refer <a href="UsbConfigHostHID.html" title="UsbConfigHostHID">Host HID</a> for kernel config options to be enabled for host HID class.
</p>
<h3><span class="mw-headline" id="Host_Audio_class"><b>Host Audio class</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AM335X_USB_Driver_User_Guide_04.06.00&amp;action=edit&amp;section=14" title="Edit section: Host Audio class">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Please refer <a href="UsbConfigHostAudio.html" title="UsbConfigHostAudio">Host Audio</a> for kernel config options to be enabled for host audio class.
</p>
<h3><span class="mw-headline" id="Host_Video_class"><b>Host Video class</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AM335X_USB_Driver_User_Guide_04.06.00&amp;action=edit&amp;section=15" title="Edit section: Host Video class">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Please refer <a href="UsbConfigHostVideo.html" title="UsbConfigHostVideo">Host Video</a> for kernel config options to be enabled for host video class.
</p>
<h3><span class="mw-headline" id="Host_CDC_class"><b>Host CDC class</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AM335X_USB_Driver_User_Guide_04.06.00&amp;action=edit&amp;section=16" title="Edit section: Host CDC class">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Please refer <a href="UsbConfigHostCDC.html" title="UsbConfigHostCDC">Host CDC</a> for kernel config options to be enabled for host CDC class.
</p>
<h2><span class="mw-headline" id="USB_Device_Configuration"><b>USB Device Configuration</b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AM335X_USB_Driver_User_Guide_04.06.00&amp;action=edit&amp;section=17" title="Edit section: USB Device Configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>This section has details of USB gadget driver kernel configurations.
</p>
<h3><span class="mw-headline" id="Device_CDC_and_RNDIS_gadget"><b>Device CDC and RNDIS gadget </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AM335X_USB_Driver_User_Guide_04.06.00&amp;action=edit&amp;section=18" title="Edit section: Device CDC and RNDIS gadget">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Please refer <a href="UsbConfigDevCDC.html" title="UsbConfigDevCDC">CDC Gadget</a> for kernel config options to be enabled for CDC gadget driver and refer <a href="UsbConfigDevRNDIS.html" title="UsbConfigDevRNDIS">RNDIS Gadget</a> for kernel config options to be enabled for RNDIS gadget driver.
</p>
<h3><span class="mw-headline" id="Device_File_Storage_gadget"><b>Device File Storage gadget </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AM335X_USB_Driver_User_Guide_04.06.00&amp;action=edit&amp;section=19" title="Edit section: Device File Storage gadget">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Please refer <a href="UsbConfigDevFSG.html" title="UsbConfigDevFSG">File Storage Gadget</a> for kernel config options to be enabled for File Storage gadget driver.
</p>
<h2><span class="mw-headline" id="Module_build"><b> Module build </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AM335X_USB_Driver_User_Guide_04.06.00&amp;action=edit&amp;section=20" title="Edit section: Module build">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Module build for usb driver is supported. Please select <b>&lt;M&gt;</b> in place of <b>&lt;*&gt;</b> for all the drivers in kernel config as explained above.
</p>
<h1><span class="mw-headline" id="Port_mode_configuration"><b> Port mode configuration </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AM335X_USB_Driver_User_Guide_04.06.00&amp;action=edit&amp;section=21" title="Edit section: Port mode configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>AM335x has two musb port and each of them are OTG capable which means each of them can act <i>host only</i> or <i>device only</i> or <i>both</i> based on board configurations. Each musb port mode can be configured for a custom board at it's board file at arch/arm/mach-omap2/board-xxx.c. Please update "mode" field within 'struct omap_musb_board_data' for configuring port mode. mode[D0:D3] is mode for musb0 port and mode[D4:D7] is mode for musb1 port.
</p>
<h1><span class="mw-headline" id="Modular_tests"><b> Modular tests </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AM335X_USB_Driver_User_Guide_04.06.00&amp;action=edit&amp;section=22" title="Edit section: Modular tests">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>Selecting the musb controller driver as module would build four different module which needs to inserted in below order for testing musb port.
</p>
<ul><li>insmod musb_hdrc.ko for inserting musb core module.</li>
<li>insmod cppi41dma.ko for inserting dma module. Please skip this step if DMA is disabled.</li>
<li>insmod ti81xx.ko for inserting platform glue module.</li>
<li>insmod g_ether.ko OR insmod g_file_storage.ko file=&lt;file-path&gt; stall=0 to insert a gadget module. Please skip this step if port is configured to be host only in board file.</li></ul>
<h1><span id="USB_OTG_(HNP/SRP)_testing"></span><span class="mw-headline" id="USB_OTG_.28HNP.2FSRP.29_testing"><b> USB OTG (HNP/SRP) testing </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AM335X_USB_Driver_User_Guide_04.06.00&amp;action=edit&amp;section=23" title="Edit section: USB OTG (HNP/SRP) testing">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<div style="margin: 5px; padding: 2px 10px; background-color: #ecffff; border-left: 5px solid #3399ff;"><b>NOTE</b><br /><br /> SRP doesn't work on AM335x and Vbus is always switched on from initial A-device.</div>
<p>Please refer <a href="UsbTestOTG.html" title="UsbTestOTG">USB OTG (HNP/SRP) testing</a> for details on how to test HNP and SRP.
</p>
<h1><span class="mw-headline" id="Software_Interface"><b> Software Interface </b></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=AM335X_USB_Driver_User_Guide_04.06.00&amp;action=edit&amp;section=24" title="Edit section: Software Interface">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>Please refer <a href="UsbSoftwareInterface.html" title="UsbSoftwareInterface">Software Interface</a> for details on software interface available in sysfs, profs and debugfs.
</p></div>
<!-- 
NewPP limit report
Cached time: 20201130061454
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.069 seconds
Real time usage: 0.073 seconds
Preprocessor visited node count: 120/1000000
Preprocessor generated node count: 190/1000000
Post‐expand include size: 697/2097152 bytes
Template argument size: 118/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 0/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    4.817      1 -total
 34.76%    1.674      1 Template:SpArticleStart
 28.79%    1.387      1 Template:SpLicenseCC-SA
 26.84%    1.293      1 Template:SpNote
-->
</div>
<!-- Saved in parser cache with key procwiki:pcache:idhash:15318-0!canonical and timestamp 20201130061454 and revision id 114478
 -->
<div class='hf-nsfooter' id='hf-nsfooter-'><table style="text-align:center; background:white; width:100%; text-align:left; height: 65px border-top: 1px solid; border-bottom: 1px solid; border-left: 1px solid; border-right: 1px solid; border-width: 1px; border-style: solid;">
<tr>
<td width="305px"><a href="File_E2e.html" class="image"><img alt="E2e.jpg" src="https://processors.wiki.ti.com/images/8/82/E2e.jpg" width="305" height="63" /></a>
</td>
<td>{{
<ol><li>switchcategory:MultiCore=</li></ol>
<ul><li>For technical support on MultiCore devices, please post your questions in the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/c6000_multi-core_dsps/default.aspx">C6000 MultiCore Forum</a></li>
<li>For questions related to the BIOS MultiCore SDK (MCSDK), please use the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/embedded/f/355.aspx">BIOS Forum</a></li></ul>
<p>Please post only comments related to the article <b>AM335X USB Driver User Guide 04.06.00</b> here.<i></i>
</p>
</td>
<td>Keystone=
<ul><li>For technical support on MultiCore devices, please post your questions in the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/c6000_multi-core_dsps/default.aspx">C6000 MultiCore Forum</a></li>
<li>For questions related to the BIOS MultiCore SDK (MCSDK), please use the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/embedded/f/355.aspx">BIOS Forum</a></li></ul>
<p>Please post only comments related to the article <b>AM335X USB Driver User Guide 04.06.00</b> here.<i></i>
</p>
</td>
<td>C2000=<i>For technical support on the C2000 please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/microcontrollers/tms320c2000_32-bit_real-time_mcus/f/171.aspx">The C2000 Forum</a>. Please post only comments about the article <b>AM335X USB Driver User Guide 04.06.00</b> here.</i>
</td>
<td>DaVinci=<i>For technical support on DaVincoplease post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/davinci_digital_media_processors/default.aspx">The DaVinci Forum</a>. Please post only comments about the article <b>AM335X USB Driver User Guide 04.06.00</b> here.</i>
</td>
<td>MSP430=<i>For technical support on MSP430 please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/microcontrollers/msp43016-bit_ultra-low_power_mcus/default.aspx">The MSP430 Forum</a>. Please post only comments about the article <b>AM335X USB Driver User Guide 04.06.00</b> here.</i>
</td>
<td>OMAP35x=<i>For technical support on OMAP please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/omap_applications_processors/default.aspx">The OMAP Forum</a>. Please post only comments about the article <b>AM335X USB Driver User Guide 04.06.00</b> here.</i>
</td>
<td>OMAPL1=<i>For technical support on OMAP please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/omap_applications_processors/default.aspx">The OMAP Forum</a>. Please post only comments about the article <b>AM335X USB Driver User Guide 04.06.00</b> here.</i>
</td>
<td>MAVRK=<i>For technical support on MAVRK please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/development_tools/mavrk/default.aspx">The MAVRK Toolbox Forum</a>. Please post only comments about the article <b>AM335X USB Driver User Guide 04.06.00</b> here.</i>
</td>
<td><i>For technical support please post your questions at <a rel="nofollow" class="external text" href="http://e2e.ti.com/">http://e2e.ti.com</a>. Please post only comments about the article <b>AM335X USB Driver User Guide 04.06.00</b> here.</i>
<p>}}
</p>
</td></tr></table>
<table style="border-style:solid; border-width:1px; text-align:center; width:100%;">

<tr style="font-size:150%;">
<td rowspan="2"><a href="File_Hyperlink_blue.html" class="image"><img alt="Hyperlink blue.png" src="https://processors.wiki.ti.com/images/9/9f/Hyperlink_blue.png" width="96" height="96" /></a>
</td>
<td><b>Links</b>
</td></tr>
<tr>
<td>
<table style="text-align: left;">
<tr>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/amplifier_and_linear.page">Amplifiers &amp; Linear</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/audio/audio_overview.page">Audio</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/rfif.page">Broadband RF/IF &amp; Digital Radio</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/clocksandtimers/clocks_and_timers.page">Clocks &amp; Timers</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/dataconverters/data_converter.page">Data Converters</a>
</p>
</td>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/mems/mems.page">DLP &amp; MEMS</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/high_reliability.page">High-Reliability</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/interface/interface.page">Interface</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/logic/home_overview.page">Logic</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/powermanagement/power_portal.page">Power Management</a>
</p>
</td>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/dsp/embedded_processor.page">Processors</a>
</p>
<ul><li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/dsp/arm.page">ARM Processors</a></li>
<li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/dsp/home.page">Digital Signal Processors (DSP)</a></li>
<li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/microcontroller/home.page">Microcontrollers (MCU)</a></li>
<li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/omap-applications-processors/the-omap-experience.page">OMAP Applications Processors</a></li></ul>
</td>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/switches_and_multiplexers.page">Switches &amp; Multiplexers</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/temperature_sensor.page">Temperature Sensors &amp; Control ICs</a><br/>
<a rel="nofollow" class="external text" href="http://focus.ti.com/wireless/docs/wirelessoverview.tsp?familyId=2003&amp;sectionId=646&amp;tabId=2735">Wireless Connectivity</a>
</p>
</td></tr></table>
</td></tr></table>
<div id="tiPrivacy"></div>
</div></div>					<div class="printfooter">
						Retrieved from "<a dir="ltr" href="https://processors.wiki.ti.com/index.php?title=AM335X_USB_Driver_User_Guide_04.06.00&amp;oldid=114478">https://processors.wiki.ti.com/index.php?title=AM335X_USB_Driver_User_Guide_04.06.00&amp;oldid=114478</a>"					</div>
				<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="Special_Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="Category_AM335x.html" title="Category:AM335x">AM335x</a></li></ul></div></div>				<div class="visualClear"></div>
							</div>
		</div>
		<div id="mw-navigation">
			<h2>Navigation menu</h2>
			<div id="mw-head">
									<div id="p-personal" role="navigation" class="" aria-labelledby="p-personal-label">
						<h3 id="p-personal-label">Personal tools</h3>
						<ul>
							<li id="pt-login"><a href="https://processors.wiki.ti.com/index.php?title=Special:UserLogin&amp;returnto=AM335X+USB+Driver+User+Guide+04.06.00" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li><li id="pt-createaccount"><a href="Special_RequestAccount.html" title="You are encouraged to create an account and log in; however, it is not mandatory">Request account</a></li>						</ul>
					</div>
									<div id="left-navigation">
										<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
						<h3 id="p-namespaces-label">Namespaces</h3>
						<ul>
							<li id="ca-nstab-main" class="selected"><span><a href="AM335X_USB_Driver_User_Guide_04.06.html" title="View the content page [c]" accesskey="c">Page</a></span></li><li id="ca-talk" class="new"><span><a href="https://processors.wiki.ti.com/index.php?title=Talk:AM335X_USB_Driver_User_Guide_04.06.00&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page (page does not exist) [t]" accesskey="t">Discussion</a></span></li>						</ul>
					</div>
										<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
												<input type="checkbox" class="vectorMenuCheckbox" aria-labelledby="p-variants-label" />
						<h3 id="p-variants-label">
							<span>Variants</span>
						</h3>
						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
									</div>
				<div id="right-navigation">
										<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
						<h3 id="p-views-label">Views</h3>
						<ul>
							<li id="ca-view" class="collapsible selected"><span><a href="AM335X_USB_Driver_User_Guide_04.06.html">Read</a></span></li><li id="ca-viewsource" class="collapsible"><span><a href="https://processors.wiki.ti.com/index.php?title=AM335X_USB_Driver_User_Guide_04.06.00&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></span></li><li id="ca-history" class="collapsible"><span><a href="https://processors.wiki.ti.com/index.php?title=AM335X_USB_Driver_User_Guide_04.06.00&amp;action=history" title="Past revisions of this page [h]" accesskey="h">View history</a></span></li>						</ul>
					</div>
										<div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label">
						<input type="checkbox" class="vectorMenuCheckbox" aria-labelledby="p-cactions-label" />
						<h3 id="p-cactions-label"><span>More</span></h3>
						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
										<div id="p-search" role="search">
						<h3>
							<label for="searchInput">Search</label>
						</h3>
						<form action="https://processors.wiki.ti.com/index.php" id="searchform">
							<div id="simpleSearch">
								<input type="search" name="search" placeholder="Search Texas Instruments Wiki" title="Search Texas Instruments Wiki [f]" accesskey="f" id="searchInput"/><input type="hidden" value="Special:Search" name="title"/><input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton mw-fallbackSearchButton"/><input type="submit" name="go" value="Go" title="Go to a page with this exact name if it exists" id="searchButton" class="searchButton"/>							</div>
						</form>
					</div>
									</div>
			</div>
			<div id="mw-panel">
				<div id="p-logo" role="banner"><a class="mw-wiki-logo" href="Main_Page.html"  title="Visit the main page"></a></div>
						<div class="portal" role="navigation" id="p-navigation" aria-labelledby="p-navigation-label">
			<h3 id="p-navigation-label">Navigation</h3>
			<div class="body">
								<ul>
					<li id="n-mainpage"><a href="Main_Page.html" title="Visit the main page [z]" accesskey="z">Main Page</a></li><li id="n-All-pages"><a href="Special_AllPages.html">All pages</a></li><li id="n-All-categories"><a href="Special_Categories.html">All categories</a></li><li id="n-recentchanges"><a href="Special_RecentChanges.html" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li><li id="n-randompage"><a href="Package_Reflow_Profiles.html" title="Load a random page [x]" accesskey="x">Random page</a></li><li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" title="The place to find out">Help</a></li>				</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id="p-tb" aria-labelledby="p-tb-label">
			<h3 id="p-tb-label">Toolbox</h3>
			<div class="body">
								<ul>
					<li id="t-whatlinkshere"><a href="Special_WhatLinksHere/AM335X_USB_Driver_User_Guide_04.06.html" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li><li id="t-recentchangeslinked"><a href="Special_RecentChangesLinked/AM335X_USB_Driver_User_Guide_04.06.html" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li><li id="t-specialpages"><a href="Special_SpecialPages.html" title="A list of all special pages [q]" accesskey="q">Special pages</a></li><li id="t-print"><a href="https://processors.wiki.ti.com/index.php?title=AM335X_USB_Driver_User_Guide_04.06.00&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li><li id="t-permalink"><a href="https://processors.wiki.ti.com/index.php?title=AM335X_USB_Driver_User_Guide_04.06.00&amp;oldid=114478" title="Permanent link to this revision of the page">Permanent link</a></li><li id="t-info"><a href="https://processors.wiki.ti.com/index.php?title=AM335X_USB_Driver_User_Guide_04.06.00&amp;action=info" title="More information about this page">Page information</a></li>				</ul>
							</div>
		</div>
				</div>
		</div>
				<div id="footer" role="contentinfo">
						<ul id="footer-info">
								<li id="footer-info-lastmod"> This page was last edited on 24 July 2012, at 21:10.</li>
								<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-ShareAlike</a> unless otherwise noted.</li>
							</ul>
						<ul id="footer-places">
								<li id="footer-places-privacy"><a href="Project_Privacy_policy.html" title="Project:Privacy policy">Privacy policy</a></li>
								<li id="footer-places-about"><a href="Project_About.html" title="Project:About">About Texas Instruments Wiki</a></li>
								<li id="footer-places-disclaimer"><a href="Project_General_disclaimer.html" title="Project:General disclaimer">Disclaimers</a></li>
								<li id="footer-places-termsofservice"><a href="Project_Terms_of_Service.html" title="Project:Terms of Service">Terms of Use</a></li>
							</ul>
										<ul id="footer-icons" class="noprint">
										<li id="footer-copyrightico">
						<a href="http://creativecommons.org/licenses/by-sa/3.0/"><img src="https://processors.wiki.ti.com/resources/assets/licenses/cc-by-sa.png" alt="Creative Commons Attribution-ShareAlike" width="88" height="31"/></a>					</li>
										<li id="footer-poweredbyico">
						<a href="http://www.mediawiki.org/"><img src="https://processors.wiki.ti.com/resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31"/></a>					</li>
									</ul>
						<div style="clear: both;"></div>
		</div>
		<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgPageParseReport":{"limitreport":{"cputime":"0.069","walltime":"0.073","ppvisitednodes":{"value":120,"limit":1000000},"ppgeneratednodes":{"value":190,"limit":1000000},"postexpandincludesize":{"value":697,"limit":2097152},"templateargumentsize":{"value":118,"limit":2097152},"expansiondepth":{"value":2,"limit":40},"expensivefunctioncount":{"value":0,"limit":100},"unstrip-depth":{"value":0,"limit":20},"unstrip-size":{"value":0,"limit":5000000},"timingprofile":["100.00%    4.817      1 -total"," 34.76%    1.674      1 Template:SpArticleStart"," 28.79%    1.387      1 Template:SpLicenseCC-SA"," 26.84%    1.293      1 Template:SpNote"]},"cachereport":{"timestamp":"20201130061454","ttl":86400,"transientcontent":false}}});});</script><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":242});});</script>
	</body>

<!-- Mirrored from processors.wiki.ti.com/index.php/AM335X_USB_Driver_User_Guide_04.06.00 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 01 Dec 2020 06:20:59 GMT -->
</html>
