<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">

<!-- Mirrored from processors.wiki.ti.com/index.php/Linux_Training:Introduction_to_Cross_Compiling by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 01 Dec 2020 10:18:47 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8"/>
<title>Linux Training:Introduction to Cross Compiling - Texas Instruments Wiki</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Linux_Training:Introduction_to_Cross_Compiling","wgTitle":"Linux Training:Introduction to Cross Compiling","wgCurRevisionId":200679,"wgRevisionId":200679,"wgArticleId":38792,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Linux_Training:Introduction_to_Cross_Compiling","wgRelevantArticleId":38792,"wgRequestId":"1f4376668d4499e42d92f388","wgIsProbablyEditable":false,"wgRelevantPageIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[]});mw.loader.state({"site.styles":"ready","noscript":"ready","user.styles":"ready","user":"ready","user.options":"ready","user.tokens":"loading","mediawiki.legacy.shared":"ready","mediawiki.legacy.commonPrint":"ready","mediawiki.sectionAnchor":"ready","mediawiki.skinning.interface":"ready","skins.vector.styles":"ready"});mw.loader.implement("user.tokens@19o3a1s",function($,jQuery,require,module){/*@nomin*/mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});
});mw.loader.load(["site","mediawiki.page.startup","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.toc","mediawiki.searchSuggest","skins.vector.js"]);});</script>
<link rel="stylesheet" href="https://processors.wiki.ti.com/load.php?debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.interface%7Cskins.vector.styles&amp;only=styles&amp;skin=vector"/>
<script async="" src="https://processors.wiki.ti.com/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=vector"></script>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="https://processors.wiki.ti.com/load.php?debug=false&amp;lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=vector"/>
<meta name="generator" content="MediaWiki 1.31.6"/>
<link rel="shortcut icon" href="https://processors.wiki.ti.com/favicon.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="https://processors.wiki.ti.com/opensearch_desc.php" title="Texas Instruments Wiki (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="https://processors.wiki.ti.com/api.php?action=rsd"/>
<link rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/"/>
<link rel="alternate" type="application/atom+xml" title="Texas Instruments Wiki Atom feed" href="https://processors.wiki.ti.com/index.php?title=Special:RecentChanges&amp;feed=atom"/>
<!--[if lt IE 9]><script src="/load.php?debug=false&amp;lang=en&amp;modules=html5shiv&amp;only=scripts&amp;skin=Vector&amp;sync=1"></script><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Linux_Training_Introduction_to_Cross_Compiling rootpage-Linux_Training_Introduction_to_Cross_Compiling skin-vector action-view">		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<div id="content" class="mw-body" role="main">
			<a id="top"></a>
			<div id="siteNotice" class="mw-body-content"><div id="localNotice" lang="en" dir="ltr"><div class="mw-parser-output"><p><br />
<span style="color:#ff0000"><b>NOTICE: The Processors Wiki will End-of-Life on January 15, 2021. It is recommended to download any files or other content you may need that are hosted on processors.wiki.ti.com. The site is now set to read only.</b></span>
</p></div></div></div><div class="mw-indicators mw-body-content">
</div>
<h1 id="firstHeading" class="firstHeading" lang="en">Linux Training:Introduction to Cross Compiling</h1>			<div id="bodyContent" class="mw-body-content">
				<div id="siteSub" class="noprint">From Texas Instruments Wiki</div>				<div id="contentSub"></div>
								<div id="jump-to-nav" class="mw-jump">
					Jump to:					<a href="#mw-head">navigation</a>, 					<a href="#p-search">search</a>
				</div>
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output"><div id="toc" class="toc"><div class="toctitle" lang="en" dir="ltr"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Prerequisite"><span class="tocnumber">1</span> <span class="toctext">Prerequisite</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#SDK"><span class="tocnumber">1.1</span> <span class="toctext">SDK</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Lab_Files"><span class="tocnumber">1.2</span> <span class="toctext">Lab Files</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Create_Directory"><span class="tocnumber">1.3</span> <span class="toctext">Create Directory</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5"><a href="#Lab_1"><span class="tocnumber">2</span> <span class="toctext">Lab 1</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Lab_2"><span class="tocnumber">3</span> <span class="toctext">Lab 2</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Lab_3"><span class="tocnumber">4</span> <span class="toctext">Lab 3</span></a>
<ul>
<li class="toclevel-2 tocsection-8"><a href="#Lab_3a"><span class="tocnumber">4.1</span> <span class="toctext">Lab 3a</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Lab_3b"><span class="tocnumber">4.2</span> <span class="toctext">Lab 3b</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Lab_3c"><span class="tocnumber">4.3</span> <span class="toctext">Lab 3c</span></a></li>
</ul>
</li>
</ul>
</div>

<h1><span class="mw-headline" id="Prerequisite">Prerequisite</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Linux_Training:Introduction_to_Cross_Compiling&amp;action=edit&amp;section=1" title="Edit section: Prerequisite">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>This training assumes you already have Processor Linux SDK 1.0 installed. The instructions and screen shots will be based on the AM335x SDK. The instructions should generally be the same AM335x and AM437x SDK. Although path's may slightly change.
</p><p>Since everyone's computer is different and the sdk may be installed anywhere the exact commands that need to be used may change depending on each user's setup.
</p><p>To keep things generic, folder path's placeholders will be used. This makes it clear that the path required is dependent on the user's setup. When you see any place holder make sure you replace it with the proper path based on your local setup.
</p>
<h2><span class="mw-headline" id="SDK">SDK</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Linux_Training:Introduction_to_Cross_Compiling&amp;action=edit&amp;section=2" title="Edit section: SDK">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The full path to the Processor Linux SDK 1.0 will be referred to as:
</p><p><code>&lt;sdk-path&gt;</code>
</p>
<h2><span class="mw-headline" id="Lab_Files">Lab Files</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Linux_Training:Introduction_to_Cross_Compiling&amp;action=edit&amp;section=3" title="Edit section: Lab Files">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>This lab also requires lab files and is located within a git repository. Choose the location where you want these files to be located and run the below command:
</p><p><code>
git clone <a rel="nofollow" class="external free" href="git://git.ti.com/sitara-linux/toolchain-lab.git">git://git.ti.com/sitara-linux/toolchain-lab.git</a>
</code></p><p><code>cd toolchain-lab
</code></p><p><code>git checkout processor-linux-sdk-v1.0
</code>
<br /><br />
The full path to the toolchain-lab folder will be referred to as:
</p><p><code>&lt;toolchain-lab dir path&gt;</code>
</p><p><br />
</p>
<h2><span class="mw-headline" id="Create_Directory">Create Directory</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Linux_Training:Introduction_to_Cross_Compiling&amp;action=edit&amp;section=4" title="Edit section: Create Directory">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>This lab also requires a directory called cross-compiled to be created. Create a directory called cross-compiled.
</p><p>The full path to this directory will be referred to as:
</p><p><code>&lt;cross-compiled dir path&gt;</code>
</p>
<h1><span class="mw-headline" id="Lab_1">Lab 1</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Linux_Training:Introduction_to_Cross_Compiling&amp;action=edit&amp;section=5" title="Edit section: Lab 1">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>This first lab will show you how to use the cross compile tool chain to build a simple hello-world program.
</p><p>The first step to using the tool chain is to include its full path in your environments PATH variable.
</p><p>This will allow you to call the tool chain’s compiler by simply entering arm-linux-gnueabihf-gcc instead of “&lt;sdk path&gt;/linux-devkit/sysroots/i686-arago-linux/usr/bin/arm-linux-gnueabihf-gcc” every time you want to use the compiler.
</p><p>The tool chain is located in your sdk’s linux-devkit/sysroots/i686-arago-linux/usr/bin directory.
</p><p>The PATH environment variable determines what programs are available to a user without having to always specify the full path to each program/. Imagine if you had to constantly type /usr/bin/cd or /usr/bin/ls!
<br /><br />
Enter the below command to add the tool chain’s path to the PATH environment variable.
</p><p><code>export PATH=&lt;sdk-path&gt;/linux-devkit/sysroots/i686-arago-linux/usr/bin:$PATH</code>
<br /><br />
To verify that your tool chain is now in your “path” enter the below characters and then hit tab:
</p><p><code>arm-</code>
<br /><br />
You should see a bunch of programs that start with arm-linux-gnueabihf- like below.
<br />
<a href="File_Toolchain-list.html" class="image"><img alt="Toolchain-list.png" src="https://processors.wiki.ti.com/images/f/f3/Toolchain-list.png" width="548" height="162" /></a>
<br /><br />
If you don’t see something similar to the above then your PATH variable was not set properly and you need to verify that the path to the toolchain was set correctly.
</p><p>Now that your tool chain is in your path you can build the hello-world example.
<br /><br />
The command you will use follows the below pattern:
</p><p><code>arm-linux-gnueabihf-gcc &lt;list of source files for a program&gt; -o &lt;name of executable&gt;</code>
<br /><br />
For this hello-world program run the below command:
</p><p><code>arm-linux-gnueabihf-gcc hello-world.c -o hello-world</code>
</p><p>You should not see anything outputted but if you type ls you should see a program called hello-world inside your current directory.
</p><p><br />
</p>
<h1><span class="mw-headline" id="Lab_2">Lab 2</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Linux_Training:Introduction_to_Cross_Compiling&amp;action=edit&amp;section=6" title="Edit section: Lab 2">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>Now that you know how to build a simple program using the cross compiler it is time to build something a bit more complex.
<br /><br />
In the terminal, execute the below command to build an example application based on the libpng library.
</p><p><code>arm-linux-gnueabihf-gcc libpng-short-example.c -o example-png</code>
<br /><br />
Oops this time you should see an error similar to the below image.
<br />
<a href="File_Png-error.html" class="image"><img alt="Png-error.png" src="https://processors.wiki.ti.com/images/c/ce/Png-error.png" width="708" height="92" /></a>
<br /><br />
A quick Google search tells us this kind of error is related to libpng.
</p><p>Usually if you don’t get a complaint about a missing header but instead see an undefined reference error message either something is wrong with the program or the compiler’s linker isn’t able to find the necessary library or doesn’t know what library to link against.
</p><p>Since the example we are trying to build comes from libpng sources we can give it the benefit of the doubt that that the program has no syntax errors.
</p><p>If you do a quick search in “&lt;sdk-path&gt;/linux-devkit/sysroots/cortexa8t2hf-vfp-neon-linux-gnueabi/usr/lib” you will find libpng headers and libraries (libpng.so) which means the required files to build this program are available and the linker isn’t linking to it for some reason. You can double check this by looking at the sdk’s manifest located in the sdk’s doc directory.
<br /><br />
<a href="File_Png-manifest.html" class="image"><img alt="Png-manifest.png" src="https://processors.wiki.ti.com/images/d/d7/Png-manifest.png" width="327" height="150" /></a>
<br /><br />
As you can see in the above image the sdk does include the libpng library so we can be sure the files are there.
</p><p>By default the compiler knows where to search for all the headers and libraries contained in linux-devkit so the problem must be related to the linker not knowing which library to link against.
</p><p>The way you do this is by passing the library to link to directly to the complier.
</p><p>If you search for libpng in linux-devkit you will see the library file libpng.so.
</p><p>So how do you tell the linker to link against libpng.so? The process is pretty simple. For the library name drop “lib” from the beginning of the library name and drop the extension from the end of the library name. And then you finally append ‘-l’ to the front and pass that directly to the compiler.
</p><p>For libpng.so this will result in -lpng being passed to the compiler.
<br /><br />
So run the below command:
</p><p><code>arm-linux-gnueabihf-gcc libpng-short-example.c -lpng -o example-png</code>
<br /><br />
If you received no error then run ls to verify that “example-png” now exist. If so you successfully built a program that linked against an external library.
</p><p>Note: Usually when building programs you didn’t create you don’t need to manually specify which library the linker should link against since the Makefile will generally handle this. Usually if you have a linking error it is due to the linker not finding the library it was told to link against.
</p>
<h1><span class="mw-headline" id="Lab_3">Lab 3</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Linux_Training:Introduction_to_Cross_Compiling&amp;action=edit&amp;section=7" title="Edit section: Lab 3">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h2><span class="mw-headline" id="Lab_3a">Lab 3a</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Linux_Training:Introduction_to_Cross_Compiling&amp;action=edit&amp;section=8" title="Edit section: Lab 3a">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>In this this portion of the lab you will build another example application that depends on the libmad library.
</p><p>Building libmad should be similar to building example-png so let’s give a shot.
<br /><br />
Run the below command in the terminal:
<code>arm-linux-gnueabihf-gcc minimad.c -o mad-example</code>
<br /><br />
<a href="File_Mad-first-error.html" class="image"><img alt="Mad-first-error.png" src="https://processors.wiki.ti.com/images/5/5a/Mad-first-error.png" width="557" height="53" /></a>
<br /><br />
The above message is something that we have never seen before. This message is saying that the compiler is unable to find the header mad.h.
</p><p>Using a bit of Google magic you will find out that mad.h is a part of the libmad library. So you can either check the sdk’s manifest (docs/software_manifest.htm) or search in “&lt;sdk-path&gt;/linux-devkit/sysroots/cortexa8t2hf-vfp-neon-linux-gnueabi/usr/include” to find references to libmad or mad.h. In both cases no header or references to libmad could be found. What will we do?
</p><p>Well with our new skills with the toolchain how hard can it be to manually cross compile the library from scratch?
<br /><br />
Run the below command to go to the libmad sources directory that was conveniently downloaded for you:
</p><p><code>cd “&lt;toolchain-lab dir path&gt;/libmad-0.15.1b”</code>
<br /><br />
Libmad uses auto tools and the first step to building an auto tools based program is to run configure.
<br /><br />
Run configure by entering the below command:
</p><p><code>./configure</code>
<br /><br />
<a href="File_Mad-second-error.html" class="image"><img alt="Mad-second-error.png" src="https://processors.wiki.ti.com/images/3/39/Mad-second-error.png" width="565" height="196" /></a>
<br /><br />
</p><p>Running ./configure may succeed but if you look closely to the output you may notice that it isn't picking up the tool chain provided in the sdk which is a problem since it means your configuring and compiling the software for your host PC not for your target device.
</p><p>From the screenshot above you will see the line asking if we are cross compiling which should say yes but since it says no that means we have a big problem.
</p><p>To fix this we need the help of environment-setup and all the useful environment variables it exports.
</p><p>When cross compiling user space programs you should always source environment-setup. This file includes a lot of helpful environment variables and best of all it already adds the compiler to your PATH!
<br /><br />
Run the below command to source environment-setup:
</p><p><code>source &lt;sdk-path&gt;/linux-devkit/environment-setup</code>
<br /><br />
In your console you should see “[linux-devkit]” in lime green colors. This is an indicator that environment-setup has been sourced in your current terminal window.
<br />
<a href="File_Linuxdevkit.html" class="image"><img alt="Linuxdevkit.png" src="https://processors.wiki.ti.com/images/a/ae/Linuxdevkit.png" width="135" height="17" /></a>
<br /><br />
Now that environment-setup has been sourced run configure again:
<br />
<code>./configure</code>
<br /><br />
<a href="File_Mad-three-error.html" class="image"><img alt="Mad-three-error.png" src="https://processors.wiki.ti.com/images/7/7a/Mad-three-error.png" width="811" height="217" /></a>
<br /><br />
You will now see that it is detecting the correct compiler but it still terminates with an error. This is because when cross compiling configure needs some additional parameters passed to it.
</p><p>So how do you know what parameters are required and what the value should be? Who cares? Environment-setup already has an environment variable called CONFIGURE_FLAGS that provides this information!
<br /><br />
Run the below command and notice that CONFIGURE_FLAGS is also being passed in.
<br /><br />
<code>./configure $CONFIGURE_FLAGS</code>
<br /><br />
<a href="File_Configure_success.html" class="image"><img alt="Configure success.png" src="https://processors.wiki.ti.com/images/8/8e/Configure_success.png" width="454" height="124" /></a>
<br /><br />
If you see something similar to the above that means configure was able to execute correctly.
</p><p>Now you simply need to run make to compile the library.
</p><p>A handy option for make is the -j option. This option lets you pass a number to run make with multiple threads.
</p><p>So to run make with 4 threads you will use make -j 4. Since modern computers typically have at least 2 cores and most likely 2 additional virtual cores which means make -j 4 will speed things up significantly.
</p><p>Bonus: Try using this option when building your kernel. You will see a significant difference in build speed.
<br /><br />
Run make with four threads by executing the below commands:
<br />
<code>make -j 4</code>
<br /><br />
<a href="File_Make-no-loc.html" class="image"><img alt="Make-no-loc.png" src="https://processors.wiki.ti.com/images/2/26/Make-no-loc.png" width="720" height="127" /></a>
<br /><br />
If make ran successfully you should see something like the above.
</p><p>Now let’s go back to our “toolchain lab” directory and build our example again.
<br /><br />
Run the below commands:
</p><p><code>cd ..
</code></p><p><code>cd
</code>
</p><p>Hmm for some reason you’re getting the same exact error message even though libmad has been cross compiled and the headers exist.
</p><p>The problem is environment-setup only knows about the libraries and headers located in linux-devkit.
</p><p>So you have two options
</p><p>Install all the headers and 	libraries into linux-devkit but that can make things messy and will 	also make it difficult to determine what came with the sdk and what 	didn't.
</p><p>Create a new directory that 	will contain all the files you manually cross compiled.
</p>
<h2><span class="mw-headline" id="Lab_3b">Lab 3b</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Linux_Training:Introduction_to_Cross_Compiling&amp;action=edit&amp;section=9" title="Edit section: Lab 3b">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>To install headers and libraries you simply run make install and it will install all the necessary headers, libraries and misc. files needed by libmad.
</p><p>So run the below command:
</p><p><code>make install</code>
<br /><br />
<a href="File_Make-install-no-loc.html" class="image"><img alt="Make-install-no-loc.png" src="https://processors.wiki.ti.com/images/e/e5/Make-install-no-loc.png" width="868" height="91" /></a>
<br /><br />
This is not a good sign. Running make install caused the makefile to try to install our cross compiled libraries on the host (/usr/local/) which is definitely something we don't want.
</p><p>So how can you change the install location?
</p><p>Configuration changes such as this is usually handled by configure so looking at the configure help will hopefully provide a solution
</p><p>Run:
</p><p><code>./configure --help</code>
<br /><br />
<a href="File_Configure-help.html" class="image"><img alt="Configure-help.png" src="https://processors.wiki.ti.com/images/4/43/Configure-help.png" width="910" height="538" /></a>
<br /><br />
Awesome changing the location that libmad is installed to is as simple as using the --prefix option.
</p><p>First we want to remove all the configuration and compiled files that were generated from the last time we built libmad.
</p><p>To do this we use make distclean. For some software running make distclean isn’t a valid command so you will use make clean instead.
<br /><br />
So first run:
</p><p><code>make distclean</code>
<br /><br />
We want the files to be located at /home/sitara/cross-compiled/usr/ so rerun configure using the below command:
</p><p><code>./configure $CONFIGURE_FLAGS --prefix=&lt;cross-compiled dir path&gt;/usr/</code>
<br /><br />
If you don’t see any errors then run:
</p><p><code>make -j 4</code>
<br /><br />
Finally run:
</p><p><code>make install</code>
<br /><br />
<a href="File_Make-insall-success.html" class="image"><img alt="Make-insall-success.png" src="https://processors.wiki.ti.com/images/3/3b/Make-insall-success.png" width="715" height="94" /></a>
<br /><br />
If you see something similar to the above with no permission denied errors then make install was successful. Typically make install will create any necessary folders if they don’t exist already so there is no need to manually create the “cross-compiled” directory
</p>
<h2><span class="mw-headline" id="Lab_3c">Lab 3c</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=Linux_Training:Introduction_to_Cross_Compiling&amp;action=edit&amp;section=10" title="Edit section: Lab 3c">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Now that libmad has been cross compiled and installed in a separate directory the compiler still needs a way to know where to find this new location for headers and libraries.
</p><p>This will require a change to environment-setup.
<br /><br />
In the terminal run:
</p><p><code>gedit &lt;sdk-path&gt;/linux-devkit/environment-setup</code>
<br /><br />
In environment setup find both the lines with LDFLAGS and CPPFLAGS.
</p><p>LDFLAGS determines where to search for the target libraries while CPPFLAGS determines where to search for target headers.
</p><p>To add to the library search path, the -L&lt;directory&gt; option should be added to the LDFLAGS environment variable. For the headers search path, the -I&lt;directory option should be added to the CPPFLAGS environment variable.
</p><p>So in environment-setup change the lines:
</p>
<hr />
<p>export LDFLAGS=" --sysroot=$SDK_PATH_TARGET"
</p><p>…
</p><p>export CPPFLAGS=" -march=armv7-a -marm -mthumb-interwork -mfloat-abi=hard -mfpu=neon -mtune=cortex-a8 --sysroot=$SDK_PATH_TARGET
</p>
<hr />
<p>To
</p>
<hr />
<p>export LDFLAGS="<b>-L&lt;cross-compiled dir path&gt;/usr/lib/</b> --sysroot=$SDK_PATH_TARGET"
</p><p>…
</p><p>export CPPFLAGS=" <b>-I&lt;cross-compiled dir path&gt;/usr/include/</b> -march=armv7-a -marm -mthumb-interwork -mfloat-abi=hard -mfpu=neon -mtune=cortex-a8 --sysroot=$SDK_PATH_TARGET"
</p>
<hr />
<p>Note: -I is a dash with a capital i.
</p><p>You should only add the bolded text so leave everything else as is.
</p><p>Now that you have changed environment-setup before you can make use of this change you need to source environment-setup again.
<br /><br />
So run:
</p><p><code>source &lt;sdk-path&gt;/linux-devkit/environment-setup</code>
<br /><br />
Now in the terminal go back to the “toolchain lab” dir if you are no longer there by running the below command:
</p><p><code>cd "&lt;toolchain-lab dir path&gt;"</code>
<br /><br />
Let’s try building the program again by running the below command:
</p><p><code>arm-linux-gnueabihf-gcc minimad.c -o mad-example</code>
<br /><br />
<a href="File_Mad-example-almost.html" class="image"><img alt="Mad-example-almost.png" src="https://processors.wiki.ti.com/images/1/17/Mad-example-almost.png" width="625" height="162" /></a>
<br /><br />
Unfortunately the same error as before is seen again. The reason is we need to explicitly pass in the CPPFLAGS and LDFLAGS environment-variable to properly tell the compiler the additional locations to search. A makefile typically handles this for you if it exist for the program or library your building.
<br /><br />
So run the below command and also pass the CPPFLAGS and LDFLAGS environment variable:
</p><p><code>arm-linux-gnueabihf-gcc minimad.c $CPPFLAGS $LDFLAGS -o mad-example</code>
<br /><br />
Ahh progress but our old friend is back.
</p><p>Once again the linker needs to have the library name passed to it.
</p><p>The shared library for libmad is called libmad.so. So like before the library name needs to be converted which would be "-lmad"
<br /><br />
So let’s hopefully try building this one last time
</p><p><code>arm-linux-gnueabihf-gcc minimad.c $CPPFLAGS $LDFLAGS -lmad -o mad-example</code>
<br /><br />
No error this time!
</p><p>If you run ls you will see mad-example has been created! Congrats!
</p><p>Now unlike hello-world and example-png you can’t simply copy mad-example to your sdk’s target file system and expect it to work since your filesystem doesn’t include libmad! So how can you copy the necessary files for libmad onto your file system?
</p><p>Simply copy the contents of cross-compiled dir path directly to the root of your target file system (ex /media/rootfs when using a sd card reader). Being able to simply copy the manually compiled files to your target file system is another benefit of installing the files in a separate directory. Once the files are copied you can copy the “mad-example” program to your target file system and you will be good to go.
</p>
<!-- 
NewPP limit report
Cached time: 20201130065814
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.073 seconds
Real time usage: 0.082 seconds
Preprocessor visited node count: 38/1000000
Preprocessor generated node count: 44/1000000
Post‐expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 0/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 -total
-->
</div>
<!-- Saved in parser cache with key procwiki:pcache:idhash:38792-0!canonical and timestamp 20201130065814 and revision id 200679
 -->
<div class='hf-nsfooter' id='hf-nsfooter-'><table style="text-align:center; background:white; width:100%; text-align:left; height: 65px border-top: 1px solid; border-bottom: 1px solid; border-left: 1px solid; border-right: 1px solid; border-width: 1px; border-style: solid;">
<tr>
<td width="305px"><a href="File_E2e.html" class="image"><img alt="E2e.jpg" src="https://processors.wiki.ti.com/images/8/82/E2e.jpg" width="305" height="63" /></a>
</td>
<td>{{
<ol><li>switchcategory:MultiCore=</li></ol>
<ul><li>For technical support on MultiCore devices, please post your questions in the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/c6000_multi-core_dsps/default.aspx">C6000 MultiCore Forum</a></li>
<li>For questions related to the BIOS MultiCore SDK (MCSDK), please use the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/embedded/f/355.aspx">BIOS Forum</a></li></ul>
<p>Please post only comments related to the article <b>Linux Training:Introduction to Cross Compiling</b> here.<i></i>
</p>
</td>
<td>Keystone=
<ul><li>For technical support on MultiCore devices, please post your questions in the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/c6000_multi-core_dsps/default.aspx">C6000 MultiCore Forum</a></li>
<li>For questions related to the BIOS MultiCore SDK (MCSDK), please use the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/embedded/f/355.aspx">BIOS Forum</a></li></ul>
<p>Please post only comments related to the article <b>Linux Training:Introduction to Cross Compiling</b> here.<i></i>
</p>
</td>
<td>C2000=<i>For technical support on the C2000 please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/microcontrollers/tms320c2000_32-bit_real-time_mcus/f/171.aspx">The C2000 Forum</a>. Please post only comments about the article <b>Linux Training:Introduction to Cross Compiling</b> here.</i>
</td>
<td>DaVinci=<i>For technical support on DaVincoplease post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/davinci_digital_media_processors/default.aspx">The DaVinci Forum</a>. Please post only comments about the article <b>Linux Training:Introduction to Cross Compiling</b> here.</i>
</td>
<td>MSP430=<i>For technical support on MSP430 please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/microcontrollers/msp43016-bit_ultra-low_power_mcus/default.aspx">The MSP430 Forum</a>. Please post only comments about the article <b>Linux Training:Introduction to Cross Compiling</b> here.</i>
</td>
<td>OMAP35x=<i>For technical support on OMAP please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/omap_applications_processors/default.aspx">The OMAP Forum</a>. Please post only comments about the article <b>Linux Training:Introduction to Cross Compiling</b> here.</i>
</td>
<td>OMAPL1=<i>For technical support on OMAP please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/omap_applications_processors/default.aspx">The OMAP Forum</a>. Please post only comments about the article <b>Linux Training:Introduction to Cross Compiling</b> here.</i>
</td>
<td>MAVRK=<i>For technical support on MAVRK please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/development_tools/mavrk/default.aspx">The MAVRK Toolbox Forum</a>. Please post only comments about the article <b>Linux Training:Introduction to Cross Compiling</b> here.</i>
</td>
<td><i>For technical support please post your questions at <a rel="nofollow" class="external text" href="http://e2e.ti.com/">http://e2e.ti.com</a>. Please post only comments about the article <b>Linux Training:Introduction to Cross Compiling</b> here.</i>
<p>}}
</p>
</td></tr></table>
<table style="border-style:solid; border-width:1px; text-align:center; width:100%;">

<tr style="font-size:150%;">
<td rowspan="2"><a href="File_Hyperlink_blue.html" class="image"><img alt="Hyperlink blue.png" src="https://processors.wiki.ti.com/images/9/9f/Hyperlink_blue.png" width="96" height="96" /></a>
</td>
<td><b>Links</b>
</td></tr>
<tr>
<td>
<table style="text-align: left;">
<tr>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/amplifier_and_linear.page">Amplifiers &amp; Linear</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/audio/audio_overview.page">Audio</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/rfif.page">Broadband RF/IF &amp; Digital Radio</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/clocksandtimers/clocks_and_timers.page">Clocks &amp; Timers</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/dataconverters/data_converter.page">Data Converters</a>
</p>
</td>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/mems/mems.page">DLP &amp; MEMS</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/high_reliability.page">High-Reliability</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/interface/interface.page">Interface</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/logic/home_overview.page">Logic</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/powermanagement/power_portal.page">Power Management</a>
</p>
</td>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/dsp/embedded_processor.page">Processors</a>
</p>
<ul><li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/dsp/arm.page">ARM Processors</a></li>
<li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/dsp/home.page">Digital Signal Processors (DSP)</a></li>
<li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/microcontroller/home.page">Microcontrollers (MCU)</a></li>
<li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/omap-applications-processors/the-omap-experience.page">OMAP Applications Processors</a></li></ul>
</td>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/switches_and_multiplexers.page">Switches &amp; Multiplexers</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/temperature_sensor.page">Temperature Sensors &amp; Control ICs</a><br/>
<a rel="nofollow" class="external text" href="http://focus.ti.com/wireless/docs/wirelessoverview.tsp?familyId=2003&amp;sectionId=646&amp;tabId=2735">Wireless Connectivity</a>
</p>
</td></tr></table>
</td></tr></table>
<div id="tiPrivacy"></div>
</div></div>					<div class="printfooter">
						Retrieved from "<a dir="ltr" href="https://processors.wiki.ti.com/index.php?title=Linux_Training:Introduction_to_Cross_Compiling&amp;oldid=200679">https://processors.wiki.ti.com/index.php?title=Linux_Training:Introduction_to_Cross_Compiling&amp;oldid=200679</a>"					</div>
				<div id="catlinks" class="catlinks catlinks-allhidden" data-mw="interface"></div>				<div class="visualClear"></div>
							</div>
		</div>
		<div id="mw-navigation">
			<h2>Navigation menu</h2>
			<div id="mw-head">
									<div id="p-personal" role="navigation" class="" aria-labelledby="p-personal-label">
						<h3 id="p-personal-label">Personal tools</h3>
						<ul>
							<li id="pt-login"><a href="https://processors.wiki.ti.com/index.php?title=Special:UserLogin&amp;returnto=Linux+Training%3AIntroduction+to+Cross+Compiling" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li><li id="pt-createaccount"><a href="Special_RequestAccount.html" title="You are encouraged to create an account and log in; however, it is not mandatory">Request account</a></li>						</ul>
					</div>
									<div id="left-navigation">
										<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
						<h3 id="p-namespaces-label">Namespaces</h3>
						<ul>
							<li id="ca-nstab-main" class="selected"><span><a href="Linux_Training_Introduction_to_Cross_Compiling.html" title="View the content page [c]" accesskey="c">Page</a></span></li><li id="ca-talk" class="new"><span><a href="https://processors.wiki.ti.com/index.php?title=Talk:Linux_Training:Introduction_to_Cross_Compiling&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page (page does not exist) [t]" accesskey="t">Discussion</a></span></li>						</ul>
					</div>
										<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
												<input type="checkbox" class="vectorMenuCheckbox" aria-labelledby="p-variants-label" />
						<h3 id="p-variants-label">
							<span>Variants</span>
						</h3>
						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
									</div>
				<div id="right-navigation">
										<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
						<h3 id="p-views-label">Views</h3>
						<ul>
							<li id="ca-view" class="collapsible selected"><span><a href="Linux_Training_Introduction_to_Cross_Compiling.html">Read</a></span></li><li id="ca-viewsource" class="collapsible"><span><a href="https://processors.wiki.ti.com/index.php?title=Linux_Training:Introduction_to_Cross_Compiling&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></span></li><li id="ca-history" class="collapsible"><span><a href="https://processors.wiki.ti.com/index.php?title=Linux_Training:Introduction_to_Cross_Compiling&amp;action=history" title="Past revisions of this page [h]" accesskey="h">View history</a></span></li>						</ul>
					</div>
										<div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label">
						<input type="checkbox" class="vectorMenuCheckbox" aria-labelledby="p-cactions-label" />
						<h3 id="p-cactions-label"><span>More</span></h3>
						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
										<div id="p-search" role="search">
						<h3>
							<label for="searchInput">Search</label>
						</h3>
						<form action="https://processors.wiki.ti.com/index.php" id="searchform">
							<div id="simpleSearch">
								<input type="search" name="search" placeholder="Search Texas Instruments Wiki" title="Search Texas Instruments Wiki [f]" accesskey="f" id="searchInput"/><input type="hidden" value="Special:Search" name="title"/><input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton mw-fallbackSearchButton"/><input type="submit" name="go" value="Go" title="Go to a page with this exact name if it exists" id="searchButton" class="searchButton"/>							</div>
						</form>
					</div>
									</div>
			</div>
			<div id="mw-panel">
				<div id="p-logo" role="banner"><a class="mw-wiki-logo" href="Main_Page.html"  title="Visit the main page"></a></div>
						<div class="portal" role="navigation" id="p-navigation" aria-labelledby="p-navigation-label">
			<h3 id="p-navigation-label">Navigation</h3>
			<div class="body">
								<ul>
					<li id="n-mainpage"><a href="Main_Page.html" title="Visit the main page [z]" accesskey="z">Main Page</a></li><li id="n-All-pages"><a href="Special_AllPages.html">All pages</a></li><li id="n-All-categories"><a href="Special_Categories.html">All categories</a></li><li id="n-recentchanges"><a href="Special_RecentChanges.html" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li><li id="n-randompage"><a href="Package_Reflow_Profiles.html" title="Load a random page [x]" accesskey="x">Random page</a></li><li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" title="The place to find out">Help</a></li>				</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id="p-tb" aria-labelledby="p-tb-label">
			<h3 id="p-tb-label">Toolbox</h3>
			<div class="body">
								<ul>
					<li id="t-whatlinkshere"><a href="Special_WhatLinksHere/Linux_Training_Introduction_to_Cross_Compiling.html" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li><li id="t-recentchangeslinked"><a href="Special_RecentChangesLinked/Linux_Training_Introduction_to_Cross_Compiling.html" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li><li id="t-specialpages"><a href="Special_SpecialPages.html" title="A list of all special pages [q]" accesskey="q">Special pages</a></li><li id="t-print"><a href="https://processors.wiki.ti.com/index.php?title=Linux_Training:Introduction_to_Cross_Compiling&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li><li id="t-permalink"><a href="https://processors.wiki.ti.com/index.php?title=Linux_Training:Introduction_to_Cross_Compiling&amp;oldid=200679" title="Permanent link to this revision of the page">Permanent link</a></li><li id="t-info"><a href="https://processors.wiki.ti.com/index.php?title=Linux_Training:Introduction_to_Cross_Compiling&amp;action=info" title="More information about this page">Page information</a></li>				</ul>
							</div>
		</div>
				</div>
		</div>
				<div id="footer" role="contentinfo">
						<ul id="footer-info">
								<li id="footer-info-lastmod"> This page was last edited on 26 May 2015, at 09:52.</li>
								<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-ShareAlike</a> unless otherwise noted.</li>
							</ul>
						<ul id="footer-places">
								<li id="footer-places-privacy"><a href="Project_Privacy_policy.html" title="Project:Privacy policy">Privacy policy</a></li>
								<li id="footer-places-about"><a href="Project_About.html" title="Project:About">About Texas Instruments Wiki</a></li>
								<li id="footer-places-disclaimer"><a href="Project_General_disclaimer.html" title="Project:General disclaimer">Disclaimers</a></li>
								<li id="footer-places-termsofservice"><a href="Project_Terms_of_Service.html" title="Project:Terms of Service">Terms of Use</a></li>
							</ul>
										<ul id="footer-icons" class="noprint">
										<li id="footer-copyrightico">
						<a href="http://creativecommons.org/licenses/by-sa/3.0/"><img src="https://processors.wiki.ti.com/resources/assets/licenses/cc-by-sa.png" alt="Creative Commons Attribution-ShareAlike" width="88" height="31"/></a>					</li>
										<li id="footer-poweredbyico">
						<a href="http://www.mediawiki.org/"><img src="https://processors.wiki.ti.com/resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31"/></a>					</li>
									</ul>
						<div style="clear: both;"></div>
		</div>
		<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgPageParseReport":{"limitreport":{"cputime":"0.073","walltime":"0.082","ppvisitednodes":{"value":38,"limit":1000000},"ppgeneratednodes":{"value":44,"limit":1000000},"postexpandincludesize":{"value":0,"limit":2097152},"templateargumentsize":{"value":0,"limit":2097152},"expansiondepth":{"value":2,"limit":40},"expensivefunctioncount":{"value":0,"limit":100},"unstrip-depth":{"value":0,"limit":20},"unstrip-size":{"value":0,"limit":5000000},"timingprofile":["100.00%    0.000      1 -total"]},"cachereport":{"timestamp":"20201130065814","ttl":86400,"transientcontent":false}}});});</script><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":224});});</script>
	</body>

<!-- Mirrored from processors.wiki.ti.com/index.php/Linux_Training:Introduction_to_Cross_Compiling by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 01 Dec 2020 10:19:01 GMT -->
</html>
