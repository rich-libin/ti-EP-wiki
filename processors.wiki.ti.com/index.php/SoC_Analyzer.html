<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">

<!-- Mirrored from processors.wiki.ti.com/index.php/SoC_Analyzer by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 01 Dec 2020 07:03:28 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8"/>
<title>SoC Analyzer - Texas Instruments Wiki</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"SoC_Analyzer","wgTitle":"SoC Analyzer","wgCurRevisionId":181473,"wgRevisionId":181473,"wgArticleId":853,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"SoC_Analyzer","wgRelevantArticleId":853,"wgRequestId":"7ac872941ec831c27b08f80c","wgIsProbablyEditable":false,"wgRelevantPageIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[]});mw.loader.state({"site.styles":"ready","noscript":"ready","user.styles":"ready","user":"ready","user.options":"ready","user.tokens":"loading","mediawiki.legacy.shared":"ready","mediawiki.legacy.commonPrint":"ready","mediawiki.sectionAnchor":"ready","mediawiki.skinning.interface":"ready","skins.vector.styles":"ready"});mw.loader.implement("user.tokens@19o3a1s",function($,jQuery,require,module){/*@nomin*/mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});
});mw.loader.load(["site","mediawiki.page.startup","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.toc","mediawiki.searchSuggest","skins.vector.js"]);});</script>
<link rel="stylesheet" href="https://processors.wiki.ti.com/load.php?debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.interface%7Cskins.vector.styles&amp;only=styles&amp;skin=vector"/>
<script async="" src="https://processors.wiki.ti.com/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=vector"></script>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="https://processors.wiki.ti.com/load.php?debug=false&amp;lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=vector"/>
<meta name="generator" content="MediaWiki 1.31.6"/>
<link rel="shortcut icon" href="https://processors.wiki.ti.com/favicon.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="https://processors.wiki.ti.com/opensearch_desc.php" title="Texas Instruments Wiki (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="https://processors.wiki.ti.com/api.php?action=rsd"/>
<link rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/"/>
<link rel="alternate" type="application/atom+xml" title="Texas Instruments Wiki Atom feed" href="https://processors.wiki.ti.com/index.php?title=Special:RecentChanges&amp;feed=atom"/>
<!--[if lt IE 9]><script src="/load.php?debug=false&amp;lang=en&amp;modules=html5shiv&amp;only=scripts&amp;skin=Vector&amp;sync=1"></script><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-SoC_Analyzer rootpage-SoC_Analyzer skin-vector action-view">		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<div id="content" class="mw-body" role="main">
			<a id="top"></a>
			<div id="siteNotice" class="mw-body-content"><div id="localNotice" lang="en" dir="ltr"><div class="mw-parser-output"><p><br />
<span style="color:#ff0000"><b>NOTICE: The Processors Wiki will End-of-Life on January 15, 2021. It is recommended to download any files or other content you may need that are hosted on processors.wiki.ti.com. The site is now set to read only.</b></span>
</p></div></div></div><div class="mw-indicators mw-body-content">
</div>
<h1 id="firstHeading" class="firstHeading" lang="en">SoC Analyzer</h1>			<div id="bodyContent" class="mw-body-content">
				<div id="siteSub" class="noprint">From Texas Instruments Wiki</div>				<div id="contentSub"></div>
								<div id="jump-to-nav" class="mw-jump">
					Jump to:					<a href="#mw-head">navigation</a>, 					<a href="#p-search">search</a>
				</div>
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output"><div id="toc" class="toc"><div class="toctitle" lang="en" dir="ltr"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Introduction"><span class="tocnumber">1</span> <span class="toctext">Introduction</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Document_Objective"><span class="tocnumber">1.1</span> <span class="toctext">Document Objective</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Motivation"><span class="tocnumber">1.2</span> <span class="toctext">Motivation</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Supported_Devices"><span class="tocnumber">1.3</span> <span class="toctext">Supported Devices</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5"><a href="#SoC_Analyzer_for_Multicore_Devices"><span class="tocnumber">2</span> <span class="toctext">SoC Analyzer for Multicore Devices</span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#SoC_Analyzer_Overview"><span class="tocnumber">2.1</span> <span class="toctext">SoC Analyzer Overview</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Requirements_and_Setup"><span class="tocnumber">2.2</span> <span class="toctext">Requirements and Setup</span></a>
<ul>
<li class="toclevel-3 tocsection-8"><a href="#Setup_Overview_for_DVSDK_Demos"><span class="tocnumber">2.2.1</span> <span class="toctext">Setup Overview for DVSDK Demos</span></a></li>
<li class="toclevel-3 tocsection-9"><a href="#DM644x_and_DM646x_target_board_requirements"><span class="tocnumber">2.2.2</span> <span class="toctext">DM644x and DM646x target board requirements</span></a>
<ul>
<li class="toclevel-4 tocsection-10"><a href="#Required_files_and_directories"><span class="tocnumber">2.2.2.1</span> <span class="toctext">Required files and directories</span></a></li>
<li class="toclevel-4 tocsection-11"><a href="#Enable_additional_features_in_the_target_Linux_kernel"><span class="tocnumber">2.2.2.2</span> <span class="toctext">Enable additional features in the target Linux kernel</span></a></li>
<li class="toclevel-4 tocsection-12"><a href="#Mount_Relay_File_System"><span class="tocnumber">2.2.2.3</span> <span class="toctext">Mount Relay File System</span></a></li>
<li class="toclevel-4 tocsection-13"><a href="#Setup_TraceUtil_in_the_target_application"><span class="tocnumber">2.2.2.4</span> <span class="toctext">Setup TraceUtil in the target application</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-14"><a href="#Copy_Symbol_Files_to_Host_File_System"><span class="tocnumber">2.2.3</span> <span class="toctext">Copy Symbol Files to Host File System</span></a></li>
<li class="toclevel-3 tocsection-15"><a href="#Establish_a_Web_Server"><span class="tocnumber">2.2.4</span> <span class="toctext">Establish a Web Server</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-16"><a href="#Trace_your_Application"><span class="tocnumber">2.3</span> <span class="toctext">Trace your Application</span></a>
<ul>
<li class="toclevel-3 tocsection-17"><a href="#Different_Trace_Modes"><span class="tocnumber">2.3.1</span> <span class="toctext">Different Trace Modes</span></a>
<ul>
<li class="toclevel-4 tocsection-18"><a href="#Online_Capture"><span class="tocnumber">2.3.1.1</span> <span class="toctext">Online Capture</span></a></li>
<li class="toclevel-4 tocsection-19"><a href="#Post_Process"><span class="tocnumber">2.3.1.2</span> <span class="toctext">Post Process</span></a></li>
<li class="toclevel-4 tocsection-20"><a href="#Offline_Capture"><span class="tocnumber">2.3.1.3</span> <span class="toctext">Offline Capture</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-21"><a href="#EMIF_Counters"><span class="tocnumber">2.3.2</span> <span class="toctext">EMIF Counters</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-22"><a href="#Capturing_Data"><span class="tocnumber">2.4</span> <span class="toctext">Capturing Data</span></a>
<ul>
<li class="toclevel-3 tocsection-23"><a href="#SOCRATES"><span class="tocnumber">2.4.1</span> <span class="toctext">SOCRATES</span></a>
<ul>
<li class="toclevel-4 tocsection-24"><a href="#Further_SOCRATES_DEFAULT_Details"><span class="tocnumber">2.4.1.1</span> <span class="toctext">Further SOCRATES_DEFAULT Details</span></a></li>
<li class="toclevel-4 tocsection-25"><a href="#Controlling_Trace_at_Run-Time_through_a_Named_Pipe"><span class="tocnumber">2.4.1.2</span> <span class="toctext">Controlling Trace at Run-Time through a Named Pipe</span></a></li>
<li class="toclevel-4 tocsection-26"><a href="#Controlling_Trace_in_Application_Code"><span class="tocnumber">2.4.1.3</span> <span class="toctext">Controlling Trace in Application Code</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-2 tocsection-27"><a href="#Custom_Traces"><span class="tocnumber">2.5</span> <span class="toctext">Custom Traces</span></a>
<ul>
<li class="toclevel-3 tocsection-28"><a href="#TRACEUTIL"><span class="tocnumber">2.5.1</span> <span class="toctext">TRACEUTIL</span></a>
<ul>
<li class="toclevel-4 tocsection-29"><a href="#Trace_Masks"><span class="tocnumber">2.5.1.1</span> <span class="toctext">Trace Masks</span></a>
<ul>
<li class="toclevel-5 tocsection-30"><a href="#Modules"><span class="tocnumber">2.5.1.1.1</span> <span class="toctext">Modules</span></a></li>
<li class="toclevel-5 tocsection-31"><a href="#Special_Modules"><span class="tocnumber">2.5.1.1.2</span> <span class="toctext">Special Modules</span></a></li>
<li class="toclevel-5 tocsection-32"><a href="#Trace_Levels"><span class="tocnumber">2.5.1.1.3</span> <span class="toctext">Trace Levels</span></a></li>
</ul>
</li>
<li class="toclevel-4 tocsection-33"><a href="#Other_Default_Trace_Settings"><span class="tocnumber">2.5.1.2</span> <span class="toctext">Other Default Trace Settings</span></a>
<ul>
<li class="toclevel-5 tocsection-34"><a href="#NO_TRACING"><span class="tocnumber">2.5.1.2.1</span> <span class="toctext">NO_TRACING</span></a></li>
<li class="toclevel-5 tocsection-35"><a href="#DEFAULT_TRACING"><span class="tocnumber">2.5.1.2.2</span> <span class="toctext">DEFAULT_TRACING</span></a></li>
<li class="toclevel-5 tocsection-36"><a href="#FULL_TRACING"><span class="tocnumber">2.5.1.2.3</span> <span class="toctext">FULL_TRACING</span></a></li>
</ul>
</li>
<li class="toclevel-4 tocsection-37"><a href="#Configuring_TraceUtil_for_Use_at_Application_Start_Time"><span class="tocnumber">2.5.1.3</span> <span class="toctext">Configuring TraceUtil for Use at Application Start Time</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-38"><a href="#Create_own_Trace_Commands_.28Custom_Traces.29"><span class="tocnumber">2.5.2</span> <span class="toctext">Create own Trace Commands (Custom Traces)</span></a></li>
<li class="toclevel-3 tocsection-39"><a href="#DVT_to_Display_Custom_Traces"><span class="tocnumber">2.5.3</span> <span class="toctext">DVT to Display Custom Traces</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-40"><a href="#Behind_the_Scenes_of_the_SoC_Analyzer_and_TraceUtil"><span class="tocnumber">2.6</span> <span class="toctext">Behind the Scenes of the SoC Analyzer and TraceUtil</span></a>
<ul>
<li class="toclevel-3 tocsection-41"><a href="#BiosLog"><span class="tocnumber">2.6.1</span> <span class="toctext">BiosLog</span></a>
<ul>
<li class="toclevel-4 tocsection-42"><a href="#Format_the_BIOS_Log_File"><span class="tocnumber">2.6.1.1</span> <span class="toctext">Format the BIOS Log File</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-43"><a href="#LogTracker"><span class="tocnumber">2.6.2</span> <span class="toctext">LogTracker</span></a></li>
<li class="toclevel-3 tocsection-44"><a href="#TimeSynch"><span class="tocnumber">2.6.3</span> <span class="toctext">TimeSynch</span></a></li>
<li class="toclevel-3 tocsection-45"><a href="#LogBuffers"><span class="tocnumber">2.6.4</span> <span class="toctext">LogBuffers</span></a>
<ul>
<li class="toclevel-4 tocsection-46"><a href="#LOG_system"><span class="tocnumber">2.6.4.1</span> <span class="toctext">LOG_system</span></a></li>
<li class="toclevel-4 tocsection-47"><a href="#ti_sdo_ce_bioslog_create"><span class="tocnumber">2.6.4.2</span> <span class="toctext">ti_sdo_ce_bioslog_create</span></a></li>
<li class="toclevel-4 tocsection-48"><a href="#ti_sdo_ce_bioslog_synch"><span class="tocnumber">2.6.4.3</span> <span class="toctext">ti_sdo_ce_bioslog_synch</span></a></li>
<li class="toclevel-4 tocsection-49"><a href="#ti_sdo_ce_bioslog_track"><span class="tocnumber">2.6.4.4</span> <span class="toctext">ti_sdo_ce_bioslog_track</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-50"><a href="#Generic_Trace"><span class="tocnumber">2.6.5</span> <span class="toctext">Generic Trace</span></a>
<ul>
<li class="toclevel-4 tocsection-51"><a href="#API_Description"><span class="tocnumber">2.6.5.1</span> <span class="toctext">API Description</span></a></li>
<li class="toclevel-4 tocsection-52"><a href="#Data_Logging"><span class="tocnumber">2.6.5.2</span> <span class="toctext">Data Logging</span></a>
<ul>
<li class="toclevel-5 tocsection-53"><a href="#GT_Log_Excerpt"><span class="tocnumber">2.6.5.2.1</span> <span class="toctext">GT Log Excerpt</span></a></li>
</ul>
</li>
<li class="toclevel-4 tocsection-54"><a href="#Example"><span class="tocnumber">2.6.5.3</span> <span class="toctext">Example</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-2 tocsection-55"><a href="#Summary"><span class="tocnumber">2.7</span> <span class="toctext">Summary</span></a></li>
<li class="toclevel-2 tocsection-56"><a href="#Example_Code"><span class="tocnumber">2.8</span> <span class="toctext">Example Code</span></a>
<ul>
<li class="toclevel-3 tocsection-57"><a href="#Control_Trace_in_Application_Code"><span class="tocnumber">2.8.1</span> <span class="toctext">Control Trace in Application Code</span></a></li>
<li class="toclevel-3 tocsection-58"><a href="#Add_Custom_GT_Module_to_Application"><span class="tocnumber">2.8.2</span> <span class="toctext">Add Custom GT Module to Application</span></a></li>
<li class="toclevel-3 tocsection-59"><a href="#Add_custom_LOG_messages_to_BIOS_Log"><span class="tocnumber">2.8.3</span> <span class="toctext">Add custom LOG_messages to BIOS Log</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-60"><a href="#SoC_Analyzer_for_Single_Core_Devices"><span class="tocnumber">3</span> <span class="toctext">SoC Analyzer for Single Core Devices</span></a></li>
<li class="toclevel-1 tocsection-61"><a href="#Issues_and_Error_Messages"><span class="tocnumber">4</span> <span class="toctext">Issues and Error Messages</span></a>
<ul>
<li class="toclevel-2 tocsection-62"><a href="#Out_of_sequence_log_received._Expecting_xxxx_but_received_yyyy"><span class="tocnumber">4.1</span> <span class="toctext">Out of sequence log received. Expecting xxxx but received yyyy</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><span class="mw-headline" id="Introduction">Introduction</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=1" title="Edit section: Introduction">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p><i><b>NOTE: SOC ANALYZER IS NO LONGER A SUPPORTED TOOL</b></i>
</p><p><br />
The TMS320DM64xx SoC Analyzer is an industry-leading system analysis and visibility tool for DVSDK applications running on DM64xx processors. The visualizations of these applications include ARM/DSP interactions, processing time, system load and execution state. The analyzer collects time-stamped data in real time from underlying components (e.g. <a href="Category_MFP.html" title="Category:MFP">Codec Engine</a>, <a href="Category_DSPBIOS.html" title="Category:DSPBIOS">DSP/BIOS<sup>TM</sup></a> and Linux), then transports the data via Ethernet to the host PC. The data is then correlated and analyzed to provide a graphical representation of the overall system performance and execution on a single time-line. This provides a complete system view of the application, and  eliminates the tedious process of manually collecting and comparing data on each core before optimization begins. Providing a complete system visibility enables developers to identify bottlenecks that were previously hard to detect. Since the DM64xx SoC Analyzer is a minimally intrusive tool, all this useful functionality comes without adding an immense additional load to the application.
</p>
<h3><span class="mw-headline" id="Document_Objective">Document Objective</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=2" title="Edit section: Document Objective">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>In this document we show how to set up the SoC Analyzer environment and how to perform a first basic tracing of your application. Next we suggest several possibilities to instrument your code to perform specific tracing of your application. Further on we want to dig deeper into the things happening behind the scenes of the user interface of the SoC Analyzer by analyzing how trace information is captured from Codec Engine, BIOS and Linux. For a deeper understanding of the different display graphs or filter possibilities we refer to the Dynamic Help of the SoC Analyzer.
</p>
<h3><span class="mw-headline" id="Motivation">Motivation</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=3" title="Edit section: Motivation">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Trends in industry tend to larger and consequently more complex systems. Systems on Chip (SoC) with multiple cores on devices are becoming more and more popular. As the complexity for systems grows, so does it for the software. Linux or other general purpose operating systems get utilized to manage a range of processors found in devices. In case of the dual-core (ARM + DSP) DaVinci product line, the trend of complex multi-core systems is followed and besides the usual OS running on TI DSPs (DSP/BIOS), Linux distributions are adopted. On the other hand, companies are putting their emphasis on development productivity and product quality. To satisfy this trend in an environment that gets more and more complex and also to reduce time-to-market, smart system analysis tools need to be provided. Such tools are meant to simplify the complexity of today’s larger systems by providing a easy to read system analysis. Especially in a multi-core environment, analyzing, benchmarking and verifying component/system performances can become a very tricky task.
</p><p>The SoC Analyzer provides a solution for TI DaVinci multi- and single core devices that makes reading pages and pages of hard-to-read log files redundant by displaying the relevant trace data graphically. It precisely analyzes CPU utilization and inter-core processes, benchmarks codec/algorithm performances, provides visibility into "black-box" system components (e.g. Codec Engine), just to mention a few features upfront. The SoC Analyzer provides an easy-to-read solution to track down even hard to identify system bottlenecks very quickly, and so helps to maintain a certain development time and quality standard.
</p>
<h3><span class="mw-headline" id="Supported_Devices">Supported Devices</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=4" title="Edit section: Supported Devices">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ul><li>Tested Platforms
<ul><li>DM644x SoC Analyzer: <b>DM6446</b></li>
<li>SoC Analyzer 1.0: <b>DM6437</b></li>
<li>SoC Analyzer 1.1: <b>DM6437</b> + <b>DM648</b></li>
<li>SoC Analyzer 1.2: <b>DM6437</b> + <b>DM648</b> + <b>DM6446</b> + <b>DM6467</b></li></ul></li></ul>
<p><br />
</p>
<ul><li>Multi Core minimal s/w requirement for standard use the SoC Analyzer
<ul><li>Linux</li>
<li>DSP/BIOS</li>
<li>Codec Engine</li>
<li>Trace Utility</li>
<li>HTTP Server ( Linux )</li></ul></li></ul>
<p><br />
</p>
<ul><li>Single Core minimal s/w requirement for standard use of the SoC Analyzer
<ul><li>DSP/BIOS</li>
<li>DSP/BIOS Log Server</li>
<li>HTTP Server ( Network Developer's Kit - NDK - TCP/IP Stack )</li></ul></li></ul>
<p><br /> The SoC Analyzer is delivered as part of the <a href="DVEVM_and_DVSDK_overview.html" title="DVEVM and DVSDK overview">DVEVM/DVSDK</a> and also available from the <a rel="nofollow" class="external text" href="http://www.ti.com/dvevmupdates">DVEVM update site</a>
</p>
<h1><span class="mw-headline" id="SoC_Analyzer_for_Multicore_Devices">SoC Analyzer for Multicore Devices</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=5" title="Edit section: SoC Analyzer for Multicore Devices">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h2><span class="mw-headline" id="SoC_Analyzer_Overview">SoC Analyzer Overview</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=6" title="Edit section: SoC Analyzer Overview">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>In the first place, the SoC Analyzer is an application that loads data from text files and displays it graphically or in tables. Those text files contain various trace data fetched from ARM or DSP and have a certain format. Those trace files are available in the target file system (assuming tracing is enabled in the application). The SoC Analyzer can utilize a web server to download those files to the host file system or one can manually transfer them to a special location on the host file system, where the SoC Analyzer application browses for them.<br /><br /> A basic overview of the the SoC Analyzer trace framework is shown in Fig. 1.The SoC Analyzer utilizes several trace mechanisms (Generic Trace and BIOS Log) available on DaVinci platforms to gather trace data from the Codec Engine and DSP/BIOS. The target Linux OS runs the Linux Trace Toolkit (LTT) to trace Linux thread scheduling. The SoC Analyzer uses the <a href="#TRACEUTIL">TraceUtil</a> module to customize the trace parameters according to the needs of the SoC Analyzer solution. At application runtime, the logged trace data is stored in temporary trace files on the target file system. When the data logging has finished, the trace files are send to the host file-system via a web server, where the SoC Analyzer application picks them up for further processing. The application correlates all trace files (i.e. CE-, DSP/BIOS-, LTT-trace file) on a common timeline and displays the trace information graphically and in tables.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:962px;"><a href="File_Overview.html" class="image"><img alt="Overview.jpg" src="https://processors.wiki.ti.com/images/c/c2/Overview.jpg" width="960" height="600" class="thumbimage" /></a>  <div class="thumbcaption"></div></div></div></div>
<h2><span class="mw-headline" id="Requirements_and_Setup">Requirements and Setup</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=7" title="Edit section: Requirements and Setup">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>In general, every application developed for the <a href="#Supported_Devices">supported platforms</a> can be analyzed by the SoC Analyzer. All that needs to be done is a slight modification of a few source files, enabling additional features in the traget kernel and establishing a webserver on the target board. This may sound complex, especially to non-experienced Linux users, but we'll show all steps necessary by means of a DVSDK demo application in the next chapters. Those steps are generally valid and can be easily applied to your own application.
</p>
<h3><span class="mw-headline" id="Setup_Overview_for_DVSDK_Demos">Setup Overview for DVSDK Demos</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=8" title="Edit section: Setup Overview for DVSDK Demos">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Before you can start using the SoC Analyzer DM644x/DM646x solution you must setup the host environment and ensure that specific files are installed on the DM644x/DM646x target board. In the following chapters, we’ll discuss how to setup the target Linux kernel and how to modify the source code in order to make the demo applications traceable by the SoC Analyzer.
</p>
<h3><span class="mw-headline" id="DM644x_and_DM646x_target_board_requirements">DM644x and DM646x target board requirements</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=9" title="Edit section: DM644x and DM646x target board requirements">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Some of the setup steps described below might have already been applied in newer versions of the DVSDK. However, for older versions and for custom applications it is essential to describe how to setup the target environment and instrument the application in order to analyze it with the SoC Analyzer. Ways to check whether required setup steps have already been applied will be mentioned in the guidelines below and will be marked with <font color="#ff0000"><i><b>CHECK</b></i> </font>.
</p>
<h4><span class="mw-headline" id="Required_files_and_directories">Required files and directories</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=10" title="Edit section: Required files and directories">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Copy the contents from the appropriate device directory on your host machine
</p>
<pre>X:\&lt;SoC_Analyzer_Install_Dir&gt;\SoCAnalyzer1_2\dvt_resources\target-install\&lt;DVSDK_Version&gt;\
</pre>
<p>to the target board. is the <b>1.20</b>, <b>1.30</b>, or <b>1.40</b> DVSDK software version. Finally run the <b>dsa-install.sh</b> script to move the files to the correct directories. By default, the cgi-bin files (used to control data transfer to the host) are installed in <i>/opt/dvsdk/web/cgi-bin</i> for access by the (default) HTTP server. Required drivers and scripts (configure the EMIF counters and read the DSP speed) are installed in the <i>/opt/dvt-dsa</i> folder. Startup scripts for EMIF kernel module are installed in the folder <i>/etc/init.d</i>, and linked from <i>/etc/rc.d/rc3.d/S88emif</i>.
</p>
<h4><span class="mw-headline" id="Enable_additional_features_in_the_target_Linux_kernel">Enable additional features in the target Linux kernel</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=11" title="Edit section: Enable additional features in the target Linux kernel">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Instrument the Linux Operating System on the target board to include Linux Trace Toolkit (LTT) and Relay file system support when you rebuild the New Linux Kernel using the procedure described in the <a href="http://www.ti.com/lit/pdf/sprue66" class="extiw" title="tidoc:sprue66">DVEVM Getting Started Guide (SPRUE66)</a>.
</p><p>In the kernel directory type
</p>
<pre>make menuconfig
</pre>
<p>then navigate to <b>Device Drivers -&gt; Filesystems -&gt; Pseudo Filesystems</b>, and set <b>Relayfs</b> file system support as built-in. Return to <b>General Setup</b> and enable <b>Linux Trace Toolkit Support</b> as built-in. To rebuild the Linux Kernel, type <br />
</p>
<pre>make ARCH=arm CROSS_COMPILE=arm_v5t_le- uImage
</pre>
<p>The uImage can now be copied to a place where U-Boot can use Trivial FTP to download it to the EVM:<br />
</p>
<pre>cp ~/workdir/lsp/ti_davinci/arch/arm/boot/uImage /tftpboot
chmod a+r /tftpboot/uImage
</pre>
<h4><span class="mw-headline" id="Mount_Relay_File_System">Mount Relay File System</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=12" title="Edit section: Mount Relay File System">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p><font color="#ff0000"><i><b>CHECK:</b></i> <i>To check whether a relay file system has already been established on your target, type</i> <i><b>mount</b></i> <i>on command line and look for something like</i> </font>
</p>
<pre>relayfs on /mnt/relayfs type relayfs (rw)
</pre>
<p><font color="#ff0000"><i>If so, the next step can be skipped.</i> </font> <br /><br /> The <b>fstab</b> file must be edited to ensure that <b>RelayFs</b> is mounted automatically each time the target board is rebooted.<br /><br />Mount the <b>RelayFs</b> on the target board by creating a directory on the target file system to mount the <b>RelayFs</b>.
</p>
<pre>mkdir /mnt/relayfs
</pre>
<p>Append this text to the <b>/etc/fstab</b> file to automatically mount the <b>RelayFs</b> each time the target board boots.
</p>
<pre>relayfs /mnt/relayfs relayfs rw 0 0
</pre>
<h4><span class="mw-headline" id="Setup_TraceUtil_in_the_target_application">Setup TraceUtil in the target application</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=13" title="Edit section: Setup TraceUtil in the target application">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p><font color="#ff0000"><i><b>CHECK:</b></i> <i>The next steps are most likely already done in the DVSDK demo applications. To verify, check the</i> <i><b>application configuration file</b></i> <i>(encode/decode/encodedecode.cfg) and</i> <i><b>main.c</b></i> <i>for code lines mentioned below and add missing lines if necessary.</i> </font> <br /><br />
</p><p>Add the <a href="#TRACEUTIL">TraceUtil</a> module to your GPP application configuration (*.cfg) script: &lt;syntaxhighlight lang="javascript"&gt;
var TraceUtil = xdc.useModule('ti.sdo.ce.utils.trace.TraceUtil');
</p><p>/* configure TraceUtils to run in "SoC Analyzer-friendly" mode */
TraceUtil.attrs = TraceUtil.SOCRATES_TRACING;
&lt;/syntaxhighlight&gt;
</p><p>And add the following to your GPP application's C source code: &lt;syntaxhighlight lang="c"&gt;
</p>
<ol><li>include &lt;ti/sdo/ce/utils/trace/TraceUtil.h&gt;</li></ol>
<p>/* ... */
CERuntime_init();
</p><p>/* ... */
/*
</p>
<pre>* Ensure this is done sometime after CERuntime_init().  Note that
* 'engineName' is the same engine string name passed to Engine_open().
*/
</pre>
<p>TraceUtil_start(engineName);
</p><p>/*
</p>
<pre>* Early releases of TraceUtil have a startup race condition.  Sleep
* here to give the TraceUtil daemon thread a chance to run.
*/
</pre>
<p>sleep(3);
</p><p>/* ... */
</p><p>/* When closing your app, stop the TraceUtil daemon */
TraceUtil_stop();
&lt;/syntaxhighlight&gt;
</p>
<h3><span class="mw-headline" id="Copy_Symbol_Files_to_Host_File_System">Copy Symbol Files to Host File System</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=14" title="Edit section: Copy Symbol Files to Host File System">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>To get a correct trace result, you must copy the appropriate application symbol files from the target to the host PC. In case the SoC Analyzer is used with the standard demos, these symbol files must be copied from the <i>/opt/dvsdk</i> target board directory to a directory on the host machine, before they can be used in the <a href="#Different_Trace_Modes">Online Capture</a> process. In case of the DVSDK demos they are:
</p>
<ul><li>decodeCombo.x64P</li>
<li>encodeCombo.x64P</li>
<li>loopbackCombo.x64P</li></ul>
<p><br />
</p>
<h3><span class="mw-headline" id="Establish_a_Web_Server">Establish a Web Server</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=15" title="Edit section: Establish a Web Server">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>In order to communicate with the host and to upload trace files, the target board needs to establish a web server. On the target change directory to <i>/opt/dvsdk/web</i> and type
</p>
<pre>./thttpd -c "/cgi-bin/*"
</pre>
<p><i>Hint:</i> Modify your target startup routine to establish the HTTP connection during target boot. Create following little shell script called /etc/rc.d/init.d/webserver
</p>
<pre>#!/bin/sh

echo "webserver startup"

cd /opt/dvsdk/web
./thttpd -c "/cgi-bin/*"

echo "webserver established"
</pre>
<p>Create a soft link to that script by typing
</p>
<pre>ln -s /etc/rc.d/init.d/webserver /etc/rc.d/rc3.d/S92webserver
</pre>
<h2><span class="mw-headline" id="Trace_your_Application">Trace your Application</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=16" title="Edit section: Trace your Application">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>In the <b>Control Panel</b> of the SoC Analyzer, chose <a href="#Different_Trace_Modes">Online Capture</a> as <b>Action</b>. Fill in the IP address of the target board and the time period you want to collect trace data (should not exceed 10 sec. significantly). Under <b>Session</b>, you will find three choices, either <i><b>decode</b></i>, <i><b>encode</b></i>, or <i><b>loopback</b></i>. Here, you just specify a certain directory, where the trace files are stored after they were downloaded from the target board. Those files are stored in
</p>
<pre>X:\&lt;SoC_Analyzer_Install_Dir&gt;\SoCAnalyzer1_2\dvt_resources\target-install\platform\&lt;platform&gt;\
   solutions\SoCAnalyzer\sessions\&lt;Session_Name&gt;.
</pre>
<p><b>Hint:</b> Session names can be added to the pull-down menu. In case your application does neither decoding or encoding, adding custom session names can prevent confusion. To add another session folder just create a new folder in
</p>
<pre>X:\&lt;SoCAnalyzer_Install_Dir&gt;\dvt_resources\platform\&lt;platform&gt;\solutions\SoCAnalyzer\sessions\
</pre>
<p>in your windows file system. It then will show up it the session pull down menu.<br /><br />After starting your application on the target, hit the <b>Start Capturing</b> button in the <b>Control Panel</b> of the SoC Analyzer. The trace will now be enabled for as many seconds you specified. The trace data is logged on the target side in the <i>/tmp</i> directory and will be downloaded from the host after the data logging has finished. Those trace files are then used to draw the tables and graphs in your SoC Analyzer user interface.
</p>
<h3><span class="mw-headline" id="Different_Trace_Modes">Different Trace Modes</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=17" title="Edit section: Different Trace Modes">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>There are three different possibilities of performing a trace:
</p>
<ul><li>Online Capture</li>
<li>Offline Capture</li>
<li>Post Process</li></ul>
<h4><span class="mw-headline" id="Online_Capture">Online Capture</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=18" title="Edit section: Online Capture">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>In the Online Capture mode the trace is started by the SoC Analyzer tool itself. By hitting the <b>Start Capture</b> button, the SoC Analyzer application calls a shell script called <i><b>startLogging.sh</b></i> which sends commands via the http server to the target board. It
</p>
<ul><li>removes old trace files from the directory,</li>
<li>initializes and starts the Linux Trace Daemon,</li>
<li>establishes a command pipe that enables the application to communicate with TraceUtil,</li>
<li>resets all needed trace files</li>
<li>and finally sets the trace parameters required by the SoC Analyzer application.</li></ul>
<p>After the specified logging time ran out and the trace data was successfully written to the trace files on the target, the trace parameters are reset to default and the Linux Trace Daemon is stopped. The files are now downloaded by the host application to produce graphs and table views of the logged trace information.
</p>
<h4><span class="mw-headline" id="Post_Process">Post Process</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=19" title="Edit section: Post Process">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>The <b>Post Process</b> option is to recall a previous trace analysis. Here, the trace files in the according directory <b>Decode</b>, <b>Encode</b>, or <b>Loopback</b> on the host side are re-loaded to reproduce the graphical analysis. In case of Post Process, no HTTP connection is necessary. This procedure allows application engineers to just exchange trace files for application analysis, instead of sending executables or whole source packages back and forth.
</p>
<h4><span class="mw-headline" id="Offline_Capture">Offline Capture</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=20" title="Edit section: Offline Capture">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>When the <b>Offline Capture</b> option is chosen, the files of a former performed trace are downloaded from the targets' directory to plot the analysis graphs. This option is useful, when trace logging is not enabled by the SoC Analyzer tool itself (by hitting the <b>Start Capture</b> button), but in the users' application code at runtime.
</p>
<h3><span class="mw-headline" id="EMIF_Counters">EMIF Counters</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=21" title="Edit section: EMIF Counters">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The SoC Analyzer DM644x solution uses two counters to evaluate External Memory Interface (EMIF) efficiency, backlog and bottleneck issues with the application's DDR2 Memory Controller. These counters are configurable to count events relating to the SDRAM, which include accesses, activations, reads/writes, etc. In addition, the counters are configurable to count events for a specific master peripheral.<br />Details about the EMIF counter configuration can be found in the SoC Analyzer Help.
</p><p><b>Caution:</b> You should not change the EMIF configuration using your application or using Code Composer Studio. Changing the EMIF configuration after starting the data collection (capture, transfer and processing) generates unpredictable results. SoC Analyzer uses the EMIF configuration values resident on the target when performing its logging.
</p>
<h2><span class="mw-headline" id="Capturing_Data">Capturing Data</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=22" title="Edit section: Capturing Data">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>As we mentioned above, the Online Capture option allows the user to start trace logging at a certain time and specify its duration. The trace parameters are send to the running application via a UNIX command pipe, which is created when the <b>Start Capture</b> button gets hit. Then a start command ("socrates=on") is written to the command pipe, which changes the default trace parameters of the application. This command is received by the TraceUtil daemon, which we have already configured into the system as described above.
</p>
<h3><span class="mw-headline" id="SOCRATES">SOCRATES</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=23" title="Edit section: SOCRATES">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The TraceUtil module contains many configurable parameters to capture trace, independent of the SoC Analyzer. One commonly used configuration is the <code>SOCRATES_DEFAULT</code> configuration. In this config, the many TraceUtil parameters are initialized as such (via the simple <code>TraceUtils.attrs = TraceUtils.SOCRATES_DEFAULT;</code> assignment described above):
</p><p>&lt;syntaxhighlight lang="javascript"&gt;
const attrs SOCRATES_TRACING = {
</p>
<pre>  localTraceMask: "*=67",
  localTraceFile: "/tmp/cearmlog.txt",
  dsp0TraceMask: "*=67",
  dsp0TraceFile: "/tmp/cedsp0log.txt",
  dsp0BiosFile: "/tmp/bioslog.dat",
  traceFileFlags: "w",
  refreshPeriod: 0,
  cmdPipeFile: "/tmp/cecmdpipe"
  cmdAliases: [
     {
        alias: "socrates=on",
        cmds: [
           "tracemask=*+5",
           "dsp0tracemask=*+5,ti.bios+3",
           "refreshperiod=200"
        ]
     },
     {
        alias: "socrates=off",
        cmds: [
           "tracemask=*-5",
           "dsp0tracemask=*-5,ti.bios-3",
           "refreshperiod=0"
        ]
     }
  ]
</pre>
<p>}
&lt;/syntaxhighlight&gt;
</p><p>Using this configuration initializes the parameters to:
</p>
<ul><li>Only warnings (level 6) and errors (level 7) are enabled in all modules (<code>*=67</code>)</li>
<li>Trace files created in the <i>/tmp</i> directory</li>
<li>Trace <i>collection</i> from the DSP is disabled (<code>refreshperiod = 0</code>)</li></ul>
<p>It also creates two 'aliases', or string commands, listened to on the command pipe - "socrates=on" and "socrates=off". Additionally, this config defines the actions to take when those commands are received.
</p>
<h4><span class="mw-headline" id="Further_SOCRATES_DEFAULT_Details">Further <code>SOCRATES_DEFAULT</code> Details</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=24" title="Edit section: Further SOCRATES DEFAULT Details">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>There are two trace mask-related config params, one for code running on the local GPP processor (<b>localTraceMask</b>) and one for code running on the remote DSP processor (<b>dsp0TraceMask</b>). Those trace masks enable certain trace modules to log information on a certain information level. The '*' is a wildcard character, which refers to all available modules on either GPP or DSP side. The integers assign the trace level to the modules. By setting e.g. localTraceMask: "*=67", we set all available trace module on GPP side to log trace information on level 6 and 7
</p><p>Each trace mask has a corresponding trace file, specified by <b>localTraceFile</b> and <b>dsp0TraceFile</b>, where the trace logs are stored. The <b>dsp0BiosFile</b> holds DSP/BIOS related trace information. DSP/BIOS trace modules are specified in the DSP trace mask and are to be activated separately, i.e. the wildcard character '*' doesn't apply for those modules.
</p><p>Also, the refresh period is configured here - initially set to zero, i.e. no trace data is fetched from the DSP. The <b>cecmdpipe</b> parameter is the name of the command pipe file.
</p><p>By hitting the <b>Start Capture</b> button in the <b>SoC Analyzer Control Panel</b>, the command <b>"socrates=on"</b> is written to the command pipe and the trace attributes change accordingly. Also the <b>Linux Trace Daemon</b> is called, to gather Linux side trace information.
</p><p>The <code>cmdAliases</code> structure holds command aliases and the according commands to execute on call. When writing <b>"socrates=on"</b> to the command pipe, the GPP and DSP trace masks are complemented by trace level 5, and additionally a DSP/BIOS module logging on level 3 is activated in the DSP trace mask. All trace modules now operate on level 5,6 and 7 and a special <b>ti.bios</b> module is added at level 3. The refresh period is set to 200, i.e. every 200 ms information is fetched from the DSP if data is available. After the specified trace time (set in the SoC Analyzer Control Panel) is over, the <b>"socrates=off"</b> command is written to the command pipe to disable data logging. The operation "-5" is applied to the wildcard character, which removes trace level 5 from all the modules. Accordingly, the "-3" operation removes trace level 3 from the <b>ti.bios</b> module. Also the refresh period is reset to 0, i.e. no data is fetched from the DSP anymore.
</p><p>When the trace duration is over and all data is written to the trace files, they are downloaded by the host application to display the results.
</p><p><b>Caution:</b> You should capture execution trace data for less than 20 seconds to ensure that log buffer capacity is not exceeded.
</p>
<h4><span class="mw-headline" id="Controlling_Trace_at_Run-Time_through_a_Named_Pipe">Controlling Trace at Run-Time through a Named Pipe</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=25" title="Edit section: Controlling Trace at Run-Time through a Named Pipe">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>When you start a <b>SOCRATES</b> enabled application, it initially provides no trace other than (potentially) warnings and errors (corresponding to trace levels 6 and 7). Another way to change this behavior is via the command line. In this case, the SoC Analyzer application doesn't need to run. <br /><br /> On the command line on the target type
</p>
<pre>killall tracedaemon
</pre>
<p>to stop any previously running <b>Linux Trace Toolkit (LTT)</b> trace daemon. Then remove any existing trace files from former traces:
</p>
<pre>rm /tmp/trace.trace
rm /tmp/proc.txt
rm /tmp/proc_thread.txt
rm /tmp/output.txt
</pre>
<p>Type
</p>
<pre>mkfifo /tmp/cecmdpipe
chmod 666 /tmp/cecmdpipe
</pre>
<p>to create a UNIX command pipe and change its permissions. This procedure needs only to be done for the first run of the application, since TraceUtil does not delete the pipe in the end. Send <i>"resetfiles"</i> to the command pipe to reset the trace files to size 0.
</p>
<pre>echo resetfiles &gt; /tmp/cecmdpipe
</pre>
<p>After starting your application type
</p>
<pre>tracedaemon -eSTART -eSCHED -ePROCESS -eFS /tmp/trace.trace /tmp/proc.txt
</pre>
<p>to start the trace daemon to capture LTT logs.<br /><br />
</p><p>To create a list of processes and threads that exist in the system at the beginning of the Linux trace and to save it in <i>/tmp/proc_thread.txt</i>, type
</p>
<pre>/opt/dvt-dsa/mapProcThread /tmp/proc_thread.txt
</pre>
<p>Send <i>"socrates=on"</i> to command pipe to start capturing Codec Engine and DSP/BIOS data.
</p>
<pre>echo socrates=on &gt; /tmp/cecmdpipe
</pre>
<p>To turn off tracing, write <i>"socrates=off"</i> to the command pipe:
</p>
<pre>echo socrates=off &gt; /tmp/cecmdpipe
</pre>
<p>To remove the trace daemon and stop capturing Linux Trace Toolkit (LTT) data, write
</p>
<pre>killall tracedaemon
</pre>
<p>to the command pipe.
</p><p><i><b>Hint:</b></i> <i>Obviously, it is quite painful to send all those commands sequentially to the command pipe. Create a script in your application directory on target side called startLogging.sh and include all command line commands for starting the Socrates Trace. Do the same to stop tracing and call the script stopLogging.sh. Now you just got to execute the startLogging.sh script</i>
</p>
<pre>./startLogging.sh
</pre>
<p><i>to start the trace and</i>
</p>
<pre>./stopLogging.sh
</pre>
<p><i>to stop it.</i> <br /><br /> <i><b>Remark:</b></i> <i>Executing the startLogging.sh script is equivalent to what happens when hitting the Start Capture button in the SoC Analyzer Control Panel in Online Capture mode.</i> <br /><br />After logging trace data over a certain time period, the created trace files can be downloaded by the SoC Analyzer application in <b>Offline Capture</b> mode to display the trace results.<br /><br /> <b>Caution:</b> You should capture execution trace data for less than 20 seconds to ensure that log buffer capacity is not exceeded.
</p>
<h4><span class="mw-headline" id="Controlling_Trace_in_Application_Code">Controlling Trace in Application Code</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=26" title="Edit section: Controlling Trace in Application Code">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Capturing LTT and CE/BIOS logs can be turned on and off within an application. This feature allows the user to time the logging process more accurately, e.g. start tracing at a certain time by utilizing Linux timers and log for a certain amount of frames. Example C code to make logging callable within your application can be found <a href="#Example_Code">here</a>.
</p>
<h2><span class="mw-headline" id="Custom_Traces">Custom Traces</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=27" title="Edit section: Custom Traces">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The SoC Analyzer is a solution based on Texas Instruments <a href="#DVT_to_Display_Custom_Traces">Data Visualization Technology</a> (DVT). This special solution is able to trace processes happening on DSP and GPP side, displays their interaction and also provides codec statistics. It relies on a special trace setup, which is defined in the <b>SOCRATES_TRACING</b> attributes structure. The solution needs all the data, according to the trace levels specified in the modules. Additionally it needs the trace logs of the Linux Trace Toolkit. Sometimes, such a complete trace might be unnecessary to track down a certain misbehavior of an application, it might even be too intrusive and disturb the application process by adding additional load to the CPU. In the next chapters we will describe the trace modules and explain their logging levels in more detail. We will then show, how to modify TraceUtil to perform custom traces. Those custom log files are available as easy-to-read text files, or can at least easily be processed to a human readable format.
</p><p><br />
</p>
<h3><span class="mw-headline" id="TRACEUTIL">TRACEUTIL</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=28" title="Edit section: TRACEUTIL">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The TraceUtil module is an ARM-side user interface to simplify CE's complex trace features. Using TraceUtil, the user can set parameters for different traces running in the background of the application, i.e. the <a href="#Generic_Trace">Generic Trace</a> (GT) for tracing Codec Engine related information (DSP and GPP side) or <a href="#BiosLog">BIOS Log</a> for DSP side events.
</p><p>TraceUtil takes care of three kinds of tracing that Codec Engine modules can produce:
</p>
<ul><li>Tracing on the Arm side: many Codec Engine and other Arm-side modules drop tidbits of information that give insight about their state, or they print warning and fatal error messages.</li>
<li>Tracing on the DSP side: same as Arm-side modules -- except this is often the only way to find out what is happening on the DSP. Arm-side code can use <code>printf()</code> or the user can fire up GDB, but for DSP, tracing is often the only way to send a line of text over to the Arm.</li>
<li>BIOS logging on the DSP side: BIOS can collect information on various system events like task switching etc. This information, called "BIOS log" (because it uses the BIOS LOG module) is important when you use the SoC Analyzer tool to analyze performance. Unlike the first two kinds of trace, which are ASCII texts, BIOS log is a binary file. TraceUtil lets you specify what tracing features you want to enable when you build your application, and lets you override some of all of those specs via Linux shell environment variables when you run the application.</li></ul>
<h4><span class="mw-headline" id="Trace_Masks">Trace Masks</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=29" title="Edit section: Trace Masks">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>The value of the trace mask is a mask name/value pair. If you change the trace mask to "*=01234567", you'll enable full tracing (which will result in a lot of output), but this is often useful in identifying what is going on internally. You can also configure the trace mask to set specific masks to specific levels during debugging. To configure more than one mask, you can separate masks with a comma or a semi-colon. Below is a list of mask names. For example, to use default setting for all modules, except "OM" (which you don't want to see), and "CV" (which you want to see <b>everything</b>), you could set the trace mask to the following:
</p>
<pre>"*=67;OM=;CV=01234567"
</pre>
<p>Special modules as e.g. the BIOS trace module are not affected by the wildcard ("*"). You must name them directly to change their flags, e.g.
</p>
<pre>GT_prefix=12"
</pre>
<p>or
</p>
<pre>"*=567,ti.bios=012"
</pre>
<h5><span class="mw-headline" id="Modules">Modules</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=30" title="Edit section: Modules">edit</a><span class="mw-editsection-bracket">]</span></span></h5>
<table cellpadding="4" cellspacing="2" border="1" style="color:black;background-color:#eeeeee;">

<tbody><tr>
<th align="left"><b>Module Name</b>
</th>
<th align="left"><b>Module Prefix</b>
</th>
<th align="left"><b>Module Description</b>
</th></tr>
<tr>
<td align="left">OC
</td>
<td align="left">OSAL Comm
</td>
<td align="left">OSAL's Comm module - used to abstract messaging APIs across OS's
</td></tr>
<tr>
<td align="left">OP
</td>
<td align="left">OSAL Process
</td>
<td align="left">OSAL's Process module - used to abstract process APIs across OS's
</td></tr>
<tr>
<td align="left">OM
</td>
<td align="left">OSAL Memory
</td>
<td align="left">OSAL's Memory module - used to abstract memory APIs across OS's
</td></tr>
<tr>
<td align="left">OG
</td>
<td align="left">OSAL Global
</td>
<td align="left">OSAL's Global module - used to abstract OSAL-generic APIs across OS's
</td></tr>
<tr>
<td align="left">CE
</td>
<td align="left">Codec Engine
</td>
<td align="left">CE Runtime APIs
</td></tr>
<tr>
<td align="left">CV
</td>
<td align="left">Codec Engine - VISA
</td>
<td align="left">CE VISA APIs
</td></tr>
<tr>
<td align="left">CR
</td>
<td align="left">Codec Engine - RMS
</td>
<td align="left">CE's Server daemon
</td></tr>
<tr>
<td align="left">CN
</td>
<td align="left">Codec Engine - Node
</td>
<td align="left">CE's Node module - used to instantiate codecs and communicate through custom skeletons
</td></tr>
<tr>
<td align="left">ti.sdo.ce.osal.AlgMem
</td>
<td align="left">OSAL Algorithm
</td>
<td align="left">OSAL's Algorithm control module - used for creating, deleting and controlling algorithms
</td></tr>
<tr>
<td align="left">ti.sdo.ce.osal.power
</td>
<td align="left">OSAL Power
</td>
<td align="left">OSAL's Power module - used in heterogeneous configurations to power on/off a server. Not supported in all releases.
</td></tr>
<tr>
<td align="left">LC
</td>
<td align="left">Log Client
</td>
<td align="left">GPP side task to connect to the DSP Log Server and responsible for GPP-DSP BIOS log message transfer
</td></tr>
<tr>
<td align="left">LS
</td>
<td align="left">Log Server
</td>
<td align="left">DSP-side server to get data logged by DSP/BIOS
</td></tr></tbody></table>
<h5><span class="mw-headline" id="Special_Modules">Special Modules</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=31" title="Edit section: Special Modules">edit</a><span class="mw-editsection-bracket">]</span></span></h5>
<table cellpadding="4" cellspacing="2" border="1" style="color:black;background-color:#eeeeee;">

<tbody><tr>
<th align="left"><b>Mask Name</b>
</th>
<th align="left"><b>Purpose</b>
</th>
<th align="left"><b>Module Description</b>
</th></tr>
<tr>
<td align="left">ti.bios
</td>
<td align="left">Control the BIOS TRC module (DSP only)
</td>
<td align="left">Levels (classes) <br />0 - TRC_LOGCLK<br />1 - TRC_LOGPRD<br />2 - TRC_LOGSWI<br />3 - TRC_LOGTSK<br />4 - TRC_STSHWI<br />5 - TRC_STSPRD with TRC_STSSWI with TRC_STSTSK<br />6 - TRC_USER0<br />7 - TRC_USER1
</td></tr>
<tr>
<td align="left">GT_prefix
</td>
<td align="left">Control what info is included in each trace line prefix
</td>
<td align="left">Levels (classes):<br />none - no prefix<br />0 - short module name<br />1 - long module name<br />2 - trace line class (level)<br />3 - thread ID<br />4 - stack address<br />5 - time stamp<br />default is "135"
</td></tr>
<tr>
<td align="left">GT_time
</td>
<td align="left">Control the format of timestamps in trace lines
</td>
<td align="left">Levels (classes):<br />none - microseconds in hex format (e.g. @0xa0cf80fe)<br />0 - microseconds, decimal (e.g. @4,021,348us)<br />1 - seconds (e.g. @0.004s)<br />2 - delta in us, excluding print time (e.g. @+0,000,259us) <br />3 - clock ticks, decimal (like level 0 but for the DSP, where the time stamp is a number of elapsed clock ticks, not number of elapsed microseconds )
</td></tr></tbody></table>
<h5><span class="mw-headline" id="Trace_Levels">Trace Levels</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=32" title="Edit section: Trace Levels">edit</a><span class="mw-editsection-bracket">]</span></span></h5>
<table cellpadding="4" cellspacing="2" border="1" style="color:black;background-color:#eeeeee;">

<tbody><tr>
<th align="left"><b>Level</b>
</th>
<th align="left"><b>Information</b>
</th></tr>
<tr>
<td align="left">0
</td>
<td align="left">Exit/enter functions
</td></tr>
<tr>
<td align="left">1
</td>
<td align="left">Debug information of interest for module developer
</td></tr>
<tr>
<td align="left">2
</td>
<td align="left">Debug information of interest for module developer &amp; maybe for the user
</td></tr>
<tr>
<td align="left">3
</td>
<td align="left">Open: no functionality yet
</td></tr>
<tr>
<td align="left">4
</td>
<td align="left">Information for developer that is likely to be important for the user
</td></tr>
<tr>
<td align="left">5
</td>
<td align="left">Benchmarking
</td></tr>
<tr>
<td align="left">6
</td>
<td align="left">Warnings
</td></tr>
<tr>
<td align="left">7
</td>
<td align="left">Errors
</td></tr></tbody></table>
<p><b>Caution:</b> If you set TraceUtil on the Arm side to use BIOS logging, you <b>must</b> have BIOS logging enabled in your DSP server image. That you do by adding this one line to your DSP server's configuration script: &lt;syntaxhighlight lang="javascript"&gt;
var LogServer = xdc.useModule('ti.sdo.ce.bioslog.LogServer');
&lt;/syntaxhighlight&gt;
</p>
<h4><span class="mw-headline" id="Other_Default_Trace_Settings">Other Default Trace Settings</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=33" title="Edit section: Other Default Trace Settings">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>To be set in the application configuration file as &lt;syntaxhighlight lang="javascript"&gt;
var TraceUtil = xdc.useModule('ti.sdo.ce.utils.trace.TraceUtil');
TraceUtil.attrs = TraceUtil.&lt;Trace_Name&gt;;
&lt;/syntaxhighlight&gt;
</p>
<h5><span class="mw-headline" id="NO_TRACING">NO_TRACING</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=34" title="Edit section: NO TRACING">edit</a><span class="mw-editsection-bracket">]</span></span></h5>
<p>&lt;syntaxhighlight lang="javascript"&gt;
const Attrs NO_TRACING = {
</p>
<pre>  localTraceMask: "*=",
  localTraceFile: null,
  dsp0TraceMask: "*=",
  dsp0TraceFile: null,
  dsp0BiosFile: null,
  traceFileFlags: null,
  refreshPeriod: 0,
  cmdPipeFile: "/tmp/cecmdpipe"
  cmdAliases: []
</pre>
<p>}
&lt;/syntaxhighlight&gt;
</p>
<h5><span class="mw-headline" id="DEFAULT_TRACING">DEFAULT_TRACING</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=35" title="Edit section: DEFAULT TRACING">edit</a><span class="mw-editsection-bracket">]</span></span></h5>
<p>&lt;syntaxhighlight lang="javascript"&gt;
const Attrs DEFAULT_TRACING = {
</p>
<pre>  localTraceMask: "*=67",
  localTraceFile: null,
  dsp0TraceMask: "*=67",
  dsp0TraceFile: null,
  dsp0BiosFile: null,
  traceFileFlags: null,
  refreshPeriod: 300,
  cmdPipeFile: "/tmp/cecmdpipe"
  cmdAliases: []
</pre>
<p>}
&lt;/syntaxhighlight&gt;
</p>
<h5><span class="mw-headline" id="FULL_TRACING">FULL_TRACING</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=36" title="Edit section: FULL TRACING">edit</a><span class="mw-editsection-bracket">]</span></span></h5>
<p>&lt;syntaxhighlight lang="javascript"&gt;
const Attrs FULL_TRACING = {
</p>
<pre>  localTraceMask: "*=01234567",
  localTraceFile: "trace/cearmlog.txt",
  dsp0TraceMask: "*=01234567",
  dsp0TraceFile: "trace/cedsp0log.txt",
  dsp0BiosFile: "trace/bioslog.dat",
  traceFileFlags: "w",
  refreshPeriod: 100,
  cmdPipeFile: "/tmp/cecmdpipe"
  cmdAliases: []
</pre>
<p>}
&lt;/syntaxhighlight&gt;
</p>
<h4><span class="mw-headline" id="Configuring_TraceUtil_for_Use_at_Application_Start_Time">Configuring TraceUtil for Use at Application Start Time</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=37" title="Edit section: Configuring TraceUtil for Use at Application Start Time">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>The trace masks (GPP and DSP) are initialized (in <code>CERuntime_init()</code>) to "*=67", which means display all warnings (6) and errors (7), but nothing else.
</p><p>CE provides a means for changing the initial trace setting via some environment variables. Before you run your TraceUtil-powered application, if you set one or more environment variables below, you will change TraceUtil properties that you specified in your application.cfg script:
</p>
<table cellpadding="4" cellspacing="2" border="1" style="color:black;background-color:#eeeeee;">

<tbody><tr>
<th align="left"><b>Parameters</b>
</th>
<th align="left"><b>Function</b>
</th></tr>
<tr>
<td align="left">CE_TRACE
</td>
<td align="left">trace mask for the Arm side, e.g. CE_TRACE="*=0567;OM=0"
</td></tr>
<tr>
<td align="left">CE_TRACEFILE
</td>
<td align="left">output file for Arm trace, e.g. CE_TRACE="trace/armtrace.txt"; if it can't be opened (e.g. points to a directory that doesn't exist)the trace will go to the standard output. (Try CE_TRACEFILE=/ for that.)
</td></tr>
<tr>
<td align="left">CE_TRACEFILEFLAGS
</td>
<td align="left">file creation flags for all files to be opened, e.g. CE_TRACEFILEFLAGS="a" (meaning "append"), or "w" (write); these are standard fopen() flags
</td></tr>
<tr>
<td align="left">TRACEUTIL_DSP0TRACEFILE
</td>
<td align="left">output file for the DSP trace; same remark holds as for the Arm trace
</td></tr>
<tr>
<td align="left">TRACEUTIL_DSP0BIOSFILE
</td>
<td align="left">output binary file for the BIOS log; if can't be open, will not be collected
</td></tr>
<tr>
<td align="left">TRACEUTIL_DSP0TRACEMASK
</td>
<td align="left">trace mask for the DSP side, e.g. TRACEUTIL_DSP0TRACEMASK="*+01;ti.bios=01234567"
</td></tr>
<tr>
<td align="left">TRACEUTIL_REFRESHPERIOD
</td>
<td align="left">number of milliseconds before the Arm thread collects all available DSP trace since the last time it did it
</td></tr>
<tr>
<td align="left">TRACEUTIL_CMDPIPE
</td>
<td align="left">name of a Unix named pipe ("fifo") where the TraceUtil listens for run-time trace commands
</td></tr>
<tr>
<td align="left">TRACEUTIL_VERBOSE
</td>
<td align="left">when set to 1 makes TraceUtil print the what trace settings (masks, files)it uses and where it gets them from. When set to 2 and up it shows more debugging info.
</td></tr></tbody></table>
<p><br /> <b>Note</b>: These environment variables are read <b>once</b>, at application startup time. Changing them after the application is executing will not have any effect: when the application runs, the application process gets its own copy of environment variables (changing them in the shell process does not affect the application process), and the application reads its copy of environment variables only when it initializes.
</p><p>To set those environment variables at start time, just set them on the command below the application execute command, e.g.
</p>
<pre>TRACEUTIL_VERBOSE=1 CE_TRACEFILE="/tmp/cearmlog.txt" TRACEUTIL_DSP0TRACEMASK="*+2345,ti.bios+23" ./application
</pre>
<p><i><b>Hint:</b></i> <i>To output the GPP or DSP trace information on standard output instead of a trace file, use</i>
</p>
<pre>CE_TRACEFILE=/ TRACEUTIL_DSP0TRACEFILE=/ ./application
</pre>
<p><i>at application start time. Setting the environment variables like this makes TraceUtil incapable of opening a valid trace file and redirects the trace data to stdout. For the GPP trace, the output will appear in the console window connected to the EVM via serial port. For DSP trace, one could connect directly to the DSP using Code Composer Studio <span class="plainlinks"><a rel="nofollow" class="external text" href="http://www.mycaal.com/"><span style="color:black;font-weight:normal; text-decoration:none!important;background:none!important; text-decoration:none;">loan modification</span></a> and view the DSP-side trace information in its standard output viewer.</span></i>
</p>
<h3><span id="Create_own_Trace_Commands_(Custom_Traces)"></span><span class="mw-headline" id="Create_own_Trace_Commands_.28Custom_Traces.29">Create own Trace Commands (Custom Traces)</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=38" title="Edit section: Create own Trace Commands (Custom Traces)">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Below is the list of supported trace pipe commands. Note that only one command per line should be written to the trace pipe.
</p>
<ul><li><b>tracemask=</b>{Arm trace mask value} sets the trace mask on the Arm, e.g. tracemask=*+01234567,OM-1</li>
<li><b>dsp0tracemask=</b>{DSP0 trace mask value} sets the DSP0 trace mask, e.g. dsp0tracemask=*-1,ti.bios-012</li>
<li><b>refreshperiod=</b>{number of milliseconds} sets the refresh period for DSP0 trace and log collection; if 0, there will be no collection until a non-0 refreshperiod is specified; example: refreshperiod=10</li>
<li><b>resetfiles</b> (no arguments) resets all open files -- Arm trace, DSP0 trace, DSP0 log (i.e. those that are in use) -- by truncating them to 0 bytes.</li></ul>
<p>Those commands can be send to the command pipe at run-time as e.g.
</p>
<pre>echo tracemask=*+345,OM-4 &gt; /tmp/cecmdpipe
</pre>
<p>assuming you created a command pipe as
</p>
<pre>mkfifo /tmp/cecmdpipe
</pre>
<p>before. As with <i>"socrates=on"</i>, the ARM application integrator can define, in his application config script, command pipe aliases that issue several pipe commands, as in this example: &lt;syntaxhighlight lang="javascript"&gt;
var TraceUtil = xdc.useModule('ti.sdo.ce.utils.trace.TraceUtil');
</p><p>TraceUtil.attrs.cmdAliases = [
</p>
<pre>   {
       alias: "mycommands_1",
       cmds: [
           "resetfiles",
           "tracemask=*+5",
           "dsp0tracemask=*+5,ti.bios+3",
           "refreshperiod=200"
           ],
   },
   {
       alias: "mycommands_2",
       cmds: [
           "tracemask=*-5",
           "refreshperiod=0",
           "dsp0tracemask=*-5,ti.bios-3"
           ],
   }, /* and so on -- no limit on the number of aliases */
</pre>
<p>];
&lt;/syntaxhighlight&gt;
</p><p>Those user defined commands can be send to the command pipe as
</p>
<pre>echo mycommands_1 &gt; /tmp/cecmdpipe
</pre>
<p>assuming you created a command pipe as
</p>
<pre>mkfifo /tmp/cecmdpipe
</pre>
<p>before.
</p>
<h3><span class="mw-headline" id="DVT_to_Display_Custom_Traces">DVT to Display Custom Traces</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=39" title="Edit section: DVT to Display Custom Traces">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The SoC Analyzer is a custom solution build with the Data Visualization Tool (DVT). the SoC Analyzer requires the trace modules and their according trace levels as defined in the SOCRATES_TRACING attribute structure. Only parameters as the refresh period and the trace file location can be changed. Changing parameters as the trace level will result in an error message in the SoC Analyzer application. Whereas the SoC Analyzer solution is a powerful one and basically shows everything relevant for debugging a real-time application even in a dual-core environment, one might need some custom trace information displayed as a graph or shown in a table. This can be achieved by utilizing the DVT tool, which is an Eclipse based, graphical IDE to create custom trace display solutions. This IDE uses a building block principle, as there are functional blocks for trace file reading, interpreting, correlating, displaying, etc. Connecting those blocks and specifying their functionality leads to a custom trace data display solution for every application.
</p><p><br />
</p>
<h2><span class="mw-headline" id="Behind_the_Scenes_of_the_SoC_Analyzer_and_TraceUtil">Behind the Scenes of the SoC Analyzer and TraceUtil</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=40" title="Edit section: Behind the Scenes of the SoC Analyzer and TraceUtil">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Using the TraceUtil module, the user can enable all specified trace parameters. TraceUtil initializes and changes trace parameters either by reading parameters specified in the application configuration file, by setting environment variables on application start time (overwrites parameters in app.cfg file), or by sending new trace parameters to a UNIX command pipe, TraceUtil is listening to. In order to communicate with the DSP, for setting trace masks or fetching CE trace data, the RMS task is utilized. In this low priority task, a message queue is established to send configuration or data fetch messages to the DSP, or to receive status messages from the DSP. For fetching DSP/BIOS logs, the GPP connects to a DSP-side <b>LogServer</b>, which is a low-priority thread responsible for logging BIOS data.
</p><p>By calling the <code>TraceUtil_start()</code> API, TraceUtil will first check for an environment variable called <b><a href="CE_DEBUG.html" title="CE DEBUG">CE_DEBUG</a></b>, which specifies if debug tracing is enabled (<b>CE_DEBUG</b> disables TraceUtil, and therefore the SoC Analyzer). If <b>CE_DEBUG</b> is <i>not</i> set, it checks for a remote server by verifying at least one of the used codecs to be remote. After collecting the environment variable for the refresh period, i.e. how frequently information is to be fetched from the DSP, a separate trace thread is created for managing the data fetching from the DSP. Now the DSP trace parameters are set by passing the DSP trace mask to a message queue established between the GPP and the DSP. This connection is established within the low priority RMS task and is used to either configure the DSP trace or to fetch trace data by sending request and reply messages over the queue. The GPP sends the message containing the DSP trace mask via the message queue to the DSP. After the DSP has processed the message, it sends an answer back to the GPP. After successfully configuring the DSP-side trace, another thread is created on GPP side. This thread is creating a UNIX command pipe and is listening to it in parallel to the data fetching thread. This pipe allows the user to send commands (e.g. "socrates=on") via the command line, causing changes in the GPP and DSP trace parameters during application run-time. The DSP trace thread fetches either CE-related, DSP/BIOS or both logs from the DSP server. To do so, the GPP connects to the BIOS <b>LogServer</b> in order to collect the data from the DSP/BIOS log buffers and to the DSP RMS task to fetch CE-related logs. Depending on the setup, DSP/BIOS log data and CE trace data will be periodically fetched from the DSP and written to the defined destination. The refresh period is specified in the TraceUtil module and can be modified either in the application configuration file, on application start time, or via command line through the recently established UNIX pipe. If the SoC Analyzer is utilized, the refresh period is set to 200 ms when the tracing is started. If the refresh period is set to zero, no data fetching from the DSP is done.
</p><p><br />
</p>
<h3><span class="mw-headline" id="BiosLog">BiosLog</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=41" title="Edit section: BiosLog">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Before connecting to the DSP/BIOS <b>LogServer</b> (a low priority DSP-side thread responsible for logging DSP/BIOS data), contiguous memory is allocated in order to store received trace data from the DSP. This is done by allocating a <b>MSGQ</b> message of maximum allowed size which acts as a data placeholder and is never actually been send. After creating a client message queue in order to receive messages from the DSP, the server message queue - which is established by the DSP log server task - needs to be located in order to communicate with the server. Finally, a command buffer is allocated, which holds the future logging or time synching commands for the server. Now, that we are connected to the DSP log server, we are able to send data fetch commands in order to collect all trace data available in the DSP/BIOS log buffers. The DSP-side log server task is waiting for either a read logs or a time synchronization command. In case of data fetching, the message sent to the DSP contains besides the fetching command also the physical address of the host-side buffer where the data is to be stored and the maximum allowed amount of data (4k) to fetch. This message is send via the server <b>MSGQ</b> to the DSP. The DSP-side log server task is running on lowest priority to not interrupt any essential processing (e.g. codecs) while gathering and sending information. The BIOS log data is written in 4k packages from cache to the specified shared memory address and the message gets updated by the number of bytes actually fetched from the DSP. Then, the message is sent back to the host client. At success, the data is written to a binary log file (SoC Analyzer default: <i>bioslog.dat</i>) using the <code>fwrite()</code> function. This data fetch and write procedure is repeated as long as there is data available on the log server.
</p><p><i><b>Hint:</b></i> <i>To enable tracing of <b>LogServer</b> and <b>LogClient</b> events, activate trace level 2 for the LC and the LS trace module.</i> <br /><br /> <i><b>Remark:</b></i> <i>The SoC Analyzer utilizes a small application called <a href="#Format_the_BIOS_Log_File">rtdadecode.exe</a> to translate the binary BIOS log file into a human-readable format.</i><br /><br /> <i><b>Hint:</b></i> <i>It is possible to add</i> <i><b>custom log messages to the BIOS log</b></i> <i>, in order to show up with a time-stamp in the SoC Analyzer BIOS Log table. An example of how to do so can be found <a href="#Add_custom_LOG_messages_to_BIOS">here</a>.</i>
</p><p><br />
</p>
<h4><span class="mw-headline" id="Format_the_BIOS_Log_File">Format the BIOS Log File</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=42" title="Edit section: Format the BIOS Log File">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>To translate the <i>bioslog.dat</i> file into a human readable format, an application called <b>rtadecode</b> is provided by the BIOS utilities. Several builds can be found either in your BIOS distribution
</p>
<pre>X:/&lt;biosutils_install_dir&gt;/packages/ti/bios/rtadecode/bin/
</pre>
<p>or in the SoC Analyzer install directory
</p>
<pre>X:/&lt;socrates_install_dir&gt;/dvt_resources/&lt;biosutils&gt;/packages/ti/bios/rtadecode/bin
</pre>
<p>In those locations you will find several executables of the application built for several platforms. The execute syntax is platform independent , as
</p>
<pre>rtdadecode.extension [symbol file] [binary BIOS log file] [optional: output file]
</pre>
<p>If the output file is not specified, the decoded BIOS log file content will be displayed on standart output. To format the file into a <i>Microsoft Excel</i> format, just add a <i>.csv</i> extension to the output file.
</p>
<pre>rtdadecode.extension decodeCombo.x64P bioslog.dat bioslog.csv
</pre>
<p>If the <i>MS Excel</i> specific file extension drops out, the data will be formatted into a comma-separated text file. The above example use case is assuming all files to be in the same directory. If that is not the case, the full file path needs to be specified.
</p>
<h3><span class="mw-headline" id="LogTracker">LogTracker</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=43" title="Edit section: LogTracker">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>In order to track task creation and EMIF events, a <a href="#LogTracker">LogTracker</a> is utilized. In order to track every static and dynamic task creation, it is connected to the DSP/BIOS HOOK module. At the time a task is created by DSP/BIOS, its name is jammed into a dedicated buffer (<a href="#ti_sdo_ce_bioslog_create">ti_sdo_ce_bioslog_create</a>). The LogTracker also frequently reads the two independent EMIF counter registers, which count events relating to the SDRAM. In addition, the counters are configurable to count events for a specific master peripheral. Those counter values are stored to a dedicated buffer (<a href="#ti_sdo_ce_bioslog_track">ti_sdo_ce_bioslog_track</a>).
</p><p><b>Remark:</b> The SoC Analyzer provides a graphical configuration manager for the EMIF counters. See the SoC Analyzer Help for more details.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:962px;"><a href="File_Bioslog.html" class="image"><img alt="Bioslog.jpg" src="https://processors.wiki.ti.com/images/6/6c/Bioslog.jpg" width="960" height="390" class="thumbimage" /></a>  <div class="thumbcaption"></div></div></div></div>
<h3><span class="mw-headline" id="TimeSynch">TimeSynch</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=44" title="Edit section: TimeSynch">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Time synchronization between GPP and DSP has to be done in order to enable the SoC Analyzer to align the different trace data on a common time line. In order to get the correct time stamps for active processes, we got to compensate for the time it takes to send messages via the message queue (<b>MSGQ latency</b>). To do so, a shared timer (<b>Timer1</b>) is used to get a time stamp on the ARM side. Also a GT and a Linux time stamp (using <code>gettimeofday()</code>) is determined. This timer values are sent via the message queue to the DSP <b>LogServer</b> with a time synchronization command. The DSP reads the shared timer again and calculates the difference between the value measured on the GPP side and the newly determined value. Using a shared timer enables us to determine the latency of the <b>MSGQ</b>. Since GT uses independent timers on GPP and DSP side, this shared timer offset value can be used to synchronize the GPP and DSP GT logs. All those time values (Linux, GT-ARM/GT-DSP, Timer1 offset) are stored to a dedicated buffer (<a href="#ti_sdo_ce_bioslog_synch">ti_sdo_ce_bioslog_synch</a>) by using the <code>LOG_event5()</code> BIOS API to be later on fetched by the LogClient task and to be written to the BIOS log file.
</p><p>The SoC Analyzer uses all the obtained timer values together with the offset value to compensate for the <b>MSGQ delay</b> and to align <b>BIOS</b>, <b>GT</b> and <b>LTT</b> logs on a common time line.
</p>
<h3><span class="mw-headline" id="LogBuffers">LogBuffers</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=45" title="Edit section: LogBuffers">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The log buffers to hold trace information from DSP/BIOS are configured in (Note that this file should not be modified!):
</p>
<pre>\&lt;ce_install_dir&gt;\packages\ti\sdo\ce\bioslog\package.xs
</pre>
<p>with their according sizes. Each buffer is responsible for holding specific data. Those log buffers are fetched frequently (frequency defined in the <i><b>refreshperiod</b></i> variable) from the DSP and their content is written to a common binary log file. In the following pictures we show how the BIOS trace data appears in the formatted BIOS trace file. In the following sections we describe what log buffer holds what kind of data and show how the data appears in the translated BIOS log file.
</p><p><br />
</p>
<h4><span class="mw-headline" id="LOG_system">LOG_system</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=46" title="Edit section: LOG system">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<table cellpadding="4" cellspacing="2" border="1" style="color:black;background-color:#eeeeee;">
<caption>LOG_System content appearance in the translated BIOS log file
</caption>
<tbody><tr>
<th align="left"><b>Buffer Index</b>
</th>
<th align="left"><b>Buffer Entry Index</b>
</th>
<th align="left"><b>-</b>
</th>
<th align="left"><b>Counter Values</b>
</th>
<th align="left"><b>BIOS OS Event</b>
</th></tr>
<tr>
<td align="left">0
</td>
<td align="left">0
</td>
<td align="left">0
</td>
<td align="left">119137
</td>
<td align="left">TSK: ready TSK_idle (0x8faffba4)
</td></tr>
<tr>
<td align="left">0
</td>
<td align="left">1
</td>
<td align="left">0
</td>
<td align="left">190697
</td>
<td align="left">SWI: begin KNL_swi (TSK scheduler) (0x8fb1dc38)
</td></tr>
<tr>
<td align="left">0
</td>
<td align="left">2
</td>
<td align="left">0
</td>
<td align="left">191398
</td>
<td align="left">TSK: ready RMS (0x8b80003c)
</td></tr>
<tr>
<td align="left">0
</td>
<td align="left">3
</td>
<td align="left">0
</td>
<td align="left">193168
</td>
<td align="left">SWI: end KNL_swi (TSK scheduler) (0x8fb1dc38) state = done
</td></tr>
<tr>
<td align="left">0
</td>
<td align="left">4
</td>
<td align="left">0
</td>
<td align="left">201993
</td>
<td align="left">SWI: begin KNL_swi (TSK scheduler) (0x8fb1dc38)
</td></tr>
<tr>
<td align="left">0
</td>
<td align="left">5
</td>
<td align="left">0
</td>
<td align="left">202056
</td>
<td align="left">TSK: ready LogServer (0x8b8040cc)
</td></tr>
<tr>
<td align="left">0
</td>
<td align="left">6
</td>
<td align="left">0
</td>
<td align="left">202618
</td>
<td align="left">SWI: end KNL_swi (TSK scheduler) (0x8fb1dc38) state = done
</td></tr>
<tr>
<td align="left">0
</td>
<td align="left">7
</td>
<td align="left">0
</td>
<td align="left">4109128969
</td>
<td align="left">TSK: blocked RMS (0x8b80003c) on &lt;unknown handle&gt; SEM
</td></tr>
<tr>
<td align="left">0
</td>
<td align="left">8
</td>
<td align="left">0
</td>
<td align="left">4109130384
</td>
<td align="left">TSK: running TSK_idle (0x8faffba4)
</td></tr>
<tr>
<td align="left">0
</td>
<td align="left">9
</td>
<td align="left">0
</td>
<td align="left">4110013355
</td>
<td align="left">SEM: post &lt;unknown handle&gt; (0x8fae0cf4) count = 0
</td></tr>
<tr>
<td align="left">0
</td>
<td align="left">10
</td>
<td align="left">0
</td>
<td align="left">4110014631
</td>
<td align="left">TSK: ready mpeg2dec#0 (0x8ba64c8c)
</td></tr>
<tr>
<td align="left">0
</td>
<td align="left">11
</td>
<td align="left">0
</td>
<td align="left">4110015237
</td>
<td align="left">TSK: running mpeg2dec#0 (0x8ba64c8c)
</td></tr></tbody></table>
<h4><span class="mw-headline" id="ti_sdo_ce_bioslog_create">ti_sdo_ce_bioslog_create</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=47" title="Edit section: ti sdo ce bioslog create">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>This buffer of size 1 kb holds the names of dynamically created tasks.
</p>
<table cellpadding="4" cellspacing="2" border="1" style="color:black;background-color:#eeeeee;">
<caption>ti_sdo_ce_bioslog_create content appearance in the translated BIOS log file
</caption>
<tbody><tr>
<th align="left"><b>Buffer Index</b>
</th>
<th align="left"><b>Buffer Entry Index</b>
</th>
<th align="left"><b>-</b>
</th>
<th align="left"><b>Counter Values</b>
</th>
<th align="left"><b>Task Name and Task Handle</b>
</th></tr>
<tr>
<td align="left">1
</td>
<td align="left">1
</td>
<td align="left">0
</td>
<td align="left">190015
</td>
<td align="left">RMS created (0x8b80003c)
</td></tr>
<tr>
<td align="left">1
</td>
<td align="left">2
</td>
<td align="left">0
</td>
<td align="left">201936
</td>
<td align="left">LogServer created (0x8b8040cc)
</td></tr>
<tr>
<td align="left">1
</td>
<td align="left">3
</td>
<td align="left">0
</td>
<td align="left">220547603
</td>
<td align="left">mpeg2dec#0 created (0x8ba64c8c)
</td></tr>
<tr>
<td align="left">1
</td>
<td align="left">4
</td>
<td align="left">0
</td>
<td align="left">500511403
</td>
<td align="left">mp3dec#1 created (0x8ba6a87c)
</td></tr></tbody></table>
<h4><span class="mw-headline" id="ti_sdo_ce_bioslog_synch">ti_sdo_ce_bioslog_synch</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=48" title="Edit section: ti sdo ce bioslog synch">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>This buffer of size 64 bytes holds time synch records
</p>
<table cellpadding="4" cellspacing="2" border="1" style="color:black;background-color:#eeeeee;">
<caption>ti_sdo_ce_bioslog_synch content appearance in the translated BIOS log file
</caption>
<tbody><tr>
<th align="left"><b>Buffer Index</b>
</th>
<th align="left"><b>Buffer Entry Index</b>
</th>
<th align="left"><b>-</b>
</th>
<th align="left"><b>Counter Values</b>
</th>
<th align="left"><b>Time of Day: sec/ms</b>
</th>
<th align="left"><b>GT Count ARM</b>
</th>
<th align="left"><b>GT Count DSP</b>
</th>
<th align="left"><b>Offset Timer1 (ARM - DSP)</b>
</th></tr>
<tr>
<td align="left">2
</td>
<td align="left">0
</td>
<td align="left">0
</td>
<td align="left">260544172
</td>
<td align="left">tod (1073044949, 974105)
</td>
<td align="left">GT ARM=974127
</td>
<td align="left">GT DSP=1017749
</td>
<td align="left">offset=1777
</td></tr>
<tr>
<td align="left">2
</td>
<td align="left">1
</td>
<td align="left">0
</td>
<td align="left">267041740
</td>
<td align="left">tod (1073044949, 974388)
</td>
<td align="left">GT ARM=974400
</td>
<td align="left">GT DSP=1043130
</td>
<td align="left">offset=1774
</td></tr></tbody></table>
<h4><span class="mw-headline" id="ti_sdo_ce_bioslog_track">ti_sdo_ce_bioslog_track</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=49" title="Edit section: ti sdo ce bioslog track">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>This buffer of size 4 kb holds EMIF data from the <a href="#LogTracker">LogTracker</a>. It also stores the actual DSP load.
</p>
<table cellpadding="4" cellspacing="2" border="1" style="color:black;background-color:#eeeeee;">
<caption>ti_sdo_ce_bioslog_track content appearance in the translated BIOS log file
</caption>
<tbody><tr>
<th align="left"><b>Buffer Index</b>
</th>
<th align="left"><b>Buffer Entry Index</b>
</th>
<th align="left"><b>-</b>
</th>
<th align="left"><b>Counter Values</b>
</th>
<th align="left"><b>EMIF Counter 1 &amp; 2, DSP Load</b>
</th></tr>
<tr>
<td align="left">3
</td>
<td align="left">187
</td>
<td align="left">0
</td>
<td align="left">1116975563
</td>
<td align="left">0x9b1bbfa, 0x37b3b45, 0x17
</td></tr>
<tr>
<td align="left">3
</td>
<td align="left">188
</td>
<td align="left">0
</td>
<td align="left">1122915237
</td>
<td align="left">0x9b1cb0c, 0x37b426a, 0x17
</td></tr>
<tr>
<td align="left">3
</td>
<td align="left">189
</td>
<td align="left">0
</td>
<td align="left">1128855465
</td>
<td align="left">0x9b27d15, 0x37b5966, 0x17
</td></tr>
<tr>
<td align="left">3
</td>
<td align="left">190
</td>
<td align="left">0
</td>
<td align="left">1134796775
</td>
<td align="left">0x9b454fb, 0x37b996e, 0x17
</td></tr>
<tr>
<td align="left">3
</td>
<td align="left">191
</td>
<td align="left">0
</td>
<td align="left">1140735879
</td>
<td align="left">0x9b463a4, 0x37ba31c, 0x17
</td></tr></tbody></table>
<p><b>Caution:</b> If you set TraceUtil on the ARM side to use BIOS logging, you <b>must</b> have BIOS logging enabled in your DSP server image. That you do by adding this one line to your DSP server's configuration script: &lt;syntaxhighlight lang="javascript"&gt;
var LogServer = xdc.useModule('ti.sdo.ce.bioslog.LogServer');
&lt;/syntaxhighlight&gt; If your DSP server is incapable of BIOS logging, you will see ARM-side error/warning messages like,
</p>
<pre>LogClient_connect&gt; Error: failed to locate server queue, Check if your DSP image has BIOS logging enabled
</pre>
<p>and
</p>
<pre>LogClient_fwriteLogs&gt; Warning: not connected to the BIOS log server on the DSP, cannot collect any BIOS log data.
</pre>
<h3><span class="mw-headline" id="Generic_Trace">Generic Trace</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=50" title="Edit section: Generic Trace">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The Generic Trace provides a set of APIs to customize the way data is logged or displayed, and what data to log. Those APIs are used both on GPP and DSP side to log data.
</p>
<h4><span class="mw-headline" id="API_Description">API Description</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=51" title="Edit section: API Description">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p><code>GT_create(mask, moduleName)</code>: The <code>GT_create()</code> function is used to create new trace modules to trace certain events (see table below). The <i>mask</i> argument is a structure holding a module name and its trace level. The input parameter <i>moduleName</i> specifies the name of the module for which the trace levels are to be determined. If tracing is enabled, default trace levels for each module are set via the application configuration file or environment variables at application start time. The <code>GT_create()</code> function determines those default trace levels for the according module at application runtime. Those levels can be changed later on by either using the <code>GT_set()</code> command, or a UNIX command pipe. A list of trace modules that can be created can be found here. Additionally, new module names can be defined to trace special events in your own application code. The names for custom modules have to differ from the already existing ones.
</p><p><code>GT_set(command)</code>: This function is used to set trace masks/levels for the different trace modules available. This function is called when TraceUtil is initialized and every time the trace configuration gets changed by the user or the application code, e.g. &lt;syntaxhighlight lang="c"&gt;
GT_set("*=67,GT_prefix=13");
&lt;/syntaxhighlight&gt;
</p><p><code>GT_#trace(mask, classId, format, arg1, ...)</code>: This function basically logs data to a specific destination, which is in most cases a trace file. The destination can be set in a separate function called <code>GT_setprintf()</code>, which is described below. The first argument mask is a structure containing the module name and its configured trace levels. The #-sign in the function name has to be replaced with an integer from 0 to 6. This just indicates the number of arguments or variables to be logged, e.g. &lt;syntaxhighlight lang="c"&gt;
GT_3trace(mask, classId, format, arg1, arg2, arg3);
&lt;/syntaxhighlight&gt; The format argument is a string containing the text arg1, arg2 etc. get embedded into. The syntax here is the same as for the <code>printf()</code> function and its place holders for specific data types, e.g. &lt;syntaxhighlight lang="c"&gt;
GT_2trace(mask, classId, "Arg1:&#160;%d\n Arg2:&#160;%x\n", arg1, arg2);
&lt;/syntaxhighlight&gt;
</p><p>The <code>classId</code> argument indicates a certain trace level. Only if this specific trace level is enabled in the mask argument, the specified data gets logged, i.e. &lt;syntaxhighlight lang="c"&gt;
GT_1trace(mask, GT_3CLASS, "Log if classId is set to:&#160;%d\n", 3)
&lt;/syntaxhighlight&gt; just gets logged, when level 3 is enabled in the mask structure. Find a list of trace level conventions below.
</p>
<table cellpadding="4" cellspacing="2" border="1" style="color:black;background-color:#eeeeee;">

<tbody><tr>
<th align="left"><b>Name, Level</b>
</th>
<th align="left"><b>Information</b>
</th></tr>
<tr>
<td align="left">GT_ENTER, 0
</td>
<td align="left">Exit/enter functions
</td></tr>
<tr>
<td align="left">GT_1CLASS, 1
</td>
<td align="left">Debug information of interest for module developer
</td></tr>
<tr>
<td align="left">GT_2CLASS, 2
</td>
<td align="left">Debug information of interest for module developer &amp; maybe for the user
</td></tr>
<tr>
<td align="left">GT_3CLASS, 3
</td>
<td align="left">Open: no functionality yet
</td></tr>
<tr>
<td align="left">GT_4CLASS, 4
</td>
<td align="left">Information for developer that is likely to be important for the user
</td></tr>
<tr>
<td align="left">GT_5CLASS, 5
</td>
<td align="left">Benchmarking
</td></tr>
<tr>
<td align="left">GT_6CLASS, 6
</td>
<td align="left">Warnings
</td></tr>
<tr>
<td align="left">GT_7CLASS, 7
</td>
<td align="left">Errors
</td></tr></tbody></table>
<p><code>GT_setprintf(<i>fxn</i>)</code>: Using this function, the destination of the data logged by the DSP can be configured. By default, the data is send to a circular buffer in the shared memory area, where it gets picked up in packages by the ARM. When debugging the DSP-side of an application in combination with Code Composer Studio (CCS), one could set the trace data destination to stdout by setting:
</p><p>&lt;syntaxhighlight lang="c"&gt;
GT_setprintf(printf);
&lt;/syntaxhighlight&gt;
</p><p>This configuration would show the logs on the message output of CCS.
</p>
<h4><span class="mw-headline" id="Data_Logging">Data Logging</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=52" title="Edit section: Data Logging">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>To fetch the logged GT data from the DSP, a message is sent to the DSP RMS task containing a fetch command. The data is then copied in 4k blocks from the log buffer to the shared memory area allocated by the message using the <code>memcpy()</code> function. Here, 4k is the maximum amount of data that can be fetched in one call, since it is the maximum message size. The logs are then written to either the specified output file (SoC Analyzer default: <i>cedsplog.txt</i>) by utilizing <code>fputs()</code> and <code>fputc()</code>, or stdout (<code>printf()</code>) depending on the GT configuration. Fetching log data is repeated until there is no data left on DSP side. The GPP data logged by GT is directly written to either the specified log file (SoC Analyzer default: <i>cearmlog.txt</i>) or send to the standard output depending on the GT configuration.
</p><p><i><b>Remark:</b></i> <i>To use the GT function APIs, "ti/sdo/utils/trace/gt.h" has to be included in the application code.</i>
</p>
<h5><span class="mw-headline" id="GT_Log_Excerpt">GT Log Excerpt</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=53" title="Edit section: GT Log Excerpt">edit</a><span class="mw-editsection-bracket">]</span></span></h5>
<p>The following tables show examples of log file excerpts of ARM and DSP-side GT log files.
</p>
<table cellpadding="4" cellspacing="2" border="1" style="color:black;background-color:#eeeeee;">
<caption>Content of the ARM-side GT trace file
</caption>
<tbody><tr>
<th align="left"><b>Timer Value</b>
</th>
<th align="left"><b>Thread Id</b>
</th>
<th align="left"><b>Traced Module</b>
</th>
<th align="left"><b>Event</b>
</th></tr>
<tr>
<td align="left">@0x07f996b6:
</td>
<td align="left">[T:0x43ee1b60]
</td>
<td align="left">CV
</td>
<td align="left">VISA_allocMsg&gt; Allocating message for <font color="#ff0000">messageId=0x00034a4c </font>
</td></tr>
<tr>
<td align="left">@0x07f99783:
</td>
<td align="left">[T:0x43ee1b60]
</td>
<td align="left">CV
</td>
<td align="left">VISA_call(visa=0x76150, msg=0x41ae0c80): <font color="#ff0000">messageId=0x00034a4c </font>, command=0x0
</td></tr>
<tr>
<td align="left">@0x07f99c49:
</td>
<td align="left">[T:0x43ee1b60]
</td>
<td align="left">CV
</td>
<td align="left">VISA_call Completed: <font color="#ff0000">messageId=0x00034a4c </font>, command=0x0, return(status=0)
</td></tr>
<tr>
<td align="left">@0x07f99d3b:
</td>
<td align="left">[T:0x43ee1b60]
</td>
<td align="left">CV
</td>
<td align="left">VISA_freeMsg(0x76150, 0x41ae0c80): Freeing message with <font color="#ff0000">messageId=0x00034a4c </font>
</td></tr>
<tr>
<td align="left">@0x07f99e07:
</td>
<td align="left">[T:0x43ee1b60]
</td>
<td align="left">CV
</td>
<td align="left">VISA_allocMsg&gt; Allocating message for <font color="#0000ff">messageId=0x00034a4d </font>
</td></tr>
<tr>
<td align="left">@0x07f99eb9:
</td>
<td align="left">[T:0x43ee1b60]
</td>
<td align="left">CV
</td>
<td align="left">VISA_call(visa=0x76150, msg=0x41ae0c80): <font color="#0000ff">messageId=0x00034a4d </font>, command=0x1
</td></tr>
<tr>
<td align="left">@0x07f9a111:
</td>
<td align="left">[T:0x43ee1b60]
</td>
<td align="left">CV
</td>
<td align="left">VISA_call Completed: <font color="#0000ff">messageId=0x00034a4d </font>, command=0x1, return(status=0)
</td></tr>
<tr>
<td align="left">@0x07f9a1fb:
</td>
<td align="left">[T:0x43ee1b60]
</td>
<td align="left">CV
</td>
<td align="left">VISA_freeMsg(0x76150, 0x41ae0c80): Freeing message with <font color="#0000ff">messageId=0x00034a4d </font>
</td></tr></tbody></table>
<p><br />
</p>
<table cellpadding="4" cellspacing="2" border="1" style="color:black;background-color:#eeeeee;">
<caption>Content of the DSP-side GT trace file
</caption>
<tbody><tr>
<th align="left"><b>Timer Value</b>
</th>
<th align="left"><b>Thread Id</b>
</th>
<th align="left"><b>Traced Module</b>
</th>
<th align="left"><b>Event</b>
</th></tr>
<tr>
<td align="left">@0x1275db0f:
</td>
<td align="left">[T:0x8fbe9fc4]
</td>
<td align="left">CN
</td>
<td align="left">NODE&gt; 0x8fbe9e80(mp3dec#1) call(algHandle=0x8fbe9ef0, msg=0x8fe0bc80); <font color="#ff0000">messageId=0x00034a4c </font>
</td></tr>
<tr>
<td align="left">@0x1275db97:
</td>
<td align="left">[T:0x8fbe9fc4]
</td>
<td align="left">CV
</td>
<td align="left">VISA_enter(visa=0x8fbe9ef0): algHandle = 0x8fbe9f18
</td></tr>
<tr>
<td align="left">@0x1275dfe9:
</td>
<td align="left">[T:0x8fbe9fc4]
</td>
<td align="left">CV
</td>
<td align="left">VISA_exit(visa=0x8fbe9ef0): algHandle = 0x8fbe9f18
</td></tr>
<tr>
<td align="left">@0x1275e08b:
</td>
<td align="left">[T:0x8fbe9fc4]
</td>
<td align="left">CN
</td>
<td align="left">NODE&gt; returned from call(algHandle=0x8fbe9ef0, msg=0x8fe0bc80); <font color="#ff0000">messageId=0x00034a4c </font>
</td></tr>
<tr>
<td align="left">@0x1275ebc1:
</td>
<td align="left">[T:0x8fbe9fc4]
</td>
<td align="left">CN
</td>
<td align="left">NODE&gt; 0x8fbe9e80(mp3dec#1) call(algHandle=0x8fbe9ef0, msg=0x8fe0bc80); <font color="#0000ff">messageId=0x00034a4d </font>
</td></tr>
<tr>
<td align="left">@0x1275ec1e:
</td>
<td align="left">[T:0x8fbe9fc4]
</td>
<td align="left">CV
</td>
<td align="left">VISA_enter(visa=0x8fbe9ef0): algHandle = 0x8fbe9f18
</td></tr>
<tr>
<td align="left">@0x1275ec6c:
</td>
<td align="left">[T:0x8fbe9fc4]
</td>
<td align="left">CV
</td>
<td align="left">VISA_exit(visa=0x8fbe9ef0): algHandle = 0x8fbe9f180x00034a4c
</td></tr>
<tr>
<td align="left">@0x1275ecb3:
</td>
<td align="left">[T:0x8fbe9fc4]
</td>
<td align="left">CN
</td>
<td align="left">NODE&gt; returned from call(algHandle=0x8fbe9ef0, msg=0x8fe0bc80); <font color="#0000ff">messageId=0x00034a4d </font>
</td></tr></tbody></table>
<h4><span class="mw-headline" id="Example">Example</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=54" title="Edit section: Example">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Example code to implement custom GT log entries can be found <a href="#Add_Custom_GT_Module_to_Applicat">here</a>. Assuming either trace level 4 or 5 is specified for the module CUSTOM_TRACE, GT will add the following line including time-stamp to the GT log file:
</p>
<table cellpadding="4" cellspacing="2" border="1" style="color:black;background-color:#eeeeee;">

<tbody><tr>
<th align="left"><b>Timer Value</b>
</th>
<th align="left"><b>Traced Module</b>
</th>
<th align="left"><b>Event</b>
</th></tr>
<tr>
<td align="left">@0x1275ecb3:[T:0x8fbe9fc4]
</td>
<td align="left">CUSTOM_MODULE
</td>
<td align="left">Counter: 1
</td></tr></tbody></table>
<p>Since in the example, all trace levels (0 to 7) are set for CUSTOM_MODULE, this line will be added to the GT log file.
</p><p><i><b>Hint:</b></i> <i>Trace levels can be OR'd in a GT_#trace call to enable more than one trace level, as can be seen in the example code.</i>
</p>
<h2><span class="mw-headline" id="Summary">Summary</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=55" title="Edit section: Summary">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>There are several trace mechanisms available on DaVinci platforms which are utilized by the SoC Analyzer <a href="#DVT_to_Display_Custom_Traces">DVT</a> solution to analyze single or multi-core systems-on-chip. The SoC Analyzer configures the trace parameters to its needs at application run-time utilizing shell scripts and a UNIX command pipe when it starts the system analysis.
</p><p>The targets' Linux OS uses the Linux Trace Toolkit to trace processes running on the ARM core and stores the LTT trace file (trace.trace) directly on the targets' file system. The SoC Analyzer utilizes TraceUtil to configure the GPP/DSP - GT trace masks as well as a special trace mask for DSP/BIOS. Generic Trace collects ARM-side CE-related trace data and stores it in a trace file (cearmlog.txt) on the targets' file system. TraceUtil establishes a trace thread, which on the one hand communicates with the DSPs RMS task via a MSGQ in order to fetch the DSP-side CE logs. On the other hand, it connects to a LogServer to fetch the BIOS log buffers in order to write it to a binary log file. Trace data is fetched from DSP until there is no data left in the trace buffers. Once the trace buffers are fetched, the trace thread waits for a certain time period and starts fetching DSP-side trace data again. Both, the DSP-side CE and BIOS trace information are stored in trace files (cedsplog.txt and bioslog.dat) on the targets' file system.
</p><p>Once the trace time period is over, all trace files are downloaded by the SoC Analyzer application via a web server and correlated on a common time line using the time sync values in the BIOS log file. After correlation, the logged trace data is displayed in several graphs and tables, which essentially reduces the complexity of system-on-chip analysis.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:962px;"><a href="File_TraceMechanism2.html" class="image"><img alt="TraceMechanism2.jpg" src="https://processors.wiki.ti.com/images/e/e2/TraceMechanism2.jpg" width="960" height="720" class="thumbimage" /></a>  <div class="thumbcaption"></div></div></div></div>
<p><br />
</p>
<h2><span class="mw-headline" id="Example_Code">Example Code</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=56" title="Edit section: Example Code">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h3><span class="mw-headline" id="Control_Trace_in_Application_Code">Control Trace in Application Code</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=57" title="Edit section: Control Trace in Application Code">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>&lt;syntaxhighlight lang="c"&gt;
</p>
<ol><li>include &lt;stdio.h&gt;</li>
<li>include &lt;spawn.h&gt;</li>
<li>include &lt;sys/wait.h&gt;</li>
<li>include &lt;unistd.h&gt;</li>
<li>include &lt;string.h&gt;</li></ol>
<p>int startTraceDaemon()
{
</p>
<pre>   int pid, res, status;
   char * argv[] = { "/bin/tracedaemon", "-eSTART", "-eSCHED", "-ePROCESS", "-eFS", "/tmp/trace.trace", "/tmp/proc.txt", (char *) 0 };
   char * argv2[] = { "opt/dvt-dsa/mapProcThread", "/tmp/proc_thread.txt", (char *) 0 };
   char * envp[] = { (char *) 0 };
</pre>
<pre>   //Spawn tracedaemon
   res = posix_spawn(&amp;pid, argv[0], NULL, NULL, argv, envp);
</pre>
<pre>   if (res&#160;!= 0) {
       printf("Cannot spawn tracedaemon process, error&#160;%d\n", res);
       printf("Errno:&#160;%d\n", errno);
       pid = 0;
       return -1;
   }
</pre>
<pre>   //Wait one second for tracedaemon to start up.
   sleep(1);
</pre>
<pre>   //Since tracedaemon forks, wait for tracedaemon%u2019s parent process to end.
   res = waitpid(pid, &amp;status, WNOHANG);
</pre>
<pre>   //Spawn mapProcThread.
   res = posix_spawn(&amp;pid, argv2[0], NULL, NULL, argv, envp);
</pre>
<pre>   if (res&#160;!= 0) {
       printf("Cannot spawn mapProcThread process, error&#160;%d\n", res);
       printf("Errno:&#160;%d\n", errno);
       pid = 0;
       return -1;
   }
</pre>
<pre>   //Wait for mapProcThread process to end.
   res = waitpid(pid, &amp;status, WNOHANG);
   return 0;
</pre>
<p>}
</p><p>int stopTraceDaemon()
{
</p>
<pre>   int pid, res, status;
   char * argv[] = { "/usr/bin/killall", "tracedaemon", (char *) 0 };
   char * envp[] = { (char *) 0 };
</pre>
<pre>   res = posix_spawn(&amp;pid, argv[0], NULL, NULL, argv, envp);
   if (res&#160;!= 0) {
       printf("Cannot spawn killall process, error&#160;%d\n", res);
       printf("Errno:&#160;%d\n", errno);
       pid = 0;
       return -1;
   }
</pre>
<pre>   //Wait one second for tracedaemon to stop.
   sleep(1);
</pre>
<pre>   //Wait for killall process to end.
   res = waitpid(pid, &amp;status, WNOHANG);
   return 0;
</pre>
<p>}
</p><p>int startTraceUtil()
{
</p>
<pre>   char * sCECmdPipeFile = "/tmp/cecmdpipe";
   char * sResetfiles = "resetfiles";
   char * sStartTraceUtil = "socrates=on";
   int nCECmdPipeFile;
</pre>
<pre>   //Open cecmdpipe file for writing.
   if ((nCECmdPipeFile = open(sCECmdPipeFile, O_WRONLY)) &lt; 0) {
       printf("Cannot open cecmdpipefile for writing.\n");
       return -1;
   }
</pre>
<pre>   //Write resetfiles to cecmdpipe
   if (write(nCECmdPipeFile, sResetFiles, strlen(sResetFiles)+1) == 0) {
       close(nCECmdPipeFile);
       printf("Cannot write to cecmdpipefile.\n");
       return -1;
   }
</pre>
<pre>   //Write "socrates=on" to cecmdpipe.
   if (write(nCECmdPipeFile, sStartTraceUtil, strlen(sStartTraceUtil)+1) == 0) {
       close(nCECmdPipeFile);
       printf("Cannot write to cecmdpipefile.\n");
       return -1;
   }
   //Close cecmdpipe file.
   close(nCECmdPipeFile);
   return 0;
</pre>
<p>}
</p><p>void stopTraceUtil()
{
</p>
<pre>   char * sCECmdPipeFile = "/tmp/cecmdpipe";
   char * sStopTraceUtil = "socrates=off";
   int nCECmdPipeFile;
</pre>
<pre>   //Open cecmdpipe file for writing.
   if ((nCECmdPipeFile = open(sCECmdPipeFile, O_WRONLY)) &lt; 0) {
       printf("Cannot open cecmdpipefile for writing.\n");
       return;
   }
   if (write(nCECmdPipeFile, sStopTraceUtil, strlen(sStopTraceUtil)+1) == 0) {
       close(nCECmdPipeFile);
       printf("Cannot write to cecmdpipefile.\n");
       return;
   }
</pre>
<pre>  //Close cecmdpipe file.
  close(nCECmdPipeFile);
</pre>
<p>}
</p><p>//Start TraceDaemon and TraceUtil logging.
//Must be called after TraceUtil thread is created: TraceUtil_start(engineName).
int startLogging()
{
</p>
<pre>   //Start TraceDaemon
   if (startTraceDaemon() ==0) {
       //Start TraceUtil
       if (startTraceUtil() ==0) {
           return 0;
       }
       else {
           //If TraceUtil failed to start, stop TraceDaemon.
           stopTraceDaemon();
           return -1;
       }
       return 0;
   }
   else {
       return -1;
   }
</pre>
<p>}
</p><p>void stopLogging()
{
</p>
<pre>   //Stop TraceUtil &amp; TraceDaemon.
   stopTraceUtil();
   stopTraceDaemon();
</pre>
<p>}
&lt;/syntaxhighlight&gt;
</p><p><br />
</p>
<h3><span class="mw-headline" id="Add_Custom_GT_Module_to_Application">Add Custom GT Module to Application</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=58" title="Edit section: Add Custom GT Module to Application">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>&lt;syntaxhighlight lang="c"&gt;
</p>
<ol><li>include &lt;ti/sdo/utils/trace/gt.h&gt;</li></ol>
<p>...
</p>
<ol><li>define GTNAME "CUSTOM_MODULE"</li></ol>
<p>...
static GT_Mask traceMask = {0,0};
int counter = 0;
</p><p>int init(...)
{
...
</p>
<pre>   GT_create(&amp;traceMask,GTNAME);
   GT_set(GTNAME"=01234567");
</pre>
<p>...
}
</p><p>int process(...)
{
...
</p>
<pre>   counter++;
   GT_1trace(traceMask,GT_4CLASS | GT_5CLASS,"Counter:&#160;%d\n",counter);
</pre>
<p>...
}
&lt;/syntaxhighlight&gt;
</p>
<h3><span class="mw-headline" id="Add_custom_LOG_messages_to_BIOS_Log">Add custom LOG_messages to BIOS Log</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=59" title="Edit section: Add custom LOG messages to BIOS Log">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>&lt;syntaxhighlight lang="c"&gt;
</p>
<ol><li>ifdef _TMS320C6400_PLUS</li>
<li>include &lt;ti/bios/include/log.h&gt;</li>
<li>endif</li></ol>
<p>...
</p><p>int process(...)
{
</p>
<pre>   int arg1 = 1;
</pre>
<p>...
</p>
<ol><li>ifdef _TMS320C6400_PLUS</li></ol>
<pre>   LOG_message("Custom Message:&#160;%d\n",arg1);
</pre>
<ol><li>endif</li></ol>
<p>...
}
&lt;/syntaxhighlight&gt;
</p>
<h1><span class="mw-headline" id="SoC_Analyzer_for_Single_Core_Devices">SoC Analyzer for Single Core Devices</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=60" title="Edit section: SoC Analyzer for Single Core Devices">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>Please see <a href="User_DVT/UserDocumentation/DVT_SoC_Analyzer.html" title="User:DVT/UserDocumentation/DVT SoC Analyzer">User:DVT/UserDocumentation/DVT_SoC_Analyzer</a>
</p>
<h1><span class="mw-headline" id="Issues_and_Error_Messages">Issues and Error Messages</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=61" title="Edit section: Issues and Error Messages">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h2><span class="mw-headline" id="Out_of_sequence_log_received._Expecting_xxxx_but_received_yyyy">Out of sequence log received. Expecting xxxx but received yyyy</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit&amp;section=62" title="Edit section: Out of sequence log received. Expecting xxxx but received yyyy">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>This problem relates to the fixed size of the BIOS log buffers. Since they are circular, it can happen that information gets overwritten if not fetch frequently enough. Since they are timestamped and indexed, the SoC Analyzer can detect whether a log entry is missing. To prevent for buffer overflow, fetch trace data more frequently from the DSP server. To do so, a variable named 'refreshperiod' has to be changed (default value = 200 ms). This variable indicates how often trace data gets fetched from the DSP.<br />
</p>
<ul><li>edit your application configuration file (e.g. decode.cfg)</li>
<li>right below the lines</li></ul>
<p>&lt;syntaxhighlight lang="javascript"&gt;
var TraceUtil = xdc.useModule('ti.sdo.ce.utils.trace.TraceUtil');
</p><p>/* configure TraceUtils to run in "SoC Analyzer-friendly" mode */
TraceUtil.attrs = TraceUtil.SOCRATES_TRACING;
&lt;/syntaxhighlight&gt; add the following line &lt;syntaxhighlight lang="javascript"&gt;
TraceUtil.attrs.cmdAliases[0].cmds[2] = "refreshperiod=50";
&lt;/syntaxhighlight&gt; to set the refresh period to 50 ms (or less). Rebuild your application.<br /><br />
</p>
<!-- 
NewPP limit report
Cached time: 20201201024150
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.170 seconds
Real time usage: 0.173 seconds
Preprocessor visited node count: 615/1000000
Preprocessor generated node count: 1068/1000000
Post‐expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 2623/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 -total
-->
</div>
<!-- Saved in parser cache with key procwiki:pcache:idhash:853-0!canonical and timestamp 20201201024150 and revision id 181473
 -->
<div class='hf-nsfooter' id='hf-nsfooter-'><table style="text-align:center; background:white; width:100%; text-align:left; height: 65px border-top: 1px solid; border-bottom: 1px solid; border-left: 1px solid; border-right: 1px solid; border-width: 1px; border-style: solid;">
<tr>
<td width="305px"><a href="File_E2e.html" class="image"><img alt="E2e.jpg" src="https://processors.wiki.ti.com/images/8/82/E2e.jpg" width="305" height="63" /></a>
</td>
<td>{{
<ol><li>switchcategory:MultiCore=</li></ol>
<ul><li>For technical support on MultiCore devices, please post your questions in the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/c6000_multi-core_dsps/default.aspx">C6000 MultiCore Forum</a></li>
<li>For questions related to the BIOS MultiCore SDK (MCSDK), please use the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/embedded/f/355.aspx">BIOS Forum</a></li></ul>
<p>Please post only comments related to the article <b>SoC Analyzer</b> here.<i></i>
</p>
</td>
<td>Keystone=
<ul><li>For technical support on MultiCore devices, please post your questions in the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/c6000_multi-core_dsps/default.aspx">C6000 MultiCore Forum</a></li>
<li>For questions related to the BIOS MultiCore SDK (MCSDK), please use the <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/embedded/f/355.aspx">BIOS Forum</a></li></ul>
<p>Please post only comments related to the article <b>SoC Analyzer</b> here.<i></i>
</p>
</td>
<td>C2000=<i>For technical support on the C2000 please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/microcontrollers/tms320c2000_32-bit_real-time_mcus/f/171.aspx">The C2000 Forum</a>. Please post only comments about the article <b>SoC Analyzer</b> here.</i>
</td>
<td>DaVinci=<i>For technical support on DaVincoplease post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/davinci_digital_media_processors/default.aspx">The DaVinci Forum</a>. Please post only comments about the article <b>SoC Analyzer</b> here.</i>
</td>
<td>MSP430=<i>For technical support on MSP430 please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/microcontrollers/msp43016-bit_ultra-low_power_mcus/default.aspx">The MSP430 Forum</a>. Please post only comments about the article <b>SoC Analyzer</b> here.</i>
</td>
<td>OMAP35x=<i>For technical support on OMAP please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/omap_applications_processors/default.aspx">The OMAP Forum</a>. Please post only comments about the article <b>SoC Analyzer</b> here.</i>
</td>
<td>OMAPL1=<i>For technical support on OMAP please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/dsp/omap_applications_processors/default.aspx">The OMAP Forum</a>. Please post only comments about the article <b>SoC Analyzer</b> here.</i>
</td>
<td>MAVRK=<i>For technical support on MAVRK please post your questions on <a rel="nofollow" class="external text" href="http://e2e.ti.com/support/development_tools/mavrk/default.aspx">The MAVRK Toolbox Forum</a>. Please post only comments about the article <b>SoC Analyzer</b> here.</i>
</td>
<td><i>For technical support please post your questions at <a rel="nofollow" class="external text" href="http://e2e.ti.com/">http://e2e.ti.com</a>. Please post only comments about the article <b>SoC Analyzer</b> here.</i>
<p>}}
</p>
</td></tr></table>
<table style="border-style:solid; border-width:1px; text-align:center; width:100%;">

<tr style="font-size:150%;">
<td rowspan="2"><a href="File_Hyperlink_blue.html" class="image"><img alt="Hyperlink blue.png" src="https://processors.wiki.ti.com/images/9/9f/Hyperlink_blue.png" width="96" height="96" /></a>
</td>
<td><b>Links</b>
</td></tr>
<tr>
<td>
<table style="text-align: left;">
<tr>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/amplifier_and_linear.page">Amplifiers &amp; Linear</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/audio/audio_overview.page">Audio</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/rfif.page">Broadband RF/IF &amp; Digital Radio</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/clocksandtimers/clocks_and_timers.page">Clocks &amp; Timers</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/dataconverters/data_converter.page">Data Converters</a>
</p>
</td>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/mems/mems.page">DLP &amp; MEMS</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/high_reliability.page">High-Reliability</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/interface/interface.page">Interface</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/logic/home_overview.page">Logic</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/powermanagement/power_portal.page">Power Management</a>
</p>
</td>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/dsp/embedded_processor.page">Processors</a>
</p>
<ul><li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/dsp/arm.page">ARM Processors</a></li>
<li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/dsp/home.page">Digital Signal Processors (DSP)</a></li>
<li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/microcontroller/home.page">Microcontrollers (MCU)</a></li>
<li><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/omap-applications-processors/the-omap-experience.page">OMAP Applications Processors</a></li></ul>
</td>
<td style="padding-right: 10px; vertical-align: top;">
<p><a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/switches_and_multiplexers.page">Switches &amp; Multiplexers</a><br/>
<a rel="nofollow" class="external text" href="http://www.ti.com/lsds/ti/analog/temperature_sensor.page">Temperature Sensors &amp; Control ICs</a><br/>
<a rel="nofollow" class="external text" href="http://focus.ti.com/wireless/docs/wirelessoverview.tsp?familyId=2003&amp;sectionId=646&amp;tabId=2735">Wireless Connectivity</a>
</p>
</td></tr></table>
</td></tr></table>
<div id="tiPrivacy"></div>
</div></div>					<div class="printfooter">
						Retrieved from "<a dir="ltr" href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;oldid=181473">https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;oldid=181473</a>"					</div>
				<div id="catlinks" class="catlinks catlinks-allhidden" data-mw="interface"></div>				<div class="visualClear"></div>
							</div>
		</div>
		<div id="mw-navigation">
			<h2>Navigation menu</h2>
			<div id="mw-head">
									<div id="p-personal" role="navigation" class="" aria-labelledby="p-personal-label">
						<h3 id="p-personal-label">Personal tools</h3>
						<ul>
							<li id="pt-login"><a href="https://processors.wiki.ti.com/index.php?title=Special:UserLogin&amp;returnto=SoC+Analyzer" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li><li id="pt-createaccount"><a href="Special_RequestAccount.html" title="You are encouraged to create an account and log in; however, it is not mandatory">Request account</a></li>						</ul>
					</div>
									<div id="left-navigation">
										<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
						<h3 id="p-namespaces-label">Namespaces</h3>
						<ul>
							<li id="ca-nstab-main" class="selected"><span><a href="SoC_Analyzer.html" title="View the content page [c]" accesskey="c">Page</a></span></li><li id="ca-talk"><span><a href="Talk_SoC_Analyzer.html" rel="discussion" title="Discussion about the content page [t]" accesskey="t">Discussion</a></span></li>						</ul>
					</div>
										<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
												<input type="checkbox" class="vectorMenuCheckbox" aria-labelledby="p-variants-label" />
						<h3 id="p-variants-label">
							<span>Variants</span>
						</h3>
						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
									</div>
				<div id="right-navigation">
										<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
						<h3 id="p-views-label">Views</h3>
						<ul>
							<li id="ca-view" class="collapsible selected"><span><a href="SoC_Analyzer.html">Read</a></span></li><li id="ca-viewsource" class="collapsible"><span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></span></li><li id="ca-history" class="collapsible"><span><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=history" title="Past revisions of this page [h]" accesskey="h">View history</a></span></li>						</ul>
					</div>
										<div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label">
						<input type="checkbox" class="vectorMenuCheckbox" aria-labelledby="p-cactions-label" />
						<h3 id="p-cactions-label"><span>More</span></h3>
						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
										<div id="p-search" role="search">
						<h3>
							<label for="searchInput">Search</label>
						</h3>
						<form action="https://processors.wiki.ti.com/index.php" id="searchform">
							<div id="simpleSearch">
								<input type="search" name="search" placeholder="Search Texas Instruments Wiki" title="Search Texas Instruments Wiki [f]" accesskey="f" id="searchInput"/><input type="hidden" value="Special:Search" name="title"/><input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton mw-fallbackSearchButton"/><input type="submit" name="go" value="Go" title="Go to a page with this exact name if it exists" id="searchButton" class="searchButton"/>							</div>
						</form>
					</div>
									</div>
			</div>
			<div id="mw-panel">
				<div id="p-logo" role="banner"><a class="mw-wiki-logo" href="Main_Page.html"  title="Visit the main page"></a></div>
						<div class="portal" role="navigation" id="p-navigation" aria-labelledby="p-navigation-label">
			<h3 id="p-navigation-label">Navigation</h3>
			<div class="body">
								<ul>
					<li id="n-mainpage"><a href="Main_Page.html" title="Visit the main page [z]" accesskey="z">Main Page</a></li><li id="n-All-pages"><a href="Special_AllPages.html">All pages</a></li><li id="n-All-categories"><a href="Special_Categories.html">All categories</a></li><li id="n-recentchanges"><a href="Special_RecentChanges.html" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li><li id="n-randompage"><a href="Package_Reflow_Profiles.html" title="Load a random page [x]" accesskey="x">Random page</a></li><li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" title="The place to find out">Help</a></li>				</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id="p-tb" aria-labelledby="p-tb-label">
			<h3 id="p-tb-label">Toolbox</h3>
			<div class="body">
								<ul>
					<li id="t-whatlinkshere"><a href="Special_WhatLinksHere/SoC_Analyzer.html" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li><li id="t-recentchangeslinked"><a href="Special_RecentChangesLinked/SoC_Analyzer.html" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li><li id="t-specialpages"><a href="Special_SpecialPages.html" title="A list of all special pages [q]" accesskey="q">Special pages</a></li><li id="t-print"><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li><li id="t-permalink"><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;oldid=181473" title="Permanent link to this revision of the page">Permanent link</a></li><li id="t-info"><a href="https://processors.wiki.ti.com/index.php?title=SoC_Analyzer&amp;action=info" title="More information about this page">Page information</a></li>				</ul>
							</div>
		</div>
				</div>
		</div>
				<div id="footer" role="contentinfo">
						<ul id="footer-info">
								<li id="footer-info-lastmod"> This page was last edited on 14 July 2014, at 08:57.</li>
								<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-ShareAlike</a> unless otherwise noted.</li>
							</ul>
						<ul id="footer-places">
								<li id="footer-places-privacy"><a href="Project_Privacy_policy.html" title="Project:Privacy policy">Privacy policy</a></li>
								<li id="footer-places-about"><a href="Project_About.html" title="Project:About">About Texas Instruments Wiki</a></li>
								<li id="footer-places-disclaimer"><a href="Project_General_disclaimer.html" title="Project:General disclaimer">Disclaimers</a></li>
								<li id="footer-places-termsofservice"><a href="Project_Terms_of_Service.html" title="Project:Terms of Service">Terms of Use</a></li>
							</ul>
										<ul id="footer-icons" class="noprint">
										<li id="footer-copyrightico">
						<a href="http://creativecommons.org/licenses/by-sa/3.0/"><img src="https://processors.wiki.ti.com/resources/assets/licenses/cc-by-sa.png" alt="Creative Commons Attribution-ShareAlike" width="88" height="31"/></a>					</li>
										<li id="footer-poweredbyico">
						<a href="http://www.mediawiki.org/"><img src="https://processors.wiki.ti.com/resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31"/></a>					</li>
									</ul>
						<div style="clear: both;"></div>
		</div>
		<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgPageParseReport":{"limitreport":{"cputime":"0.170","walltime":"0.173","ppvisitednodes":{"value":615,"limit":1000000},"ppgeneratednodes":{"value":1068,"limit":1000000},"postexpandincludesize":{"value":0,"limit":2097152},"templateargumentsize":{"value":0,"limit":2097152},"expansiondepth":{"value":2,"limit":40},"expensivefunctioncount":{"value":0,"limit":100},"unstrip-depth":{"value":0,"limit":20},"unstrip-size":{"value":2623,"limit":5000000},"timingprofile":["100.00%    0.000      1 -total"]},"cachereport":{"timestamp":"20201201024150","ttl":86400,"transientcontent":false}}});});</script><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":228});});</script>
	</body>

<!-- Mirrored from processors.wiki.ti.com/index.php/SoC_Analyzer by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 01 Dec 2020 07:03:34 GMT -->
</html>
